{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/manifest/v4.json", "dbt_version": "1.0.8", "generated_at": "2022-07-29T11:22:56.010419Z", "invocation_id": "c87396a1-3193-4bd6-9fc6-4a447c319699", "env": {}, "project_id": "10f53ae29c3b4573637ab6cc443d3a2c", "user_id": "04771a38-b3e0-4816-a709-106e0abb7ac1", "send_anonymous_usage_stats": true, "adapter_type": "snowflake"}, "nodes": {"model.OI_Foundation.ns_opco_gl_trans": {"raw_sql": "{{ config(\r\n    post_hook=\r\n    [\"UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\r\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '4')\r\n    WHERE SRC_KEY_TXT IN ('28794802|0', '28794802|1', '28794152|0', '28794152|1', '28794477|1', '28794477|0', '29073638|0', '29073638|1', '29072175|0', '29072175|1')\" \r\n    ,\r\n    \"UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\r\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '12')\r\n    WHERE SRC_KEY_TXT IN ('261322|0', '261322|12', '261322|13')\"]\r\n) }}\r\n\r\n{% set _load = load_type('NS_OPCO_GL_TRANS') %}\r\n\r\nwith ns_opco_gl_trans as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    tl._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when tl._fivetran_deleted = true then tl._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    concat_ws('|', tl.transaction_id, tl.transaction_line_id)::varchar(50) as src_key_txt,\r\n    t.trandate::timestamp as trans_dt,\r\n    opco.opco_sk,\r\n    oca.opco_chart_of_accts_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    null::varchar(32) as opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    null::varchar(32) as opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    null::varchar(32) as opco_proj_sk,\r\n    null::varchar(32) as original_gl_opco_sk,\r\n    null::varchar(20) as original_gl_voucher_nbr,\r\n    t.document_number::varchar(20) as voucher_nbr,\r\n    t.document_number::varchar(20) as journal_batch_nbr,\r\n    tl.memo::varchar(5000) as gl_desc,\r\n    t.document_number::varchar(20) as document_nbr,\r\n    t.document_date::date as document_dt,\r\n    null::numeric(1,0) as crrctn_trans_ind,\r\n    case \r\n        when is_leftside = 'F' then 1\r\n        when is_leftside = 'T' then 0\r\n    end::numeric(1,0) as credit_ind,\r\n    tl.opi_qty::float as gl_qty,\r\n    tl.amount_foreign::float as trans_currency_gl_amt,\r\n    tl.amount::float as opco_currency_gl_amt,\r\n    fc.fscl_yr_id as fscl_yr_nbr,\r\n    fc.fscl_mnth_nbr as fscl_mnth_nbr,\r\n    case    \r\n        when a.type_name <> 'Statistical' and  tl.non_posting_line = 'No' then 1\r\n        when a.type_name <> 'Statistical' and  tl.non_posting_line = 'Yes' then 0\r\n        when a.type_name = 'Statistical' then 1\r\n    end::numeric(1,0) as posted_ind,\r\n    ou.opco_uom_sk,\r\n    ob.opco_brand_sk,\r\n    null::varchar(32) as opco_sub_ledger_type_sk,\r\n    null::varchar(32) as sub_ledger_cd\r\n    from {{ source('NS_DEV', 'TRANSACTION_LINES') }} tl\r\n    left join {{ source('NS_DEV', 'TRANSACTIONS')}} t \r\n        on tl.transaction_id = t.transaction_id\r\n        and t._fivetran_deleted = false\r\n    left join {{ source('NS_DEV', 'ACCOUNTING_PERIODS')}} ap \r\n        on t.accounting_period_id = ap.accounting_period_id\r\n        and ap._fivetran_deleted = false\r\n    left join {{ source('NS_DEV', 'ACCOUNTS')}} a\r\n        on tl.account_id = a.account_id\r\n        and a._fivetran_deleted = false\r\n    left join {{ ref('v_ns_opco_curr')}} opco \r\n        on tl.subsidiary_id = opco.opco_id\r\n        and opco.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_chart_of_accts_curr')}} oca \r\n        on a.accountnumber = oca.gl_acct_nbr\r\n        and tl.subsidiary_id = oca.opco_id\r\n        and oca.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_gl_trans_type_curr')}} ogt \r\n        on upper(t.transaction_type) = ogt.src_gl_trans_type_cd\r\n        and ogt.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_cost_center_curr')}} occ \r\n        on upper(tl.location_id) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_dept_curr')}} od \r\n        on upper(tl.department_id) = od.src_dept_cd\r\n        and od.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_type_curr')}} ot \r\n        on upper(substr(a.opi_ax_acct, 8)) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_purpose_curr')}} oip\r\n        on upper(tl.market_opi_id) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_currency_curr')}} oc\r\n        on upper(t.currency_id) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_uom_curr')}} ou \r\n        on ou.src_uom_cd = upper(a.opi_qty_uom_id)\r\n        and ou.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_brand_curr')}} ob \r\n        on tl.class_id = ob.src_brand_cd\r\n        and ob.src_sys_nm = 'NS'\r\n    left join {{ ref('fscl_clndr')}} fc \r\n        on fc.clndr_dt = date(ap.ending)\r\n    where tl.account_id is not null\r\n),\r\nfinal as (\r\n    select  distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt']) }} as opco_gl_trans_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'trans_dt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'opco_proj_sk', 'original_gl_opco_sk', 'original_gl_voucher_nbr', 'voucher_nbr', 'journal_batch_nbr', 'gl_desc', 'document_nbr', 'document_dt', 'crrctn_trans_ind', 'gl_qty', 'trans_currency_gl_amt', 'opco_currency_gl_amt', 'fscl_yr_nbr', 'fscl_mnth_nbr', 'posted_ind', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd']) }} as opco_gl_trans_ck,\r\n            concat_ws('|', src_sys_nm, src_key_txt)::varchar(100) as opco_gl_trans_ak,\r\n            * \r\n    from ns_opco_gl_trans ogt\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_GL_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_GL_TRANS_SK, OPCO_GL_TRANS_CK, OPCO_GL_TRANS_AK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_key_txt, trans_dt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, opco_proj_sk, original_gl_opco_sk, original_gl_voucher_nbr, voucher_nbr, journal_batch_nbr, gl_desc, document_nbr, document_dt, crrctn_trans_ind, credit_ind, gl_qty, trans_currency_gl_amt, opco_currency_gl_amt, fscl_yr_nbr, fscl_mnth_nbr, posted_ind, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.TRANSACTION_LINES", "source.OI_Foundation.NS_DEV.TRANSACTIONS", "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "model.OI_Foundation.v_ns_opco_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_purpose_curr", "model.OI_Foundation.v_ns_opco_currency_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "model.OI_Foundation.v_ns_opco_brand_curr", "model.OI_Foundation.fscl_clndr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [{"sql": "UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '4')\n    WHERE SRC_KEY_TXT IN ('28794802|0', '28794802|1', '28794152|0', '28794152|1', '28794477|1', '28794477|0', '29073638|0', '29073638|1', '29072175|0', '29072175|1')", "transaction": true, "index": null}, {"sql": "UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '12')\n    WHERE SRC_KEY_TXT IN ('261322|0', '261322|12', '261322|13')", "transaction": true, "index": null}], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "general_ledger", "ns_opco_gl_trans"], "unique_id": "model.OI_Foundation.ns_opco_gl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/general_ledger/ns_opco_gl_trans.sql", "original_file_path": "models/ns/general_ledger/ns_opco_gl_trans.sql", "name": "ns_opco_gl_trans", "alias": "ns_opco_gl_trans", "checksum": {"name": "sha256", "checksum": "46bc564838eac6753ea7477ac9b46d3bd5ec439bc2576bbe3c75436e832d8b88"}, "tags": [], "refs": [["v_ns_opco_curr"], ["v_ns_opco_chart_of_accts_curr"], ["v_ns_opco_gl_trans_type_curr"], ["v_ns_opco_cost_center_curr"], ["v_ns_opco_dept_curr"], ["v_ns_opco_type_curr"], ["v_ns_opco_purpose_curr"], ["v_ns_opco_currency_curr"], ["v_ns_opco_uom_curr"], ["v_ns_opco_brand_curr"], ["fscl_clndr"]], "sources": [["NS_DEV", "TRANSACTION_LINES"], ["NS_DEV", "TRANSACTIONS"], ["NS_DEV", "ACCOUNTING_PERIODS"], ["NS_DEV", "ACCOUNTS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false, "post-hook": ["UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '4')\n    WHERE SRC_KEY_TXT IN ('28794802|0', '28794802|1', '28794152|0', '28794152|1', '28794477|1', '28794477|0', '29073638|0', '29073638|1', '29072175|0', '29072175|1')", "UPDATE OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_GL_TRANS\n    SET OPCO_COST_CENTER_SK = (SELECT OPCO_COST_CENTER_SK FROM OI_DATA_DEV.INTERMEDIATE_FND_DEV.NS_OPCO_COST_CENTER WHERE SRC_COST_CENTER_CD = '12')\n    WHERE SRC_KEY_TXT IN ('261322|0', '261322|12', '261322|13')"]}, "created_at": 1659086792.72558}, "model.OI_Foundation.ns_opco_chart_of_accts_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_chart_of_accts_type as (\r\n  {% set values_cd = [ 'ACCOUNTS PAYABLE', 'ACCOUNTS RECEIVABLE', 'BANK', 'COST OF GOODS SOLD', 'CREDIT CARD', 'DEFERRED EXPENSE',\r\n   'DEFERRED REVENUE', 'EQUITY', 'EXPENSE', 'FIXED ASSET', 'INCOME', 'LONG TERM LIABILITY', 'NON POSTING', 'OTHER ASSET',\r\n    'OTHER CURRENT ASSET', 'OTHER CURRENT LIABILITY', 'OTHER EXPENSE', 'OTHER INCOME', 'STATISTICAL','UNBILLED RECEIVABLE'] %}\r\n\r\n\r\n  {% set values_desc = [ 'Accounts Payable', 'Accounts Receivable', 'Bank', 'Cost Of Goods Sold', 'Credit Card', 'Deferred Expense',\r\n   'Deferred Revenue', 'Equity', 'Expense', 'Fixed Asset', 'Income', 'Long Term Liability', 'Non-Posting', 'Other Asset',\r\n    'Other Current Asset', 'Other Current Liability', 'Other Expense', 'Other Income', 'Statistical','Unbilled Receivable'] %}\r\n\r\n  {% for i in range(20) %}\r\n    select current_timestamp as crt_dtm,\r\n        'NS'::varchar(20) as src_sys_nm,\r\n        '{{values_cd[i]}}'::varchar(50) as src_acct_type_cd,\r\n        '{{values_desc[i]}}'::varchar(100) as src_acct_type_desc\r\n        {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_acct_type_cd']) }} as opco_chart_of_accts_type_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_acct_type_cd', 'src_acct_type_desc']) }} as opco_chart_of_accts_type_ck,\r\n            * \r\n    from opco_chart_of_accts_type  \r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "general_ledger", "ns_opco_chart_of_accts_type"], "unique_id": "model.OI_Foundation.ns_opco_chart_of_accts_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/general_ledger/ns_opco_chart_of_accts_type.sql", "original_file_path": "models/ns/general_ledger/ns_opco_chart_of_accts_type.sql", "name": "ns_opco_chart_of_accts_type", "alias": "ns_opco_chart_of_accts_type", "checksum": {"name": "sha256", "checksum": "ae6fea78c14e372e288930d70582b8f8284f0b6108c8c6a90146af464aebf931"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086792.7814667}, "model.OI_Foundation.ns_opco_chart_of_accts": {"raw_sql": "{% set _load = load_type('NS_OPCO_CHART_OF_ACCTS') %}\r\n\r\nwith ns_opco_chart_of_accts as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    acct._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when acct._fivetran_deleted = true then acct._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    acct.accountnumber::varchar(20) as gl_acct_nbr,\r\n    null::varchar(15) as opco_id,\r\n    acct.name::varchar(100) as gl_acct_nm,\r\n    coa.chart_of_accts_sk,\r\n    cc.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    null::varchar(32) as opco_purpose_sk,\r\n    null::varchar(32) as opco_lob_sk,\r\n    cat.opco_chart_of_accts_type_sk,\r\n    ou.opco_uom_sk,\r\n    acct.full_name::varchar(120) as gl_acct_alias_nm,\r\n    null::number(1,0) as manual_entry_allowed_ind,\r\n    case \r\n        when acct.dpo_flag = 'T' then 0::number(1,0)\r\n        when acct.dpo_flag = 'F' then 1::number(1,0)\r\n    end as dpo_exclusion_ind,\r\n    null::number(1,0) as movement_allowed_ind,\r\n    null::varchar(50) as cost_center_reqd_txt,\r\n    null::varchar(50) as dept_reqd_txt,\r\n    null::varchar(50) as type_reqd_txt,\r\n    acct.parent_id::varchar(10) as prnt_gl_acct_nbr,\r\n    null::varchar(10) as related_gl_acct_nbr,\r\n    null::varchar(10) as monetary_gl_acct_ind,\r\n    iff(acct.isinactive='No', 1::number(1,0), 0::number(1,0)) as actv_ind,\r\n    case\r\n        when is_balancesheet = 'T' then 1::number(1,0)\r\n        when is_balancesheet = 'F' then 0::number(1,0)\r\n    end as balance_sheet_acct_ind,\r\n    case\r\n        when is_summary = 'Yes' then 1::number(1,0)\r\n        when is_summary = 'No' then 0::number(1,0)\r\n    end as summary_acct_ind,\r\n    ob.opco_brand_sk,\r\n    null::varchar(20) as acct_clssfctn_cd,\r\n    null::varchar(20) as sub_acct_nbr\r\n    from {{source('NS_DEV', 'ACCOUNTS')}} acct\r\n    left join {{ref('chart_of_accts')}} coa \r\n        on left(acct.opi_ax_acct, 6) = coa.gl_acct_nbr\r\n        and acct.opi_ax_acct is not null\r\n        and acct.opi_ax_acct not in ('none', 'None')\r\n    left join {{ref('v_ns_opco_cost_center_curr')}} cc \r\n        on upper(acct.location_id) = cc.src_cost_center_cd\r\n        and cc.src_sys_nm = 'NS'\r\n    left join {{ref('v_ns_opco_dept_curr')}} od \r\n        on upper(acct.department_id) = od.src_dept_cd\r\n        and od.src_sys_nm = 'NS'\r\n    left join {{ref('v_ns_opco_type_curr')}} ot \r\n        on upper(substr(acct.opi_ax_acct, 8)) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'NS'\r\n        and acct.opi_ax_acct is not null\r\n    left join {{ref('v_ns_opco_chart_of_accts_type_curr')}} cat \r\n        on upper(acct.type_name) = cat.src_acct_type_cd\r\n        and cat.src_sys_nm = 'NS'\r\n    left join {{ref('v_ns_opco_uom_curr')}} ou \r\n        on upper(acct.opi_qty_uom_id) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_brand_curr')}} ob \r\n        on acct.class_id = ob.src_brand_cd\r\n        and ob.src_sys_nm = 'NS'\r\n    where acct.accountnumber is not null\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['cat.src_sys_nm', 'cat.gl_acct_nbr', 'sb.subsidiary_id']) }} as opco_chart_of_accts_sk,\r\n            {{ dbt_utils.surrogate_key(['cat.src_sys_nm', 'cat.gl_acct_nbr', 'sb.subsidiary_id', 'cat.gl_acct_nm', 'cat.chart_of_accts_sk', 'cat.opco_cost_center_sk', 'cat.opco_dept_sk', 'cat.opco_type_sk', 'cat.opco_purpose_sk', 'cat.opco_lob_sk', 'cat.opco_chart_of_accts_type_sk', 'cat.opco_uom_sk', 'cat.gl_acct_alias_nm', 'cat.manual_entry_allowed_ind', 'cat.dpo_exclusion_ind', 'cat.movement_allowed_ind', 'cat.cost_center_reqd_txt', 'cat.dept_reqd_txt', 'cat.type_reqd_txt', 'accts.accountnumber', 'cat.related_gl_acct_nbr', 'cat.monetary_gl_acct_ind', 'cat.actv_ind', 'cat.balance_sheet_acct_ind', 'cat.summary_acct_ind', 'cat.opco_brand_sk', 'cat.acct_clssfctn_cd', 'cat.sub_acct_nbr']) }} as opco_chart_of_accts_ck,\r\n            cat.crt_dtm, cat.stg_load_dtm, cat.delete_dtm, cat.src_sys_nm, cat.gl_acct_nbr, sb.subsidiary_id as opco_id, cat.gl_acct_nm, cat.chart_of_accts_sk, cat.opco_cost_center_sk, cat.opco_dept_sk, cat.opco_type_sk, cat.opco_purpose_sk, cat.opco_lob_sk, cat.opco_chart_of_accts_type_sk, cat.opco_uom_sk, cat.gl_acct_alias_nm, cat.manual_entry_allowed_ind, cat.dpo_exclusion_ind, cat.movement_allowed_ind, cat.cost_center_reqd_txt, cat.dept_reqd_txt, cat.type_reqd_txt, accts.accountnumber as prnt_gl_acct_nbr, cat.related_gl_acct_nbr, cat.monetary_gl_acct_ind, cat.actv_ind, cat.balance_sheet_acct_ind, cat.summary_acct_ind, cat.opco_brand_sk, cat.acct_clssfctn_cd, cat.sub_acct_nbr\r\n    from ns_opco_chart_of_accts cat\r\n    left join {{ source('NS_DEV', 'ACCOUNTS')}} accts \r\n        on accts.account_id = cat.prnt_gl_acct_nbr\r\n    cross join {{ source('NS_DEV', 'SUBSIDIARIES') }} sb \r\n        where sb.subsidiary_id not in (1, 4, 5, 7)\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_CHART_OF_ACCTS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CHART_OF_ACCTS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_CHART_OF_ACCTS_SK, OPCO_CHART_OF_ACCTS_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, gl_acct_nbr, opco_id, gl_acct_nm, chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, manual_entry_allowed_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind, opco_brand_sk, acct_clssfctn_cd, sub_acct_nbr\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS\r\n    {% if _load == 1 %}\r\n        where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final)\r\n    {% else %}\r\n        where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.SUBSIDIARIES", "model.OI_Foundation.chart_of_accts", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "model.OI_Foundation.v_ns_opco_brand_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "general_ledger", "ns_opco_chart_of_accts"], "unique_id": "model.OI_Foundation.ns_opco_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/general_ledger/ns_opco_chart_of_accts.sql", "original_file_path": "models/ns/general_ledger/ns_opco_chart_of_accts.sql", "name": "ns_opco_chart_of_accts", "alias": "ns_opco_chart_of_accts", "checksum": {"name": "sha256", "checksum": "9d4d735d93999e19fe5407568efd3d055344a9fd6aa10061cef5cfbce6f3dc86"}, "tags": [], "refs": [["chart_of_accts"], ["v_ns_opco_cost_center_curr"], ["v_ns_opco_dept_curr"], ["v_ns_opco_type_curr"], ["v_ns_opco_chart_of_accts_type_curr"], ["v_ns_opco_uom_curr"], ["v_ns_opco_brand_curr"]], "sources": [["NS_DEV", "ACCOUNTS"], ["NS_DEV", "ACCOUNTS"], ["NS_DEV", "SUBSIDIARIES"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.7915363}, "model.OI_Foundation.ns_opco_gl_trans_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_gl_trans_type as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    upper(transaction_type)::varchar(50) as src_gl_trans_type_cd,\r\n    max(transaction_type)::varchar(100) as src_gl_trans_type_desc\r\n    from {{ source('NS_DEV', 'TRANSACTIONS')}}\r\n    group by src_sys_nm, src_gl_trans_type_cd\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd']) }} as opco_gl_trans_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd']) }} as opco_gl_trans_type_ck, \r\n            *\r\n    from opco_gl_trans_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": ["source.OI_Foundation.NS_DEV.TRANSACTIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "general_ledger", "ns_opco_gl_trans_type"], "unique_id": "model.OI_Foundation.ns_opco_gl_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/general_ledger/ns_opco_gl_trans_type.sql", "original_file_path": "models/ns/general_ledger/ns_opco_gl_trans_type.sql", "name": "ns_opco_gl_trans_type", "alias": "ns_opco_gl_trans_type", "checksum": {"name": "sha256", "checksum": "359f203ffe69884e616ab2e76396f6babbccd1d730b9a2fd8343e2dae769bed6"}, "tags": [], "refs": [], "sources": [["NS_DEV", "TRANSACTIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086792.8102393}, "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\n{% set _load = load_type('NS_OPCO_FSCL_YR_GL_OPENING_BAL') %}\r\n\r\nwith ns_opco_fscl_yr_gl_opening_bal as(\r\n    select \r\n    'NS'::varchar(20) as src_sys_nm,\r\n    null::varchar(50) as src_key_txt,\r\n    ifnull(tl.subsidiary_id, -1) as subsidiary_id,\r\n    ifnull(a.accountnumber, '') as accountnumber,\r\n    ifnull(t.transaction_type, '') as transaction_type,\r\n    null as opco_gl_trans_posting_type_sk,\r\n    max(case \r\n            when concat_ws('|', tl.transaction_id, tl.transaction_line_id) in ('28794802|0', '28794802|1', '28794152|0', '28794152|1', '28794477|1', '28794477|0', '29073638|0', '29073638|1', '29072175|0', '29072175|1') then '4'\r\n            when concat_ws('|', tl.transaction_id, tl.transaction_line_id) in ('261322|0', '261322|12', '261322|13') then '12'\r\n            else ifnull(tl.location_id, -1) \r\n        end) as location_id,\r\n    ifnull(tl.department_id, -1) as department_id,\r\n    ifnull(upper(substr(a.opi_ax_acct, 8)), '') as type,\r\n    ifnull(tl.market_opi_id, -1) as market_opi_id,\r\n    ifnull(tl.class_id, -1) as class_id,\r\n    ifnull(t.currency_id, -1) as currency_id,\r\n    ifnull(fscl_yr_id, -1) as fscl_yr_nbr,\r\n    max(a.is_leftside) as credit_ind,\r\n    sum(ifnull(tl.opi_qty, 0)) as opening_bal_qty,\r\n    sum(ifnull(tl.amount_foreign, 0)) as trans_currency_opening_bal_amt,\r\n    sum(ifnull(tl.amount, 0)) as opco_currency_opening_bal_amt\r\n    from {{ source('NS_DEV', 'TRANSACTION_LINES') }} tl\r\n    left join {{ source('NS_DEV', 'TRANSACTIONS')}} t \r\n        on tl.transaction_id = t.transaction_id\r\n        and t._fivetran_deleted = false \r\n    left join {{ source('NS_DEV', 'ACCOUNTING_PERIODS')}} ap \r\n        on t.accounting_period_id = ap.accounting_period_id\r\n        and ap._fivetran_deleted = false \r\n    left join {{ source('NS_DEV', 'ACCOUNTS')}} a\r\n        on tl.account_id = a.account_id\r\n        and a._fivetran_deleted = false \r\n    left join {{ ref('fscl_clndr')}} fc\r\n        on fc.clndr_dt = date(ap.ending)\r\n    where tl.subsidiary_id in (2, 3, 8, 9)\r\n    and case subsidiary_id\r\n            when 2 then year(fc.fscl_yr_strt_dt) >= '2006'\r\n            when 3 then year(fc.fscl_yr_strt_dt) >= '2006'\r\n            when 8 then year(fc.fscl_yr_strt_dt) >= '2016'\r\n            when 9 then year(fc.fscl_yr_strt_dt) >= '2017'\r\n        end\r\n    and tl.account_id is not null\r\n    and tl.non_posting_line = 'No'\r\n    and fc.fscl_yr_id < year(current_timestamp)\r\n    group by subsidiary_id, accountnumber, transaction_type, tl.location_id, tl.department_id, type, tl.market_opi_id, tl.class_id, t.currency_id, fscl_yr_id\r\n),\r\nALL_LEDGER_COMBINATIONS AS\r\n(\r\n    SELECT DISTINCT * FROM\r\n    (SELECT DISTINCT src_sys_nm, subsidiary_id, accountnumber, transaction_type, location_id, department_id, type, market_opi_id, class_id, currency_id\r\n    FROM ns_opco_fscl_yr_gl_opening_bal) A\r\n    CROSS JOIN \r\n    (SELECT DISTINCT FSCL_YR_NBR FROM ns_opco_fscl_yr_gl_opening_bal B)\r\n),\r\nrolled_up_balance as(\r\n    select *,\r\n        sum(ifnull(opening_bal_qty, 0)) over(partition by subsidiary_id, accountnumber, transaction_type, location_id, department_id, type, market_opi_id, class_id, currency_id order by fscl_yr_nbr asc range between unbounded preceding and current row) as opening_bal_qty1,\r\n        sum(ifnull(trans_currency_opening_bal_amt, 0)) over(partition by subsidiary_id, accountnumber, transaction_type, location_id, department_id, type, market_opi_id, class_id, currency_id order by fscl_yr_nbr asc range between unbounded preceding and current row) as trans_currency_opening_bal_amt1,\r\n        sum(ifnull(opco_currency_opening_bal_amt, 0)) over(partition by subsidiary_id, accountnumber, transaction_type, location_id, department_id, type, market_opi_id, class_id, currency_id order by fscl_yr_nbr asc range between unbounded preceding and current row) as opco_currency_opening_bal_amt1\r\n    from ns_opco_fscl_yr_gl_opening_bal\r\n  FULL OUTER JOIN ALL_LEDGER_COMBINATIONS\r\n    USING (src_sys_nm, subsidiary_id, accountnumber, transaction_type, location_id, department_id, type, market_opi_id, class_id, currency_id, fscl_yr_nbr)\r\n),\r\nplus_one_logic as(\r\n    select distinct \r\n    {{ dbt_utils.surrogate_key(['ofgo.src_sys_nm', 'ofgo.subsidiary_id', 'ofgo.accountnumber', 'ofgo.transaction_type', 'ofgo.location_id', 'ofgo.department_id', 'ofgo.type', 'ofgo.market_opi_id', 'ofgo.class_id', 'ofgo.currency_id', 'ofgo.fscl_yr_nbr']) }} as opco_fscl_yr_gl_opening_bal_sk,\r\n    concat_ws('|', ofgo.src_sys_nm, ifnull(ofgo.subsidiary_id::string , ''), ifnull(ofgo.accountnumber::string , ''), ifnull(ofgo.transaction_type::string , ''), ifnull(ofgo.location_id::string , ''), ifnull(ofgo.department_id::string , ''), ifnull(ofgo.type::string , ''), ifnull(ofgo.market_opi_id::string , ''), ifnull(ofgo.class_id::string , ''), ifnull(ofgo.currency_id::string , ''), ifnull(ofgo.fscl_yr_nbr::string , '')) as opco_fscl_yr_gl_opening_bal_ak,\r\n    ofgo.src_sys_nm,\r\n    ofgo.src_key_txt,\r\n    opco.opco_sk,\r\n    oca.opco_chart_of_accts_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    null::varchar(32) as opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    null::varchar(32) as opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    fc.fscl_yr_strt_dt::date as fscl_yr_strt_dt,\r\n    fc.fscl_yr_id::int as fscl_yr_nbr,\r\n    case \r\n        when ofgo.credit_ind = 'F' then 1\r\n        when ofgo.credit_ind = 'T' then 0\r\n    end::numeric(1,0) as credit_ind,\r\n    ifnull(ofgo.opening_bal_qty1, 0)::numeric(38,15) as opening_bal_qty,\r\n    ifnull(ofgo.trans_currency_opening_bal_amt1, 0)::numeric(38,15) as trans_currency_opening_bal_amt,\r\n    ifnull(ofgo.opco_currency_opening_bal_amt1, 0)::numeric(38,15) as opco_currency_opening_bal_amt,\r\n    ou.opco_uom_sk,\r\n    ob.opco_brand_sk\r\n    from rolled_up_balance ofgo\r\n    left join {{ ref('fscl_clndr')}} fc \r\n        on ofgo.fscl_yr_nbr + 1 = fc.fscl_yr_id \r\n    left join {{ source('NS_DEV', 'ACCOUNTS')}} a\r\n        on ofgo.accountnumber = a.accountnumber\r\n        and a._fivetran_deleted = false\r\n    left join {{ ref('v_ns_opco_curr')}} opco \r\n        on ofgo.subsidiary_id = opco.opco_id\r\n        and opco.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_chart_of_accts_curr')}} oca \r\n        on ofgo.accountnumber = oca.gl_acct_nbr\r\n        and oca.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_gl_trans_type_curr')}} ogt \r\n        on ofgo.transaction_type = ogt.src_gl_trans_type_cd\r\n        and ogt.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_cost_center_curr')}} occ \r\n        on upper(ofgo.location_id) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_dept_curr')}} od \r\n        on upper(ofgo.department_id) = od.src_dept_cd\r\n        and od.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_type_curr')}} ot \r\n        on upper(ofgo.type) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_purpose_curr')}} oip\r\n        on upper(ofgo.market_opi_id) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_currency_curr')}} oc\r\n        on upper(ofgo.currency_id) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_uom_curr')}} ou \r\n        on a.opi_qty_uom_id::varchar(15) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'NS'\r\n    left join {{ ref('v_ns_opco_brand_curr')}} ob \r\n        on ofgo.class_id = ob.src_brand_cd\r\n        and ob.src_sys_nm = 'NS'\r\n),\r\npre_final as (\r\n    select  distinct\r\n        pol.opco_fscl_yr_gl_opening_bal_sk,\r\n        pol.opco_fscl_yr_gl_opening_bal_ak,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        pol.src_sys_nm,\r\n        pol.src_key_txt,\r\n        pol.opco_sk,\r\n        pol.opco_chart_of_accts_sk,\r\n        pol.opco_gl_trans_type_sk,\r\n        pol.opco_gl_trans_posting_type_sk,\r\n        pol.opco_cost_center_sk,\r\n        pol.opco_dept_sk,\r\n        pol.opco_type_sk,\r\n        pol.opco_purpose_sk,\r\n        pol.opco_lob_sk,\r\n        pol.trans_currency_sk,\r\n        pol.fscl_yr_strt_dt,\r\n        pol.fscl_yr_nbr,\r\n        pol.credit_ind,\r\n        pol.opening_bal_qty,\r\n        pol.trans_currency_opening_bal_amt,\r\n        pol.opco_currency_opening_bal_amt,\r\n        pol.opco_uom_sk,\r\n        pol.opco_brand_sk\r\n    from plus_one_logic pol\r\n),\r\nfinal as(\r\n    select \r\n        opco_fscl_yr_gl_opening_bal_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'fscl_yr_strt_dt', 'fscl_yr_nbr', 'credit_ind', 'opening_bal_qty', 'trans_currency_opening_bal_amt', 'opco_currency_opening_bal_amt', 'opco_uom_sk', 'opco_brand_sk']) }} as opco_fscl_yr_gl_opening_bal_ck,\r\n        opco_fscl_yr_gl_opening_bal_ak, \r\n        crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk,\r\n        opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt,\r\n        opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_FSCL_YR_GL_OPENING_BAL') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_FSCL_YR_GL_OPENING_BAL') and _load != 3%}\r\n    union\r\n    select\r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ck, opco_fscl_yr_gl_opening_bal_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk,\r\n    opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt,\r\n    opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL\r\n    {% if _load == 1 %}\r\n        where opco_fscl_yr_gl_opening_bal_ck not in (select distinct opco_fscl_yr_gl_opening_bal_ck from final)\r\n    {% else %}\r\n        where opco_fscl_yr_gl_opening_bal_ck not in (select distinct opco_fscl_yr_gl_opening_bal_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check"], "nodes": ["source.OI_Foundation.NS_DEV.TRANSACTION_LINES", "source.OI_Foundation.NS_DEV.TRANSACTIONS", "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "model.OI_Foundation.fscl_clndr", "model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_ns_opco_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_purpose_curr", "model.OI_Foundation.v_ns_opco_currency_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "model.OI_Foundation.v_ns_opco_brand_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "general_ledger", "ns_opco_fscl_yr_gl_opening_bal"], "unique_id": "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/general_ledger/ns_opco_fscl_yr_gl_opening_bal.sql", "original_file_path": "models/ns/general_ledger/ns_opco_fscl_yr_gl_opening_bal.sql", "name": "ns_opco_fscl_yr_gl_opening_bal", "alias": "ns_opco_fscl_yr_gl_opening_bal", "checksum": {"name": "sha256", "checksum": "5153578b8d61a73ffcd073fff2692aaf42a36c500bc03f8891ee133f20dbdba5"}, "tags": [], "refs": [["fscl_clndr"], ["fscl_clndr"], ["v_ns_opco_curr"], ["v_ns_opco_chart_of_accts_curr"], ["v_ns_opco_gl_trans_type_curr"], ["v_ns_opco_cost_center_curr"], ["v_ns_opco_dept_curr"], ["v_ns_opco_type_curr"], ["v_ns_opco_purpose_curr"], ["v_ns_opco_currency_curr"], ["v_ns_opco_uom_curr"], ["v_ns_opco_brand_curr"]], "sources": [["NS_DEV", "TRANSACTION_LINES"], ["NS_DEV", "TRANSACTIONS"], ["NS_DEV", "ACCOUNTING_PERIODS"], ["NS_DEV", "ACCOUNTS"], ["NS_DEV", "ACCOUNTS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086792.8172498}, "model.OI_Foundation.v_ns_opco_gl_trans_curr": {"raw_sql": "with v_ns_opco_gl_trans as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_gl_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_gl_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_gl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "general_ledger", "v_ns_opco_gl_trans_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_gl_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/general_ledger/v_ns_opco_gl_trans_curr.sql", "original_file_path": "models/ns/current_views/general_ledger/v_ns_opco_gl_trans_curr.sql", "name": "v_ns_opco_gl_trans_curr", "alias": "v_ns_opco_gl_trans_curr", "checksum": {"name": "sha256", "checksum": "1063b7a5e49cf4b76c15647640dc60b33376808f7a5e19ab6ceb7f9a2bc774bd"}, "tags": [], "refs": [["ns_opco_gl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8375168}, "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr": {"raw_sql": "with v_ns_opco_chart_of_accts_type as(\r\n    select *\r\n    from {{ ref('ns_opco_chart_of_accts_type') }}\r\n)\r\n\r\nselect * from v_ns_opco_chart_of_accts_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_chart_of_accts_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "general_ledger", "v_ns_opco_chart_of_accts_type_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/general_ledger/v_ns_opco_chart_of_accts_type_curr.sql", "original_file_path": "models/ns/current_views/general_ledger/v_ns_opco_chart_of_accts_type_curr.sql", "name": "v_ns_opco_chart_of_accts_type_curr", "alias": "v_ns_opco_chart_of_accts_type_curr", "checksum": {"name": "sha256", "checksum": "c86ca0b28044bf8823d12272fd9b305c8587a4f6f9bffdc9fda98844972d564e"}, "tags": [], "refs": [["ns_opco_chart_of_accts_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8406372}, "model.OI_Foundation.v_ns_opco_chart_of_accts_curr": {"raw_sql": "with v_ns_opco_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by opco_chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_chart_of_accts') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "general_ledger", "v_ns_opco_chart_of_accts_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/general_ledger/v_ns_opco_chart_of_accts_curr.sql", "original_file_path": "models/ns/current_views/general_ledger/v_ns_opco_chart_of_accts_curr.sql", "name": "v_ns_opco_chart_of_accts_curr", "alias": "v_ns_opco_chart_of_accts_curr", "checksum": {"name": "sha256", "checksum": "11cf907ffe18ef6089c311adeb028056c0021123eca8fa614975f1a1b591499f"}, "tags": [], "refs": [["ns_opco_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.842654}, "model.OI_Foundation.v_ns_opco_gl_trans_type_curr": {"raw_sql": "with v_ns_opco_gl_trans_type as(\r\n    select *\r\n    from {{ ref('ns_opco_gl_trans_type') }}\r\n)\r\n\r\nselect * from v_ns_opco_gl_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_gl_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "general_ledger", "v_ns_opco_gl_trans_type_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/general_ledger/v_ns_opco_gl_trans_type_curr.sql", "original_file_path": "models/ns/current_views/general_ledger/v_ns_opco_gl_trans_type_curr.sql", "name": "v_ns_opco_gl_trans_type_curr", "alias": "v_ns_opco_gl_trans_type_curr", "checksum": {"name": "sha256", "checksum": "f29e7f96a06304b7838643f07fe9970a109b7eebb447815999fda452f2a860f2"}, "tags": [], "refs": [["ns_opco_gl_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8449101}, "model.OI_Foundation.v_ns_opco_fscl_yr_gl_opening_bal_curr": {"raw_sql": "with v_ns_opco_fscl_yr_gl_opening_bal as(\r\n    select *,\r\n    rank() over(partition by opco_fscl_yr_gl_opening_bal_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_fscl_yr_gl_opening_bal') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_fscl_yr_gl_opening_bal\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "general_ledger", "v_ns_opco_fscl_yr_gl_opening_bal_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_fscl_yr_gl_opening_bal_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/general_ledger/v_ns_opco_fscl_yr_gl_opening_bal_curr.sql", "original_file_path": "models/ns/current_views/general_ledger/v_ns_opco_fscl_yr_gl_opening_bal_curr.sql", "name": "v_ns_opco_fscl_yr_gl_opening_bal_curr", "alias": "v_ns_opco_fscl_yr_gl_opening_bal_curr", "checksum": {"name": "sha256", "checksum": "8ca837838cb58d9b3d1b8c90a8c3f0e2def83ad3708d8ec26bc4454de9d0b427"}, "tags": [], "refs": [["ns_opco_fscl_yr_gl_opening_bal"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8470335}, "model.OI_Foundation.v_ns_opco_pymnt_terms_curr": {"raw_sql": "with v_ns_opco_pymnt_terms as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_pymnt_terms') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_pymnt_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_pymnt_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "customer", "v_ns_opco_pymnt_terms_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_pymnt_terms_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/customer/v_ns_opco_pymnt_terms_curr.sql", "original_file_path": "models/ns/current_views/customer/v_ns_opco_pymnt_terms_curr.sql", "name": "v_ns_opco_pymnt_terms_curr", "alias": "v_ns_opco_pymnt_terms_curr", "checksum": {"name": "sha256", "checksum": "070edaa7efc2fca3b117ab11812d316c3c168cfa2ebce5ef0c1d4c32981e6288"}, "tags": [], "refs": [["ns_opco_pymnt_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8491807}, "model.OI_Foundation.v_ns_opco_pymnt_mode_curr": {"raw_sql": "with v_ns_opco_pymnt_mode as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_mode_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_pymnt_mode') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_pymnt_mode\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_pymnt_mode"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "customer", "v_ns_opco_pymnt_mode_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_pymnt_mode_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/customer/v_ns_opco_pymnt_mode_curr.sql", "original_file_path": "models/ns/current_views/customer/v_ns_opco_pymnt_mode_curr.sql", "name": "v_ns_opco_pymnt_mode_curr", "alias": "v_ns_opco_pymnt_mode_curr", "checksum": {"name": "sha256", "checksum": "ed9fda0af88e4c86129a3346a7ce8787088d4a3601ccd19ffa046ac8e1f32556"}, "tags": [], "refs": [["ns_opco_pymnt_mode"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8513181}, "model.OI_Foundation.v_ns_opco_currency_curr": {"raw_sql": "with v_ns_opco_currency as(\r\n    select *,\r\n    rank() over(partition by opco_currency_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_currency') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_currency\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "customer", "v_ns_opco_currency_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_currency_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/customer/v_ns_opco_currency_curr.sql", "original_file_path": "models/ns/current_views/customer/v_ns_opco_currency_curr.sql", "name": "v_ns_opco_currency_curr", "alias": "v_ns_opco_currency_curr", "checksum": {"name": "sha256", "checksum": "c6c9ac383b4c2eea009a3bb884733b18b808c5159bb58e343781716e2e98f1ac"}, "tags": [], "refs": [["ns_opco_currency"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8535419}, "model.OI_Foundation.v_ns_opco_purpose_curr": {"raw_sql": "with v_ns_opco_purpose as(\r\n    select *,\r\n    rank() over(partition by opco_purpose_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_purpose') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_purpose\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_purpose"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "product", "v_ns_opco_purpose_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_purpose_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/product/v_ns_opco_purpose_curr.sql", "original_file_path": "models/ns/current_views/product/v_ns_opco_purpose_curr.sql", "name": "v_ns_opco_purpose_curr", "alias": "v_ns_opco_purpose_curr", "checksum": {"name": "sha256", "checksum": "7c1410270940a3b2c4cffab319113613b36838b6d3d1cb8a9b8b8fb3947d7750"}, "tags": [], "refs": [["ns_opco_purpose"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8555586}, "model.OI_Foundation.v_ns_opco_brand_curr": {"raw_sql": "with v_ns_opco_brand as(\r\n    select *,\r\n    rank() over(partition by opco_brand_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_brand') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_brand\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_brand"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "product", "v_ns_opco_brand_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_brand_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/product/v_ns_opco_brand_curr.sql", "original_file_path": "models/ns/current_views/product/v_ns_opco_brand_curr.sql", "name": "v_ns_opco_brand_curr", "alias": "v_ns_opco_brand_curr", "checksum": {"name": "sha256", "checksum": "20aa070df28d8c517cf181b746b83eeae6f4a526a82beb22d670788c6b6a1489"}, "tags": [], "refs": [["ns_opco_brand"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8577452}, "model.OI_Foundation.v_ns_opco_uom_curr": {"raw_sql": "with v_ns_opco_uom as(\r\n    select *,\r\n    rank() over(partition by opco_uom_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_uom') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_uom\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_uom"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "product", "v_ns_opco_uom_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_uom_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/product/v_ns_opco_uom_curr.sql", "original_file_path": "models/ns/current_views/product/v_ns_opco_uom_curr.sql", "name": "v_ns_opco_uom_curr", "alias": "v_ns_opco_uom_curr", "checksum": {"name": "sha256", "checksum": "0c705c4cf6f6a2b3cf1ade6c3f0d4da41f1a0deff72292770db80a60b4e79568"}, "tags": [], "refs": [["ns_opco_uom"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8597538}, "model.OI_Foundation.v_ns_opco_type_curr": {"raw_sql": "with v_ns_opco_type as(\r\n    select *,\r\n    rank() over(partition by opco_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_opco_type_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_opco_type_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_opco_type_curr.sql", "name": "v_ns_opco_type_curr", "alias": "v_ns_opco_type_curr", "checksum": {"name": "sha256", "checksum": "8eb62ce7fadb6cc3d19a28d883b8ebff78ce68775d6a7c7cfd4d830b5110eb6b"}, "tags": [], "refs": [["ns_opco_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.862128}, "model.OI_Foundation.v_ns_region_curr": {"raw_sql": "with v_ns_region as(\r\n    select *,\r\n    rank() over(partition by region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_region') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_region_curr"], "unique_id": "model.OI_Foundation.v_ns_region_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_region_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_region_curr.sql", "name": "v_ns_region_curr", "alias": "v_ns_region_curr", "checksum": {"name": "sha256", "checksum": "827a518436f01af2bcad4dc219c985668135afc4bf28f508fa502e89e47dc5b0"}, "tags": [], "refs": [["ns_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8641703}, "model.OI_Foundation.v_ns_sub_region_curr": {"raw_sql": "with v_ns_sub_region as(\r\n    select *,\r\n    rank() over(partition by sub_region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_sub_region') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_sub_region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_sub_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_sub_region_curr"], "unique_id": "model.OI_Foundation.v_ns_sub_region_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_sub_region_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_sub_region_curr.sql", "name": "v_ns_sub_region_curr", "alias": "v_ns_sub_region_curr", "checksum": {"name": "sha256", "checksum": "88b2b58dcbab22c20413990f01aa79db321c0c1bd4d0bb6270ee9168c7b53df6"}, "tags": [], "refs": [["ns_sub_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8663049}, "model.OI_Foundation.v_ns_opco_dept_curr": {"raw_sql": "with v_ns_opco_dept as(\r\n    select *,\r\n    rank() over(partition by opco_dept_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_dept') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_dept\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_dept"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_opco_dept_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_dept_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_opco_dept_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_opco_dept_curr.sql", "name": "v_ns_opco_dept_curr", "alias": "v_ns_opco_dept_curr", "checksum": {"name": "sha256", "checksum": "26d561c7fec5c7675a047b3bf59a5ff14b618f9768a2f4feec931b1874f0fcf3"}, "tags": [], "refs": [["ns_opco_dept"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8683407}, "model.OI_Foundation.v_ns_opco_cost_center_curr": {"raw_sql": "with v_ns_opco_cost_center as(\r\n    select *,\r\n    rank() over(partition by opco_cost_center_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco_cost_center') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco_cost_center\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco_cost_center"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_opco_cost_center_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_cost_center_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_opco_cost_center_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_opco_cost_center_curr.sql", "name": "v_ns_opco_cost_center_curr", "alias": "v_ns_opco_cost_center_curr", "checksum": {"name": "sha256", "checksum": "55e2b6746ed19bc405897404495831b2fa9ebed1a0e6d8cd5c21b40c06c64af3"}, "tags": [], "refs": [["ns_opco_cost_center"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8705628}, "model.OI_Foundation.v_ns_opco_curr": {"raw_sql": "with v_ns_opco as(\r\n    select *,\r\n    rank() over(partition by opco_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ns_opco') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ns_opco\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ns_opco"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "current_views", "organization", "v_ns_opco_curr"], "unique_id": "model.OI_Foundation.v_ns_opco_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/current_views/organization/v_ns_opco_curr.sql", "original_file_path": "models/ns/current_views/organization/v_ns_opco_curr.sql", "name": "v_ns_opco_curr", "alias": "v_ns_opco_curr", "checksum": {"name": "sha256", "checksum": "d3d4b815caa7accfba80d8bb1a04145f186120f36e35c9a6a7229c2f3c0c7866"}, "tags": [], "refs": [["ns_opco"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086792.8727176}, "model.OI_Foundation.ns_opco_pymnt_terms": {"raw_sql": "{% set _load = load_type('NS_OPCO_PYMNT_TERMS') %}\r\n\r\nwith ns_opco_pymnt_terms as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    payment_terms_id::varchar(40) as src_pymnt_terms_cd,\r\n    name::varchar(100) as src_pymnt_terms_desc\r\n    from {{source('NS_DEV', 'PAYMENT_TERMS')}}\r\n),\r\nfinal as(\r\n    select  {{dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_terms_cd'])}} as opco_pymnt_terms_sk, \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_terms_cd','src_pymnt_terms_desc'])}} as opco_pymnt_terms_ck, *\r\n    from ns_opco_pymnt_terms   \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_PYMNT_TERMS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PYMNT_TERMS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_pymnt_terms_SK, OPCO_pymnt_terms_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    SRC_SYS_NM, SRC_pymnt_terms_CD, src_pymnt_terms_desc  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms\r\n    {% if _load == 1 %}\r\n        where opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from final)\r\n    {% else %}\r\n        where opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_terms_ck in (select distinct opco_pymnt_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.PAYMENT_TERMS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "customer", "ns_opco_pymnt_terms"], "unique_id": "model.OI_Foundation.ns_opco_pymnt_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/customer/ns_opco_pymnt_terms.sql", "original_file_path": "models/ns/customer/ns_opco_pymnt_terms.sql", "name": "ns_opco_pymnt_terms", "alias": "ns_opco_pymnt_terms", "checksum": {"name": "sha256", "checksum": "da116153132ea6af4791b4953a62f610d9a34114bb3b42163b9932070366e47e"}, "tags": [], "refs": [], "sources": [["NS_DEV", "PAYMENT_TERMS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.8746908}, "model.OI_Foundation.ns_opco_pymnt_mode": {"raw_sql": "{% set _load = load_type('NS_OPCO_PYMNT_MODE') %}\r\n\r\nwith ns_opco_pymnt_mode as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    payment_method_id::varchar(10) as src_pymnt_mode_cd,\r\n    name::varchar(100) as src_pymnt_mode_desc\r\n    from {{source('NS_DEV', 'PAYMENT_METHODS')}}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_mode_cd']) }} as opco_pymnt_mode_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_mode_cd','src_pymnt_mode_desc']) }} as opco_pymnt_mode_ck,\r\n            * \r\n    from ns_opco_pymnt_mode\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_PYMNT_MODE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PYMNT_MODE') and _load != 3 %}\r\n    union\r\n    select\r\n    OPCO_pymnt_mode_SK, OPCO_pymnt_mode_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    SRC_SYS_NM, SRC_pymnt_mode_CD, src_pymnt_mode_desc  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PYMNT_MODE\r\n    {% if _load == 1 %}\r\n        where opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from final)\r\n    {% else %}\r\n        where opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PYMNT_MODE where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PYMNT_MODE where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_mode_ck in (select distinct opco_pymnt_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PYMNT_MODE where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.PAYMENT_METHODS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "customer", "ns_opco_pymnt_mode"], "unique_id": "model.OI_Foundation.ns_opco_pymnt_mode", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/customer/ns_opco_pymnt_mode.sql", "original_file_path": "models/ns/customer/ns_opco_pymnt_mode.sql", "name": "ns_opco_pymnt_mode", "alias": "ns_opco_pymnt_mode", "checksum": {"name": "sha256", "checksum": "d591ade25b0c8164a69b26066c0857921c7466ae68c92ab0af854871e1029cf6"}, "tags": [], "refs": [], "sources": [["NS_DEV", "PAYMENT_METHODS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.8866327}, "model.OI_Foundation.ns_opco_currency": {"raw_sql": "{% set _load = load_type('NS_OPCO_CURRENCY') %}\r\n\r\nwith ns_opco_currency as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    currency_id::varchar(10) as src_currency_cd,\r\n    name::varchar(50) as src_currency_nm\r\n    from {{source('NS_DEV', 'CURRENCIES')}}\r\n),\r\nfinal as(\r\n    select  {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd'])}} as opco_currency_sk, \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd', 'src_currency_nm'])}} as opco_currency_ck,\r\n            *\r\n    from ns_opco_currency\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_CURRENCY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CURRENCY') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_CURRENCY_SK, OPCO_CURRENCY_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    SRC_SYS_NM, SRC_CURRENCY_CD, SRC_CURRENCY_NM  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency\r\n    {% if _load == 1 %}\r\n        where opco_currency_ck not in (select distinct opco_currency_ck from final)\r\n    {% else %}\r\n        where opco_currency_ck not in (select distinct opco_currency_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck not in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.CURRENCIES"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "customer", "ns_opco_currency"], "unique_id": "model.OI_Foundation.ns_opco_currency", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/customer/ns_opco_currency.sql", "original_file_path": "models/ns/customer/ns_opco_currency.sql", "name": "ns_opco_currency", "alias": "ns_opco_currency", "checksum": {"name": "sha256", "checksum": "afe8e643c9bad606d262a4335e75826c26d86f1f4f6af7502604e721601e4193"}, "tags": [], "refs": [], "sources": [["NS_DEV", "CURRENCIES"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.8985298}, "model.OI_Foundation.ns_opco_purpose": {"raw_sql": "{% set _load = load_type('NS_OPCO_PURPOSE') %}\r\n\r\nwith ns_opco_purpose as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    upper(market_opi_id)::varchar(20) as src_purpose_cd,\r\n    market_opi_name::varchar(100) as src_purpose_desc,\r\n    case \r\n        when is_inactive = 'T' then 0 \r\n        else 1 \r\n    end::numeric(1,0) as actv_ind,\r\n    {{ spcl_chr_rp('src_purpose_desc')}}::varchar(100) as purpose_wo_spcl_chr_cd\r\n    from {{source('NS_DEV', 'MARKET_OPI')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_purpose_cd']) }} as opco_purpose_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_purpose_cd', 'src_purpose_desc', 'purpose_wo_spcl_chr_cd', 'actv_ind']) }} as opco_purpose_ck,\r\n            * \r\n    from ns_opco_purpose \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_PURPOSE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PURPOSE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PURPOSE_SK, OPCO_PURPOSE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_purpose_cd, src_purpose_desc, actv_ind, purpose_wo_spcl_chr_cd\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE\r\n    {% if _load == 1 %}\r\n        where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final)\r\n    {% else %}\r\n        where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.MARKET_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "product", "ns_opco_purpose"], "unique_id": "model.OI_Foundation.ns_opco_purpose", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/product/ns_opco_purpose.sql", "original_file_path": "models/ns/product/ns_opco_purpose.sql", "name": "ns_opco_purpose", "alias": "ns_opco_purpose", "checksum": {"name": "sha256", "checksum": "7cfba4c1e3cf0e51836abdf4287c0d9c97d5490fc7edd2fa60128047eb35810a"}, "tags": [], "refs": [], "sources": [["NS_DEV", "MARKET_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.9107256}, "model.OI_Foundation.ns_opco_brand": {"raw_sql": "{% set _load = load_type('NS_OPCO_BRAND') %}\r\n\r\nwith ns_opco_brand as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    upper(class_id)::varchar(20) as src_brand_cd,\r\n    name::varchar(100) as src_brand_nm,\r\n    case \r\n        when isinactive = 'Yes' then 0 \r\n        else 1 \r\n    end::numeric(1,0) as actv_ind,\r\n    {{ spcl_chr_rp('src_brand_nm')}}::varchar(100) as brand_wo_spcl_chr_cd\r\n    from {{source('NS_DEV', 'CLASSES')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_brand_cd']) }} as opco_brand_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_brand_cd', 'src_brand_nm', 'brand_wo_spcl_chr_cd', 'actv_ind']) }} as opco_brand_ck,\r\n            *\r\n    from ns_opco_brand \r\n)\r\n\r\nselect *  from final \r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_BRAND') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_BRAND') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_BRAND_SK, OPCO_BRAND_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_brand_cd, src_brand_nm, actv_ind, brand_wo_spcl_chr_cd\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_BRAND\r\n    {% if _load == 1 %}\r\n        where OPCO_BRAND_ck not in (select distinct OPCO_BRAND_ck from final)\r\n    {% else %}\r\n        where OPCO_BRAND_ck not in (select distinct OPCO_BRAND_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_BRAND where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_BRAND_ck not in (select distinct OPCO_BRAND_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_BRAND where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_BRAND_ck in (select distinct OPCO_BRAND_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_BRAND where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.CLASSES"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "product", "ns_opco_brand"], "unique_id": "model.OI_Foundation.ns_opco_brand", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/product/ns_opco_brand.sql", "original_file_path": "models/ns/product/ns_opco_brand.sql", "name": "ns_opco_brand", "alias": "ns_opco_brand", "checksum": {"name": "sha256", "checksum": "1ca43cfdd7bf6dc03ff36fd4de5fffe7c4bf83bb94ef9f7b50dd9111d2692707"}, "tags": [], "refs": [], "sources": [["NS_DEV", "CLASSES"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.923659}, "model.OI_Foundation.ns_opco_uom": {"raw_sql": "{% set _load = load_type('NS_OPCO_UOM') %}\r\n\r\nwith ns_opco_uom as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    uom_id::varchar(15) as src_uom_cd,\r\n    name::varchar(50) as src_uom_desc\r\n    from {{source('NS_DEV', 'UOM')}}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd']) }} as opco_uom_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd', 'src_uom_desc']) }} as opco_uom_ck,\r\n            * \r\n    from ns_opco_uom\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_UOM') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_UOM') and _load != 3 %}\r\n    union\r\n    select\r\n    OPCO_UOM_SK, OPCO_UOM_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_uom_cd, src_uom_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM\r\n    {% if _load == 1 %}\r\n        where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final)\r\n    {% else %}\r\n        where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.UOM"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "product", "ns_opco_uom"], "unique_id": "model.OI_Foundation.ns_opco_uom", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/product/ns_opco_uom.sql", "original_file_path": "models/ns/product/ns_opco_uom.sql", "name": "ns_opco_uom", "alias": "ns_opco_uom", "checksum": {"name": "sha256", "checksum": "cf5ba4cbb840e09d85158f12facaf622c28b262db72d716d2835de126cce428a"}, "tags": [], "refs": [], "sources": [["NS_DEV", "UOM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.9355235}, "model.OI_Foundation.ns_opco_type": {"raw_sql": "{% set _load = load_type('NS_OPCO_TYPE') %}\r\n\r\nwith ns_opco_type as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    upper(substr(opi_ax_acct, 8))::varchar(20) as src_type_cd,\r\n    max (substr (opi_ax_acct, 8))::varchar(100) as src_type_desc,\r\n    {{ spcl_chr_rp('src_type_desc')}}::varchar(100) as type_wo_spcl_chr_cd\r\n    from {{source('NS_DEV', 'ACCOUNTS')}}\r\n    group by src_sys_nm, src_type_cd\r\n),\r\nactv_ind_grouping as(\r\n    select upper(substr(opi_ax_acct, 8)) as src_type_cd,\r\n    avg(case when isinactive = 'Yes' then 1 else 0 end) as actv_ind\r\n    from {{source('NS_DEV', 'ACCOUNTS')}}\r\n    group by src_type_cd\r\n),\r\npre_final as (\r\n    select distinct {{ dbt_utils.surrogate_key(['ot.src_sys_nm', 'ot.src_type_cd']) }} as opco_type_sk, ot.*, iff(aig.actv_ind=1, 0, 1)::numeric(1,0) as actv_ind \r\n    from ns_opco_type ot\r\n    inner join actv_ind_grouping aig \r\n        using(src_type_cd)\r\n),\r\nfinal as (\r\n    select  opco_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_type_cd', 'src_type_desc', 'type_wo_spcl_chr_cd', 'actv_ind']) }} as opco_type_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_type_cd, src_type_desc, type_wo_spcl_chr_cd, actv_ind\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_TYPE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_TYPE_SK, OPCO_TYPE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_type_cd, src_type_desc, type_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE\r\n    {% if _load == 1 %}\r\n        where OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from final)\r\n    {% else %}\r\n        where OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_TYPE_ck in (select distinct OPCO_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_opco_type"], "unique_id": "model.OI_Foundation.ns_opco_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_opco_type.sql", "original_file_path": "models/ns/organization/ns_opco_type.sql", "name": "ns_opco_type", "alias": "ns_opco_type", "checksum": {"name": "sha256", "checksum": "61a164ba54440ea47453f02975f5295c0b2e9dba45ade571ffb49994e85c6e81"}, "tags": [], "refs": [], "sources": [["NS_DEV", "ACCOUNTS"], ["NS_DEV", "ACCOUNTS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.947193}, "model.OI_Foundation.ns_region": {"raw_sql": "{% set _load = load_type('NS_REGION') %}\r\n\r\nwith region as (\r\n    SELECT \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    region_opi_id::varchar(15) as region_id,\r\n    region_opi_name::varchar(50) as region_nm,\r\n    case \r\n        when is_inactive = 'F' then 1\r\n        when is_inactive = 'T' then 0\r\n    end::numeric(1,0) as actv_ind\r\n    from {{source('NS_DEV', 'REGION_OPI')}}\r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'region_id']) }} as region_sk,\r\n    {{ dbt_utils.surrogate_key(['src_sys_nm', 'region_id','region_nm','actv_ind']) }} as region_ck, * \r\n    from region  \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_REGION') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'REGION') and _load != 3%}\r\n    union\r\n    select\r\n    REGION_SK, REGION_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    SRC_SYS_NM, region_id, region_nm, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION\r\n    {% if _load == 1 %}\r\n        where REGION_ck not in (select distinct REGION_ck from final)\r\n    {% else %}\r\n        where REGION_ck not in (select distinct REGION_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and REGION_ck not in (select distinct REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and REGION_ck in (select distinct REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.REGION_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_region"], "unique_id": "model.OI_Foundation.ns_region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_region.sql", "original_file_path": "models/ns/organization/ns_region.sql", "name": "ns_region", "alias": "ns_region", "checksum": {"name": "sha256", "checksum": "0d9e531d9c69e43451d43aaa89d6285af5f5eedd17cfb985b7319fbf60c66881"}, "tags": [], "refs": [], "sources": [["NS_DEV", "REGION_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.9593592}, "model.OI_Foundation.ns_opco_dept": {"raw_sql": "{% set _load = load_type('NS_OPCO_DEPT') %}\r\n\r\nwith ns_opco_dept as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    department_id::varchar(20) as src_dept_cd,\r\n    name::varchar(100) as src_dept_desc,\r\n    case\r\n        when isinactive = 'Yes' then 0\r\n        else 1\r\n    end::numeric(1,0) as actv_ind,\r\n    {{ spcl_chr_rp('src_dept_desc')}}::varchar(100) as dept_wo_spcl_chr_cd\r\n    from {{source('NS_DEV', 'DEPARTMENTS')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dept_cd']) }} as opco_dept_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dept_cd', 'src_dept_desc', 'actv_ind']) }} as opco_dept_ck,\r\n            *\r\n    from ns_opco_dept \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_DEPT') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_DEPT') and _load != 3%}\r\n    union\r\n    select\r\n    opco_dept_sk, opco_dept_ck, crt_dtm,   \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_dept_cd, src_dept_desc, dept_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT\r\n    {% if _load == 1 %}\r\n        where OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from final)\r\n    {% else %}\r\n        where OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_DEPT_ck in (select distinct OPCO_DEPT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.DEPARTMENTS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_opco_dept"], "unique_id": "model.OI_Foundation.ns_opco_dept", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_opco_dept.sql", "original_file_path": "models/ns/organization/ns_opco_dept.sql", "name": "ns_opco_dept", "alias": "ns_opco_dept", "checksum": {"name": "sha256", "checksum": "1db1f2033c95e2878be7cbe8271be568117387d10511dd08d1107857d39979e0"}, "tags": [], "refs": [], "sources": [["NS_DEV", "DEPARTMENTS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.9718697}, "model.OI_Foundation.ns_sub_region": {"raw_sql": "{% set _load = load_type('NS_SUB_REGION') %}\r\n\r\nwith sub_region as(\r\n    SELECT \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    subregion_opi_id::varchar(15) as sub_region_id,\r\n    subregion_opi_name::varchar(100) as sub_region_nm,\r\n    case \r\n        when is_inactive = 'F' then 1\r\n        when is_inactive = 'T' then 0\r\n    end::numeric(1,0) as actv_ind\r\n    from {{source('NS_DEV', 'SUBREGION_OPI')}}   \r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'sub_region_id']) }} as sub_region_sk,\r\n     {{ dbt_utils.surrogate_key(['src_sys_nm', 'sub_region_id','sub_region_nm','actv_ind']) }} as sub_region_ck,* \r\n    from sub_region \r\n)\r\n\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_SUB_REGION') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'SUB_REGION') and _load != 3%}\r\n    union\r\n    select\r\n    SUB_REGION_SK, SUB_REGION_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    SRC_SYS_NM, sub_region_id, sub_region_nm, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION\r\n    {% if _load == 1 %}\r\n        where SUB_REGION_ck not in (select distinct SUB_REGION_ck from final)\r\n    {% else %}\r\n        where SUB_REGION_ck not in (select distinct SUB_REGION_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SUB_REGION_ck not in (select distinct SUB_REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SUB_REGION_ck in (select distinct SUB_REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.SUBREGION_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_sub_region"], "unique_id": "model.OI_Foundation.ns_sub_region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_sub_region.sql", "original_file_path": "models/ns/organization/ns_sub_region.sql", "name": "ns_sub_region", "alias": "ns_sub_region", "checksum": {"name": "sha256", "checksum": "d09a5c9d96ef9fe2ac9c091c7454c04f586ce73580cc138cbbcc6f2db2d1a636"}, "tags": [], "refs": [], "sources": [["NS_DEV", "SUBREGION_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.983879}, "model.OI_Foundation.ns_opco_cost_center": {"raw_sql": "{% set _load = load_type('NS_OPCO_COST_CENTER') %}\r\n\r\nwith ns_opco_cost_center as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    location_id::varchar(20) as src_cost_center_cd,\r\n    name::varchar(100) as src_cost_center_desc,\r\n    {{ spcl_chr_rp('src_cost_center_desc')}}::varchar(100) as cost_center_wo_spcl_chr_cd,\r\n    case\r\n        when isinactive = 'Yes' then 0\r\n        else 1\r\n    end::numeric(1,0) as actv_ind,\r\n    null::varchar(50) as src_cost_center_type_txt\r\n    from {{source('NS_DEV', 'LOCATIONS')}}  \r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd']) }} as opco_cost_center_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd', 'src_cost_center_desc']) }} as opco_cost_center_ck,\r\n            *\r\n    from ns_opco_cost_center \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO_COST_CENTER') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_COST_CENTER') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_COST_CENTER_SK, OPCO_COST_CENTER_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_cost_center_cd, src_cost_center_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER\r\n    {% if _load == 1 %}\r\n        where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final)\r\n    {% else %}\r\n        where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.LOCATIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_opco_cost_center"], "unique_id": "model.OI_Foundation.ns_opco_cost_center", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_opco_cost_center.sql", "original_file_path": "models/ns/organization/ns_opco_cost_center.sql", "name": "ns_opco_cost_center", "alias": "ns_opco_cost_center", "checksum": {"name": "sha256", "checksum": "04228291d8acdf7534a59c5d29b9e25d153f092b696c7e39af45dc45afdae56a"}, "tags": [], "refs": [], "sources": [["NS_DEV", "LOCATIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086792.9953475}, "model.OI_Foundation.ns_opco": {"raw_sql": "{% set _load = load_type('NS_OPCO') %}\r\n\r\nwith ns_opco as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    sd._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when sd._fivetran_deleted = true then sd._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    concat_ws('|', 'NS', sd.subsidiary_id)::varchar(255) as opco_ak,\r\n    'NS'::varchar(20) as src_sys_nm,\r\n    sd.subsidiary_id::varchar(15) as opco_id,\r\n    sd.name::varchar(120) as opco_nm,\r\n    ocr.opco_currency_sk,\r\n    null::varchar(32) as region_sk,\r\n    null::varchar(32) as sub_region_sk,\r\n    null::varchar(120) as dba_nm,\r\n    null::numeric(1,0) as enterprise_ind,\r\n    sd.federal_number::varchar(130) as govt_issued_id,\r\n    null::varchar(15) as duns_nbr,\r\n    null::varchar(40) as vat_nbr,\r\n    null::date as acqstn_dt,\r\n    case \r\n        when sd.isinactive='No' then 1\r\n        when sd.isinactive='Yes' then 0  \r\n    end::numeric(1,0) as actv_ind,\r\n    null::date as inactv_dt,\r\n    null::varchar(40) as import_vat_nbr,\r\n    sd.url::varchar(510) as website_url_txt,\r\n    null::varchar(20) as language_txt,\r\n    null::date as conversion_dt,\r\n    null::numeric(1,0) as foreign_enty_ind,\r\n    null::numeric(1,0) as combined_fed_state_tax_filer_ind,\r\n    null::numeric(1,0) as validate_1099_on_entry_ind,\r\n    null::numeric(1,0) as planning_company_ind,\r\n    null::varchar(60) as sls_tax_global_id,\r\n    null::varchar(60) as sls_tax_local_id,\r\n    null::varchar(20) as product_line_txt,\r\n    null::varchar(50) as prnt_opco_id,\r\n    null::varchar(50) as collection_type_txt,\r\n    null::numeric(1,0) as dashboard_usage_id \r\n    from {{ source('NS_DEV', 'SUBSIDIARIES')}} sd\r\n    left join {{ref('v_ns_opco_currency_curr')}} ocr \r\n       on upper(sd.base_currency_id) = ocr.src_currency_cd\r\n       and ocr.src_sys_nm = 'NS'\r\n    where subsidiary_id not in (1, 4, 5, 7)\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id']) }} as opco_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'opco_nm', 'opco_currency_sk', 'region_sk', 'sub_region_sk', 'dba_nm', 'enterprise_ind', 'govt_issued_id', 'duns_nbr', 'vat_nbr', 'acqstn_dt', 'actv_ind', 'inactv_dt', 'import_vat_nbr', 'website_url_txt', 'language_txt', 'conversion_dt', 'foreign_enty_ind', 'combined_fed_state_tax_filer_ind', 'validate_1099_on_entry_ind', 'planning_company_ind', 'sls_tax_global_id', 'sls_tax_local_id', 'product_line_txt', 'prnt_opco_id', 'collection_type_txt', 'dashboard_usage_id']) }} as opco_ck,\r\n            *\r\n    from ns_opco  \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'NS_OPCO') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_SK, OPCO_CK, opco_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, opco_nm, opco_currency_sk, region_sk, sub_region_sk, dba_nm, enterprise_ind, govt_issued_id,  duns_nbr, vat_nbr, acqstn_dt, actv_ind, inactv_dt, import_vat_nbr, website_url_txt, language_txt, conversion_dt, foreign_enty_ind, combined_fed_state_tax_filer_ind, validate_1099_on_entry_ind, planning_company_ind, sls_tax_global_id, sls_tax_local_id, product_line_txt, prnt_opco_id, collection_type_txt, dashboard_usage_id\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO\r\n    {% if _load == 1 %}\r\n        where OPCO_ck not in (select distinct OPCO_ck from final)\r\n    {% else %}\r\n        where OPCO_ck not in (select distinct OPCO_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'NS')\r\n    {% endif %} \r\n    and src_sys_nm = 'NS'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ck not in (select distinct OPCO_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'NS')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ck in (select distinct OPCO_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'NS') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.NS_DEV.SUBSIDIARIES", "model.OI_Foundation.v_ns_opco_currency_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ns", "organization", "ns_opco"], "unique_id": "model.OI_Foundation.ns_opco", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ns/organization/ns_opco.sql", "original_file_path": "models/ns/organization/ns_opco.sql", "name": "ns_opco", "alias": "ns_opco", "checksum": {"name": "sha256", "checksum": "c4e02b4239fbce914760eb95ad6017b1e37d0142cc9a39ecf8c830bc0d8ffb87"}, "tags": [], "refs": [["v_ns_opco_currency_curr"]], "sources": [["NS_DEV", "SUBSIDIARIES"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.0068915}, "model.OI_Foundation.ax_opco_gl_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_GL_TRANS') %}\r\n\r\nwith ax_opco_gl_trans as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    lt._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when lt._fivetran_deleted = true then lt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    lt.recid::varchar(50) as src_key_txt,\r\n    lt.transdate as trans_dt,\r\n    opco.opco_sk,\r\n    oca.opco_chart_of_accts_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    ogtp.opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    {{ dbt_utils.surrogate_key([\"'AX'\", 'lt.dataareaid', 'lt.projid_opi']) }} as opco_proj_sk,\r\n    {{ dbt_utils.surrogate_key([\"'AX'\", 'lt.origincompany_opi']) }} as original_gl_opco_sk,\r\n    lt.originvoucher_opi::varchar(20) as original_gl_voucher_nbr,\r\n    lt.voucher::varchar(20) as voucher_nbr,\r\n    lt.journalnum::varchar(20) as journal_batch_nbr,\r\n    lt.txt::varchar(5000) as gl_desc,\r\n    lt.documentnum::varchar(20) as document_nbr,\r\n    lt.documentdate::date as document_dt,\r\n    lt.correct::numeric(1,0) as crrctn_trans_ind,\r\n    lt.crediting::numeric(1,0) as credit_ind,\r\n    case \r\n        when ltb.accountpltype = 100 and ltb.unitid_opi in ('$', null, ' ', '') then null\r\n        when ltb.accountpltype = 100 and ltb.unitid_opi not in ('$', null, ' ', '') then lt.qty\r\n        else lt.qty \r\n    end::float as gl_qty,\r\n    lt.amountcur::float as trans_currency_gl_amt,\r\n    case \r\n        when ltb.accountpltype = 100 and ltb.unitid_opi in ('$', null, ' ', '') then lt.qty\r\n        when ltb.accountpltype = 100 and ltb.unitid_opi not in ('$', null, ' ', '') then null\r\n        else lt.amountmst\r\n    end::float as opco_currency_gl_amt,\r\n    fc.fscl_yr_id as fscl_yr_nbr,\r\n    fc.fscl_mnth_nbr as fscl_mnth_nbr,\r\n    1::numeric(1,0) as posted_ind,\r\n    ou.opco_uom_sk,\r\n    null::varchar(32) as opco_brand_sk,\r\n    null::varchar(32) as opco_sub_ledger_type_sk,\r\n    null::varchar(32) as sub_ledger_cd\r\n    from {{ source('AX_DEV', 'LEDGERTRANS') }} lt\r\n    left join {{ source('AX_DEV', 'LEDGERTABLE')}} ltb \r\n        on lt.dataareaid = ltb.dataareaid\r\n        and lt.accountnum = ltb.accountnum\r\n        and ltb._fivetran_deleted = false\r\n        and ltb.dataareaid not in {{ var('excluded_ax_companies')}}\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on lt.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} oca \r\n        on lt.dataareaid = oca.opco_id\r\n        and lt.accountnum = oca.gl_acct_nbr\r\n        and oca.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_gl_trans_type_curr')}} ogt \r\n        on lt.transtype::string = ogt.src_gl_trans_type_cd\r\n        and ogt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_gl_trans_posting_type_curr')}} ogtp \r\n        on lt.posting = ogtp.src_gl_trans_posting_type_cd\r\n        and ogtp.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(lt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(lt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(lt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(lt.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(lt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc\r\n        on upper(lt.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_fscl_clndr_curr')}} fc\r\n        on fc.clndr_dt = date(lt.transdate)\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on ou.src_uom_cd = upper(ltb.unitid_opi)\r\n        and ou.src_sys_nm = 'AX'\r\n    where lt.periodcode = 1\r\n    and lt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt']) }} as opco_gl_trans_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'trans_dt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'opco_proj_sk', 'original_gl_opco_sk', 'original_gl_voucher_nbr', 'voucher_nbr', 'journal_batch_nbr', 'gl_desc', 'document_nbr', 'document_dt', 'crrctn_trans_ind', 'credit_ind', 'gl_qty', 'trans_currency_gl_amt', 'opco_currency_gl_amt', 'fscl_yr_nbr', 'fscl_mnth_nbr', 'posted_ind', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd']) }} as opco_gl_trans_ck,\r\n            concat_ws('|', src_sys_nm, src_key_txt)::varchar(100) as opco_gl_trans_ak,\r\n            * \r\n    from ax_opco_gl_trans \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_GL_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_GL_TRANS_SK, OPCO_GL_TRANS_CK, OPCO_GL_TRANS_AK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_key_txt, trans_dt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, opco_proj_sk, original_gl_opco_sk, original_gl_voucher_nbr, voucher_nbr, journal_batch_nbr, gl_desc, document_nbr, document_dt, crrctn_trans_ind, credit_ind, gl_qty, trans_currency_gl_amt, opco_currency_gl_amt, fscl_yr_nbr, fscl_mnth_nbr, posted_ind, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.LEDGERTRANS", "source.OI_Foundation.AX_DEV.LEDGERTABLE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_fscl_clndr_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_gl_trans"], "unique_id": "model.OI_Foundation.ax_opco_gl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_gl_trans.sql", "original_file_path": "models/ax/general_ledger/ax_opco_gl_trans.sql", "name": "ax_opco_gl_trans", "alias": "ax_opco_gl_trans", "checksum": {"name": "sha256", "checksum": "0cd8152db5df52e24e2f3e8f98a398eefee77f6fcb5f33ee64af606f7b1385dc"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_chart_of_accts_curr"], ["v_ax_opco_gl_trans_type_curr"], ["v_ax_opco_gl_trans_posting_type_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_currency_curr"], ["v_ax_fscl_clndr_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "LEDGERTRANS"], ["AX_DEV", "LEDGERTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.0223866}, "model.OI_Foundation.ax_opco_gl_trans_posting_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_gl_trans_posting_type as (\r\n  {% set values = [ 'Exchange rate profit', 'Exchange rate loss', 'Intercompany accounting', 'Sales tax', 'Sales tax rounding', 'Allocation', 'Investment tax', 'Liquidity', 'Penny difference in secondary currency', 'Error account', 'Penny difference in default currency', 'Year-end result', 'Close', 'Ledger journal', 'Cash discount', 'Balance account for consolidation differences', 'Payment fee', 'Sales tax reporting', 'Transfer of closing and opening transactions', 'Bank', 'Conversion profit', 'Conversion loss', 'Withholding tax', 'Profit & loss account for consolidation differences', 'Production - indirect WIP offset', 'Production - indirect absorption', 'Production - indirect absorption offset', 'Customer balance', 'Customer revenue', 'Customer interest', 'Customer cash discount', 'Customer collection letter fee', 'Customer interest fee', 'Customer invoice discount', 'Customer payment', 'Reimbursement', 'Customer settlement', 'Vendor balance', 'Vendor Incoming', 'Vendor offset account', 'Vendor interest', 'Vendor cash discount', 'Vendor disbursement', 'Vendor invoice discount', 'Vendor settlement', 'Intercompany settlement', 'Fixed asset issue', 'Sales order revenue', 'Sales order consumption', 'Sales order discount', 'Order cash', 'Order, freight', 'Order fee', 'Sales order postage', 'Order invoice rounding', 'Order packing slip', 'Order offset account packing slip', 'Sales order issue', 'Sales, commission', 'Sales, commission offset', 'Sales - packing slip revenue', 'Sales - packing slip revenue offset', 'Purchase, consumption', 'Purchase, discount', 'Purchase cash', 'Purchase freight', 'Purchase fee', 'Purchase postage', 'Purchase offset account', 'Purchase invoice rounding-off', 'Purchase misc. charges, freight', 'Purchase misc. charges duty', 'Purchase misc. charges insurance', 'Purchase, packing slip', 'Purchase, packing slip offset', 'Purchase, receipt', 'Purchase, fixed receipt price profit', 'Purchase, fixed receipt price loss', 'Purchase, fixed receipt price offset', 'Inventory receipt', 'Inventory issue', 'Inventory profit', 'Inventory loss', 'Inventory, fixed receipt price profit', 'Inventory, fixed receipt price loss', 'Production, report as finished', 'Production offset-account, report as finished', 'Production issue', 'Production offset account issue', 'Production receipt', 'Production offset account receipt', 'Production offset account picking list', 'Production, picking list', 'Production - WIP', 'Production WIP issue', 'Production - Work center issue', 'Production scrap', 'Production offset account, work center issue', 'Production offset account, scrap', 'Project - Cost', 'Project - Payroll allocation', 'Project - WIP cost', 'Project - Cost - Item', 'Project - WIP cost - Item', 'Project - Invoiced revenue', 'Project - Invoiced on-account', 'Project - Accrued revenue - Sales value', 'Project - WIP - Sales value', 'Project - Accrued revenue - Production', 'Project - WIP - Production', 'Project - Accrued revenue - Profit', 'Project - WIP - Profit', 'Never ledger', 'Project - Accrued loss', 'Project - WIP - Accrued loss', 'Project - Accrued revenue - On account', 'Project - WIP invoiced - On account', 'No ledger', 'Wage debit account', 'Payroll Credit account', 'Fixed assets, debit', 'Fixed assets, credit', 'Ledger journal - no offset account', 'Purchase, charge', 'Purchase, stock variation', 'Purchase, packing slip purchase offset', 'Purchase, packing slip tax', 'Purchase, packing slip purchase', 'Sales, packing slip tax', 'Accrued revenue - Subscription', 'WIP - Subscription', 'Cost change variance', 'System rounding', 'Purchase price variance', 'Production price variance', 'Inventory inter-unit payable', 'Inventory inter-unit receivable', 'Production - indirect WIP issue', 'Production lot size variance', 'Production quantity variance', 'Production substitution variance', 'Rounding variance', 'Fixed asset receipt', 'Inventory cost revaluation' ] %}\r\n  {% set num = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 91, 92, 93, 94, 95, 96, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 141, 142, 161, 162, 163, 201, 202, 203, 204, 205, 206, 207, 208, 210, 211, 213, 216, 219, 220, 221, 222, 223, 224, 225, 226, 235] %}\r\n\r\n  {% for i in range(145) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{num[i]}} as src_gl_trans_posting_type_cd,\r\n          {% if i == 0 %}\r\n            null as src_gl_trans_posting_type_desc\r\n          {% else %}\r\n            '{{values[i-1]}}' as src_gl_trans_posting_type_desc\r\n          {% endif %}\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_posting_type_cd']) }} as opco_gl_trans_posting_type_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_posting_type_cd', 'src_gl_trans_posting_type_desc']) }} as opco_gl_trans_posting_type_ck, \r\n            *\r\n    from opco_gl_trans_posting_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_gl_trans_posting_type"], "unique_id": "model.OI_Foundation.ax_opco_gl_trans_posting_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_gl_trans_posting_type.sql", "original_file_path": "models/ax/general_ledger/ax_opco_gl_trans_posting_type.sql", "name": "ax_opco_gl_trans_posting_type", "alias": "ax_opco_gl_trans_posting_type", "checksum": {"name": "sha256", "checksum": "752c11f0d4214ae3ff735a994f5b4de9e1cfdc51a4d8cf69ddb938c2b1434935"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.0450397}, "model.OI_Foundation.ax_opco_chart_of_accts_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_chart_of_accts_type as (\r\n    select\r\n    '0'::varchar(10) as src_acct_type_cd,\r\n    'P&L'::varchar(100) as src_acct_type_desc\r\n    union\r\n    select\r\n    '3'::varchar(10) as src_acct_type_cd,\r\n    'Balance'::varchar(100) as src_acct_type_desc\r\n    union\r\n    select\r\n    '6'::varchar(10) as src_acct_type_cd,\r\n    'Header'::varchar(100) as src_acct_type_desc\r\n    union\r\n    select\r\n    '9'::varchar(10) as src_acct_type_cd,\r\n    'Total'::varchar(100) as src_acct_type_desc\r\n    union\r\n    select\r\n    '100'::varchar(10) as src_acct_type_cd,\r\n    'Statistical'::varchar(100) as src_acct_type_desc\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key([\"'AX'\", 'src_acct_type_cd']) }} as opco_chart_of_accts_type_sk, \r\n            {{ dbt_utils.surrogate_key([\"'AX'\", 'src_acct_type_cd', 'src_acct_type_desc']) }} as opco_chart_of_accts_type_ck, \r\n            current_timestamp as crt_dtm, 'AX'::varchar(20) as src_sys_nm, * \r\n    from opco_chart_of_accts_type  \r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_chart_of_accts_type"], "unique_id": "model.OI_Foundation.ax_opco_chart_of_accts_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_chart_of_accts_type.sql", "original_file_path": "models/ax/general_ledger/ax_opco_chart_of_accts_type.sql", "name": "ax_opco_chart_of_accts_type", "alias": "ax_opco_chart_of_accts_type", "checksum": {"name": "sha256", "checksum": "7bf447603ce4a9d998fe01a4eb4f824ce4b750e079b70d4cd53916156cd4cea8"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.063965}, "model.OI_Foundation.ax_opco_gl_trans_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_gl_trans_type as (\r\n  {% set values = [ 'Transfer', 'Sales Order', 'Purchase Order', 'Inventory', 'Production', 'Project', 'Interest', 'Customer', 'Exchange Adjustment', 'Totaled', 'Payroll', 'Fixed Assets', 'Collection Letter', 'Vendor', 'Payment', 'Sales Tax', 'Bank', 'Conversion', 'Bill Of Exchange', 'Promissory Note', 'Cost Accounting', 'Labor', 'Fee', 'Settlement', 'Allocation', 'Elimination', 'Cash Discount', 'Overpayment/Underpayment', 'Penny Difference', 'Intercompany Settlement'] %}\r\n\r\n  {% for i in range(31) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX'::varchar(20) as src_sys_nm,\r\n          cast({{ i }} as string) as src_gl_trans_type_cd,\r\n          {% if i == 0 %}\r\n            null::varchar(100) as src_gl_trans_type_desc\r\n          {% else %}\r\n            '{{values[i-1]}}'::varchar(100) as src_gl_trans_type_desc\r\n          {% endif %}\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd']) }} as opco_gl_trans_type_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd', 'src_gl_trans_type_desc']) }} as opco_gl_trans_type_ck,\r\n            *\r\n    from opco_gl_trans_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_gl_trans_type"], "unique_id": "model.OI_Foundation.ax_opco_gl_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_gl_trans_type.sql", "original_file_path": "models/ax/general_ledger/ax_opco_gl_trans_type.sql", "name": "ax_opco_gl_trans_type", "alias": "ax_opco_gl_trans_type", "checksum": {"name": "sha256", "checksum": "fdb74a4750bd60de046b89d17004fa8b18d3f82facea227b019d2fbddbb29028"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.070612}, "model.OI_Foundation.ax_opco_chart_of_accts": {"raw_sql": "{% set _load = load_type('AX_OPCO_CHART_OF_ACCTS') %}\r\n\r\nwith ax_opco_chart_of_accts as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    lt._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when lt._fivetran_deleted = true then lt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    lt.accountnum::varchar(20) as gl_acct_nbr,\r\n    lt.dataareaid::varchar(15) as opco_id,\r\n    lt.accountname::varchar(100) as gl_acct_nm,\r\n    coa.chart_of_accts_sk,\r\n    cc.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    cat.opco_chart_of_accts_type_sk,\r\n    ou.opco_uom_sk,\r\n    lt.accountnamealias::varchar(120) as gl_acct_alias_nm,\r\n    case \r\n        when lt.blockedinjournal = 0 then 1\r\n        when lt.blockedinjournal = 1 then 0 \r\n    end::numeric(1,0) as manual_entry_allowed_ind,\r\n    lt.excludefromdpo_opi::numeric(1,0) as dpo_exclusion_ind,\r\n    lt.movementjournal_opi::numeric(1,0) as movement_allowed_ind,\r\n    case \r\n        when lt.mandatorydimension = 0 then 'Optional'\r\n        when lt.mandatorydimension = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension = 2 then 'Table'\r\n        when lt.mandatorydimension = 3 then 'List'\r\n        when lt.mandatorydimension = 4 then 'Fixed'\r\n        when lt.mandatorydimension = 5 then 'Default'\r\n    end::varchar(50) as cost_center_reqd_txt,\r\n    case \r\n        when lt.mandatorydimension2_ = 0 then 'Optional'\r\n        when lt.mandatorydimension2_ = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension2_ = 2 then 'Table'\r\n        when lt.mandatorydimension2_ = 3 then 'List'\r\n        when lt.mandatorydimension2_ = 4 then 'Fixed'\r\n        when lt.mandatorydimension2_ = 5 then 'Default'\r\n    end::varchar(50) as dept_reqd_txt,\r\n    case \r\n        when lt.mandatorydimension3_ = 0 then 'Optional'\r\n        when lt.mandatorydimension3_ = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension3_ = 2 then 'Table'\r\n        when lt.mandatorydimension3_ = 3 then 'List'\r\n        when lt.mandatorydimension3_ = 4 then 'Fixed'\r\n        when lt.mandatorydimension3_ = 5 then 'Default'\r\n    end::varchar(50) as type_reqd_txt,\r\n    lt.parentaccount_opi::varchar(10) as prnt_gl_acct_nbr,\r\n    lt.relatedaccount_opi::varchar(10) as related_gl_acct_nbr,\r\n    lt.monetary::varchar(10) as monetary_gl_acct_ind,\r\n    iff(lt.closed=0, 1,0)::numeric(1,0) as actv_ind,\r\n    case\r\n        when accountpltype = 3 then 1\r\n        else 0\r\n    end::numeric(1,0) as balance_sheet_acct_ind,\r\n    case\r\n        when accountpltype = 9 then 1\r\n        else 0\r\n    end::numeric(1,0) as summary_acct_ind,\r\n    null::varchar(32) as opco_brand_sk,\r\n    null::varchar(20) as acct_clssfctn_cd,\r\n    null::varchar(20) as sub_acct_nbr\r\n    from {{source('AX_DEV', 'LEDGERTABLE')}} lt\r\n    left join {{ref('v_ax_chart_of_accts_curr')}} coa \r\n        on lt.accountnum = coa.gl_acct_nbr\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} cc \r\n        on upper(lt.dimension) = cc.src_cost_center_cd\r\n        and cc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(lt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(lt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(lt.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(lt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_chart_of_accts_type_curr')}} cat \r\n        on cast(lt.accountpltype as varchar) = cat.src_acct_type_cd\r\n        and cat.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(lt.unitid_opi) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where upper(lt.dataareaid) != 'UGL' \r\n    and lt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'gl_acct_nbr']) }} as opco_chart_of_accts_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'gl_acct_nbr', 'opco_id', 'gl_acct_nm', 'chart_of_accts_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_chart_of_accts_type_sk', 'opco_uom_sk', 'gl_acct_alias_nm', 'manual_entry_allowed_ind', 'dpo_exclusion_ind', 'movement_allowed_ind', 'cost_center_reqd_txt', 'dept_reqd_txt', 'type_reqd_txt', 'prnt_gl_acct_nbr', 'related_gl_acct_nbr', 'monetary_gl_acct_ind', 'actv_ind', 'balance_sheet_acct_ind', 'summary_acct_ind', 'opco_brand_sk', 'acct_clssfctn_cd', 'sub_acct_nbr']) }} as opco_chart_of_accts_ck,\r\n            * \r\n    from ax_opco_chart_of_accts\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CHART_OF_ACCTS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CHART_OF_ACCTS') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CHART_OF_ACCTS_SK, OPCO_CHART_OF_ACCTS_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, gl_acct_nbr, opco_id, gl_acct_nm, chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, manual_entry_allowed_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind, opco_brand_sk, acct_clssfctn_cd, sub_acct_nbr\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS\r\n        {% if _load == 1 %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final)\r\n        {% else %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'AX')\r\n        {% endif %} \r\n        and src_sys_nm = 'AX'\r\n    {% endif %}\r\n)\r\nselect * from final\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.LEDGERTABLE", "model.OI_Foundation.v_ax_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_chart_of_accts"], "unique_id": "model.OI_Foundation.ax_opco_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_chart_of_accts.sql", "original_file_path": "models/ax/general_ledger/ax_opco_chart_of_accts.sql", "name": "ax_opco_chart_of_accts", "alias": "ax_opco_chart_of_accts", "checksum": {"name": "sha256", "checksum": "6b411cd79137fbc07875c43131b607b847ccf8648005a4497837c46da7e55645"}, "tags": [], "refs": [["v_ax_chart_of_accts_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_chart_of_accts_type_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "LEDGERTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.079831}, "model.OI_Foundation.ax_chart_of_accts": {"raw_sql": "{% set _load = load_type('AX_CHART_OF_ACCTS') %}\r\n\r\nwith ax_chart_of_accts as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    lt._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when lt._fivetran_deleted = true then lt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    lt.accountnum as gl_acct_nbr,\r\n    lt.accountname as gl_acct_nm,\r\n    cc.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    cat.opco_chart_of_accts_type_sk,\r\n    ou.opco_uom_sk,\r\n    lt.accountnamealias as gl_acct_alias_nm,\r\n    lt.blockedinjournal as blocked_in_journal_ind,\r\n    lt.excludefromdpo_opi as dpo_exclusion_ind,\r\n    lt.movementjournal_opi as movement_allowed_ind,\r\n    case \r\n        when lt.mandatorydimension = 0 then 'Optional'\r\n        when lt.mandatorydimension = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension = 2 then 'Table'\r\n        when lt.mandatorydimension = 3 then 'List'\r\n        when lt.mandatorydimension = 4 then 'Fixed'\r\n        when lt.mandatorydimension = 5 then 'Default'\r\n    end as cost_center_reqd_txt,\r\n    case \r\n        when lt.mandatorydimension2_ = 0 then 'Optional'\r\n        when lt.mandatorydimension2_ = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension2_ = 2 then 'Table'\r\n        when lt.mandatorydimension2_ = 3 then 'List'\r\n        when lt.mandatorydimension2_ = 4 then 'Fixed'\r\n        when lt.mandatorydimension2_ = 5 then 'Default'\r\n    end as dept_reqd_txt,\r\n    case \r\n        when lt.mandatorydimension3_ = 0 then 'Optional'\r\n        when lt.mandatorydimension3_ = 1 then 'To Be Filled In'\r\n        when lt.mandatorydimension3_ = 2 then 'Table'\r\n        when lt.mandatorydimension3_ = 3 then 'List'\r\n        when lt.mandatorydimension3_ = 4 then 'Fixed'\r\n        when lt.mandatorydimension3_ = 5 then 'Default'\r\n    end as type_reqd_txt,\r\n    lt.parentaccount_opi as prnt_gl_acct_nbr,\r\n    lt.relatedaccount_opi as related_gl_acct_nbr,\r\n    lt.monetary as monetary_gl_acct_ind,\r\n    iff(lt.closed=0, 1,0) as actv_ind,\r\n    case \r\n        when lt.accountpltype = 3 then 1\r\n        else 0\r\n    end as balance_sheet_acct_ind,\r\n    case \r\n        when lt.accountpltype = 9 then 1\r\n        else 0\r\n    end as summary_acct_ind\r\n    from {{source('AX_DEV', 'LEDGERTABLE')}} lt\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} cc \r\n        on upper(lt.dimension) = cc.src_cost_center_cd\r\n        and cc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(lt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(lt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(lt.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(lt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_chart_of_accts_type_curr')}} cat \r\n        on cast(lt.accountpltype as varchar) = cat.src_acct_type_cd\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(lt.unitid_opi) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where upper(lt.dataareaid) = 'UGL' \r\n    and lt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['gl_acct_nbr']) }} as chart_of_accts_sk, \r\n            {{ dbt_utils.surrogate_key(['gl_acct_nbr', 'gl_acct_nm', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_chart_of_accts_type_sk', 'opco_uom_sk', 'gl_acct_alias_nm', 'blocked_in_journal_ind', 'dpo_exclusion_ind', 'movement_allowed_ind', 'cost_center_reqd_txt', 'dept_reqd_txt', 'type_reqd_txt', 'prnt_gl_acct_nbr', 'related_gl_acct_nbr', 'monetary_gl_acct_ind', 'actv_ind', 'balance_sheet_acct_ind', 'summary_acct_ind']) }} as chart_of_accts_ck,\r\n            * \r\n    from ax_chart_of_accts \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_CHART_OF_ACCTS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'CHART_OF_ACCTS') and _load != 3%}\r\n    union\r\n    select\r\n    CHART_OF_ACCTS_SK, CHART_OF_ACCTS_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    gl_acct_nbr, gl_acct_nm, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, blocked_in_journal_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.CHART_OF_ACCTS\r\n    {% if _load == 1 %}\r\n        where CHART_OF_ACCTS_ck not in (select distinct CHART_OF_ACCTS_ck from final)\r\n    {% else %}\r\n        where CHART_OF_ACCTS_ck not in (select distinct CHART_OF_ACCTS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.CHART_OF_ACCTS)\r\n    {% endif %} \r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and CHART_OF_ACCTS_ck not in (select distinct CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.CHART_OF_ACCTS)) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and CHART_OF_ACCTS_ck in (select distinct CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.CHART_OF_ACCTS) and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.LEDGERTABLE", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_chart_of_accts"], "unique_id": "model.OI_Foundation.ax_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_chart_of_accts.sql", "original_file_path": "models/ax/general_ledger/ax_chart_of_accts.sql", "name": "ax_chart_of_accts", "alias": "ax_chart_of_accts", "checksum": {"name": "sha256", "checksum": "ac7020ff49264ff9dacf27b40337d6fa96491536de54d5e5dabc26d71a37c61e"}, "tags": [], "refs": [["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_chart_of_accts_type_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "LEDGERTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.0970812}, "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal": {"raw_sql": "{% set _load = load_type('AX_OPCO_FSCL_YR_GL_OPENING_BAL') %}\r\n\r\nwith opco_fscl_yr_gl_opening_bal as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    lt._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when lt._fivetran_deleted = true then lt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    lt.recid::varchar(50) as src_key_txt,\r\n    opco.opco_sk,\r\n    oca.opco_chart_of_accts_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    ogtp.opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    lt.transdate::date as fscl_yr_strt_dt,\r\n    case    \r\n        when month(lt.transdate) = 12 then year(lt.transdate)+1\r\n        else year(lt.transdate)\r\n    end::int as fscl_yr_nbr,\r\n    lt.crediting::numeric(1,0) as credit_ind,\r\n    lt.qty::float as opening_bal_qty,\r\n    lt.amountcur::float as trans_currency_opening_bal_amt,\r\n    lt.amountmst::float as opco_currency_opening_bal_amt,\r\n    ou.opco_uom_sk,\r\n    null::varchar(32) as opco_brand_sk\r\n    from {{ source('AX_DEV', 'LEDGERTRANS') }} lt\r\n    left join {{ source('AX_DEV', 'LEDGERTABLE')}} ltb \r\n        on lt.accountnum = ltb.accountnum\r\n        and lt.dataareaid = ltb.dataareaid\r\n        and ltb.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and ltb._fivetran_deleted = false\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on lt.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} oca \r\n        on lt.dataareaid = oca.opco_id\r\n        and lt.accountnum = oca.gl_acct_nbr\r\n        and oca.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_gl_trans_type_curr')}} ogt \r\n        on lt.transtype::string = ogt.src_gl_trans_type_cd\r\n        and ogt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_gl_trans_posting_type_curr')}} ogtp \r\n        on lt.posting = ogtp.src_gl_trans_posting_type_cd\r\n        and ogtp.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(lt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(lt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(lt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(lt.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(lt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc\r\n        on upper(lt.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(ltb.unitid_opi) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where lt.periodcode = 0\r\n    and lt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  distinct\r\n            {{ dbt_utils.surrogate_key(['ogo.src_sys_nm', 'ogo.src_key_txt']) }} as opco_fscl_yr_gl_opening_bal_sk, \r\n            {{ dbt_utils.surrogate_key(['ogo.src_sys_nm', 'ogo.src_key_txt', 'ogo.opco_sk', 'ogo.opco_chart_of_accts_sk', 'ogo.opco_gl_trans_type_sk', 'ogo.opco_gl_trans_posting_type_sk', 'ogo.opco_cost_center_sk', 'ogo.opco_dept_sk', 'ogo.opco_type_sk', 'ogo.opco_purpose_sk', 'ogo.opco_lob_sk', 'ogo.trans_currency_sk', 'ogo.fscl_yr_strt_dt', 'ogo.fscl_yr_nbr', 'ogo.opening_bal_qty', 'ogo.trans_currency_opening_bal_amt', 'ogo.opco_currency_opening_bal_amt']) }} as opco_fscl_yr_gl_opening_bal_ck,\r\n            concat_ws('|', ogo.src_sys_nm, ogo.src_key_txt)::varchar(100) as opco_fscl_yr_gl_opening_bal_ak,\r\n            * \r\n    from opco_fscl_yr_gl_opening_bal ogo\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_FSCL_YR_GL_OPENING_BAL') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_FSCL_YR_GL_OPENING_BAL') and _load != 3%}\r\n    union\r\n    select\r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ck, opco_fscl_yr_gl_opening_bal_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, opening_bal_qty, trans_currency_opening_bal_amt, opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL\r\n    {% if _load == 1 %}\r\n        where opco_fscl_yr_gl_opening_bal_ck not in (select distinct opco_fscl_yr_gl_opening_bal_ck from final)\r\n    {% else %}\r\n        where opco_fscl_yr_gl_opening_bal_ck not in (select distinct opco_fscl_yr_gl_opening_bal_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_fscl_yr_gl_opening_bal_ck not in (select distinct opco_fscl_yr_gl_opening_bal_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_fscl_yr_gl_opening_bal_ck in (select distinct opco_fscl_yr_gl_opening_bal_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.LEDGERTRANS", "source.OI_Foundation.AX_DEV.LEDGERTABLE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "general_ledger", "ax_opco_fscl_yr_gl_opening_bal"], "unique_id": "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/general_ledger/ax_opco_fscl_yr_gl_opening_bal.sql", "original_file_path": "models/ax/general_ledger/ax_opco_fscl_yr_gl_opening_bal.sql", "name": "ax_opco_fscl_yr_gl_opening_bal", "alias": "ax_opco_fscl_yr_gl_opening_bal", "checksum": {"name": "sha256", "checksum": "3017936afe58d1a6e99c88ff5d971f0674d28a2bd1809edb661f4b6ce4081e2e"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_chart_of_accts_curr"], ["v_ax_opco_gl_trans_type_curr"], ["v_ax_opco_gl_trans_posting_type_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "LEDGERTRANS"], ["AX_DEV", "LEDGERTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.122078}, "model.OI_Foundation.v_ax_opco_gl_trans_curr": {"raw_sql": "with v_ax_opco_gl_trans as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_gl_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_gl_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_gl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_gl_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_gl_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_gl_trans_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_gl_trans_curr.sql", "name": "v_ax_opco_gl_trans_curr", "alias": "v_ax_opco_gl_trans_curr", "checksum": {"name": "sha256", "checksum": "f1e09ddd654846571520309958785b839ea67291477ac83523a0e94b4a893c68"}, "tags": [], "refs": [["ax_opco_gl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1461945}, "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr": {"raw_sql": "with v_ax_opco_gl_trans_posting_type as(\r\n    select *\r\n    from {{ ref('ax_opco_gl_trans_posting_type') }}\r\n)\r\n\r\nselect * from v_ax_opco_gl_trans_posting_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_gl_trans_posting_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_gl_trans_posting_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_gl_trans_posting_type_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_gl_trans_posting_type_curr.sql", "name": "v_ax_opco_gl_trans_posting_type_curr", "alias": "v_ax_opco_gl_trans_posting_type_curr", "checksum": {"name": "sha256", "checksum": "4348612675ab3f0027420c1fc8487fa2ea439ee3180235bd990e525a0775535f"}, "tags": [], "refs": [["ax_opco_gl_trans_posting_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.148271}, "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr": {"raw_sql": "with v_ax_opco_chart_of_accts_type as(\r\n    select *\r\n    from {{ ref('ax_opco_chart_of_accts_type') }}\r\n)\r\n\r\nselect * from v_ax_opco_chart_of_accts_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_chart_of_accts_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_chart_of_accts_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_chart_of_accts_type_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_chart_of_accts_type_curr.sql", "name": "v_ax_opco_chart_of_accts_type_curr", "alias": "v_ax_opco_chart_of_accts_type_curr", "checksum": {"name": "sha256", "checksum": "a1d561c631a9ffa9887aea6e700eb1208abce4fe269be708a3b650c864e65fc7"}, "tags": [], "refs": [["ax_opco_chart_of_accts_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1503737}, "model.OI_Foundation.v_ax_opco_gl_trans_type_curr": {"raw_sql": "with v_ax_opco_gl_trans_type as(\r\n    select *\r\n    from {{ ref('ax_opco_gl_trans_type') }}\r\n)\r\n\r\nselect * from v_ax_opco_gl_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_gl_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_gl_trans_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_gl_trans_type_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_gl_trans_type_curr.sql", "name": "v_ax_opco_gl_trans_type_curr", "alias": "v_ax_opco_gl_trans_type_curr", "checksum": {"name": "sha256", "checksum": "da70222aa0e7d7365cf21613836f5f4880c1c52b386f40b00ba5397d9e1a8fef"}, "tags": [], "refs": [["ax_opco_gl_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1523845}, "model.OI_Foundation.v_ax_opco_chart_of_accts_curr": {"raw_sql": "with v_ax_opco_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by opco_chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_chart_of_accts') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_chart_of_accts_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_chart_of_accts_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_chart_of_accts_curr.sql", "name": "v_ax_opco_chart_of_accts_curr", "alias": "v_ax_opco_chart_of_accts_curr", "checksum": {"name": "sha256", "checksum": "e51ec8adbb305510a081a528ee718385a1ec1c1bf1869b7f875889ce0e47ce4b"}, "tags": [], "refs": [["ax_opco_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1545737}, "model.OI_Foundation.v_ax_chart_of_accts_curr": {"raw_sql": "with v_ax_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_chart_of_accts') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_chart_of_accts_curr"], "unique_id": "model.OI_Foundation.v_ax_chart_of_accts_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_chart_of_accts_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_chart_of_accts_curr.sql", "name": "v_ax_chart_of_accts_curr", "alias": "v_ax_chart_of_accts_curr", "checksum": {"name": "sha256", "checksum": "0e7d04e5f1098c458bf11833131acd8395faab83bb9d534ce078d9b80b82fb2f"}, "tags": [], "refs": [["ax_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1566973}, "model.OI_Foundation.v_ax_opco_fscl_yr_gl_opening_bal_curr": {"raw_sql": "with v_ax_opco_fscl_yr_gl_opening_bal as(\r\n    select *,\r\n    rank() over(partition by opco_fscl_yr_gl_opening_bal_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_fscl_yr_gl_opening_bal') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_fscl_yr_gl_opening_bal\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "general_ledger", "v_ax_opco_fscl_yr_gl_opening_bal_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_fscl_yr_gl_opening_bal_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/general_ledger/v_ax_opco_fscl_yr_gl_opening_bal_curr.sql", "original_file_path": "models/ax/current_views/general_ledger/v_ax_opco_fscl_yr_gl_opening_bal_curr.sql", "name": "v_ax_opco_fscl_yr_gl_opening_bal_curr", "alias": "v_ax_opco_fscl_yr_gl_opening_bal_curr", "checksum": {"name": "sha256", "checksum": "7131e99d5b14825c8418c3fd2b62b706456cca141b717eb0c43c89e084f425fc"}, "tags": [], "refs": [["ax_opco_fscl_yr_gl_opening_bal"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1587043}, "model.OI_Foundation.v_ax_opco_cust_settled_trans_curr": {"raw_sql": "with v_ax_opco_cust_settled_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_settled_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_settled_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_settled_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_settled_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_settled_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_settled_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_settled_trans_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_settled_trans_curr.sql", "name": "v_ax_opco_cust_settled_trans_curr", "alias": "v_ax_opco_cust_settled_trans_curr", "checksum": {"name": "sha256", "checksum": "489f40b8b2c3da362b7ba0aa2419159cbee8f5f1849fee683e49af4ea03af7f0"}, "tags": [], "refs": [["ax_opco_cust_settled_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1608229}, "model.OI_Foundation.v_ax_opco_pymnt_terms_curr": {"raw_sql": "with v_ax_opco_pymnt_terms as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_pymnt_terms') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_pymnt_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_pymnt_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_pymnt_terms_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_pymnt_terms_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_pymnt_terms_curr.sql", "name": "v_ax_opco_pymnt_terms_curr", "alias": "v_ax_opco_pymnt_terms_curr", "checksum": {"name": "sha256", "checksum": "e629d5031bfe567d18ba3681d036b8edbec6b2b8b12e60fc9c02b0d1b1d5636a"}, "tags": [], "refs": [["ax_opco_pymnt_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1630116}, "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr": {"raw_sql": "with v_ax_opco_cust_packing_slip as(\r\n    select *,\r\n    rank() over(partition by opco_cust_packing_slip_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_packing_slip') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_packing_slip\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_packing_slip"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_packing_slip_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_packing_slip_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_packing_slip_curr.sql", "name": "v_ax_opco_cust_packing_slip_curr", "alias": "v_ax_opco_cust_packing_slip_curr", "checksum": {"name": "sha256", "checksum": "e787d7178e878aebb3cf878b85cc3031ba27d31e3c435df2af96a6d66818e76c"}, "tags": [], "refs": [["ax_opco_cust_packing_slip"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1650162}, "model.OI_Foundation.v_ax_opco_cust_invoice_line_curr": {"raw_sql": "with v_ax_opco_cust_invoice_line as(\r\n    select *,\r\n    rank() over(partition by opco_cust_invoice_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_invoice_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_invoice_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_invoice_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_invoice_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_invoice_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_invoice_line_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_invoice_line_curr.sql", "name": "v_ax_opco_cust_invoice_line_curr", "alias": "v_ax_opco_cust_invoice_line_curr", "checksum": {"name": "sha256", "checksum": "362e04e0720917d9680bff612636406ce71a5dbfec4c6ef56b7f0b7076d05039"}, "tags": [], "refs": [["ax_opco_cust_invoice_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.167136}, "model.OI_Foundation.v_ax_opco_cust_trans_curr": {"raw_sql": "with v_ax_opco_cust_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_trans_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_trans_curr.sql", "name": "v_ax_opco_cust_trans_curr", "alias": "v_ax_opco_cust_trans_curr", "checksum": {"name": "sha256", "checksum": "850aafa244b8d354dafb756d1816ea0af3c4b261d1939f82046eb2a95832b712"}, "tags": [], "refs": [["ax_opco_cust_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1691499}, "model.OI_Foundation.v_ax_opco_pymnt_mode_curr": {"raw_sql": "with v_ax_opco_pymnt_mode as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_mode_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_pymnt_mode') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_pymnt_mode\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_pymnt_mode"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_pymnt_mode_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_pymnt_mode_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_pymnt_mode_curr.sql", "name": "v_ax_opco_pymnt_mode_curr", "alias": "v_ax_opco_pymnt_mode_curr", "checksum": {"name": "sha256", "checksum": "2e019fb73c7f4a123f528fbd801d181b2b3037c40be869effa10969097ef561f"}, "tags": [], "refs": [["ax_opco_pymnt_mode"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1714246}, "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr": {"raw_sql": "with v_ax_opco_cash_dscnt_terms as(\r\n    select *,\r\n    rank() over(partition by opco_cash_dscnt_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cash_dscnt_terms') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cash_dscnt_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cash_dscnt_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cash_dscnt_terms_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cash_dscnt_terms_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cash_dscnt_terms_curr.sql", "name": "v_ax_opco_cash_dscnt_terms_curr", "alias": "v_ax_opco_cash_dscnt_terms_curr", "checksum": {"name": "sha256", "checksum": "90ed059cba69ce09174e5aeb6d5221b8520948b57f8750154eac90431947766c"}, "tags": [], "refs": [["ax_opco_cash_dscnt_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1734433}, "model.OI_Foundation.v_ax_opco_cust_type_curr": {"raw_sql": "with v_ax_opco_cust_type as(\r\n    select *,\r\n    rank() over(partition by opco_cust_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_type_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_type_curr.sql", "name": "v_ax_opco_cust_type_curr", "alias": "v_ax_opco_cust_type_curr", "checksum": {"name": "sha256", "checksum": "6569db880286681043c35cdc501bf60c9e617115e9c327c5b9b6381636c05276"}, "tags": [], "refs": [["ax_opco_cust_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1754081}, "model.OI_Foundation.v_ax_opco_picking_list_curr": {"raw_sql": "with v_ax_opco_picking_list as(\r\n    select *,\r\n    rank() over(partition by opco_picking_list_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_picking_list') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_picking_list\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_picking_list"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_picking_list_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_picking_list_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_picking_list_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_picking_list_curr.sql", "name": "v_ax_opco_picking_list_curr", "alias": "v_ax_opco_picking_list_curr", "checksum": {"name": "sha256", "checksum": "2ec0203864f3fe28b031f2ef014b917158765b3a47af58f2096ad1da2b0557cb"}, "tags": [], "refs": [["ax_opco_picking_list"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1777024}, "model.OI_Foundation.v_ax_opco_handling_status_curr": {"raw_sql": "with v_ax_opco_handling_status as(\r\n    select *\r\n    from {{ ref('ax_opco_handling_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_handling_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_handling_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_handling_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_handling_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_handling_status_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_handling_status_curr.sql", "name": "v_ax_opco_handling_status_curr", "alias": "v_ax_opco_handling_status_curr", "checksum": {"name": "sha256", "checksum": "5720995cd4b08078b25f315a2984ced721c944918cc58ac0adc3f5a5b3838467"}, "tags": [], "refs": [["ax_opco_handling_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1797397}, "model.OI_Foundation.v_ax_opco_currency_curr": {"raw_sql": "with v_ax_opco_currency as(\r\n    select *,\r\n    rank() over(partition by opco_currency_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_currency') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_currency\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_currency_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_currency_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_currency_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_currency_curr.sql", "name": "v_ax_opco_currency_curr", "alias": "v_ax_opco_currency_curr", "checksum": {"name": "sha256", "checksum": "a56c18c7bba6ebde0616cbc99cc8de90dc6ef7ba937df6a17b0e84e058954b1a"}, "tags": [], "refs": [["ax_opco_currency"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1818385}, "model.OI_Foundation.v_ax_opco_cust_invoice_curr": {"raw_sql": "with v_ax_opco_cust_invoice as(\r\n    select *,\r\n    rank() over(partition by opco_cust_invoice_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_invoice') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_invoice\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_invoice"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_invoice_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_invoice_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_invoice_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_invoice_curr.sql", "name": "v_ax_opco_cust_invoice_curr", "alias": "v_ax_opco_cust_invoice_curr", "checksum": {"name": "sha256", "checksum": "fe770026857250915c2d02b91bca4f14674cb84e2638aa6c07832cbc5cc261f5"}, "tags": [], "refs": [["ax_opco_cust_invoice"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1838124}, "model.OI_Foundation.v_ax_opco_opco_cust_xref_curr": {"raw_sql": "with v_ax_opco_opco_cust_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sk, opco_cust_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_opco_cust_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_opco_cust_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_opco_cust_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_opco_cust_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_opco_cust_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_opco_cust_xref_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_opco_cust_xref_curr.sql", "name": "v_ax_opco_opco_cust_xref_curr", "alias": "v_ax_opco_opco_cust_xref_curr", "checksum": {"name": "sha256", "checksum": "34506e99d63ebd40c20448b9cdbde657b3674827e0adcbbf31306bb282527818"}, "tags": [], "refs": [["ax_opco_opco_cust_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1860373}, "model.OI_Foundation.v_ax_opco_cust_curr": {"raw_sql": "with v_ax_opco_cust as(\r\n    select *,\r\n    rank() over(partition by opco_cust_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_curr.sql", "name": "v_ax_opco_cust_curr", "alias": "v_ax_opco_cust_curr", "checksum": {"name": "sha256", "checksum": "438d5ad59d12ec715d07ad1ace87b4197a2174f6fb431bd1b0b6fe218dca817e"}, "tags": [], "refs": [["ax_opco_cust"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.188086}, "model.OI_Foundation.v_ax_opco_cust_open_trans_curr": {"raw_sql": "with v_ax_opco_cust_open_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_open_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_open_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_open_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_open_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_open_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_open_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_open_trans_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_open_trans_curr.sql", "name": "v_ax_opco_cust_open_trans_curr", "alias": "v_ax_opco_cust_open_trans_curr", "checksum": {"name": "sha256", "checksum": "ef0230ca26f8c4d8ab8e1e64221d08b4ddbce405f74c12dcb2a77cee74379237"}, "tags": [], "refs": [["ax_opco_cust_open_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1900892}, "model.OI_Foundation.v_ax_opco_cust_grp_curr": {"raw_sql": "with v_ax_opco_cust_grp as(\r\n    select *,\r\n    rank() over(partition by opco_cust_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_grp') }}\r\n),\r\nfinal as(\r\n    select \r\n    * \r\n    from v_ax_opco_cust_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_grp_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_grp_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_grp_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_grp_curr.sql", "name": "v_ax_opco_cust_grp_curr", "alias": "v_ax_opco_cust_grp_curr", "checksum": {"name": "sha256", "checksum": "3bbfd5c9ba68018c95ef9236f86390618621c98e3db48ee2ba4cc0a16a0cd3b3"}, "tags": [], "refs": [["ax_opco_cust_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1921802}, "model.OI_Foundation.v_ax_opco_commsn_grp_curr": {"raw_sql": "with v_ax_opco_commsn_grp as(\r\n    select *,\r\n    rank() over(partition by opco_commsn_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_commsn_grp') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_commsn_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_commsn_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_commsn_grp_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_commsn_grp_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_commsn_grp_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_commsn_grp_curr.sql", "name": "v_ax_opco_commsn_grp_curr", "alias": "v_ax_opco_commsn_grp_curr", "checksum": {"name": "sha256", "checksum": "8c51445a9bc6ae45be549978b9e580289a7aace3c6394d9d867b12ef1f1c471e"}, "tags": [], "refs": [["ax_opco_commsn_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1943748}, "model.OI_Foundation.v_ax_opco_cust_code_curr": {"raw_sql": "with v_ax_opco_cust_code as(\r\n    select *,\r\n    rank() over(partition by opco_cust_code_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_code') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_code\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_code"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_code_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_code_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_code_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_code_curr.sql", "name": "v_ax_opco_cust_code_curr", "alias": "v_ax_opco_cust_code_curr", "checksum": {"name": "sha256", "checksum": "38ed6d39b5f88e31685b77218ec5492906cc44d30e168f65026aac18dab7dac8"}, "tags": [], "refs": [["ax_opco_cust_code"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1964393}, "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr": {"raw_sql": "with v_ax_opco_invtry_ref_type as(\r\n    select *\r\n    from {{ ref('ax_opco_invtry_ref_type') }}\r\n\r\n)\r\n\r\nselect * from v_ax_opco_invtry_ref_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_invtry_ref_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_invtry_ref_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_invtry_ref_type_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_invtry_ref_type_curr.sql", "name": "v_ax_opco_invtry_ref_type_curr", "alias": "v_ax_opco_invtry_ref_type_curr", "checksum": {"name": "sha256", "checksum": "24bb202600eb4adeb118957c7d8af70a98f99b249404d6d209b0ed8810f078e4"}, "tags": [], "refs": [["ax_opco_invtry_ref_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.1984441}, "model.OI_Foundation.v_ax_opco_cust_packing_slip_line_curr": {"raw_sql": "with v_ax_opco_cust_packing_slip_line as(\r\n    select *,\r\n    rank() over(partition by opco_cust_packing_slip_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_packing_slip_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_packing_slip_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_packing_slip_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "customer", "v_ax_opco_cust_packing_slip_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_packing_slip_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/customer/v_ax_opco_cust_packing_slip_line_curr.sql", "original_file_path": "models/ax/current_views/customer/v_ax_opco_cust_packing_slip_line_curr.sql", "name": "v_ax_opco_cust_packing_slip_line_curr", "alias": "v_ax_opco_cust_packing_slip_line_curr", "checksum": {"name": "sha256", "checksum": "dc083d1a674abd7b01047b87dd49eb0941121b3b7014fb7614bfe4954d4a4333"}, "tags": [], "refs": [["ax_opco_cust_packing_slip_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2004652}, "model.OI_Foundation.v_ax_opco_po_line_curr": {"raw_sql": "with v_ax_opco_po_line as(\r\n    select *,\r\n    rank() over(partition by opco_po_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_po_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_po_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_po_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "purchase_order", "v_ax_opco_po_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_po_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/purchase_order/v_ax_opco_po_line_curr.sql", "original_file_path": "models/ax/current_views/purchase_order/v_ax_opco_po_line_curr.sql", "name": "v_ax_opco_po_line_curr", "alias": "v_ax_opco_po_line_curr", "checksum": {"name": "sha256", "checksum": "79c795c999f5b073c815d79f686ab5f0dc134250d69bd40adf88bfce7aa3b7dc"}, "tags": [], "refs": [["ax_opco_po_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.203447}, "model.OI_Foundation.v_ax_opco_po_type_curr": {"raw_sql": "with v_ax_opco_po_type as(\r\n    select *\r\n    from {{ ref('ax_opco_po_type') }}\r\n\r\n)\r\n\r\nselect * from v_ax_opco_po_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_po_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "purchase_order", "v_ax_opco_po_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_po_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/purchase_order/v_ax_opco_po_type_curr.sql", "original_file_path": "models/ax/current_views/purchase_order/v_ax_opco_po_type_curr.sql", "name": "v_ax_opco_po_type_curr", "alias": "v_ax_opco_po_type_curr", "checksum": {"name": "sha256", "checksum": "ade6874b1838402cb317013a02ca8441bebfc1bb8ebcfe01bcc0d84b1d570458"}, "tags": [], "refs": [["ax_opco_po_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2054505}, "model.OI_Foundation.v_ax_opco_po_curr": {"raw_sql": "with v_ax_opco_po as(\r\n    select *,\r\n    rank() over(partition by opco_po_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_po') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_po\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_po"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "purchase_order", "v_ax_opco_po_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_po_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/purchase_order/v_ax_opco_po_curr.sql", "original_file_path": "models/ax/current_views/purchase_order/v_ax_opco_po_curr.sql", "name": "v_ax_opco_po_curr", "alias": "v_ax_opco_po_curr", "checksum": {"name": "sha256", "checksum": "714301b9342f0586918d813be88f54bfdea1f11918c3e181ef1a3e1340623d0a"}, "tags": [], "refs": [["ax_opco_po"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2075188}, "model.OI_Foundation.v_ax_opco_po_doc_status_curr": {"raw_sql": "with v_ax_opco_po_doc_status as(\r\n    select *\r\n    from {{ ref('ax_opco_po_doc_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_po_doc_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_po_doc_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "purchase_order", "v_ax_opco_po_doc_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_po_doc_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/purchase_order/v_ax_opco_po_doc_status_curr.sql", "original_file_path": "models/ax/current_views/purchase_order/v_ax_opco_po_doc_status_curr.sql", "name": "v_ax_opco_po_doc_status_curr", "alias": "v_ax_opco_po_doc_status_curr", "checksum": {"name": "sha256", "checksum": "5ff92a72823eeee521fa7f3eb9b06b6c2df0cd5784a4b345ddf0d2c6366f21bf"}, "tags": [], "refs": [["ax_opco_po_doc_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2095375}, "model.OI_Foundation.v_ax_opco_vendor_invoice_curr": {"raw_sql": "with v_ax_opco_vendor_invoice as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_invoice_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_invoice') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_invoice\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_invoice"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "vendor", "v_ax_opco_vendor_invoice_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_invoice_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/vendor/v_ax_opco_vendor_invoice_curr.sql", "original_file_path": "models/ax/current_views/vendor/v_ax_opco_vendor_invoice_curr.sql", "name": "v_ax_opco_vendor_invoice_curr", "alias": "v_ax_opco_vendor_invoice_curr", "checksum": {"name": "sha256", "checksum": "6218fc739b5bc3d5c1362d9efab219686b7b32cd78b09230888a7abe1a57f9b5"}, "tags": [], "refs": [["ax_opco_vendor_invoice"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2117133}, "model.OI_Foundation.v_ax_opco_vendor_packing_slip_line_curr": {"raw_sql": "with v_ax_opco_vendor_packing_slip_line as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_packing_slip_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_packing_slip_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_packing_slip_line \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "vendor", "v_ax_opco_vendor_packing_slip_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_packing_slip_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/vendor/v_ax_opco_vendor_packing_slip_line_curr.sql", "original_file_path": "models/ax/current_views/vendor/v_ax_opco_vendor_packing_slip_line_curr.sql", "name": "v_ax_opco_vendor_packing_slip_line_curr", "alias": "v_ax_opco_vendor_packing_slip_line_curr", "checksum": {"name": "sha256", "checksum": "3ff49ecec9b46ff5a12a8ff254b281c08be7bd2b7e103c1e9b2fa22eac3a522f"}, "tags": [], "refs": [["ax_opco_vendor_packing_slip_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2138324}, "model.OI_Foundation.v_ax_opco_vendor_trans_curr": {"raw_sql": "with v_ax_opco_vendor_trans  as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "vendor", "v_ax_opco_vendor_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/vendor/v_ax_opco_vendor_trans_curr.sql", "original_file_path": "models/ax/current_views/vendor/v_ax_opco_vendor_trans_curr.sql", "name": "v_ax_opco_vendor_trans_curr", "alias": "v_ax_opco_vendor_trans_curr", "checksum": {"name": "sha256", "checksum": "3ee22b504bf2efde2e803fb23d642772653360c72b83f0fdfa58378aac6804c1"}, "tags": [], "refs": [["ax_opco_vendor_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2158482}, "model.OI_Foundation.v_ax_opco_vendor_invoice_line_curr": {"raw_sql": "with v_ax_opco_vendor_invoice_line as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_invoice_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_invoice_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_invoice_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_invoice_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "vendor", "v_ax_opco_vendor_invoice_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_invoice_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/vendor/v_ax_opco_vendor_invoice_line_curr.sql", "original_file_path": "models/ax/current_views/vendor/v_ax_opco_vendor_invoice_line_curr.sql", "name": "v_ax_opco_vendor_invoice_line_curr", "alias": "v_ax_opco_vendor_invoice_line_curr", "checksum": {"name": "sha256", "checksum": "f5aecbdde26412d12814ecc14b6b79abecbc30d5815a15dd9a0f43a957f5e221"}, "tags": [], "refs": [["ax_opco_vendor_invoice_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2180033}, "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr": {"raw_sql": "with v_ax_opco_vendor_packing_slip as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_packing_slip_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_packing_slip') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_packing_slip\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_packing_slip"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "vendor", "v_ax_opco_vendor_packing_slip_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/vendor/v_ax_opco_vendor_packing_slip_curr.sql", "original_file_path": "models/ax/current_views/vendor/v_ax_opco_vendor_packing_slip_curr.sql", "name": "v_ax_opco_vendor_packing_slip_curr", "alias": "v_ax_opco_vendor_packing_slip_curr", "checksum": {"name": "sha256", "checksum": "f0f4977d87ccbdb3d26ba34a7c883466a9ce1d0ddf52a257a966e71770e39959"}, "tags": [], "refs": [["ax_opco_vendor_packing_slip"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2202148}, "model.OI_Foundation.v_ax_opco_item_invtry_curr": {"raw_sql": "with v_ax_opco_item_invtry as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk, opco_assctn_sk  order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_invtry') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_invtry\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_invtry"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_invtry_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_invtry_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_invtry_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_invtry_curr.sql", "name": "v_ax_opco_item_invtry_curr", "alias": "v_ax_opco_item_invtry_curr", "checksum": {"name": "sha256", "checksum": "53535f78296652928aa4dabbd91b117b85146cc43db37e9be90ddd0b1e506258"}, "tags": [], "refs": [["ax_opco_item_invtry"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.222805}, "model.OI_Foundation.v_ax_opco_item_subtype_curr": {"raw_sql": "with v_ax_opco_item_subtype as(\r\n    select *,\r\n    rank() over(partition by opco_item_subtype_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_subtype') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_subtype\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_subtype"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_subtype_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_subtype_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_subtype_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_subtype_curr.sql", "name": "v_ax_opco_item_subtype_curr", "alias": "v_ax_opco_item_subtype_curr", "checksum": {"name": "sha256", "checksum": "14412dfa4c044e8f2e4c158a2af60b76181523b6336ed69cf9ff54b712496968"}, "tags": [], "refs": [["ax_opco_item_subtype"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.225174}, "model.OI_Foundation.v_ax_opco_purpose_curr": {"raw_sql": "with v_ax_opco_purpose as(\r\n    select *,\r\n    rank() over(partition by opco_purpose_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_purpose') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_purpose\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_purpose"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_purpose_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_purpose_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_purpose_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_purpose_curr.sql", "name": "v_ax_opco_purpose_curr", "alias": "v_ax_opco_purpose_curr", "checksum": {"name": "sha256", "checksum": "90d7031e15a48df64c1817e745bad8fb6b41505cfa7da190dcf670325c87b0cb"}, "tags": [], "refs": [["ax_opco_purpose"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2278066}, "model.OI_Foundation.v_ax_opco_vendor_curr": {"raw_sql": "with v_ax_opco_vendor as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_vendor_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_vendor_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_vendor_curr.sql", "name": "v_ax_opco_vendor_curr", "alias": "v_ax_opco_vendor_curr", "checksum": {"name": "sha256", "checksum": "d758b2a4704625b305cc2930eae61907dff4f52adfb766ee085653743a046f69"}, "tags": [], "refs": [["ax_opco_vendor"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.230487}, "model.OI_Foundation.v_ax_opco_item_opco_assctn_xref_curr": {"raw_sql": "with v_ax_opco_item_opco_assctn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk, opco_assctn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_opco_assctn_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_opco_assctn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_opco_assctn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_opco_assctn_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_opco_assctn_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_opco_assctn_xref_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_opco_assctn_xref_curr.sql", "name": "v_ax_opco_item_opco_assctn_xref_curr", "alias": "v_ax_opco_item_opco_assctn_xref_curr", "checksum": {"name": "sha256", "checksum": "a2b4bb310b2b59d0fc3a25d9465b52c64e16dd79712a0cf3d6592cf065f9f330"}, "tags": [], "refs": [["ax_opco_item_opco_assctn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.232644}, "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr": {"raw_sql": "with v_ax_opco_invtry_trans_type as(\r\n    select *\r\n    from {{ ref('ax_opco_invtry_trans_type') }}\r\n)\r\n\r\nselect * from v_ax_opco_invtry_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_invtry_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_invtry_trans_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_invtry_trans_type_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_invtry_trans_type_curr.sql", "name": "v_ax_opco_invtry_trans_type_curr", "alias": "v_ax_opco_invtry_trans_type_curr", "checksum": {"name": "sha256", "checksum": "6496b9d769951202bda9b3c3d2a8f0b9fb3f512abeca06f38fa419e2da219cd0"}, "tags": [], "refs": [["ax_opco_invtry_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2346356}, "model.OI_Foundation.v_ax_opco_item_class_curr": {"raw_sql": "with v_ax_opco_item_class as(\r\n    select *,\r\n    rank() over(partition by opco_item_class_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_class') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_class\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_class"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_class_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_class_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_class_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_class_curr.sql", "name": "v_ax_opco_item_class_curr", "alias": "v_ax_opco_item_class_curr", "checksum": {"name": "sha256", "checksum": "0df7312b1a6b95f372dad577c8d786dffc6992f14bc78a432dd07cfa2ed92ab8"}, "tags": [], "refs": [["ax_opco_item_class"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2366612}, "model.OI_Foundation.v_ax_opco_item_type_curr": {"raw_sql": "with v_ax_opco_item_type as(\r\n    select *,\r\n    rank() over(partition by opco_item_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_type_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_type_curr.sql", "name": "v_ax_opco_item_type_curr", "alias": "v_ax_opco_item_type_curr", "checksum": {"name": "sha256", "checksum": "765f092caca142282c4f55c430f9c3ce007c94d8ee01441ae5f7f05f73a840a1"}, "tags": [], "refs": [["ax_opco_item_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.238936}, "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr": {"raw_sql": "with v_ax_opco_item_cvrg_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_cvrg_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_cvrg_grp') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_cvrg_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_cvrg_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_cvrg_grp_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_cvrg_grp_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_cvrg_grp_curr.sql", "name": "v_ax_opco_item_cvrg_grp_curr", "alias": "v_ax_opco_item_cvrg_grp_curr", "checksum": {"name": "sha256", "checksum": "7f14d0b1e4d4763ed919fffaa2d67b7edd046410e56834c0ac4b5c71f51dd4a7"}, "tags": [], "refs": [["ax_opco_item_cvrg_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.240945}, "model.OI_Foundation.v_ax_opco_invtry_trans_curr": {"raw_sql": "with v_ax_opco_invtry_trans as(\r\n    select *,\r\n    rank() over(partition by opco_invtry_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_invtry_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_invtry_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_invtry_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_invtry_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_invtry_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_invtry_trans_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_invtry_trans_curr.sql", "name": "v_ax_opco_invtry_trans_curr", "alias": "v_ax_opco_invtry_trans_curr", "checksum": {"name": "sha256", "checksum": "e52a111cd656b5a7cfa830ede4c2b6a29140eb65a04d3fb2f361c05e65ea416b"}, "tags": [], "refs": [["ax_opco_invtry_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2430496}, "model.OI_Foundation.v_ax_opco_item_curr": {"raw_sql": "with v_ax_opco_item as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_curr.sql", "name": "v_ax_opco_item_curr", "alias": "v_ax_opco_item_curr", "checksum": {"name": "sha256", "checksum": "2e5db4b2d6cf55c9fe3de039af8b4bfe04edec742c2f1bad1efdb6d44aa39ef4"}, "tags": [], "refs": [["ax_opco_item"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2451}, "model.OI_Foundation.v_ax_opco_item_model_grp_curr": {"raw_sql": "with v_ax_opco_item_model_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_model_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_model_grp') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_model_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_model_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_model_grp_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_model_grp_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_model_grp_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_model_grp_curr.sql", "name": "v_ax_opco_item_model_grp_curr", "alias": "v_ax_opco_item_model_grp_curr", "checksum": {"name": "sha256", "checksum": "17abf6aa5ebad45fcc8a87f32a83c278a55e82410a72b013f06ef528a3a29237"}, "tags": [], "refs": [["ax_opco_item_model_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.247277}, "model.OI_Foundation.v_ax_opco_item_grp_curr": {"raw_sql": "with v_ax_opco_item_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_grp') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_grp_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_grp_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_grp_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_grp_curr.sql", "name": "v_ax_opco_item_grp_curr", "alias": "v_ax_opco_item_grp_curr", "checksum": {"name": "sha256", "checksum": "b2a3d20cbfa7a89d4c7d3579a578a0d723e0f28e7a3ff72e614dc5993f2af6fb"}, "tags": [], "refs": [["ax_opco_item_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.249377}, "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr": {"raw_sql": "with v_ax_opco_invtry_rcpt_status as(\r\n    select *\r\n    from {{ ref('ax_opco_invtry_rcpt_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_invtry_rcpt_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_invtry_rcpt_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_invtry_rcpt_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_invtry_rcpt_status_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_invtry_rcpt_status_curr.sql", "name": "v_ax_opco_invtry_rcpt_status_curr", "alias": "v_ax_opco_invtry_rcpt_status_curr", "checksum": {"name": "sha256", "checksum": "6f305618232778cacc2fe574ed97c38ef73f858e2e2944c892456517a1b27ca0"}, "tags": [], "refs": [["ax_opco_invtry_rcpt_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2513876}, "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr": {"raw_sql": "with v_ax_opco_invtry_issue_status as(\r\n    select *\r\n    from {{ ref('ax_opco_invtry_issue_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_invtry_issue_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_invtry_issue_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_invtry_issue_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_invtry_issue_status_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_invtry_issue_status_curr.sql", "name": "v_ax_opco_invtry_issue_status_curr", "alias": "v_ax_opco_invtry_issue_status_curr", "checksum": {"name": "sha256", "checksum": "0053cdda6a6b80a91d15b2c03b56ac107ae04e94ca9a62133da38f4cb688e6fa"}, "tags": [], "refs": [["ax_opco_invtry_issue_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2537189}, "model.OI_Foundation.v_ax_opco_item_freight_curr": {"raw_sql": "with v_ax_opco_item_freight as(\r\n    select *,\r\n    rank() over(partition by opco_item_freight_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_freight') }}\r\n),\r\nfinal as(\r\n    select \r\n    *    \r\n    from v_ax_opco_item_freight\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_freight"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_freight_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_freight_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_freight_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_freight_curr.sql", "name": "v_ax_opco_item_freight_curr", "alias": "v_ax_opco_item_freight_curr", "checksum": {"name": "sha256", "checksum": "15a3dd5538484cb6c959cefe2bd8b0a48d4abaf4439142850d9bef5d6fbae15c"}, "tags": [], "refs": [["ax_opco_item_freight"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.255709}, "model.OI_Foundation.v_ax_opco_lob_curr": {"raw_sql": "with v_ax_opco_lob as(\r\n    select *,\r\n    rank() over(partition by opco_lob_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_lob') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_lob\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_lob"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_lob_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_lob_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_lob_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_lob_curr.sql", "name": "v_ax_opco_lob_curr", "alias": "v_ax_opco_lob_curr", "checksum": {"name": "sha256", "checksum": "f15b5ff01186c37c464298a136a9fbc9eda80b44cbfacfd7a277a52645a5f37f"}, "tags": [], "refs": [["ax_opco_lob"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.257729}, "model.OI_Foundation.v_ax_opco_item_psi_dtl_curr": {"raw_sql": "with v_ax_opco_item_psi_dtl as(\r\n    select *,\r\n    rank() over(partition by opco_item_psi_dtl_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_psi_dtl') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_psi_dtl\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_psi_dtl"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_psi_dtl_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_psi_dtl_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_psi_dtl_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_psi_dtl_curr.sql", "name": "v_ax_opco_item_psi_dtl_curr", "alias": "v_ax_opco_item_psi_dtl_curr", "checksum": {"name": "sha256", "checksum": "fd661c1036ede6d2e60488e76a582695e93209f603265ec4c4b3fa20efda88c9"}, "tags": [], "refs": [["ax_opco_item_psi_dtl"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2598352}, "model.OI_Foundation.v_ax_opco_item_sls_class_curr": {"raw_sql": "with v_ax_opco_item_sls_class as(\r\n    select *,\r\n    rank() over(partition by opco_item_sls_class_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_sls_class') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_sls_class\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_sls_class"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_sls_class_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_sls_class_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_sls_class_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_sls_class_curr.sql", "name": "v_ax_opco_item_sls_class_curr", "alias": "v_ax_opco_item_sls_class_curr", "checksum": {"name": "sha256", "checksum": "436be77a6aada2840bdf8af36635b0676fc161f6e2cd53f8b3522dbf5fc52bfb"}, "tags": [], "refs": [["ax_opco_item_sls_class"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2620716}, "model.OI_Foundation.v_ax_opco_uom_curr": {"raw_sql": "with v_ax_opco_uom as(\r\n    select *,\r\n    rank() over(partition by opco_uom_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_uom') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_uom\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_uom"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_uom_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_uom_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_uom_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_uom_curr.sql", "name": "v_ax_opco_uom_curr", "alias": "v_ax_opco_uom_curr", "checksum": {"name": "sha256", "checksum": "f6d1cac2199914c62c359e5480b0efb82055ad31d82915bb707ff5080719c3e4"}, "tags": [], "refs": [["ax_opco_uom"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2641695}, "model.OI_Foundation.v_ax_opco_item_size_curr": {"raw_sql": "with v_ax_opco_item_size as(\r\n    select *,\r\n    rank() over(partition by opco_item_size_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_item_size') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_item_size\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_item_size"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "product", "v_ax_opco_item_size_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_item_size_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/product/v_ax_opco_item_size_curr.sql", "original_file_path": "models/ax/current_views/product/v_ax_opco_item_size_curr.sql", "name": "v_ax_opco_item_size_curr", "alias": "v_ax_opco_item_size_curr", "checksum": {"name": "sha256", "checksum": "8e1d3daf0107c7e7b527706398c31e5cf575c3954d7cb2ce6cc8f10c3b532124"}, "tags": [], "refs": [["ax_opco_item_size"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.266173}, "model.OI_Foundation.v_ax_opco_cust_opco_locn_xref_curr": {"raw_sql": "with v_ax_opco_cust_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_cust_sk, opco_locn_sk, opco_cust_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cust_opco_locn_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cust_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cust_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "location", "v_ax_opco_cust_opco_locn_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cust_opco_locn_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/location/v_ax_opco_cust_opco_locn_xref_curr.sql", "original_file_path": "models/ax/current_views/location/v_ax_opco_cust_opco_locn_xref_curr.sql", "name": "v_ax_opco_cust_opco_locn_xref_curr", "alias": "v_ax_opco_cust_opco_locn_xref_curr", "checksum": {"name": "sha256", "checksum": "bd6f4a11879d9fbcc4c4a74e5d0d4338ddc56d7cc12bad17463a8113d43a6ffd"}, "tags": [], "refs": [["ax_opco_cust_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2681868}, "model.OI_Foundation.v_ax_opco_locn_curr": {"raw_sql": "with v_ax_opco_locn as(\r\n    select *,\r\n    rank() over(partition by opco_locn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_locn') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_locn\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_locn"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "location", "v_ax_opco_locn_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_locn_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/location/v_ax_opco_locn_curr.sql", "original_file_path": "models/ax/current_views/location/v_ax_opco_locn_curr.sql", "name": "v_ax_opco_locn_curr", "alias": "v_ax_opco_locn_curr", "checksum": {"name": "sha256", "checksum": "6300fd1d76dc07fa4855ff92bc4a0c42bd68044f52e4e905c1398c20709252b1"}, "tags": [], "refs": [["ax_opco_locn"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2704742}, "model.OI_Foundation.v_ax_opco_opco_locn_xref_curr": {"raw_sql": "with v_ax_opco_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sk, opco_locn_sk, opco_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_opco_locn_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "location", "v_ax_opco_opco_locn_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_opco_locn_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/location/v_ax_opco_opco_locn_xref_curr.sql", "original_file_path": "models/ax/current_views/location/v_ax_opco_opco_locn_xref_curr.sql", "name": "v_ax_opco_opco_locn_xref_curr", "alias": "v_ax_opco_opco_locn_xref_curr", "checksum": {"name": "sha256", "checksum": "7b4c3bf9e723cb7f8b22cbb3abdd2f1d94529a5f06cfe70c7f5b70fe811fdf46"}, "tags": [], "refs": [["ax_opco_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2724824}, "model.OI_Foundation.v_ax_opco_vendor_opco_locn_xref_curr": {"raw_sql": "with v_ax_opco_vendor_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_sk, opco_locn_sk, opco_vendor_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_vendor_opco_locn_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_vendor_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_vendor_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "location", "v_ax_opco_vendor_opco_locn_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_vendor_opco_locn_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/location/v_ax_opco_vendor_opco_locn_xref_curr.sql", "original_file_path": "models/ax/current_views/location/v_ax_opco_vendor_opco_locn_xref_curr.sql", "name": "v_ax_opco_vendor_opco_locn_xref_curr", "alias": "v_ax_opco_vendor_opco_locn_xref_curr", "checksum": {"name": "sha256", "checksum": "6b42777f135681b77e3ae25d779e2037e674269f2f2fbd6cbdb55f08f18de53d"}, "tags": [], "refs": [["ax_opco_vendor_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.274581}, "model.OI_Foundation.v_ax_fscl_clndr_curr": {"raw_sql": "with v_ax_fscl_clndr as(\r\n    select *,\r\n    rank() over(partition by fscl_clndr_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_fscl_clndr') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_fscl_clndr\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_fscl_clndr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_fscl_clndr_curr"], "unique_id": "model.OI_Foundation.v_ax_fscl_clndr_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_fscl_clndr_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_fscl_clndr_curr.sql", "name": "v_ax_fscl_clndr_curr", "alias": "v_ax_fscl_clndr_curr", "checksum": {"name": "sha256", "checksum": "aef8bd47ce01563b765e81c1d326f16b2f57ed0ca8f0f5b2416d32bf42b4a3fc"}, "tags": [], "refs": [["ax_fscl_clndr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2766218}, "model.OI_Foundation.v_ax_opco_type_curr": {"raw_sql": "with v_ax_opco_type as(\r\n    select *,\r\n    rank() over(partition by opco_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_type_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_type_curr.sql", "name": "v_ax_opco_type_curr", "alias": "v_ax_opco_type_curr", "checksum": {"name": "sha256", "checksum": "5a5bc156e4d171079d3c1976a69ab09aa533429f5536db680b7026cc43c4c751"}, "tags": [], "refs": [["ax_opco_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2788877}, "model.OI_Foundation.v_ax_opco_assctn_curr": {"raw_sql": "with v_ax_opco_assctn as(\r\n    select *,\r\n    rank() over(partition by opco_assctn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_assctn') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_assctn\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_assctn"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_assctn_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_assctn_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_assctn_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_assctn_curr.sql", "name": "v_ax_opco_assctn_curr", "alias": "v_ax_opco_assctn_curr", "checksum": {"name": "sha256", "checksum": "78c587718ba244be607bc02a80787ed272cba294e2e032691d6de81e28a5bbd2"}, "tags": [], "refs": [["ax_opco_assctn"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2808995}, "model.OI_Foundation.v_ax_region_curr": {"raw_sql": "with v_ax_region as(\r\n    select *,\r\n    rank() over(partition by region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_region') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_region_curr"], "unique_id": "model.OI_Foundation.v_ax_region_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_region_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_region_curr.sql", "name": "v_ax_region_curr", "alias": "v_ax_region_curr", "checksum": {"name": "sha256", "checksum": "2d21bc097133b5a18dc25ff72bfda3102a1f24a70a1288c6512f55988f07a364"}, "tags": [], "refs": [["ax_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2828836}, "model.OI_Foundation.v_ax_warehouse_curr": {"raw_sql": "with v_ax_warehouse as(\r\n    select *,\r\n    rank() over(partition by warehouse_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_warehouse') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_warehouse\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_warehouse_curr"], "unique_id": "model.OI_Foundation.v_ax_warehouse_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_warehouse_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_warehouse_curr.sql", "name": "v_ax_warehouse_curr", "alias": "v_ax_warehouse_curr", "checksum": {"name": "sha256", "checksum": "beadc8fb2aa965a7da8b82741844e2b983801083b469e073ae86113da9e43c90"}, "tags": [], "refs": [["ax_warehouse"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2850199}, "model.OI_Foundation.v_ax_opco_dept_curr": {"raw_sql": "with v_ax_opco_dept as(\r\n    select *,\r\n    rank() over(partition by opco_dept_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_dept') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_dept\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_dept"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_dept_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_dept_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_dept_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_dept_curr.sql", "name": "v_ax_opco_dept_curr", "alias": "v_ax_opco_dept_curr", "checksum": {"name": "sha256", "checksum": "12e67ae1ccc257b53af0b16322a613da0c698bbce0dc2a645f0b8298e5fb86a9"}, "tags": [], "refs": [["ax_opco_dept"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2872157}, "model.OI_Foundation.v_ax_sub_region_curr": {"raw_sql": "with v_ax_sub_region as(\r\n    select *,\r\n    rank() over(partition by sub_region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_sub_region') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_sub_region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_sub_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_sub_region_curr"], "unique_id": "model.OI_Foundation.v_ax_sub_region_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_sub_region_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_sub_region_curr.sql", "name": "v_ax_sub_region_curr", "alias": "v_ax_sub_region_curr", "checksum": {"name": "sha256", "checksum": "62090fd320544a03ef1c3d8bea1baac176f79b515247e019ab92aa1599b942f1"}, "tags": [], "refs": [["ax_sub_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2893045}, "model.OI_Foundation.v_ax_opco_site_curr": {"raw_sql": "with v_ax_opco_site as(\r\n    select *,\r\n    rank() over(partition by opco_site_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_site') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_site\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_site"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_site_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_site_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_site_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_site_curr.sql", "name": "v_ax_opco_site_curr", "alias": "v_ax_opco_site_curr", "checksum": {"name": "sha256", "checksum": "93818c36c52556d696f3fc1a4dfaea1d72c34001c18bf1962e479bfc90d472f9"}, "tags": [], "refs": [["ax_opco_site"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2913153}, "model.OI_Foundation.v_ax_opco_curr": {"raw_sql": "with v_ax_opco as(\r\n    select *,\r\n    rank() over(partition by opco_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_curr.sql", "name": "v_ax_opco_curr", "alias": "v_ax_opco_curr", "checksum": {"name": "sha256", "checksum": "e3c1512fa1387380507d3e266083056ecc37235cbaa652d40a7f5078ff631d73"}, "tags": [], "refs": [["ax_opco"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2937021}, "model.OI_Foundation.v_ax_opco_cost_center_curr": {"raw_sql": "with v_ax_opco_cost_center as(\r\n    select *,\r\n    rank() over(partition by opco_cost_center_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_cost_center') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_cost_center\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_cost_center"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "organization", "v_ax_opco_cost_center_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_cost_center_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/organization/v_ax_opco_cost_center_curr.sql", "original_file_path": "models/ax/current_views/organization/v_ax_opco_cost_center_curr.sql", "name": "v_ax_opco_cost_center_curr", "alias": "v_ax_opco_cost_center_curr", "checksum": {"name": "sha256", "checksum": "e0a73c274979b03e3c52df59c671afaebff1ba95a55c6a234d493ba0eb4127d0"}, "tags": [], "refs": [["ax_opco_cost_center"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.2972312}, "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr": {"raw_sql": "with v_ax_opco_sls_ordr_doc_status as(\r\n    select *\r\n    from {{ ref('ax_opco_sls_ordr_doc_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_sls_ordr_doc_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_doc_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_sls_ordr_doc_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_sls_ordr_doc_status_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_sls_ordr_doc_status_curr.sql", "name": "v_ax_opco_sls_ordr_doc_status_curr", "alias": "v_ax_opco_sls_ordr_doc_status_curr", "checksum": {"name": "sha256", "checksum": "68c6eb372012f2e1b4b817647018e1d66f567f4711b7ccce25d14692266fb885"}, "tags": [], "refs": [["ax_opco_sls_ordr_doc_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3006148}, "model.OI_Foundation.v_ax_opco_sls_ordr_curr": {"raw_sql": "with v_ax_opco_sls_ordr as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_sls_ordr') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_sls_ordr\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_sls_ordr_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_sls_ordr_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_sls_ordr_curr.sql", "name": "v_ax_opco_sls_ordr_curr", "alias": "v_ax_opco_sls_ordr_curr", "checksum": {"name": "sha256", "checksum": "45c1b53f0508fc4f3f46e73a7b12cfb88e1b1a0909dd7fb7cfad664337c23c18"}, "tags": [], "refs": [["ax_opco_sls_ordr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3039196}, "model.OI_Foundation.v_ax_opco_dlvry_terms_curr": {"raw_sql": "with v_ax_opco_dlvry_terms as(\r\n    select *,\r\n    rank() over(partition by opco_dlvry_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_dlvry_terms') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_dlvry_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_dlvry_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_dlvry_terms_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_dlvry_terms_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_dlvry_terms_curr.sql", "name": "v_ax_opco_dlvry_terms_curr", "alias": "v_ax_opco_dlvry_terms_curr", "checksum": {"name": "sha256", "checksum": "26f072b6f457ad11f98c87ce9dd153b9290da3ab9b038ce58984d62d2afe0b7c"}, "tags": [], "refs": [["ax_opco_dlvry_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3087785}, "model.OI_Foundation.v_ax_opco_trans_status_curr": {"raw_sql": "with v_ax_opco_trans_status as(\r\n    select *\r\n    from {{ ref('ax_opco_trans_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_trans_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_trans_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_trans_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_trans_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_trans_status_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_trans_status_curr.sql", "name": "v_ax_opco_trans_status_curr", "alias": "v_ax_opco_trans_status_curr", "checksum": {"name": "sha256", "checksum": "44db74110560a6a5e0db91504824c00234c7e82f1b48604bf48ca24775b3c8b8"}, "tags": [], "refs": [["ax_opco_trans_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.311623}, "model.OI_Foundation.v_ax_opco_sls_ordr_line_curr": {"raw_sql": "with v_ax_opco_sls_ordr_line as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_sls_ordr_line') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_sls_ordr_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_sls_ordr_line_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_sls_ordr_line_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_sls_ordr_line_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_sls_ordr_line_curr.sql", "name": "v_ax_opco_sls_ordr_line_curr", "alias": "v_ax_opco_sls_ordr_line_curr", "checksum": {"name": "sha256", "checksum": "413d38e3fc7ac123b96c749fd71b3acefef1ad407beca09e79e0eec78c00b464"}, "tags": [], "refs": [["ax_opco_sls_ordr_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3142223}, "model.OI_Foundation.v_ax_sls_ordr_opco_locn_xref_curr": {"raw_sql": "with v_ax_sls_ordr_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_sk, opco_locn_sk, sls_ordr_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_sls_ordr_opco_locn_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_sls_ordr_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_sls_ordr_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_sls_ordr_opco_locn_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_sls_ordr_opco_locn_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_sls_ordr_opco_locn_xref_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_sls_ordr_opco_locn_xref_curr.sql", "name": "v_ax_sls_ordr_opco_locn_xref_curr", "alias": "v_ax_sls_ordr_opco_locn_xref_curr", "checksum": {"name": "sha256", "checksum": "ec61508717c2a8133cdad2772b0be3dfff9dfb0bffe351ced0eb0d749ef8ce6b"}, "tags": [], "refs": [["ax_sls_ordr_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.317311}, "model.OI_Foundation.v_ax_opco_dlvry_mode_curr": {"raw_sql": "with v_ax_opco_dlvry_mode as(\r\n    select *,\r\n    rank() over(partition by opco_dlvry_mode_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_dlvry_mode') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_dlvry_mode\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_dlvry_mode"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_dlvry_mode_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_dlvry_mode_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_dlvry_mode_curr.sql", "name": "v_ax_opco_dlvry_mode_curr", "alias": "v_ax_opco_dlvry_mode_curr", "checksum": {"name": "sha256", "checksum": "63a3b800de0b75942607f870489e4db6789f11feb0c35348dd97bef24c9431b6"}, "tags": [], "refs": [["ax_opco_dlvry_mode"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.319634}, "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr": {"raw_sql": "with v_ax_opco_sls_ordr_type as(\r\n    select *\r\n    from {{ ref('ax_opco_sls_ordr_type') }}\r\n\r\n)\r\n\r\nselect * from v_ax_opco_sls_ordr_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "sales_order", "v_ax_opco_sls_ordr_type_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/sales_order/v_ax_opco_sls_ordr_type_curr.sql", "original_file_path": "models/ax/current_views/sales_order/v_ax_opco_sls_ordr_type_curr.sql", "name": "v_ax_opco_sls_ordr_type_curr", "alias": "v_ax_opco_sls_ordr_type_curr", "checksum": {"name": "sha256", "checksum": "cba2ed48eacbda592ba44af013646bafea7f3e3efe385d957b2926f4b119ca92"}, "tags": [], "refs": [["ax_opco_sls_ordr_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.321771}, "model.OI_Foundation.v_ax_opco_project_cost_trans_curr": {"raw_sql": "with v_ax_opco_project_cost_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_cost_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_cost_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_cost_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_cost_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_cost_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_cost_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_cost_trans_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_cost_trans_curr.sql", "name": "v_ax_opco_project_cost_trans_curr", "alias": "v_ax_opco_project_cost_trans_curr", "checksum": {"name": "sha256", "checksum": "4f4ecedcf4ed63aa550eaa711fd8d74fc5c7f34a004f535454a85480ea885ce8"}, "tags": [], "refs": [["ax_opco_project_cost_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3237562}, "model.OI_Foundation.v_ax_opco_project_item_trans_curr": {"raw_sql": "with v_ax_opco_project_item_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_item_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_item_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_item_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_item_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_item_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_item_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_item_trans_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_item_trans_curr.sql", "name": "v_ax_opco_project_item_trans_curr", "alias": "v_ax_opco_project_item_trans_curr", "checksum": {"name": "sha256", "checksum": "7242ff09bdf635ed241d1d273c881c2560247f5a495d8aa0eb74bfd6c5aab27a"}, "tags": [], "refs": [["ax_opco_project_item_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3258865}, "model.OI_Foundation.v_ax_opco_project_cost_frcst_curr": {"raw_sql": "with v_ax_opco_project_cost_frcst as(\r\n    select *,\r\n    rank() over(partition by opco_project_cost_frcst_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_cost_frcst') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_cost_frcst\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_cost_frcst"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_cost_frcst_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_cost_frcst_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_cost_frcst_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_cost_frcst_curr.sql", "name": "v_ax_opco_project_cost_frcst_curr", "alias": "v_ax_opco_project_cost_frcst_curr", "checksum": {"name": "sha256", "checksum": "4922ce1682f25560ccfce9cf0b120d4f2d09fd1a421ceae1d26af087628b369b"}, "tags": [], "refs": [["ax_opco_project_cost_frcst"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3280787}, "model.OI_Foundation.v_ax_opco_project_catgry_curr": {"raw_sql": "with v_ax_opco_project_catgry as(\r\n    select *,\r\n    rank() over(partition by opco_project_catgry_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_catgry') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_catgry\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_catgry"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_catgry_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_catgry_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_catgry_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_catgry_curr.sql", "name": "v_ax_opco_project_catgry_curr", "alias": "v_ax_opco_project_catgry_curr", "checksum": {"name": "sha256", "checksum": "5777da9d84679753765b6b8e5154774c2324e0387b6ef48ceed7895706409dbe"}, "tags": [], "refs": [["ax_opco_project_catgry"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3301766}, "model.OI_Foundation.v_ax_opco_project_empl_trans_curr": {"raw_sql": "with v_ax_opco_project_empl_trans  as(\r\n    select *,\r\n    rank() over(partition by opco_project_empl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_empl_trans') }}\r\n),\r\nfinal as(\r\n    select\r\n    *\r\n    from v_ax_opco_project_empl_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_empl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_empl_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_empl_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_empl_trans_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_empl_trans_curr.sql", "name": "v_ax_opco_project_empl_trans_curr", "alias": "v_ax_opco_project_empl_trans_curr", "checksum": {"name": "sha256", "checksum": "392b9c3ea910094d9b65013396a101ec80d033b24ea858227783cfc51f7ae5de"}, "tags": [], "refs": [["ax_opco_project_empl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3321917}, "model.OI_Foundation.v_ax_opco_project_revenue_trans_curr": {"raw_sql": "with v_ax_opco_project_revenue_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_revenue_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_revenue_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_revenue_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_revenue_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_revenue_trans_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_revenue_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_revenue_trans_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_revenue_trans_curr.sql", "name": "v_ax_opco_project_revenue_trans_curr", "alias": "v_ax_opco_project_revenue_trans_curr", "checksum": {"name": "sha256", "checksum": "c02df48ef2d158b7a6da8f0587a2a200bf0c65a6ba0bbc64273236648bad2572"}, "tags": [], "refs": [["ax_opco_project_revenue_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.334263}, "model.OI_Foundation.v_ax_opco_project_curr": {"raw_sql": "with v_ax_opco_project as(\r\n    select *,\r\n    rank() over(partition by opco_project_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_curr.sql", "name": "v_ax_opco_project_curr", "alias": "v_ax_opco_project_curr", "checksum": {"name": "sha256", "checksum": "bb5697f8fba190ef41c23b7117449d334f15e9c5446de2edbd9ebee431179dab"}, "tags": [], "refs": [["ax_opco_project"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.33655}, "model.OI_Foundation.v_ax_opco_project_invoice_project_xref_curr": {"raw_sql": "with v_ax_opco_project_invoice_project_xref  as(\r\n    select *,\r\n    rank() over(partition by opco_project_sk, invoice_project_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_invoice_project_xref') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_invoice_project_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_invoice_project_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_invoice_project_xref_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_invoice_project_xref_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_invoice_project_xref_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_invoice_project_xref_curr.sql", "name": "v_ax_opco_project_invoice_project_xref_curr", "alias": "v_ax_opco_project_invoice_project_xref_curr", "checksum": {"name": "sha256", "checksum": "096a00bff9054f6651bc43f1b5b1ea6a02ee80cf17554787e709be93bd58c07d"}, "tags": [], "refs": [["ax_opco_project_invoice_project_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3385367}, "model.OI_Foundation.v_ax_opco_project_empl_frcst_curr": {"raw_sql": "with v_ax_opco_project_empl_frcst as(\r\n    select *,\r\n    rank() over(partition by opco_project_empl_frcst_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_empl_frcst') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_empl_frcst\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_empl_frcst"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_empl_frcst_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_empl_frcst_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_empl_frcst_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_empl_frcst_curr.sql", "name": "v_ax_opco_project_empl_frcst_curr", "alias": "v_ax_opco_project_empl_frcst_curr", "checksum": {"name": "sha256", "checksum": "590871745cf6f65c4dbbf669bf8bddb000b0e2332017bba50a34a202dbbe75e3"}, "tags": [], "refs": [["ax_opco_project_empl_frcst"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3406222}, "model.OI_Foundation.v_ax_opco_project_trans_origin_curr": {"raw_sql": "with v_ax_opco_project_trans_origin as(\r\n    select *\r\n    from {{ ref('ax_opco_project_trans_origin') }}\r\n\r\n)\r\n\r\nselect * from v_ax_opco_project_trans_origin", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_trans_origin"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_trans_origin_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_trans_origin_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_trans_origin_curr.sql", "name": "v_ax_opco_project_trans_origin_curr", "alias": "v_ax_opco_project_trans_origin_curr", "checksum": {"name": "sha256", "checksum": "fb5302ef9ab1180529247154755e1d1074ca65bbbfae6d369840c953643adea1"}, "tags": [], "refs": [["ax_opco_project_trans_origin"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3426602}, "model.OI_Foundation.v_ax_opco_project_trans_status_curr": {"raw_sql": "with v_ax_opco_project_trans_status as(\r\n    select *\r\n    from {{ ref('ax_opco_project_trans_status') }}\r\n)\r\n\r\nselect * from v_ax_opco_project_trans_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_trans_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_trans_status_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_trans_status_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_trans_status_curr.sql", "name": "v_ax_opco_project_trans_status_curr", "alias": "v_ax_opco_project_trans_status_curr", "checksum": {"name": "sha256", "checksum": "7620190ce3abd1acbdf15084ccf4fa608a44a62c763163e0e306e93adbd699a3"}, "tags": [], "refs": [["ax_opco_project_trans_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3448427}, "model.OI_Foundation.v_ax_opco_project_trans_posting_curr": {"raw_sql": "with v_ax_opco_project_trans_posting  as(\r\n    select *,\r\n    rank() over(partition by opco_project_trans_posting_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('ax_opco_project_trans_posting') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_ax_opco_project_trans_posting \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.ax_opco_project_trans_posting"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "current_views", "project", "v_ax_opco_project_trans_posting_curr"], "unique_id": "model.OI_Foundation.v_ax_opco_project_trans_posting_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/current_views/project/v_ax_opco_project_trans_posting_curr.sql", "original_file_path": "models/ax/current_views/project/v_ax_opco_project_trans_posting_curr.sql", "name": "v_ax_opco_project_trans_posting_curr", "alias": "v_ax_opco_project_trans_posting_curr", "checksum": {"name": "sha256", "checksum": "b9a69a89a56e27431c3accc94c7f4251274a45f100128fa343a2d9bef4391a10"}, "tags": [], "refs": [["ax_opco_project_trans_posting"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086793.3469534}, "model.OI_Foundation.ax_opco_cust_settled_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_SETTLED_TRANS') %}\r\n\r\nwith ax_opco_cust_settled_trans as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    cs._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when cs._fivetran_deleted = true then cs._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cs.dataareaid as opco_id,\r\n    cs.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    oct.opco_cust_trans_sk,\r\n    oc.opco_cust_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oca.opco_chart_of_accts_sk as cash_dscnt_gl_acct_sk,\r\n    cs.transdate as trans_dt,\r\n    cs.duedate as due_dt,\r\n    cs.createddatetime as src_crt_dtm,\r\n    oc1.opco_cust_sk as offset_cust_sk,\r\n    oct1.opco_cust_trans_sk as offset_cust_trans_sk,\r\n    cs.offsettransvoucher as offset_voucher_nbr,\r\n    cs.custcashdiscdate as cust_cash_dscnt_dt,\r\n    cs.lastinterestdate as latest_interest_calc_dt,\r\n    cs.canbereversed as reversible_ind,\r\n    cs.settlementgroup as settlement_grp_txt,\r\n    cs.settlementvoucher as settled_voucher_nbr,\r\n    cs.settleamountcur as trans_currency_settled_amt,\r\n    cs.settleamountmst as opco_currency_settled_amt,\r\n    cs.exchadjustment as exch_adjstmnt_amt,\r\n    cs.utilizedcashdisc as utilized_cash_dscnt_amt\r\n    from {{ source('AX_DEV', 'CUSTSETTLEMENT') }} cs\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on cs.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_trans_curr')}} oct\r\n        on cs.dataareaid = oct.opco_id\r\n        and cs.transrecid = oct.src_key_txt\r\n        and oct.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc\r\n        on cs.dataareaid = oc.opco_id\r\n        and cs.accountnum = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_trans_curr')}} oct1\r\n        on cs.dataareaid = oct1.opco_id\r\n        and cs.offsetrecid = oct1.src_key_txt\r\n        and oct1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc1\r\n        on cs.offsetcompany = oc1.opco_id\r\n        and cs.offsetaccountnum = oc1.cust_id\r\n        and oc1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(cs.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(cs.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(cs.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(cs.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(cs.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} oca \r\n        on cs.dataareaid = oca.opco_id\r\n        and cs.cashdiscaccount = oca.gl_acct_nbr\r\n        and oca.src_sys_nm = 'AX'\r\n    where cs.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select distinct\r\n           {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt'])}} as opco_cust_settled_trans_sk,\r\n           {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_sk', 'opco_cust_trans_sk', 'opco_cust_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'cash_dscnt_gl_acct_sk', 'trans_dt', 'due_dt', 'src_crt_dtm', 'offset_cust_sk', 'offset_cust_trans_sk', 'offset_voucher_nbr', 'cust_cash_dscnt_dt', 'latest_interest_calc_dt', 'reversible_ind', 'settlement_grp_txt', 'settled_voucher_nbr', 'trans_currency_settled_amt', 'opco_currency_settled_amt', 'exch_adjstmnt_amt', 'utilized_cash_dscnt_amt'])}} as opco_cust_settled_trans_ck,\r\n           concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_cust_settled_trans_ak, *\r\n    from ax_opco_cust_settled_trans\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_SETTLED_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_SETTLED_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_settled_trans_sk, opco_cust_settled_trans_ck, opco_cust_settled_trans_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_trans_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk,\r\n    cash_dscnt_gl_acct_sk, trans_dt, due_dt, src_crt_dtm, offset_cust_sk, offset_cust_trans_sk, offset_voucher_nbr, cust_cash_dscnt_dt, latest_interest_calc_dt, \r\n    reversible_ind, settlement_grp_txt, settled_voucher_nbr, trans_currency_settled_amt, opco_currency_settled_amt, exch_adjstmnt_amt, utilized_cash_dscnt_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_settled_trans\r\n    {% if _load == 1 %}\r\n        where opco_cust_settled_trans_ck not in (select distinct opco_cust_settled_trans_ck from final)\r\n    {% else %}\r\n        where opco_cust_settled_trans_ck not in (select distinct opco_cust_settled_trans_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_settled_trans where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_settled_trans_ck not in (select distinct opco_cust_settled_trans_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_settled_trans where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_settled_trans_ck in (select distinct opco_cust_settled_trans_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_settled_trans where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTSETTLEMENT", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_settled_trans"], "unique_id": "model.OI_Foundation.ax_opco_cust_settled_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_settled_trans.sql", "original_file_path": "models/ax/customer/ax_opco_cust_settled_trans.sql", "name": "ax_opco_cust_settled_trans", "alias": "ax_opco_cust_settled_trans", "checksum": {"name": "sha256", "checksum": "755418cb0eb0466f1f1735f273348fea352507d76428f4b7e3b1637584f8f65f"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_trans_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cust_trans_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_chart_of_accts_curr"]], "sources": [["AX_DEV", "CUSTSETTLEMENT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.3489602}, "model.OI_Foundation.ax_opco_pymnt_terms": {"raw_sql": "{% set _load = load_type('AX_OPCO_PYMNT_TERMS') %}\r\n\r\nwith ax_opco_pymnt_terms as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(paymtermid)::varchar(40) as src_pymnt_terms_cd,\r\n    max(description)::varchar(100) as src_pymnt_terms_desc\r\n    from {{source('AX_DEV', 'PAYMTERM')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_pymnt_terms_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_terms_cd'])}} as opco_pymnt_terms_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_terms_cd','src_pymnt_terms_desc']) }} as opco_pymnt_terms_ck, \r\n            *\r\n    from ax_opco_pymnt_terms \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PYMNT_TERMS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PYMNT_TERMS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_pymnt_terms_sk, opco_pymnt_terms_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_pymnt_terms_cd, src_pymnt_terms_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms\r\n    {% if _load == 1 %}\r\n        where opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from final)\r\n    {% else %}\r\n        where opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_terms_ck not in (select distinct opco_pymnt_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_terms_ck in (select distinct opco_pymnt_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_terms where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PAYMTERM"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_pymnt_terms"], "unique_id": "model.OI_Foundation.ax_opco_pymnt_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_pymnt_terms.sql", "original_file_path": "models/ax/customer/ax_opco_pymnt_terms.sql", "name": "ax_opco_pymnt_terms", "alias": "ax_opco_pymnt_terms", "checksum": {"name": "sha256", "checksum": "1a3f3f9b63ddf2e0edfc5a788fdadc742733de5acbef2bd7f3593f7ff0da8185"}, "tags": [], "refs": [], "sources": [["AX_DEV", "PAYMTERM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.3675442}, "model.OI_Foundation.ax_opco_cust_invoice_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_INVOICE_LINE') %}\r\n\r\nwith ax_opco_cust_invoice_line as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    cit._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when cit._fivetran_deleted = true then cit._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cit.dataareaid as opco_id,\r\n    cit.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    oso.opco_sls_ordr_sk,\r\n    oso1.opco_sls_ordr_sk as orig_sls_ordr_sk,\r\n    oi.opco_item_sk,\r\n    ocoa.opco_chart_of_accts_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    ou.opco_uom_sk as sls_uom_sk,\r\n    ou1.opco_uom_sk as gl_prod_uom_sk,\r\n    ou2.opco_uom_sk as gl_sls_uom_sk,\r\n    oa.opco_assctn_sk,\r\n    oirt.opco_invtry_ref_type_sk,\r\n    cit.invoiceid as invoice_nbr,\r\n    cit.linenum as line_nbr,\r\n    cit.inventtransid as invtry_trans_id,\r\n    cit.externalitemid as cust_item_id,\r\n    cit.taxgroup as tax_grp_id,\r\n    cit.taxitemgroup as tax_item_grp_id,\r\n    cit.inventrefid as invtry_ref_id,\r\n    cit.itembomid_opi as item_bom_id,\r\n    cit.name as item_desc,\r\n    cit.salesgroup as sls_grp_txt,\r\n    cit.countryregionofshipment as shpmt_country_nm,\r\n    cit.dlvcountryregionid as dlvry_country_nm,\r\n    cit.dlvstate as dlvry_state_nm,\r\n    cit.dlvcounty as dlvry_county_nm,\r\n    cit.mark_opi as mark_txt,\r\n    cit.groupname_opi as grp_nm,\r\n    cit.dlvdate as ship_dt,\r\n    cit.partdelivery as partial_dlvry_ind,\r\n    cit.risktype_opi as risk_type_ind,\r\n    cit.kits_opi as kits_ind,\r\n    cit.commisscalc as commsn_calc_ind,\r\n    case \r\n        when cit.deliverytype = 0 then null\r\n        when cit.deliverytype = 1 then 'Direct Delivery'\r\n    end as dlvry_type_txt,\r\n    cit.lineheader as invoice_line_txt,\r\n    cit.special_opi as spcl_item_ind,\r\n    cit.specialinspecial_opi as spcl_in_spcl_ind,\r\n    cit.specialnumber_opi as spcl_item_nbr,\r\n    cit.laborhours_opi as labor_hours_nbr,\r\n    cit.engineeringhours_opi as engineering_hours_nbr,\r\n    cit.weight as item_weight_amt,\r\n    cit.priceunit as per_unit_qty,\r\n    cit.qty as invoice_item_qty,\r\n    cit.qtyordered_opi as ordr_qty,\r\n    cit.qtyphysical as dlvrd_qty,\r\n    cit.qtyprevinvoiced_opi as prev_invoiced_qty,\r\n    cit.qtyremain_opi as remaining_qty,\r\n    cit.inventqty as invtry_units_qty,\r\n    cit.glprodqty_opi as gl_prod_qty,\r\n    cit.glsalesqty_opi as gl_sls_qty,\r\n    cit.sisqty_opi as sis_qty,\r\n    cit.discpercent as dscnt_pct,\r\n    cit.linepercent as line_dscnt_pct,\r\n    cit.overheadcostpct_opi as overhead_cost_pct,\r\n    cit.mc_opi as margin_contribution_pct,\r\n    cit.lineamount as trans_currency_sls_amt,\r\n    cit.lineamountmst as opco_currency_sls_amt,\r\n    cit.lineamounttax as trans_currency_incl_sls_tax_amt,\r\n    cit.lineamounttaxmst as opco_currency_incl_sls_tax_amt,\r\n    cit.sumlinedisc as trans_currency_sum_line_dscnt_amt,\r\n    cit.sumlinediscmst as opco_currency_sum_line_dscnt_amt,\r\n    cit.taxamount as trans_currency_tax_amt,\r\n    cit.taxamountmst as opco_currency_tax_amt,\r\n    cit.commissamountcur as trans_currency_commsn_amt,\r\n    cit.commissamountmst as opco_currency_commsn_amt,\r\n    cit.salesmarkup as sls_markup_amt,\r\n    cit.salesprice as per_unit_sls_price_amt,\r\n    cit.ediprice_opi as online_price_amt,\r\n    cit.listprice_opi as list_price_amt,\r\n    cit.imbfrtcost_opi as imbedded_freight_cost_amt,\r\n    cit.imbfrt_opi as imbedded_freight_amt,\r\n    cit.totalcost_opi as total_cost_amt,\r\n    cit.itemcost_opi as item_cost_amt,\r\n    cit.defaultprice_opi as default_item_price_amt,\r\n    cit.itemprice_opi as item_price_amt\r\n    from {{ source('AX_DEV', 'CUSTINVOICETRANS') }} cit \r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on cit.dataareaid = opco.opco_id \r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on cit.dataareaid = oso.opco_id\r\n        and cit.salesid = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso1 \r\n        on cit.dataareaid = oso1.opco_id\r\n        and cit.origsalesid = oso1.sls_ordr_id\r\n        and oso1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on cit.dataareaid = oi.opco_id\r\n        and cit.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} ocoa \r\n        on cit.dataareaid = ocoa.opco_id\r\n        and cit.ledgeraccount = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(cit.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(cit.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(cit.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(cit.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(cit.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr \r\n        on upper(cit.currencycode) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(cit.salesunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou1 \r\n        on upper(cit.glproduom_opi) = ou1.src_uom_cd\r\n        and ou1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou2 \r\n        on upper(cit.glsalesuom_opi) = ou2.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa \r\n        on cit.dataareaid = oa.opco_id\r\n        and cit.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_ref_type_curr')}} oirt\r\n        on cit.inventreftype = oirt.invtry_ref_type_cd\r\n        and oirt.src_sys_nm = 'AX'\r\n    where cit.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt']) }} as opco_cust_invoice_line_sk,\r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_sk', 'opco_sls_ordr_sk', 'orig_sls_ordr_sk', 'opco_item_sk', 'opco_chart_of_accts_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'sls_uom_sk', 'gl_prod_uom_sk', 'gl_sls_uom_sk', 'opco_assctn_sk', 'opco_invtry_ref_type_sk', 'invoice_nbr', 'line_nbr', 'invtry_trans_id', 'cust_item_id', 'tax_grp_id', 'tax_item_grp_id', 'invtry_ref_id', 'item_bom_id', 'item_desc', 'sls_grp_txt', 'shpmt_country_nm', 'dlvry_country_nm', 'dlvry_state_nm', 'dlvry_county_nm', 'mark_txt', 'grp_nm', 'ship_dt', 'partial_dlvry_ind', 'risk_type_ind', 'kits_ind', 'commsn_calc_ind', 'dlvry_type_txt', 'invoice_line_txt', 'spcl_item_ind', 'spcl_in_spcl_ind', 'spcl_item_nbr', 'labor_hours_nbr', 'engineering_hours_nbr', 'item_weight_amt', 'per_unit_qty', 'invoice_item_qty', 'ordr_qty', 'dlvrd_qty', 'prev_invoiced_qty', 'remaining_qty', 'invtry_units_qty', 'gl_prod_qty', 'gl_sls_qty', 'sis_qty', 'dscnt_pct', 'line_dscnt_pct', 'overhead_cost_pct', 'margin_contribution_pct', 'trans_currency_sls_amt', 'opco_currency_sls_amt', 'trans_currency_incl_sls_tax_amt', 'opco_currency_incl_sls_tax_amt', 'trans_currency_sum_line_dscnt_amt', 'opco_currency_sum_line_dscnt_amt', 'trans_currency_tax_amt', 'opco_currency_tax_amt', 'trans_currency_commsn_amt', 'opco_currency_commsn_amt', 'sls_markup_amt', 'per_unit_sls_price_amt', 'online_price_amt', 'list_price_amt', 'imbedded_freight_cost_amt', 'imbedded_freight_amt', 'total_cost_amt', 'item_cost_amt', 'default_item_price_amt', 'item_price_amt']) }} as opco_cust_invoice_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_cust_invoice_line_ak,\r\n            * \r\n    from ax_opco_cust_invoice_line \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_INVOICE_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_INVOICE_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_invoice_line_sk, opco_cust_invoice_line_ck, opco_cust_invoice_line_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_sls_ordr_sk, orig_sls_ordr_sk, opco_item_sk, opco_chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, trans_currency_sk, sls_uom_sk, gl_prod_uom_sk,  gl_sls_uom_sk, opco_assctn_sk, opco_invtry_ref_type_sk, invoice_nbr, line_nbr, invtry_trans_id,  cust_item_id, tax_grp_id,\r\n    tax_item_grp_id, invtry_ref_id, item_bom_id, item_desc, sls_grp_txt, shpmt_country_nm, dlvry_country_nm, dlvry_state_nm,  dlvry_county_nm, mark_txt, grp_nm, ship_dt, partial_dlvry_ind,\r\n    risk_type_ind, kits_ind, commsn_calc_ind, dlvry_type_txt, invoice_line_txt, spcl_item_ind, spcl_in_spcl_ind, spcl_item_nbr, labor_hours_nbr, engineering_hours_nbr, item_weight_amt,\r\n    per_unit_qty, invoice_item_qty, ordr_qty, dlvrd_qty, prev_invoiced_qty, remaining_qty, invtry_units_qty, gl_prod_qty, gl_sls_qty, sis_qty, dscnt_pct, line_dscnt_pct, \r\n    overhead_cost_pct, margin_contribution_pct, trans_currency_sls_amt, opco_currency_sls_amt, trans_currency_incl_sls_tax_amt, opco_currency_incl_sls_tax_amt, trans_currency_sum_line_dscnt_amt,\r\n    opco_currency_sum_line_dscnt_amt, trans_currency_tax_amt, opco_currency_tax_amt, trans_currency_commsn_amt, opco_currency_commsn_amt, sls_markup_amt, per_unit_sls_price_amt, \r\n    online_price_amt, list_price_amt, imbedded_freight_cost_amt, imbedded_freight_amt, total_cost_amt, item_cost_amt, default_item_price_amt, item_price_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_invoice_line\r\n    {% if _load == 1 %}\r\n        where OPCO_cust_invoice_line_ck not in (select distinct OPCO_cust_invoice_line_ck from final)\r\n    {% else %}\r\n        where OPCO_cust_invoice_line_ck not in (select distinct OPCO_cust_invoice_line_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_cust_invoice_line where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_cust_invoice_line_ck not in (select distinct OPCO_cust_invoice_line_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_cust_invoice_line where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_cust_invoice_line_ck in (select distinct OPCO_cust_invoice_line_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_cust_invoice_line where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTINVOICETRANS", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_invoice_line"], "unique_id": "model.OI_Foundation.ax_opco_cust_invoice_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_invoice_line.sql", "original_file_path": "models/ax/customer/ax_opco_cust_invoice_line.sql", "name": "ax_opco_cust_invoice_line", "alias": "ax_opco_cust_invoice_line", "checksum": {"name": "sha256", "checksum": "a73aba1c8c204a188584ed18c80e2fe461963b359c7fa9e859ea1f13584b9ead"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_chart_of_accts_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_invtry_ref_type_curr"]], "sources": [["AX_DEV", "CUSTINVOICETRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.379216}, "model.OI_Foundation.ax_opco_cust_packing_slip": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_PACKING_SLIP') %}\r\n\r\nwith ax_opco_cust_packing_slip as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    cpj._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when cpj._fivetran_deleted = true then cpj._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cpj.dataareaid as opco_id,\r\n    cpj.packingslipid as packing_slip_id,\r\n    oso.opco_sls_ordr_sk,\r\n    osot.opco_sls_ordr_type_sk,\r\n    oc.opco_cust_sk,\r\n    oc1.opco_cust_sk as invoice_cust_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opl.opco_picking_list_sk,\r\n    os.opco_site_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    wr.warehouse_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    oln.opco_locn_sk as dlvry_locn_sk,\r\n    cpj.ledgervoucher as gl_voucher_nbr,\r\n    cpj.purchaseorder as po_form_nbr,\r\n    cpj.deliverydate as ship_dt,\r\n    cpj.customerref as cust_ref_txt,\r\n    cpj.taxgroup_opi as tax_grp_id,\r\n    case\r\n        when cpj.donotprintinvoice_opi = 0 then 1\r\n        when cpj.donotprintinvoice_opi = 1 then 0\r\n    end as print_invoice_ind,\r\n    cpj.creditreasonid_opi as credit_reason_id,\r\n    cpj.specialinstructions_opi as spcl_instr_txt,\r\n    cpj.registered_opi as registered_Ind,\r\n    cpj.deliveryname as dlvry_cust_nm,\r\n    cpj.invoicingname as invoice_cust_nm,\r\n    cpj.invoicingaddress as invoice_address_txt,\r\n    cpj.loadno_opi as load_nbr,\r\n    cpj.plloadcount_opi as pl_load_cnt,\r\n    cpj.miles_opi as miles_cnt,\r\n    cpj.qty as dlvry_qty,\r\n    cpj.palletqty_opi as pallet_qty,\r\n    cpj.rateperpallet_opi as pallet_rate_amt,\r\n    cpj.volume as dlvry_volume_amt,\r\n    cpj.weight as dlvry_weight_amt,\r\n    cpj.deliverycost_opi as dlvry_cost_amt,\r\n    cpj.packedamount_opi as packing_slip_amt,\r\n    cpj.invoiceid_opi as invoice_nbr,\r\n    cpj.invoicedate_opi as invoice_dt,\r\n    cpj.invoiced_opi as invoice_sent_ind,\r\n    cpj.invoiceamount_opi as invoice_amt\r\n    from {{ source('AX_DEV', 'CUSTPACKINGSLIPJOUR') }} cpj\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on cpj.dataareaid = oso.opco_id\r\n        and cpj.salesid = oso. sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_type_curr')}} osot \r\n        on cpj.salestype = osot.src_sls_ordr_type_cd\r\n        and osot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc \r\n        on cpj.dataareaid = oc.opco_id\r\n        and cpj.orderaccount = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc1 \r\n        on cpj.dataareaid = oc1.opco_id\r\n        and cpj.invoiceaccount = oc1.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(cpj.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(cpj.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(cpj.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(cpj.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(cpj.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_picking_list_curr')}} opl \r\n        on cpj.dataareaid = opl.opco_id\r\n        and cpj.pickinglistid_opi = opl.picking_list_id\r\n        and opl.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_site_curr')}} os \r\n        on upper(cpj.inventsiteid_opi) = os.src_site_id\r\n        and os.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr\r\n        on upper(cpj.currencycode_opi) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(cpj.payment_opi) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_warehouse_curr')}} wr \r\n        on cpj.dataareaid = wr.opco_id\r\n        and upper(cpj.inventlocationid) = wr.warehouse_id\r\n        and wr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(cpj.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(cpj.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} oln \r\n         on upper(cpj.deliverystreet) = oln.addr_ln_1_txt\r\n        and upper(cpj.deliverycity) = oln.city_nm\r\n        and upper(cpj.dlvstate) = oln.state_nm\r\n        and upper(cpj.dlvcountryregionid) = oln.country_nm\r\n        and upper(cpj.dlvzipcode) = oln.zip_cd\r\n        and oln.src_sys_nm = 'AX'\r\n    where cpj.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id']) }} as opco_cust_packing_slip_sk,\r\n           {{ dbt_utils.surrogate_key(['opco_id', 'packing_slip_id', 'opco_sls_ordr_sk', 'opco_sls_ordr_type_sk', 'opco_cust_sk', 'invoice_cust_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_picking_list_sk', 'opco_site_sk', 'trans_currency_sk', 'opco_pymnt_terms_sk', 'warehouse_sk', 'opco_dlvry_terms_sk', 'opco_dlvry_mode_sk', 'dlvry_locn_sk', 'gl_voucher_nbr', 'po_form_nbr', 'ship_dt', 'cust_ref_txt', 'tax_grp_id', 'print_invoice_ind', 'credit_reason_id', 'spcl_instr_txt', 'registered_Ind', 'dlvry_cust_nm', 'invoice_cust_nm', 'invoice_address_txt', 'load_nbr', 'pl_load_cnt', 'miles_cnt', 'dlvry_qty', 'pallet_qty', 'pallet_rate_amt', 'dlvry_volume_amt', 'dlvry_weight_amt', 'dlvry_cost_amt', 'packing_slip_amt', 'invoice_nbr', 'invoice_dt', 'invoice_sent_ind', 'invoice_amt']) }} as opco_cust_packing_slip_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, packing_slip_id) as opco_cust_packing_slip_ak,\r\n            * \r\n    from ax_opco_cust_packing_slip ocps\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_PACKING_SLIP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_PACKING_SLIP') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_packing_slip_sk, opco_cust_packing_slip_ck, opco_cust_packing_slip_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    opco_id, packing_slip_id, opco_sls_ordr_sk, opco_sls_ordr_type_sk, opco_cust_sk, invoice_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, \r\n    opco_lob_sk, opco_picking_list_sk, opco_site_sk, trans_currency_sk, opco_pymnt_terms_sk, warehouse_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk, gl_voucher_nbr, \r\n    po_form_nbr, ship_dt, cust_ref_txt, tax_grp_id, print_invoice_ind, credit_reason_id, spcl_instr_txt, registered_Ind, dlvry_cust_nm, invoice_cust_nm, invoice_address_txt, \r\n    load_nbr, pl_load_cnt, miles_cnt, dlvry_qty, pallet_qty, pallet_rate_amt, dlvry_volume_amt, dlvry_weight_amt, dlvry_cost_amt, packing_slip_amt, invoice_nbr, invoice_dt,\r\n    invoice_sent_ind, invoice_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip\r\n    {% if _load == 1 %}\r\n        where opco_cust_packing_slip_CK not in (select distinct opco_cust_packing_slip_CK from final)\r\n    {% else %}\r\n        where opco_cust_packing_slip_CK not in (select distinct opco_cust_packing_slip_CK from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_packing_slip_CK not in (select distinct opco_cust_packing_slip_CK from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_packing_slip_CK in (select distinct opco_cust_packing_slip_CK from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_warehouse_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_packing_slip"], "unique_id": "model.OI_Foundation.ax_opco_cust_packing_slip", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_packing_slip.sql", "original_file_path": "models/ax/customer/ax_opco_cust_packing_slip.sql", "name": "ax_opco_cust_packing_slip", "alias": "ax_opco_cust_packing_slip", "checksum": {"name": "sha256", "checksum": "bb5a8a9b0d26db808a78fdc0fb92ca6e890245bc415da61f997d19641770e8ec"}, "tags": [], "refs": [["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_sls_ordr_type_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_picking_list_curr"], ["v_ax_opco_site_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_warehouse_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "CUSTPACKINGSLIPJOUR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.4073648}, "model.OI_Foundation.ax_opco_cust_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_TRANS') %}\r\n\r\nwith ax_opco_cust_trans as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    ct._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when ct._fivetran_deleted = true then ct._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    ct.dataareaid as opco_id,\r\n    ct.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    oc.opco_cust_sk,\r\n    odc.opco_cust_sk as order_cust_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oso.opco_sls_ordr_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    ocu.opco_currency_sk as trans_currency_sk,\r\n    opm.opco_pymnt_mode_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    ocd.opco_cash_dscnt_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    opr.opco_project_sk,\r\n    ct.transdate as trans_dt,\r\n    ct.approved as trans_apprvd_ind,\r\n    ct.voucher as voucher_nbr,\r\n    ct.invoice as invoice_nbr,\r\n    ct.offsetrecid as offset_src_key_txt,\r\n    ct.duedate as due_dt,\r\n    ct.correct as crrctn_trans_ind,\r\n    ct.settlement as auto_settle_ind,\r\n    ct.cancelledpayment as pymnt_cancelled_ind,\r\n    ct.interest as interest_calc_allowed_ind,\r\n    ct.collectionletter as collection_letter_allowed_ind,\r\n    ct.cashpayment as cod_cash_pymnt_ind,\r\n    ct.paymreference as pymnt_ref_txt,\r\n    case \r\n        when ct.paymmethod = 0 then 'Net'\r\n        when ct.paymmethod = 1 then 'Current Month'\r\n        when ct.paymmethod = 2 then 'Current Quarter'\r\n        when ct.paymmethod = 3 then 'Current Year'\r\n        when ct.paymmethod = 4 then 'Current Week'\r\n        when ct.paymmethod = 5 then 'C.O.D.'\r\n    end as pymnt_method_txt,\r\n    ct.retention_opi as retention_cd,\r\n    ct.retentioncheck_opi as check_retention_ind,\r\n    ct.documentnum as document_nbr,\r\n    ct.documentdate as document_dt,\r\n    ct.discdate_opi as trans_dscnt_dt,\r\n    ct.lastinterestdate_opi as ltst_interest_dt,\r\n    case\r\n        when ct.collectionlettercode = 0 then 'None'\r\n        when ct.collectionlettercode = 1 then 'Collection Letter 1'\r\n        when ct.collectionlettercode = 2 then 'Collection Letter 2'\r\n        when ct.collectionlettercode = 3 then 'Collection Letter 3'\r\n        when ct.collectionlettercode = 4 then 'Collection Letter 4'\r\n        when ct.collectionlettercode = 5 then 'Collection'\r\n        when ct.collectionlettercode = 6 then 'All'\r\n        when ct.collectionlettercode = 7 then 'Collection Per Customer'\r\n    end as collection_letter_txt,\r\n    ct.purchaseorder_opi as po_form_nbr,\r\n    ct.lastsettlecompany as ltst_settled_opco_sk,\r\n    ct.lastsettleaccountnum as ltst_settled_cust_sk,\r\n    ct.lastsettledate as ltst_settled_dt,\r\n    ct.lastsettlevoucher as ltst_settled_voucher_nbr,\r\n    ct.closed as trans_closed_dt,\r\n    ct.amountcur as trans_currency_trans_amt,\r\n    ct.amountmst as opco_currency_trans_amt,\r\n    ct.settleamountcur as trans_currency_total_settled_amt,\r\n    ct.settleamountmst as opco_currency_total_settled_amt,\r\n    ct.discamt_opi as trans_dscnt_amt,\r\n    ct.sumtax_opi as sum_tax_amt,\r\n    ct.exchrate as trans_exch_rt\r\n    from {{ source('AX_DEV', 'CUSTTRANS') }} ct \r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on ct.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc \r\n        on ct.accountnum = oc.cust_id\r\n        and ct.dataareaid = oc.opco_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} odc \r\n        on ct.orderaccount = odc.cust_id\r\n        and ct.dataareaid = odc.opco_id\r\n        and odc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(ct.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(ct.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(ct.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(ct.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(ct.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on ct.dataareaid = oso.opco_id\r\n        and ct.salesid_opi = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n        and ct.salesid_opi is not null\r\n        and ct.salesid_opi <> '0'\r\n    left join {{ ref('v_ax_opco_gl_trans_type_curr')}} ogt \r\n        on ct.transtype::string =  ogt.src_gl_trans_type_cd\r\n        and ogt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocu \r\n        on upper(ct.currencycode) = ocu.src_currency_cd\r\n        and ocu.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_mode_curr')}} opm \r\n        on upper(ct.paymmode) = opm.src_pymnt_mode_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cash_dscnt_terms_curr')}} ocd\r\n        on upper(ct.cashdisccode) = ocd.src_cash_dscnt_terms_cd\r\n        and ocd.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(ct.payment_opi) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(ct.deliverymode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr \r\n        on ct.projid_opi = opr.project_id\r\n        and ct.dataareaid = opr.opco_id\r\n        and opr.src_sys_nm = 'AX'\r\n    where ct.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select distinct\r\n           {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt'])}} as opco_cust_trans_sk,\r\n           {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_sk', 'opco_cust_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_sls_ordr_sk', 'opco_gl_trans_type_sk', 'trans_currency_sk', 'opco_pymnt_mode_sk', 'opco_pymnt_terms_sk', 'opco_cash_dscnt_terms_sk', 'opco_dlvry_mode_sk', 'opco_project_sk', 'trans_dt', 'trans_apprvd_ind', 'voucher_nbr', 'invoice_nbr', 'offset_src_key_txt', 'due_dt', 'crrctn_trans_ind', 'auto_settle_ind', 'pymnt_cancelled_ind', 'interest_calc_allowed_ind', 'collection_letter_allowed_ind', 'cod_cash_pymnt_ind', 'pymnt_ref_txt', 'pymnt_method_txt', 'retention_cd', 'check_retention_ind', 'document_nbr', 'document_dt', 'trans_dscnt_dt', 'ltst_interest_dt', 'collection_letter_txt', 'po_form_nbr', 'ltst_settled_opco_sk', 'ltst_settled_cust_sk', 'ltst_settled_dt', 'ltst_settled_voucher_nbr', 'trans_closed_dt', 'trans_currency_trans_amt', 'opco_currency_trans_amt', 'trans_currency_total_settled_amt', 'opco_currency_total_settled_amt', 'trans_dscnt_amt', 'sum_tax_amt', 'trans_exch_rt'])}} as opco_cust_trans_ck,\r\n           concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_cust_trans_ak, *\r\n    from ax_opco_cust_trans \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_trans_sk, opco_cust_trans_ck, opco_cust_trans_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_sls_ordr_sk, opco_gl_trans_type_sk,\r\n    trans_currency_sk, opco_pymnt_mode_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_mode_sk, opco_project_sk, trans_dt, trans_apprvd_ind,\r\n    voucher_nbr, invoice_nbr, offset_src_key_txt, due_dt, crrctn_trans_ind, auto_settle_ind, pymnt_cancelled_ind, interest_calc_allowed_ind, collection_letter_allowed_ind,\r\n    cod_cash_pymnt_ind, pymnt_ref_txt, pymnt_method_txt, retention_cd, check_retention_ind, document_nbr, document_dt, trans_dscnt_dt, ltst_interest_dt,\r\n    collection_letter_txt, po_form_nbr, ltst_settled_opco_sk, ltst_settled_cust_sk, ltst_settled_dt, ltst_settled_voucher_nbr, trans_closed_dt, trans_currency_trans_amt,\r\n    opco_currency_trans_amt, trans_currency_total_settled_amt, opco_currency_total_settled_amt, trans_dscnt_amt, sum_tax_amt, trans_exch_rt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_trans\r\n    {% if _load == 1 %}\r\n        where opco_cust_trans_ck not in (select distinct opco_cust_trans_ck from final)\r\n    {% else %}\r\n        where opco_cust_trans_ck not in (select distinct opco_cust_trans_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_trans where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_trans_ck not in (select distinct opco_cust_trans_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_trans where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_trans_ck in (select distinct opco_cust_trans_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_trans where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTTRANS", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_project_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_trans"], "unique_id": "model.OI_Foundation.ax_opco_cust_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_trans.sql", "original_file_path": "models/ax/customer/ax_opco_cust_trans.sql", "name": "ax_opco_cust_trans", "alias": "ax_opco_cust_trans", "checksum": {"name": "sha256", "checksum": "bf9d564c7c69d99605df332eba01d029105bd3a97e95f7ea75fa710d0ba9cc43"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_gl_trans_type_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_cash_dscnt_terms_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_project_curr"]], "sources": [["AX_DEV", "CUSTTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.4290838}, "model.OI_Foundation.ax_opco_pymnt_mode": {"raw_sql": "{% set _load = load_type('AX_OPCO_PYMNT_MODE') %}\r\n\r\nwith ax_opco_pymnt_mode as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(paymmode)::varchar(10) as src_pymnt_mode_cd,\r\n    max(name)::varchar(100) as src_pymnt_mode_desc\r\n    from {{source('AX_DEV', 'CUSTPAYMMODETABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_pymnt_mode_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_mode_cd']) }} as opco_pymnt_mode_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_pymnt_mode_cd','src_pymnt_mode_desc']) }} as opco_pymnt_mode_ck, \r\n            *  \r\n    from ax_opco_pymnt_mode   \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PYMNT_MODE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PYMNT_MODE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_pymnt_mode_sk, opco_pymnt_mode_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_pymnt_mode_cd, src_pymnt_mode_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_mode\r\n    {% if _load == 1 %}\r\n        where opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from final)\r\n    {% else %}\r\n        where opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_mode where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_mode_ck not in (select distinct opco_pymnt_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_mode where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_pymnt_mode_ck in (select distinct opco_pymnt_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_pymnt_mode where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_pymnt_mode"], "unique_id": "model.OI_Foundation.ax_opco_pymnt_mode", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_pymnt_mode.sql", "original_file_path": "models/ax/customer/ax_opco_pymnt_mode.sql", "name": "ax_opco_pymnt_mode", "alias": "ax_opco_pymnt_mode", "checksum": {"name": "sha256", "checksum": "6b7a93f7b814685d2bc93e283d5f89dd7f671173b34d29584c13986c45af3ae7"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CUSTPAYMMODETABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.4522762}, "model.OI_Foundation.ax_opco_cash_dscnt_terms": {"raw_sql": "{% set _load = load_type('AX_OPCO_CASH_DSCNT_TERMS') %}\r\n\r\nwith ax_opco_cash_dscnt_terms as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(cashdisccode)::varchar(20) as src_cash_dscnt_terms_cd,\r\n    max(description)::varchar(100) as src_cash_dscnt_terms_desc,\r\n    max(numofdays)::number(4) as pymnt_period_in_days_nbr,\r\n    max(percent_)::float as dscnt_pct\r\n    from {{source('AX_DEV', 'CASHDISC')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_cash_dscnt_terms_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select \r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cash_dscnt_terms_cd'])}} as opco_CASH_DSCNT_TERMS_sk,\r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cash_dscnt_terms_cd', 'src_cash_dscnt_terms_desc','pymnt_period_in_days_nbr','dscnt_pct'])}} as opco_CASH_DSCNT_TERMS_ck, \r\n        *\r\n    from ax_opco_CASH_DSCNT_TERMS\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CASH_DSCNT_TERMS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CASH_DSCNT_TERMS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_CASH_DSCNT_TERMS_sk, opco_CASH_DSCNT_TERMS_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_cash_dscnt_terms_cd, src_cash_dscnt_terms_desc, pymnt_period_in_days_nbr, dscnt_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_CASH_DSCNT_TERMS\r\n    {% if _load == 1 %}\r\n        where opco_CASH_DSCNT_TERMS_ck not in (select distinct opco_CASH_DSCNT_TERMS_ck from final)\r\n    {% else %}\r\n        where opco_CASH_DSCNT_TERMS_ck not in (select distinct opco_CASH_DSCNT_TERMS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_CASH_DSCNT_TERMS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_CASH_DSCNT_TERMS_ck not in (select distinct opco_CASH_DSCNT_TERMS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_CASH_DSCNT_TERMS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_CASH_DSCNT_TERMS_ck in (select distinct opco_CASH_DSCNT_TERMS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_CASH_DSCNT_TERMS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CASHDISC"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cash_dscnt_terms"], "unique_id": "model.OI_Foundation.ax_opco_cash_dscnt_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cash_dscnt_terms.sql", "original_file_path": "models/ax/customer/ax_opco_cash_dscnt_terms.sql", "name": "ax_opco_cash_dscnt_terms", "alias": "ax_opco_cash_dscnt_terms", "checksum": {"name": "sha256", "checksum": "c033870db6ba57ea654b471703e4c2bc1150271c7d8390a84d2699ceb017482c"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CASHDISC"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.4648576}, "model.OI_Foundation.ax_opco_picking_list": {"raw_sql": "{% set _load = load_type('AX_OPCO_PICKING_LIST') %}\r\n\r\nwith ax_opco_picking_list as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    wms._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when wms._fivetran_deleted = true then wms._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    wms.dataareaid as opco_id,\r\n    wms.pickingrouteid as picking_list_id,\r\n    wms.shipmentid as shpmnt_id,\r\n    ocu.opco_cust_sk,\r\n    oi.opco_cust_sk as invoice_cust_sk,\r\n    oit.opco_invtry_trans_type_sk,\r\n    ohs.opco_handling_status_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    os.opco_site_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    wms.pickinglistcreatedate_opi as src_crt_dt,\r\n    wms.transrefid as trans_ref_id,\r\n    case \r\n        when wms.handlingtype = 0 then 'Online'\r\n        when wms.handlingtype = 1 then 'Document'\r\n    end as handling_type_txt,\r\n    wms.startdatetime as start_dtm,\r\n    wms.enddatetime as end_dtm,\r\n    wms.activationdatetime as activation_dtm,\r\n    wms.shippingdaterequested_opi as rqstd_ship_dt,\r\n    wms.dlvdate as actl_ship_dt,\r\n    wms.custdeliverydate_opi as cust_dlvry_dt,\r\n    case\r\n        when wms.shipmenttype = 0 then 'Consolidated Picking'\r\n        when wms.shipmenttype = 1 then 'Order Picking'\r\n    end as shpmnt_type_txt,\r\n    wms.deliveryname as dlvry_nm,\r\n    wms.creditreasonid_opi as credit_reason_id,\r\n    wms.purchorderformnum_opi as po_form_nbr,\r\n    wms.taxgroup_opi as tax_grp_id,\r\n    wms.updated_opi as picking_list_updt_ind,\r\n    wms.customerref_opi as cust_ref_txt,\r\n    case \r\n        when wms.donotprintinvoice_opi = 0 then 1\r\n        when wms.donotprintinvoice_opi = 1 then 0\r\n    end as print_invoice_ind,\r\n    wms.reserve_opi as item_reserved_ind,\r\n    wms.packingslip_opi as packing_slip_available_ind,\r\n    wms.tmsdlvwindow_opi as dlvry_window_txt,\r\n    wms.tmsequiptype_opi as equipment_type_txt,\r\n    wms.specialinstructions_opi as spcl_instr_txt,\r\n    wms.tmsservicedurationmin_opi as srvc_duration_mins_nbr,\r\n    wms.tmsrequirement_opi as requrmnt_txt,\r\n    wms.printed_opi as picking_list_printed_ind,\r\n    wms.printedafterchange_opi as picking_list_printed_after_chg_ind,\r\n    wms.tmsdonotsend_opi as do_not_send_ind\r\n    from {{ source('AX_DEV', 'WMSPICKINGROUTE') }} wms \r\n    left join {{ ref('v_ax_opco_cust_curr')}} ocu \r\n        on wms.dataareaid = ocu.opco_id\r\n        and wms.customer = ocu.cust_id\r\n        and ocu.src_sys_nm = 'AX' \r\n    left join {{ ref('v_ax_opco_cust_curr')}} oi \r\n        on wms.dataareaid = oi.opco_id\r\n        and wms.invoiceaccount_opi = oi.cust_id\r\n        and oi.src_sys_nm = 'AX' \r\n    left join {{ ref('v_ax_opco_invtry_trans_type_curr')}} oit \r\n        on wms.transtype = oit.invtry_trans_type_cd\r\n        and oit.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_handling_status_curr')}} ohs \r\n        on wms.expeditionstatus = ohs.handling_status_cd\r\n        and ohs.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(wms.dlvtermid) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(wms.dlvmodeid) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_site_curr')}} os \r\n        on upper(wms.inventsiteid_opi) = os.src_site_id\r\n        and os.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(wms.payment_opi) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    where wms.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'picking_list_id']) }} as opco_picking_list_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'picking_list_id', 'shpmnt_id', 'opco_cust_sk', 'invoice_cust_sk', 'opco_invtry_trans_type_sk', 'opco_handling_status_sk', 'opco_dlvry_terms_sk', 'opco_dlvry_mode_sk', 'opco_site_sk', 'opco_pymnt_terms_sk', 'src_crt_dt', 'trans_ref_id', 'handling_type_txt', 'start_dtm', 'end_dtm', 'activation_dtm', 'rqstd_ship_dt', 'actl_ship_dt', 'cust_dlvry_dt', 'shpmnt_type_txt', 'dlvry_nm', 'credit_reason_id', 'po_form_nbr', 'tax_grp_id', 'picking_list_updt_ind', 'cust_ref_txt', 'print_invoice_ind', 'item_reserved_ind', 'packing_slip_available_ind', 'dlvry_window_txt', 'spcl_instr_txt', 'srvc_duration_mins_nbr', 'requrmnt_txt', 'picking_list_printed_ind', 'picking_list_printed_after_chg_ind', 'do_not_send_ind']) }} as opco_picking_list_Ck,\r\n            concat_ws('|', src_sys_nm, opco_id, picking_list_id) as opco_picking_list_ak, \r\n            * \r\n    from ax_opco_picking_list \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PICKING_LIST') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PICKING_LIST') and _load != 3%}\r\n    union\r\n    select\r\n    opco_picking_list_sk, opco_picking_list_ck, opco_picking_list_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, picking_list_id, shpmnt_id, opco_cust_sk, invoice_cust_sk, opco_invtry_trans_type_sk, opco_handling_status_sk, opco_dlvry_terms_sk,\r\n    opco_dlvry_mode_sk, opco_site_sk, opco_pymnt_terms_sk, src_crt_dt, trans_ref_id, handling_type_txt, start_dtm, end_dtm, activation_dtm, rqstd_ship_dt,\r\n    actl_ship_dt, cust_dlvry_dt, shpmnt_type_txt, dlvry_nm, credit_reason_id, po_form_nbr, tax_grp_id, picking_list_updt_ind, cust_ref_txt, print_invoice_ind,\r\n    item_reserved_ind, packing_slip_available_ind, dlvry_window_txt, spcl_instr_txt, srvc_duration_mins_nbr, requrmnt_txt, picking_list_printed_ind, \r\n    picking_list_printed_after_chg_ind, do_not_send_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PICKING_LIST\r\n    {% if _load == 1 %}\r\n        where opco_picking_list_ck not in (select distinct opco_picking_list_ck from final)\r\n    {% else %}\r\n        where opco_picking_list_ck not in (select distinct opco_picking_list_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PICKING_LIST where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_picking_list_ck not in (select distinct opco_picking_list_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PICKING_LIST where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_picking_list_ck in (select distinct opco_picking_list_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PICKING_LIST where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.WMSPICKINGROUTE", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "model.OI_Foundation.v_ax_opco_handling_status_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_picking_list"], "unique_id": "model.OI_Foundation.ax_opco_picking_list", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_picking_list.sql", "original_file_path": "models/ax/customer/ax_opco_picking_list.sql", "name": "ax_opco_picking_list", "alias": "ax_opco_picking_list", "checksum": {"name": "sha256", "checksum": "47ec6c34a1f566a7c7bd265a0475fc05cdd171a5757863307e7411c26e42805f"}, "tags": [], "refs": [["v_ax_opco_cust_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_invtry_trans_type_curr"], ["v_ax_opco_handling_status_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_site_curr"], ["v_ax_opco_pymnt_terms_curr"]], "sources": [["AX_DEV", "WMSPICKINGROUTE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.5531929}, "model.OI_Foundation.ax_opco_cust_type": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_TYPE') %}\r\n\r\nwith ax_opco_cust_type as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(category_opi) as src_cust_type_cd,\r\n    max(description_opi) as src_cust_type_desc\r\n    from {{source('AX_DEV', 'CUSTPRECASTCATEGORY_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_cust_type_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_type_cd'])}} as opco_cust_type_sk,\r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_type_cd', 'src_cust_type_desc'])}} as opco_cust_type_ck,  \r\n            *\r\n    from ax_opco_cust_type \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_TYPE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_type_sk, opco_cust_type_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_cust_type_cd, src_cust_type_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_TYPE\r\n    {% if _load == 1 %}\r\n        where opco_cust_type_ck not in (select distinct opco_cust_type_ck from final)\r\n    {% else %}\r\n        where opco_cust_type_ck not in (select distinct opco_cust_type_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_TYPE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_type_ck not in (select distinct opco_cust_type_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_TYPE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_type_ck in (select distinct opco_cust_type_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_TYPE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_type"], "unique_id": "model.OI_Foundation.ax_opco_cust_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_type.sql", "original_file_path": "models/ax/customer/ax_opco_cust_type.sql", "name": "ax_opco_cust_type", "alias": "ax_opco_cust_type", "checksum": {"name": "sha256", "checksum": "a4bb84b82008889e652f86a28473da67070a920c4d356f02301d3864f6677a73"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CUSTPRECASTCATEGORY_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.5732775}, "model.OI_Foundation.ax_opco_handling_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_handling_status as (\r\n  {% set values = ['None', 'Registered', 'Reserved', 'Activated', 'Started', 'Picked', 'Staged', 'Loaded', 'Completed', 'Canceled'] %}\r\n  {% set num = [0, 1, 2, 3, 4, 7, 8, 9, 10, 20] %}\r\n\r\n  {% for i in range(10) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{num[i]}} as handling_status_cd,\r\n          '{{values[i]}}' as handling_status_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'handling_status_cd']) }} as opco_handling_status_sk,\r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'handling_status_cd', 'handling_status_desc'])}} as opco_handling_status_ck, \r\n            *\r\n    from opco_handling_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_handling_status"], "unique_id": "model.OI_Foundation.ax_opco_handling_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_handling_status.sql", "original_file_path": "models/ax/customer/ax_opco_handling_status.sql", "name": "ax_opco_handling_status", "alias": "ax_opco_handling_status", "checksum": {"name": "sha256", "checksum": "d185464f3814ae81e941ee5c84bb7ad579577e43401bfa408b45db2d4ad740e9"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.5856984}, "model.OI_Foundation.ax_opco_cust_invoice": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_INVOICE') %}\r\n\r\nwith ax_opco_cust_invoice as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    cij._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when cij._fivetran_deleted = true then cij._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cij.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    oc.opco_cust_sk,\r\n    oso.opco_sls_ordr_sk,\r\n    opl.opco_picking_list_sk,\r\n    ocps.opco_cust_packing_slip_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    osot.opco_sls_ordr_type_sk,\r\n    oc1.opco_cust_sk as invoice_cust_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    ocg.opco_cust_grp_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    ocdt.opco_cash_dscnt_terms_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    oln.opco_locn_sk as dlvry_locn_sk,\r\n    oln1.opco_locn_sk as invoice_locn_sk,\r\n    cij.invoiceid as invoice_nbr,\r\n    case\r\n        when cij.refnum = 0 then 'Sales Order'\r\n        when cij.refnum = 1 then 'Project'\r\n        when cij.refnum = 2 then 'Customer'\r\n        when cij.refnum = 3 then 'Interest'\r\n    end as trans_ref_txt,\r\n    cij.invoicedate as invoice_dt,\r\n    cij.duedate as due_dt,\r\n    cij.cashdiscdate as cash_dscnt_dt,\r\n    cij.ledgervoucher as gl_voucher_nbr,\r\n    cij.documentnum as document_nbr,\r\n    cij.documentdate as document_dt,\r\n    cij.deliveryname as dlvry_cust_nm,\r\n    cij.invoicingname as invoice_cust_nm,\r\n    cij.salesgroup_opi as sls_grp_txt,\r\n    cij.incltax as sls_tax_included_ind,\r\n    cij.updated as updt_after_printing_ind,\r\n    cij.log as specific_action_txt,\r\n    cij.dispatchlocation_opi as dispatch_locn_txt,\r\n    cij.paymentsched as pymnt_sched_cd,\r\n    cij.del_leadcode_opi as lead_cd,\r\n    cij.purchaseorder as po_form_nbr,\r\n    cij.commissiongroup_opi as commsn_grp_id,\r\n    cij.creditreason_opi as credit_reason_id,\r\n    cij.custendcustomerid_opi as end_cust_id,\r\n    cij.taxgroup as tax_grp_id,\r\n    cij.qty as invoice_qty,\r\n    cij.volume as invoice_volume_amt,\r\n    cij.weight as invoice_weight_amt,\r\n    cij.salesbalance as trans_currency_balance_sls_amt,\r\n    cij.salesbalancemst as opco_currency_balance_sls_amt,\r\n    cij.invoiceamount as trans_currency_invoice_amt,\r\n    cij.invoiceamountmst as opco_currency_invoice_amt,\r\n    cij.sumlinedisc as trans_currency_line_dscnt_amt,\r\n    cij.sumlinediscmst as opco_currency_line_dscnt_amt,\r\n    cij.cashdisc as trans_currency_cash_dscnt_amt,\r\n    cij.sumtax as trans_currency_sls_tax_amt,\r\n    cij.sumtaxmst as opco_currency_sls_tax_amt,\r\n    cij.summarkup as trans_currency_misc_chrgs_amt,\r\n    cij.summarkupmst as opco_currenty_misc_chrgs_amt,\r\n    cij.deliverycost_opi as dlvry_cost_amt\r\n    from {{ source('AX_DEV', 'CUSTINVOICEJOUR') }} cij \r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on cij.dataareaid = opco.opco_id \r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc \r\n        on cij.dataareaid = oc.opco_id\r\n        and cij.orderaccount = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on cij.dataareaid = oso.opco_id\r\n        and cij.salesid = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_picking_list_curr')}} opl \r\n        on cij.dataareaid = opl.opco_id\r\n        and cij.pickinglistid_opi = opl.picking_list_id\r\n        and opl.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_packing_slip_curr')}} ocps \r\n        on cij.dataareaid = ocps.opco_id\r\n        and cij.packingslipid_opi = ocps.packing_slip_id\r\n        and ocps.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(cij.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(cij.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(cij.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(cij.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(cij.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_type_curr')}} osot \r\n        on cij.salestype = osot.src_sls_ordr_type_cd\r\n        and osot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc1   \r\n        on cij.dataareaid = oc1.opco_id\r\n        and cij.invoiceaccount = oc1.cust_id\r\n        and oc1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr \r\n        on upper(cij.currencycode) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_grp_curr')}} ocg \r\n        on upper(cij.custgroup) = ocg.src_cust_grp_cd\r\n        and ocg.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(cij.payment) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cash_dscnt_terms_curr')}} ocdt \r\n        on upper(cij.cashdisccode) = ocdt.src_cash_dscnt_terms_cd\r\n        and ocdt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(cij.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(cij.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} oln \r\n         on upper(cij.deliverystreet) = oln.addr_ln_1_txt\r\n        and upper(cij.deliverycity) = oln.city_nm\r\n        and upper(cij.dlvstate) = oln.state_nm\r\n        and upper(cij.dlvcountryregionid) = oln.country_nm\r\n        and upper(cij.dlvzipcode) = oln.zip_cd\r\n        and oln.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} oln1 \r\n         on upper(cij.invoicestreet) = oln1.addr_ln_1_txt\r\n        and upper(cij.invoicecity) = oln1.city_nm\r\n        and upper(cij.invstate) = oln1.state_nm\r\n        and upper(cij.invcountryregionid) = oln1.country_nm\r\n        and upper(cij.invzipcode) = oln1.zip_cd\r\n        and oln1.src_sys_nm = 'AX'\r\n    where cij.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt']) }} as opco_cust_invoice_sk,\r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'opco_sk', 'opco_cust_sk', 'opco_sls_ordr_sk', 'opco_picking_list_sk', 'opco_cust_packing_slip_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_sls_ordr_type_sk', 'invoice_cust_sk', 'trans_currency_sk', 'opco_cust_grp_sk', 'opco_pymnt_terms_sk', 'opco_cash_dscnt_terms_sk', 'opco_dlvry_terms_sk', 'opco_dlvry_mode_sk', 'dlvry_locn_sk', 'invoice_locn_sk', 'invoice_nbr', 'trans_ref_txt', 'invoice_dt', 'due_dt', 'cash_dscnt_dt', 'gl_voucher_nbr', 'document_nbr', 'document_dt', 'dlvry_cust_nm', 'invoice_cust_nm', 'sls_grp_txt', 'sls_tax_included_ind', 'updt_after_printing_ind', 'specific_action_txt', 'dispatch_locn_txt', 'pymnt_sched_cd', 'lead_cd', 'po_form_nbr', 'commsn_grp_id', 'credit_reason_id', 'end_cust_id', 'tax_grp_id', 'invoice_qty', 'invoice_volume_amt', 'invoice_weight_amt', 'trans_currency_balance_sls_amt', 'opco_currency_balance_sls_amt', 'trans_currency_invoice_amt', 'opco_currency_invoice_amt', 'trans_currency_line_dscnt_amt', 'opco_currency_line_dscnt_amt', 'trans_currency_cash_dscnt_amt', 'trans_currency_sls_tax_amt', 'opco_currency_sls_tax_amt', 'trans_currency_misc_chrgs_amt', 'opco_currenty_misc_chrgs_amt', 'dlvry_cost_amt']) }} as opco_cust_invoice_ck,\r\n            concat_ws('|', src_sys_nm, src_key_txt) as opco_cust_invoice_ak, \r\n            *\r\n    from ax_opco_cust_invoice \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_INVOICE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_INVOICE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_invoice_sk, opco_cust_invoice_ck, opco_cust_invoice_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_key_txt, opco_sk, opco_cust_sk, opco_sls_ordr_sk, opco_picking_list_sk, opco_cust_packing_slip_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, opco_sls_ordr_type_sk, invoice_cust_sk, trans_currency_sk, opco_cust_grp_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk\r\n    invoice_locn_sk, invoice_nbr, trans_ref_txt, invoice_dt, due_dt, cash_dscnt_dt, gl_voucher_nbr, document_nbr, document_dt, dlvry_cust_nm, invoice_cust_nm, sls_grp_txt, sls_tax_included_ind,\r\n    updt_after_printing_ind, specific_action_txt, dispatch_locn_txt, pymnt_sched_cd, lead_cd, po_form_nbr,commsn_grp_id, credit_reason_id, end_cust_id, tax_grp_id, invoice_qty, invoice_volume_amt,\r\n    invoice_weight_amt, trans_currency_balance_sls_amt, opco_currency_balance_sls_amt, trans_currency_invoice_amt, opco_currency_invoice_amt, trans_currency_line_dscnt_amt, opco_currency_line_dscnt_amt,\r\n    trans_currency_cash_dscnt_amt, trans_currency_sls_tax_amt, opco_currency_sls_tax_amt, trans_currency_misc_chrgs_amt, opco_currenty_misc_chrgs_amt, dlvry_cost_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_invoice\r\n    {% if _load == 1 %}\r\n        where opco_cust_invoice_ck not in (select distinct opco_cust_invoice_ck from final)\r\n    {% else %}\r\n        where opco_cust_invoice_ck not in (select distinct opco_cust_invoice_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_INVOICE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_invoice_ck not in (select distinct opco_cust_invoice_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_INVOICE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_invoice_ck in (select distinct opco_cust_invoice_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_INVOICE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_invoice"], "unique_id": "model.OI_Foundation.ax_opco_cust_invoice", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_invoice.sql", "original_file_path": "models/ax/customer/ax_opco_cust_invoice.sql", "name": "ax_opco_cust_invoice", "alias": "ax_opco_cust_invoice", "checksum": {"name": "sha256", "checksum": "0a006256fd0b51a6ab9d39f6e4f195374ef76adf5ef8f9a0743262ac595c5804"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_picking_list_curr"], ["v_ax_opco_cust_packing_slip_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_sls_ordr_type_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_cust_grp_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_cash_dscnt_terms_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_locn_curr"], ["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "CUSTINVOICEJOUR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.5953946}, "model.OI_Foundation.ax_opco_currency": {"raw_sql": "{% set _load = load_type('AX_OPCO_CURRENCY') %}\r\n\r\nwith ax_opco_currency as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(currencycode)::varchar(10) as src_currency_cd,\r\n    max(txt)::varchar(50) as src_currency_nm\r\n    from {{source('AX_DEV', 'CURRENCY')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_currency_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select \r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd'])}} as opco_currency_sk,\r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd', 'src_currency_nm'])}} as opco_currency_ck, \r\n        *\r\n    from ax_opco_currency\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CURRENCY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CURRENCY') and _load != 3%}\r\n    union\r\n    select\r\n    opco_currency_sk, opco_currency_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_currency_cd, src_currency_nm  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency\r\n    {% if _load == 1 %}\r\n        where opco_currency_ck not in (select distinct opco_currency_ck from final)\r\n    {% else %}\r\n        where opco_currency_ck not in (select distinct opco_currency_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck not in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CURRENCY"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_currency"], "unique_id": "model.OI_Foundation.ax_opco_currency", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_currency.sql", "original_file_path": "models/ax/customer/ax_opco_currency.sql", "name": "ax_opco_currency", "alias": "ax_opco_currency", "checksum": {"name": "sha256", "checksum": "19798be5f4f52a0a1c5c50976aec49c5d66a1f222c13c3dd6ee4c6749e4b177f"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CURRENCY"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.6229534}, "model.OI_Foundation.ax_opco_opco_cust_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_OPCO_CUST_XREF') %}\r\n\r\nwith ax_opco_opco_cust_xref as(\r\n    select \r\n    opco.opco_sk,\r\n    oc.opco_cust_sk,\r\n    current_timestamp as crt_dtm,\r\n    ct._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when ct._fivetran_deleted = true then ct._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    1 as actv_ind,\r\n    opcur.opco_currency_sk,\r\n    oppyt.opco_pymnt_terms_sk,\r\n    oppym.opco_pymnt_mode_sk,\r\n    opcc.opco_cust_code_sk,\r\n    opct.opco_cust_type_sk,\r\n    opcg.opco_commsn_grp_sk,\r\n    opcug.opco_cust_grp_sk,\r\n    opcdt.opco_cash_dscnt_terms_sk,\r\n    upper(ct.linedisc) as line_disc_txt,\r\n    ct.creditmax as max_cr_amt,\r\n    ct.mandatorycreditlimit as mandatory_cr_lmt_ind,\r\n    ct.blocked as block_lvl_cd,\r\n    ct.custclassificationid as cust_clssfctn_cd,\r\n    upper(ct.paymsched) as pymnt_schd_desc,\r\n    ct.salesgroup as sls_grp_nm,\r\n    ct.regsalesmanager_opi as rgnl_sls_mgr_nm,\r\n    ct.invoiceaccount as invoice_acct_nbr,\r\n    ct.segment_opi as segment_cd,\r\n    ct.segmentation_opi as segmentation_txt\r\n    from {{source('AX_DEV', 'CUSTTABLE')}} ct\r\n    left join {{ref('v_ax_opco_curr')}} opco\r\n        on ct.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_curr')}} oc \r\n        on ct.accountnum = oc.cust_id\r\n        and ct.dataareaid = oc.opco_id\r\n        and oc.src_sys_nm = 'AX' \r\n    left join {{ref('v_ax_opco_currency_curr')}} opcur\r\n        on upper(ct.currency) = opcur.src_currency_cd\r\n        and opcur.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_terms_curr')}} oppyt\r\n        on upper(ct.paymtermid) = oppyt.src_pymnt_terms_cd\r\n        and oppyt.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_mode_curr')}} oppym\r\n        on  upper(ct.paymmode) = oppym.src_pymnt_mode_cd \r\n        and oppym.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_code_curr')}} opcc \r\n        on upper(ct.precastcode_opi) = opcc.src_cust_code_cd \r\n        and opcc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_type_curr')}} opct\r\n        on upper(ct.precastcategory_opi) = opct.src_cust_type_cd\r\n        and opct.src_sys_nm = 'AX' \r\n    left join {{ref('v_ax_opco_commsn_grp_curr')}} opcg \r\n        on upper(ct.commissiongroup) = opcg.src_commsn_grp_cd\r\n        and opcg.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_grp_curr')}} opcug\r\n        on upper(ct.custgroup) = opcug.src_cust_grp_cd \r\n        and opcug.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cash_dscnt_terms_curr')}} opcdt \r\n        on upper(cashdisc) = opcdt.src_cash_dscnt_terms_cd\r\n        and opcdt.src_sys_nm = 'AX' \r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select\r\n        {{ dbt_utils.surrogate_key([ 'opco_sk',  'opco_cust_sk',  'actv_ind',  'opco_currency_sk',  'opco_pymnt_terms_sk',  'opco_pymnt_mode_sk',  'opco_cust_code_sk',  'opco_cust_type_sk',  'opco_commsn_grp_sk',  'opco_cust_grp_sk',  'opco_cash_dscnt_terms_sk',  'line_disc_txt',  'max_cr_amt',  'mandatory_cr_lmt_ind',  'block_lvl_cd',  'cust_clssfctn_cd',  'pymnt_schd_desc',  'sls_grp_nm',  'rgnl_sls_mgr_nm',  'invoice_acct_nbr',  'segment_cd',  'segmentation_txt'])}} as opco_opco_cust_xref_ck,\r\n        *\r\n    from ax_opco_opco_cust_xref\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_OPCO_CUST_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_OPCO_CUST_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_sk, opco_cust_sk, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, actv_ind, opco_currency_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk, opco_cust_code_sk, opco_cust_type_sk, opco_commsn_grp_sk, opco_cust_grp_sk, opco_cash_dscnt_terms_sk, line_disc_txt, max_cr_amt, mandatory_cr_lmt_ind, block_lvl_cd, cust_clssfctn_cd, pymnt_schd_desc, sls_grp_nm, rgnl_sls_mgr_nm, invoice_acct_nbr, segment_cd, segmentation_txt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_CUST_XREF\r\n    {% if _load == 1 %}\r\n        where OPCO_OPCO_CUST_XREF_ck not in (select distinct OPCO_OPCO_CUST_XREF_ck from final)\r\n    {% else %}\r\n        where OPCO_OPCO_CUST_XREF_ck not in (select distinct OPCO_OPCO_CUST_XREF_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_CUST_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_OPCO_CUST_XREF_ck not in (select distinct OPCO_OPCO_CUST_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_CUST_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_OPCO_CUST_XREF_ck in (select distinct OPCO_OPCO_CUST_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_CUST_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTTABLE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_cust_code_curr", "model.OI_Foundation.v_ax_opco_cust_type_curr", "model.OI_Foundation.v_ax_opco_commsn_grp_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_opco_cust_xref"], "unique_id": "model.OI_Foundation.ax_opco_opco_cust_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_opco_cust_xref.sql", "original_file_path": "models/ax/customer/ax_opco_opco_cust_xref.sql", "name": "ax_opco_opco_cust_xref", "alias": "ax_opco_opco_cust_xref", "checksum": {"name": "sha256", "checksum": "61726480aa94416c3201b5ab0a65d2ef375d78ff62c0a667fa3f780eb7d067bd"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_cust_code_curr"], ["v_ax_opco_cust_type_curr"], ["v_ax_opco_commsn_grp_curr"], ["v_ax_opco_cust_grp_curr"], ["v_ax_opco_cash_dscnt_terms_curr"]], "sources": [["AX_DEV", "CUSTTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.6356514}, "model.OI_Foundation.ax_opco_cust": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST') %}\r\n\r\nwith ax_opco_cust as(\r\n    select \r\n    concat_ws('|', 'AX', accountnum, dataareaid) as opco_cust_ak,\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,    \r\n    'AX' as src_sys_nm,\r\n    accountnum as cust_id,\r\n    name as cust_nm,\r\n    dataareaid as opco_id,\r\n    namealias as dba_nm,\r\n    '' as govt_issued_id,\r\n    '' as duns_nbr,\r\n    '' as lob_nm,\r\n    vatnum as vat_number,\r\n    '' as language_txt,\r\n    countryregionid as country_cd,\r\n    url as website_url_txt,\r\n    taxexemptnumber_opi as tax_exempt_nbr,\r\n    taxgroup as tax_grp_txt,\r\n    custitemgroupid as cust_item_grp_cd,\r\n    dimension4_ as end_market_nm,\r\n    collectorcode_opi as collector_cd,\r\n    partyid as party_id,\r\n    flag_opi as flag_id\r\n    from {{ source('AX_DEV', 'CUSTTABLE') }} \r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select \r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'cust_id', 'opco_id'])}} as opco_cust_sk,\r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'cust_id', 'cust_nm','opco_id','dba_nm','govt_issued_id','duns_nbr','lob_nm','vat_number','language_txt','country_cd','website_url_txt','tax_exempt_nbr','tax_grp_txt','cust_item_grp_cd','end_market_nm','collector_cd','party_id','flag_id'])}} as opco_cust_ck, \r\n        *\r\n    from ax_opco_cust\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_sk, opco_cust_ck, opco_cust_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, cust_id, opco_id, dba_nm, govt_issued_id, duns_nbr, lob_nm, vat_number, language_txt, country_cd, website_url_txt, tax_exempt_nbr, tax_grp_txt, cust_item_grp_cd, end_market_nm, collector_cd, party_id, flag_id\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust\r\n    {% if _load == 1 %}\r\n        where opco_cust_ck not in (select distinct opco_cust_ck from final)\r\n    {% else %}\r\n        where opco_cust_ck not in (select distinct opco_cust_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_ck not in (select distinct opco_cust_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_ck in (select distinct opco_cust_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTTABLE"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust"], "unique_id": "model.OI_Foundation.ax_opco_cust", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust.sql", "original_file_path": "models/ax/customer/ax_opco_cust.sql", "name": "ax_opco_cust", "alias": "ax_opco_cust", "checksum": {"name": "sha256", "checksum": "642365ddb3df7697637a9fc26810c670ac8a7feb0b5c7a9519576cdad6fa4d65"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CUSTTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.6523614}, "model.OI_Foundation.ax_opco_cust_grp": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_GRP') %}\r\n\r\nwith ax_opco_cust_grp as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(custgroup) as src_cust_grp_cd,\r\n    max(name) as src_cust_grp_desc\r\n    from {{source('AX_DEV', 'CUSTGROUP')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_cust_grp_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_grp_cd']) }} as opco_cust_grp_sk,\r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_grp_cd', 'src_cust_grp_desc'])}} as opco_cust_grp_ck, \r\n            *\r\n    from ax_opco_cust_grp\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_GRP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_GRP') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_grp_sk, opco_cust_grp_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_cust_grp_cd, src_cust_grp_desc  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_grp\r\n    {% if _load == 1 %}\r\n        where opco_cust_grp_ck not in (select distinct opco_cust_grp_ck from final)\r\n    {% else %}\r\n        where opco_cust_grp_ck not in (select distinct opco_cust_grp_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_grp where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_grp_ck not in (select distinct opco_cust_grp_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_grp where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_grp_ck in (select distinct opco_cust_grp_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_grp where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTGROUP"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_grp"], "unique_id": "model.OI_Foundation.ax_opco_cust_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_grp.sql", "original_file_path": "models/ax/customer/ax_opco_cust_grp.sql", "name": "ax_opco_cust_grp", "alias": "ax_opco_cust_grp", "checksum": {"name": "sha256", "checksum": "2cb2fdb8892ad2556603f36744dda21ffa7d760b031d9f13be839eddfce191d0"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CUSTGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.6670673}, "model.OI_Foundation.ax_opco_cust_open_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_OPEN_TRANS') %}\r\n\r\nwith ax_opco_cust_open_trans as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    cto._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when cto._fivetran_deleted = true then cto._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cto.dataareaid as opco_id,\r\n    cto.recid as src_key_txt,\r\n    oct.opco_cust_trans_sk,\r\n    opco.opco_sk,\r\n    oc.opco_cust_sk,\r\n    oca.opco_chart_of_accts_sk as cash_dscnt_gl_acct_sk,\r\n    cto.transdate as trans_dt,\r\n    cto.duedate as due_dt,\r\n    cto.lastinterestdate as ltst_interest_calc_dt,\r\n    cto.cashdiscdate as cash_dscnt_dt,\r\n    case\r\n        when cto.usecashdisc = 0 then 'Normal'\r\n        when cto.usecashdisc = 1 then 'Always'\r\n        when cto.usecashdisc = 2 then 'Never'\r\n    end as cash_dscnt_usage_txt,\r\n    cto.amountcur as trans_currency_trans_amt,\r\n    cto.amountmst as opco_currency_trans_amt,\r\n    cto.possiblecashdisc as included_cash_dscnt_amt\r\n    from {{ source('AX_DEV', 'CUSTTRANSOPEN') }} cto \r\n    left join {{ ref('v_ax_opco_cust_trans_curr')}} oct \r\n        on cto.dataareaid = oct.opco_id\r\n        and cto.refrecid = oct.src_key_txt\r\n        and oct.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on cto.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc \r\n        on cto.dataareaid = oc.opco_id\r\n        and cto.accountnum = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} oca \r\n        on cto.dataareaid = oca.opco_id\r\n        and cto.cashdiscaccount = oca.gl_acct_nbr\r\n        and oca.src_sys_nm = 'AX'\r\n    where cto.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt'])}} as opco_cust_open_trans_sk,\r\n           {{dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_cust_trans_sk', 'opco_sk', 'opco_cust_sk', 'cash_dscnt_gl_acct_sk', 'trans_dt', 'due_dt', 'ltst_interest_calc_dt', 'cash_dscnt_dt', 'cash_dscnt_usage_txt', 'trans_currency_trans_amt', 'opco_currency_trans_amt', 'included_cash_dscnt_amt'])}} as opco_cust_open_trans_ck,\r\n           concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_cust_open_trans_ak,\r\n           *\r\n    from ax_opco_cust_open_trans \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_OPEN_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'AX_OPCO_CUST_OPEN_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_open_trans_sk, opco_cust_open_trans_CK, opco_cust_open_trans_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_cust_trans_sk, opco_sk, opco_cust_sk, cash_dscnt_gl_acct_sk, trans_dt, due_dt, ltst_interest_calc_dt, cash_dscnt_dt, cash_dscnt_usage_txt, trans_currency_trans_amt, opco_currency_trans_amt, included_cash_dscnt_amt \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_open_trans\r\n    {% if _load == 1 %}\r\n        where opco_cust_open_trans_CK not in (select distinct opco_cust_open_trans_CK from final)\r\n    {% else %}\r\n        where opco_cust_open_trans_CK not in (select distinct opco_cust_open_trans_CK from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_open_trans where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_open_trans_CK not in (select distinct opco_cust_open_trans_CK from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_open_trans where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_open_trans_CK in (select distinct opco_cust_open_trans_CK from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_open_trans where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTTRANSOPEN", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_open_trans"], "unique_id": "model.OI_Foundation.ax_opco_cust_open_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_open_trans.sql", "original_file_path": "models/ax/customer/ax_opco_cust_open_trans.sql", "name": "ax_opco_cust_open_trans", "alias": "ax_opco_cust_open_trans", "checksum": {"name": "sha256", "checksum": "a3c86c9e726d2fa3e859a29e3fff40dfd53af632a040c65358abb66febbd2c43"}, "tags": [], "refs": [["v_ax_opco_cust_trans_curr"], ["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_chart_of_accts_curr"]], "sources": [["AX_DEV", "CUSTTRANSOPEN"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.679257}, "model.OI_Foundation.ax_opco_commsn_grp": {"raw_sql": "{% set _load = load_type('AX_OPCO_COMMSN_GRP') %}\r\n\r\nwith ax_opco_commsn_grp as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(15) as src_sys_nm,\r\n    upper(groupid)::varchar(50) as src_commsn_grp_cd,\r\n    max(name)::varchar(100) as src_commsn_grp_desc,\r\n    'CUST'::varchar(20) as src_commsn_grp_type_txt\r\n    from {{source('AX_DEV', 'COMMISSIONCUSTOMERGROUP')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_commsn_grp_type_txt, src_commsn_grp_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select \r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_commsn_grp_cd'])}} as opco_commsn_grp_sk,\r\n        {{dbt_utils.surrogate_key(['src_sys_nm', 'src_commsn_grp_cd', 'src_commsn_grp_desc','src_commsn_grp_type_txt'])}} as opco_commsn_grp_ck, \r\n        *\r\n    from ax_opco_COMMSN_GRP\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_COMMSN_GRP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_COMMSN_GRP') and _load != 3%}\r\n    union\r\n    select\r\n    opco_commsn_grp_sk, opco_commsn_grp_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_commsn_grp_cd, src_commsn_grp_desc, src_commsn_grp_type_txt \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_commsn_grp\r\n    {% if _load == 1 %}\r\n        where opco_commsn_grp_ck not in (select distinct opco_commsn_grp_ck from final)\r\n    {% else %}\r\n        where opco_commsn_grp_ck not in (select distinct opco_commsn_grp_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_commsn_grp where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_COMMSN_GRP_ck not in (select distinct opco_commsn_grp_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_commsn_grp where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_COMMSN_GRP_ck in (select distinct opco_commsn_grpck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_commsn_grp where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_commsn_grp"], "unique_id": "model.OI_Foundation.ax_opco_commsn_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_commsn_grp.sql", "original_file_path": "models/ax/customer/ax_opco_commsn_grp.sql", "name": "ax_opco_commsn_grp", "alias": "ax_opco_commsn_grp", "checksum": {"name": "sha256", "checksum": "311d9af073264e3155ddc9824d66106aa910df0670638916fb6c0c75cbc27e14"}, "tags": [], "refs": [], "sources": [["AX_DEV", "COMMISSIONCUSTOMERGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.6953375}, "model.OI_Foundation.ax_opco_cust_packing_slip_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_PACKING_SLIP_LINE') %}\r\n\r\nwith ax_opco_cust_packing_slip_line as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    cpt._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when cpt._fivetran_deleted = true then cpt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cpt.dataareaid as opco_id,\r\n    cpt.packingslipid as packing_slip_id,\r\n    cpt.inventtransid as intry_trans_id,\r\n    ocps.opco_cust_packing_slip_sk,\r\n    oso.opco_sls_ordr_sk,\r\n    oso1.opco_sls_ordr_sk as orig_sls_ordr_sk,\r\n    oi.opco_item_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oa.opco_assctn_sk,\r\n    oirt.opco_invtry_ref_type_sk,\r\n    ou.opco_uom_sk as sls_uom_sk,\r\n    ou1.opco_uom_sk as invtry_uom_sk,\r\n    cpt.linenum as line_nbr,\r\n    cpt.externalitemid as cust_item_id,\r\n    cpt.name as item_desc,\r\n    cpt.inventrefid as invtry_ref_id,\r\n    cpt.inventreftransid as invtry_ref_trans_id,\r\n    cpt.deliverydate as ship_dt,\r\n    cpt.dlvcounty as dlvry_county_nm,\r\n    cpt.dlvstate as dlvry_state_nm,\r\n    cpt.dlvcountryregionid as dlvry_country_nm,\r\n    cpt.partdelivery as partial_dlvry_ind,\r\n    case \r\n        when cpt.deliverytype = 0 then null\r\n        when cpt.deliverytype = 1 then 'Direct Delivery'\r\n    end as dlvry_type_txt,\r\n    cpt.salesgroup as sls_grp_txt,\r\n    cpt.lineheader as packing_slip_line_desc,\r\n    cpt.special_opi as spcl_item_ind,\r\n    cpt.specialnumber_opi as spcl_item_nbr,\r\n    cpt.groupname_opi as grp_nm,\r\n    cpt.priceunit as per_unit_qty,\r\n    cpt.inventqty as invtry_unit_qty,\r\n    cpt.qtyordered_opi as picked_ordr_qty,\r\n    cpt.ordered as packed_ordr_qty,\r\n    cpt.qty as released_qty,\r\n    cpt.remain as remaining_qty,\r\n    cpt.salesprice_opi as per_unit_sls_price_amt,\r\n    cpt.lineamount_opi as opco_currency_picked_line_amt,\r\n    cpt.valuemst as opco_currency_packed_line_amt,\r\n    cpt.weight_opi as item_weight_amt\r\n    from {{ source('AX_DEV', 'CUSTPACKINGSLIPTRANS') }} cpt\r\n    left join {{ ref('v_ax_opco_cust_packing_slip_curr')}} ocps\r\n        on cpt.dataareaid = ocps.opco_id\r\n        and cpt.packingslipid = ocps.packing_slip_id\r\n        and src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on cpt.dataareaid = oso.opco_id\r\n        and cpt.salesid = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso1 \r\n        on cpt.dataareaid = oso1.opco_id\r\n        and cpt.origsalesid = oso1.sls_ordr_id\r\n        and oso1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on cpt.dataareaid = oi.opco_id\r\n        and cpt.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(cpt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(cpt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(cpt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(cpt.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(cpt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa \r\n        on cpt.dataareaid = oa.opco_id\r\n        and cpt.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_ref_type_curr')}} oirt\r\n        on cpt.inventreftype = oirt.invtry_ref_type_cd\r\n        and oirt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(cpt.salesunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou1 \r\n        on upper(cpt.inventunit_opi) = ou1.src_uom_cd\r\n        and ou1.src_sys_nm = 'AX'\r\n    where cpt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'intry_trans_id']) }} as opco_cust_packing_slip_line_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'intry_trans_id', 'opco_cust_packing_slip_sk', 'opco_sls_ordr_sk', 'orig_sls_ordr_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_assctn_sk', 'opco_invtry_ref_type_sk', 'sls_uom_sk', 'invtry_uom_sk', 'line_nbr', 'cust_item_id', 'item_desc', 'invtry_ref_id', 'invtry_ref_trans_id', 'ship_dt', 'dlvry_county_nm', 'dlvry_state_nm', 'dlvry_country_nm', 'partial_dlvry_ind', 'dlvry_type_txt', 'sls_grp_txt', 'packing_slip_line_desc', 'spcl_item_ind', 'spcl_item_nbr', 'grp_nm', 'per_unit_qty', 'invtry_unit_qty', 'picked_ordr_qty', 'packed_ordr_qty', 'released_qty', 'remaining_qty', 'per_unit_sls_price_amt', 'opco_currency_picked_line_amt', 'opco_currency_packed_line_amt', 'item_weight_amt']) }} as opco_cust_packing_slip_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, packing_slip_id, intry_trans_id) as opco_cust_packing_slip_line_ak,\r\n            * \r\n    from ax_opco_cust_packing_slip_line \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_PACKING_SLIP_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_PACKING_SLIP_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_packing_slip_line_sk, opco_cust_packing_slip_line_ck, opco_cust_packing_slip_line_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, packing_slip_id, intry_trans_id, opco_cust_packing_slip_sk, opco_sls_ordr_sk, orig_sls_ordr_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, \r\n    opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_assctn_sk, opco_invtry_ref_type_sk, sls_uom_sk, invtry_uom_sk, line_nbr, cust_item_id, item_desc, invtry_ref_id, \r\n    invtry_ref_trans_id, ship_dt, dlvry_county_nm, dlvry_state_nm, dlvry_country_nm, partial_dlvry_ind, dlvry_type_txt, sls_grp_txt, packing_slip_line_desc, spcl_item_ind,\r\n    spcl_item_nbr, grp_nm, per_unit_qty, invtry_unit_qty, picked_ordr_qty, packed_ordr_qty, released_qty, remaining_qty, per_unit_sls_price_amt, opco_currency_picked_line_amt,\r\n    opco_currency_packed_line_amt, item_weight_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip_line\r\n    {% if _load == 1 %}\r\n        where opco_cust_packing_slip_line_ck not in (select distinct opco_cust_packing_slip_line_ck from final)\r\n    {% else %}\r\n        where opco_cust_packing_slip_line_ck not in (select distinct opco_cust_packing_slip_line_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip_line where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_packing_slip_line_ck not in (select distinct opco_cust_packing_slip_line_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip_line where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_packing_slip_line_ck in (select distinct opco_cust_packing_slip_line_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_packing_slip_line where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS", "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_packing_slip_line"], "unique_id": "model.OI_Foundation.ax_opco_cust_packing_slip_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_packing_slip_line.sql", "original_file_path": "models/ax/customer/ax_opco_cust_packing_slip_line.sql", "name": "ax_opco_cust_packing_slip_line", "alias": "ax_opco_cust_packing_slip_line", "checksum": {"name": "sha256", "checksum": "1c07526f07bd85f2d29a358fd9f422cd7fefcc0ce677317c50cd3998fa2b2a5a"}, "tags": [], "refs": [["v_ax_opco_cust_packing_slip_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_invtry_ref_type_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "CUSTPACKINGSLIPTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.7076266}, "model.OI_Foundation.ax_opco_invtry_ref_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_invtry_ref_type as (\r\n  {% set values = ['Sales Order', 'Purchase Order', 'Production', 'Production Line', 'Inventory Journal', 'CRM Quotation', 'Transfer Order', 'Fixed Asset'] %}\r\n\r\n  {% for i in range(9) %}\r\n    select \r\n        current_timestamp as crt_dtm,\r\n        'AX' as src_sys_nm,\r\n        {{i}} as invtry_ref_type_cd,\r\n        {% if i == 0 %}\r\n        null as invtry_ref_type_desc\r\n        {% else %}\r\n        '{{values[i-1]}}' as invtry_ref_type_desc\r\n        {% endif %}\r\n        {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_ref_type_cd']) }} as opco_invtry_ref_type_sk, \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'invtry_ref_type_cd', 'invtry_ref_type_desc'])}} as opco_invtry_ref_type_ck, \r\n            *\r\n    from opco_invtry_ref_type\r\n)\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_invtry_ref_type"], "unique_id": "model.OI_Foundation.ax_opco_invtry_ref_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_invtry_ref_type.sql", "original_file_path": "models/ax/customer/ax_opco_invtry_ref_type.sql", "name": "ax_opco_invtry_ref_type", "alias": "ax_opco_invtry_ref_type", "checksum": {"name": "sha256", "checksum": "93c9e6c7cdb74f31d9d48a1ddafad1e5c31d2dafc0a6fc25a6022806c03e5008"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.7293506}, "model.OI_Foundation.ax_opco_cust_code": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_CODE') %}\r\n\r\nwith ax_opco_cust_code as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(code_opi) as src_cust_code_cd,\r\n    max(description_opi) as src_cust_code_desc\r\n    from {{source('AX_DEV', 'CUSTPRECASTCODE_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_cust_code_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_code_cd']) }} as opco_cust_code_sk,\r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_cust_code_cd', 'src_cust_code_desc'])}} as opco_cust_code_ck, \r\n            *\r\n    from ax_opco_cust_code\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_CODE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_CODE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_code_sk, opco_cust_code_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_cust_code_cd, src_cust_code_desc  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_code\r\n    {% if _load == 1 %}\r\n        where opco_cust_code_ck not in (select distinct opco_cust_code_ck from final)\r\n    {% else %}\r\n        where opco_cust_code_ck not in (select distinct opco_cust_code_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_code where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_code_ck not in (select distinct opco_cust_code_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_code where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_code_ck in (select distinct opco_cust_code_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_cust_code where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "customer", "ax_opco_cust_code"], "unique_id": "model.OI_Foundation.ax_opco_cust_code", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/customer/ax_opco_cust_code.sql", "original_file_path": "models/ax/customer/ax_opco_cust_code.sql", "name": "ax_opco_cust_code", "alias": "ax_opco_cust_code", "checksum": {"name": "sha256", "checksum": "fa0fb60b0f7a81addffe4ce290e588b71a18c3b74400041447a85a9828b85ab1"}, "tags": [], "refs": [], "sources": [["AX_DEV", "CUSTPRECASTCODE_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.7380471}, "model.OI_Foundation.ax_opco_po_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_PO_LINE') %}\r\n\r\nwith ax_opco_po_line as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    pl._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pl._fivetran_deleted = true then pl._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pl.dataareaid as opco_id,\r\n    pl.purchid as po_id,\r\n    pl.linenum as po_line_nbr,\r\n    op.opco_po_sk,\r\n    ov.opco_vendor_sk, \r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oa.opco_assctn_sk,\r\n    oi.opco_item_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    ots.opco_trans_status_sk,\r\n    opt.opco_po_type_sk,\r\n    ou.opco_uom_sk as purchase_uom_sk,\r\n    ocoa.opco_chart_of_accts_sk as opco_gl_acct_sk,\r\n    oirt.opco_invtry_ref_type_sk,\r\n    opc.opco_project_catgry_sk,\r\n    opr.opco_project_sk,\r\n    pl.inventtransid as invtry_trans_id,\r\n    pl.inventrefid as invtry_ref_id,\r\n    pl.inventreftransid as invtry_ref_trans_id,\r\n    pl.projtransid as project_item_trans_id,\r\n    upper(pl.reqplanidsched) as req_plan_schedule_id,\r\n    pl.reqpoid as req_plan_ordr_id,\r\n    pl.assetid as asset_id,\r\n    pl.projtaxgroupid as project_tax_grp_id,\r\n    pl.name as po_line_nm,\r\n    pl.blocked as po_line_locked_ind,\r\n    pl.complete as po_line_dlvry_complete_ind,\r\n    pl.scrap as scrap_ind,\r\n    pl.taxable_opi as taxable_ind,\r\n    pl.taxitemgroup as tax_item_grp_cd,\r\n    pl.deliverydate as rqst_dlvry_dt,\r\n    pl.confirmeddlv as actl_dlvry_dt,\r\n    case    \r\n        when pl.deliverytype = 0 then null\r\n        when pl.deliverytype = 1 then 'Direct Delivery'\r\n    end as dlvry_type_txt,\r\n    pl.createddatetime as po_line_crt_dtm,\r\n    pl.createdby as po_line_crt_by,\r\n    upper(pl.vendgroup) as vendor_grp_cd,\r\n    pl.externalitemid as vendor_item_id,\r\n    pl.qtyordered as invtry_unit_ordr_qty,\r\n    pl.purchqty as purchase_unit_ordr_qty,\r\n    pl.remainpurchfinancial as purchase_unit_financial_remaining_qty,\r\n    pl.remainpurchphysical as purchase_unit_physical_remaining_qty,\r\n    pl.remaininventphysical as invtry_unit_physical_remaining_qty,\r\n    pl.remaininventfinancial as invtry_unit_financial_remaining_qty,\r\n    pl.purchreceivednow as purchase_unit_received_qty,\r\n    pl.inventreceivednow as invtry_unit_received_qty,\r\n    pl.priceunit as per_unit_qty,\r\n    pl.linepercent as po_line_dscnt_pct,\r\n    pl.linedisc as per_unit_line_dscnt_amt,\r\n    pl.multilndisc as per_unit_multi_line_dscnt_amt,\r\n    pl.purchprice as unit_purchase_price_amt,\r\n    pl.lineamount as po_line_amt,\r\n    pl.purchmarkup as purchase_markup_amt,\r\n    pl.tax1099amount as tax_1099_amt\r\n    from {{ source('AX_DEV', 'PURCHLINE') }} pl \r\n    left join {{ ref('v_ax_opco_po_curr')}} op \r\n        on pl.dataareaid = op.opco_id\r\n        and pl.purchid = op.po_id\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov\r\n        on upper(pl.vendaccount) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pl.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pl.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pl.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(pl.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pl.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa\r\n        on pl.dataareaid = oa.opco_id\r\n        and pl.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on pl.dataareaid = oi.opco_id\r\n        and pl.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(pl.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_trans_status_curr')}} ots \r\n        on pl.purchstatus = ots.src_trans_status_cd\r\n        and ots.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_type_curr')}} opt \r\n        on pl.purchasetype = opt.src_po_type_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pl.priceunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} ocoa\r\n        on pl.dataareaid = ocoa.opco_id\r\n        and pl.ledgeraccount = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_ref_type_curr')}} oirt \r\n        on pl.itemreftype = oirt.invtry_ref_type_cd\r\n        and oirt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on pl.dataareaid = opc.opco_id\r\n        and pl.projcategoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pl.dataareaid = opr.opco_id\r\n        and pl.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    where pl.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'po_id', 'po_line_nbr', 'invtry_trans_id']) }} as opco_po_line_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'po_id', 'po_line_nbr', 'opco_po_sk', 'opco_vendor_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_assctn_sk', 'opco_item_sk', 'trans_currency_sk', 'opco_trans_status_sk', 'opco_po_type_sk', 'purchase_uom_sk', 'opco_gl_acct_sk', 'opco_invtry_ref_type_sk', 'opco_project_catgry_sk', 'opco_project_sk', 'invtry_trans_id', 'invtry_ref_id', 'invtry_ref_trans_id', 'project_item_trans_id', 'req_plan_schedule_id', 'req_plan_ordr_id', 'asset_id', 'project_tax_grp_id', 'po_line_nm', 'po_line_locked_ind', 'po_line_dlvry_complete_ind', 'scrap_ind', 'taxable_ind', 'tax_item_grp_cd', 'rqst_dlvry_dt', 'actl_dlvry_dt', 'dlvry_type_txt', 'po_line_crt_dtm', 'po_line_crt_by', 'vendor_grp_cd', 'vendor_item_id', 'invtry_unit_ordr_qty', 'purchase_unit_ordr_qty', 'purchase_unit_financial_remaining_qty', 'purchase_unit_physical_remaining_qty', 'invtry_unit_physical_remaining_qty', 'invtry_unit_financial_remaining_qty', 'purchase_unit_received_qty', 'invtry_unit_received_qty', 'per_unit_qty', 'po_line_dscnt_pct', 'per_unit_line_dscnt_amt', 'per_unit_multi_line_dscnt_amt', 'unit_purchase_price_amt', 'po_line_amt', 'purchase_markup_amt', 'tax_1099_amt']) }} as opco_po_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, po_id, po_line_nbr, invtry_trans_id) as opco_po_line_ak, \r\n            * \r\n    from ax_opco_po_line \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PO_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PO_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_po_line_sk, opco_po_line_ck ,opco_po_line_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, po_id, po_line_nbr, opco_po_sk, opco_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk,\r\n    opco_assctn_sk, opco_item_sk, trans_currency_sk, opco_trans_status_sk, opco_po_type_sk, purchase_uom_sk, opco_gl_acct_sk, opco_invtry_ref_type_sk,\r\n    opco_project_catgry_sk, opco_project_sk, invtry_trans_id, invtry_ref_id, invtry_ref_trans_id, project_item_trans_id, req_plan_schedule_id, req_plan_ordr_id,\r\n    asset_id, project_tax_grp_id, po_line_nm, po_line_locked_ind, po_line_dlvry_complete_ind, scrap_ind,taxable_ind, tax_item_grp_cd, rqst_dlvry_dt,\r\n    actl_dlvry_dt, dlvry_type_txt, po_line_crt_dtm, po_line_crt_by, vendor_grp_cd, vendor_item_id, invtry_unit_ordr_qty, purchase_unit_ordr_qty, \r\n    purchase_unit_financial_remaining_qty, purchase_unit_physical_remaining_qty, invtry_unit_physical_remaining_qty, invtry_unit_financial_remaining_qty,\r\n    purchase_unit_received_qty, invtry_unit_received_qty, per_unit_qty, po_line_dscnt_pct, per_unit_line_dscnt_amt, per_unit_multi_line_dscnt_amt,\r\n    unit_purchase_price_amt, po_line_amt, purchase_markup_amt, tax_1099_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO_LINE\r\n    {% if _load == 1 %}\r\n        where opco_po_ck not in (select distinct opco_po_ck from final)\r\n    {% else %}\r\n        where opco_po_ck not in (select distinct opco_po_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO_LINE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_po_ck not in (select distinct opco_po_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO_LINE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_po_ck in (select distinct opco_po_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO_LINE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PURCHLINE", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "purchase_order", "ax_opco_po_line"], "unique_id": "model.OI_Foundation.ax_opco_po_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/purchase_order/ax_opco_po_line.sql", "original_file_path": "models/ax/purchase_order/ax_opco_po_line.sql", "name": "ax_opco_po_line", "alias": "ax_opco_po_line", "checksum": {"name": "sha256", "checksum": "c4951475cbba99ec742f74ff0c7620cfb6d36e51e53143b1a890e1b197b1bef5"}, "tags": [], "refs": [["v_ax_opco_po_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_trans_status_curr"], ["v_ax_opco_po_type_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_chart_of_accts_curr"], ["v_ax_opco_invtry_ref_type_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_project_curr"]], "sources": [["AX_DEV", "PURCHLINE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.7495203}, "model.OI_Foundation.ax_opco_po_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_po_type as (\r\n  {% set values = [ 'Journal', 'Quotation', 'Subscription', 'Purchase Order', 'Returned Order', 'Blanket Order'] %}\r\n  {% set num = [0, 1, 2, 3, 4, 5] %}\r\n\r\n  {% for i in range(6) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{num[i]}} as src_po_type_cd,\r\n          '{{values[i]}}' as src_po_type_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n  select \r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_po_type_cd']) }} as opco_po_type_sk,\r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_po_type_cd','src_po_type_desc']) }} as opco_po_type_ck, \r\n      *\r\n  from opco_po_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "purchase_order", "ax_opco_po_type"], "unique_id": "model.OI_Foundation.ax_opco_po_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/purchase_order/ax_opco_po_type.sql", "original_file_path": "models/ax/purchase_order/ax_opco_po_type.sql", "name": "ax_opco_po_type", "alias": "ax_opco_po_type", "checksum": {"name": "sha256", "checksum": "887e7c25eda6dce555351310202b3ff445c1eb31153df6d6b9bd3893d97f5496"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.7752085}, "model.OI_Foundation.ax_opco_po": {"raw_sql": "{% set _load = load_type('AX_OPCO_PO') %}\r\n\r\nwith ax_opco_po as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    pt._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when pt._fivetran_deleted = true then pt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pt.dataareaid as opco_id,\r\n    pt.purchid as po_id,\r\n    pt.purchname as po_nm,\r\n    opco.opco_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    ov.opco_vendor_sk,\r\n    ov2.opco_vendor_sk as invoice_vendor_sk,\r\n    ocd.opco_cash_dscnt_terms_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    ots.opco_trans_status_sk,\r\n    opo.opco_po_type_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    opm.opco_pymnt_mode_sk,\r\n    oso.opco_sls_ordr_sk as intercompany_orig_sls_ordr_sk,\r\n    ocu.opco_cust_sk as intercompany_orig_cust_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    opds.opco_po_doc_status_sk,\r\n    wr.warehouse_sk,\r\n    op.opco_project_sk,\r\n    oln.opco_locn_sk,\r\n    pt.deliverydate as dlvry_dt,\r\n    pt.createddatetime as po_crt_dtm,\r\n    pt.requestedby_opi as po_reqstd_by_nm,\r\n    upper(pt.vendgroup) as vendor_grp_cd,\r\n    pt.deliveryname as dlvry_vendor_nm,\r\n    pt.vendorref as vendor_ref_txt,\r\n    pt.namealias_opi as alias_nm,\r\n    pt.itembuyergroupid as item_buyer_grp_id,\r\n    pt.purchplacer as purchased_by_txt,\r\n    pt.taxable_opi as taxable_ind,\r\n    pt.discpercent as dscnt_pct,\r\n    pt.cashdiscpercent as cash_dscnt_pct\r\n    from {{ source('AX_DEV', 'PURCHTABLE') }} pt\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on pt.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} oip\r\n        on upper(pt.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(pt.orderaccount) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov2\r\n        on upper(pt.invoiceaccount) = ov2.vendor_id\r\n        and ov2.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cash_dscnt_terms_curr')}} ocd \r\n        on upper(pt.cashdisc) = ocd.src_cash_dscnt_terms_cd\r\n        and ocd.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(pt.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_trans_status_curr')}} ots \r\n        on pt.purchstatus = ots.src_trans_status_cd\r\n        and ots.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_type_curr')}} opo\r\n        on pt.purchasetype = opo.src_po_type_cd\r\n        and opo.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(pt.payment) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_mode_curr')}} opm \r\n        on upper(pt.paymmode) = opm.src_pymnt_mode_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} ocu \r\n        on pt.dataareaid = ocu.opco_id\r\n        and pt.intercompanyoriginalcustacco12 = ocu.cust_id\r\n        and ocu.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on pt.dataareaid = oso.opco_id\r\n        and pt.intercompanyoriginalsalesid = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(pt.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(pt.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_doc_status_curr')}} opds\r\n        on pt.documentstatus = opds.po_doc_status_cd\r\n        and opds.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_warehouse_curr')}} wr \r\n        on pt.dataareaid = wr.opco_id\r\n        and upper(pt.inventlocationid) = wr.warehouse_id\r\n        and wr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} op\r\n        on pt.dataareaid = op.opco_id\r\n        and pt.projid = op.project_id\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} oln \r\n        on upper(pt.deliverystreet) = oln.addr_ln_1_txt\r\n        and upper(pt.deliverycity) = oln.city_nm\r\n        and upper(pt.dlvstate) = oln.state_nm\r\n        and upper(pt.dlvcountryregionid) = oln.country_nm\r\n        and upper(pt.deliveryzipcode) = oln.zip_cd\r\n        and oln.src_sys_nm = 'AX'\r\n    where pt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'po_id']) }} as opco_po_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'po_id', 'po_nm', 'opco_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_vendor_sk', 'invoice_vendor_sk', 'opco_cash_dscnt_terms_sk', 'trans_currency_sk', 'opco_trans_status_sk', 'opco_po_type_sk', 'opco_pymnt_terms_sk', 'opco_pymnt_mode_sk', 'intercompany_orig_sls_ordr_sk', 'intercompany_orig_cust_sk', 'opco_dlvry_mode_sk', 'opco_dlvry_terms_sk', 'opco_po_doc_status_sk', 'warehouse_sk', 'opco_project_sk', 'opco_locn_sk', 'dlvry_dt', 'po_crt_dtm', 'po_reqstd_by_nm', 'vendor_grp_cd', 'dlvry_vendor_nm', 'vendor_ref_txt', 'alias_nm', 'item_buyer_grp_id', 'purchased_by_txt', 'taxable_ind', 'dscnt_pct', 'cash_dscnt_pct']) }} as opco_po_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, po_id) as opco_po_ak,\r\n            * \r\n    from ax_opco_po \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PO') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PO') and _load != 3%}\r\n    union\r\n    select\r\n    opco_po_sk, opco_po_ck,opco_po_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, po_id, po_nm, opco_sk, opco_cost_center_sk, opco_dept_sk,opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_vendor_sk,\r\n    invoice_vendor_sk, opco_cash_dscnt_terms_sk, trans_currency_sk, opco_trans_status_sk, opco_po_type_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk,\r\n    intercompany_orig_sls_ordr_sk, intercompany_orig_cust_sk, opco_dlvry_mode_sk,  opco_dlvry_terms_sk, opco_po_doc_status_sk, warehouse_sk,\r\n    opco_project_sk, opco_locn_sk, dlvry_dt, po_crt_dtm, po_reqstd_by_nm, vendor_grp_cd, dlvry_vendor_nm, vendor_ref_txt, alias_nm, item_buyer_grp_id,\r\n    purchased_by_txt, taxable_ind, dscnt_pct, cash_dscnt_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO\r\n    {% if _load == 1 %}\r\n        where opco_po_ck not in (select distinct opco_po_ck from final)\r\n    {% else %}\r\n        where opco_po_ck not in (select distinct opco_po_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_po_ck not in (select distinct opco_po_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_po_ck in (select distinct opco_po_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PO where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PURCHTABLE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_po_doc_status_curr", "model.OI_Foundation.v_ax_warehouse_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "purchase_order", "ax_opco_po"], "unique_id": "model.OI_Foundation.ax_opco_po", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/purchase_order/ax_opco_po.sql", "original_file_path": "models/ax/purchase_order/ax_opco_po.sql", "name": "ax_opco_po", "alias": "ax_opco_po", "checksum": {"name": "sha256", "checksum": "2e3f1b1b0dd8189f0fdce4c54a7f9472b7a779eec1c4b96506a32dab9fc43dfb"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_cash_dscnt_terms_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_trans_status_curr"], ["v_ax_opco_po_type_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_po_doc_status_curr"], ["v_ax_warehouse_curr"], ["v_ax_opco_project_curr"], ["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "PURCHTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.7838047}, "model.OI_Foundation.ax_opco_po_doc_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_po_doc_status as (\r\n  {% set values = [ 'None', 'Quotation', 'Purchase Order', 'Confirmation', 'Picking List', 'Packing Slip', 'Receipts List', 'Invoice', 'Invoice Approval Journal', 'Project - Invoice', 'Project - Packing Slip', 'CRM Quotation', 'Lost', 'Canceled', 'Free Text Invoice', 'Request for Quote', 'Request for Quote - Accept', 'Request for Quote - Reject', 'Purchase Requisition' ] %}\r\n\r\n  {% for i in range(19) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{i}} as po_doc_status_cd,\r\n          '{{values[i]}}' as po_doc_status_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n  select \r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'po_doc_status_cd']) }} as opco_po_doc_status_sk,\r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'po_doc_status_cd','po_doc_status_desc']) }} as opco_po_doc_status_ck, \r\n      *\r\n  from opco_po_doc_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "purchase_order", "ax_opco_po_doc_status"], "unique_id": "model.OI_Foundation.ax_opco_po_doc_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/purchase_order/ax_opco_po_doc_status.sql", "original_file_path": "models/ax/purchase_order/ax_opco_po_doc_status.sql", "name": "ax_opco_po_doc_status", "alias": "ax_opco_po_doc_status", "checksum": {"name": "sha256", "checksum": "4abfe33d083bf5942b12d00a268d805edde0354efd78a63ad7faf0290fabd631"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.8062897}, "model.OI_Foundation.ax_opco_vendor_invoice": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_INVOICE') %}\r\n\r\nwith ax_opco_vendor_invoice as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    vij._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vij._fivetran_deleted = true then vij._fivetran_synced \r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    vij.dataareaid as opco_id,\r\n    vij.invoiceid as invoice_nbr,\r\n    vij.internalinvoiceid as internal_invoice_nbr,\r\n    opco.opco_sk,\r\n    opo.opco_po_sk,\r\n    ov.opco_vendor_sk,\r\n    ov1.opco_vendor_sk as opco_invoice_vendor_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opt.opco_po_type_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    opm.opco_pymnt_terms_sk,\r\n    ocd.opco_cash_dscnt_terms_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    opr.opco_project_sk,\r\n    vij.vendgroup as vendor_grp_cd,\r\n    vij.invoicedate as invoice_dt,\r\n    vij.duedate as due_dt,\r\n    vij.ledgervoucher as gl_voucher_nbr,\r\n    vij.documentnum as document_nbr,\r\n    vij.documentdate as document_dt,\r\n    vij.cashdiscdate as cash_dscnt_dt,\r\n    vij.countryregionid as default_country_nm,\r\n    vij.purchplacer_opi as purchaser_nm,\r\n    vij.qty as invoice_qty,\r\n    vij.weight as invoice_weight_amt,\r\n    vij.volume as invoice_vol_amt,\r\n    vij.requestedby_opi as rqstd_by_nm,\r\n    vij.exchrate as exchg_rt,\r\n    vij.paymid as pymnt_id,\r\n    vij.taxgroup as tax_grp_id,\r\n    vij.itembuyergroupid as item_buyer_grp_id,\r\n    vij.fixedduedate as fixed_due_dt,\r\n    vij.invoiceamount as trans_currency_invoice_amt,\r\n    vij.invoiceamountmst as opco_currency_invoice_amt,\r\n    vij.invoiceroundoff as trans_currency_invoice_roundoff_amt,\r\n    vij.summarkup as trans_currency_misc_chrgs_amt,\r\n    vij.summarkupmst as opco_currency_misc_chrgs_amt,\r\n    vij.cashdisc as trans_currency_cash_dscnt_amt,\r\n    vij.sumlinedisc as trans_currency_line_dscnt_amt,\r\n    vij.salesbalance as trans_currency_balance_sls_amt    \r\n    from {{ source('AX_DEV', 'VENDINVOICEJOUR') }} vij\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on vij.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo \r\n        on vij.dataareaid = opo.opco_id\r\n        and vij.purchid = opo.po_id\r\n        and opo.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(vij.orderaccount) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov1 \r\n        on upper(vij.invoiceaccount) = ov1.vendor_id\r\n        and ov1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vij.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vij.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vij.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vij.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(vij.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_type_curr')}} opt\r\n        on vij.purchasetype = opt.src_po_type_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(vij.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_terms_curr')}} opm \r\n        on upper(vij.payment) = opm.src_pymnt_terms_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cash_dscnt_terms_curr')}} ocd \r\n        on upper(vij.cashdisccode) = ocd.src_cash_dscnt_terms_cd\r\n        and ocd.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(vij.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(vij.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr \r\n        on vij.dataareaid = opr.opco_id\r\n        and vij.projid_opi = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    where vij.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'invoice_nbr', 'internal_invoice_nbr']) }} as opco_vendor_invoice_sk, \r\n            {{ dbt_utils.surrogate_key([ 'src_sys_nm' , 'opco_id' , 'invoice_nbr' , 'internal_invoice_nbr' , 'opco_sk' , 'opco_po_sk' , 'opco_vendor_sk' , 'opco_invoice_vendor_sk' , 'opco_cost_center_sk' , 'opco_dept_sk' , 'opco_type_sk' , 'opco_purpose_sk' , 'opco_lob_sk' , 'opco_po_type_sk' , 'trans_currency_sk' , 'opco_pymnt_terms_sk' , 'opco_cash_dscnt_terms_sk' , 'opco_dlvry_terms_sk' , 'opco_dlvry_mode_sk' , 'opco_project_sk' , 'vendor_grp_cd' , 'invoice_dt' , 'due_dt' , 'gl_voucher_nbr' , 'document_nbr' , 'document_dt' , 'cash_dscnt_dt' , 'default_country_nm' , 'purchaser_nm' , 'invoice_qty' , 'invoice_weight_amt' , 'invoice_vol_amt' , 'rqstd_by_nm' , 'exchg_rt' , 'pymnt_id' , 'tax_grp_id' , 'item_buyer_grp_id' , 'fixed_due_dt' , 'trans_currency_invoice_amt' , 'opco_currency_invoice_amt' , 'trans_currency_invoice_roundoff_amt' , 'trans_currency_misc_chrgs_amt' , 'opco_currency_misc_chrgs_amt' , 'trans_currency_cash_dscnt_amt' , 'trans_currency_line_dscnt_amt' , 'trans_currency_balance_sls_amt']) }} as opco_vendor_invoice_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr) as opco_vendor_invoice_ak,\r\n            * \r\n    from ax_opco_vendor_invoice \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_VENDOR_INVOICE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_VENDOR_INVOICE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_VENDOR_INVOICE_sk, OPCO_VENDOR_INVOICE_ck, opco_vendor_invoice_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr, opco_sk, opco_po_sk, opco_vendor_sk, opco_invoice_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_type_sk, trans_currency_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, opco_project_sk, vendor_grp_cd, invoice_dt, due_dt, gl_voucher_nbr, document_nbr, document_dt, cash_dscnt_dt, default_country_nm, purchaser_nm, invoice_qty, invoice_weight_amt, invoice_vol_amt, rqstd_by_nm, exchg_rt, pymnt_id, tax_grp_id, item_buyer_grp_id, fixed_due_dt, trans_currency_invoice_amt, opco_currency_invoice_amt, trans_currency_invoice_roundoff_amt, trans_currency_misc_chrgs_amt, opco_currency_misc_chrgs_amt, trans_currency_cash_dscnt_amt, trans_currency_line_dscnt_amt, trans_currency_balance_sls_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE\r\n    {% if _load == 1 %}\r\n        where OPCO_VENDOR_INVOICE_ck not in (select distinct OPCO_VENDOR_INVOICE_ck from final)\r\n    {% else %}\r\n        where OPCO_VENDOR_INVOICE_ck not in (select distinct OPCO_VENDOR_INVOICE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_INVOICE_ck not in (select distinct OPCO_VENDOR_INVOICE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_INVOICE_ck in (select distinct OPCO_VENDOR_INVOICE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDINVOICEJOUR", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_project_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "vendor", "ax_opco_vendor_invoice"], "unique_id": "model.OI_Foundation.ax_opco_vendor_invoice", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/vendor/ax_opco_vendor_invoice.sql", "original_file_path": "models/ax/vendor/ax_opco_vendor_invoice.sql", "name": "ax_opco_vendor_invoice", "alias": "ax_opco_vendor_invoice", "checksum": {"name": "sha256", "checksum": "7e3554c030c6815f8974c1238e5690b4e727925fadc4f964fc0eb563b5ad2945"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_po_type_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_cash_dscnt_terms_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_project_curr"]], "sources": [["AX_DEV", "VENDINVOICEJOUR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.814825}, "model.OI_Foundation.ax_opco_vendor_packing_slip_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_PACKING_SLIP_LINE') %}\r\n\r\nwith ax_opco_vendor_packing_slip_line as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    vps._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vps._fivetran_deleted = true then vps._fivetran_synced \r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    vps.dataareaid as opco_id,\r\n    vps.packingslipid as packing_slip_id,\r\n    vps.internalpackingslipid as internal_packing_slip_id,\r\n    vps.inventtransid as invtry_trans_id,\r\n    ovps.opco_vendor_packing_slip_sk,\r\n    opco.opco_sk,\r\n    oi.opco_item_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opo.opco_po_sk,\r\n    opo1.opco_po_sk as orig_po_sk,\r\n    oa.opco_assctn_sk,\r\n    ou.opco_uom_sk,\r\n    oirt.opco_invtry_ref_type_sk,\r\n    vps.linenum as line_nbr,\r\n    vps.deliverydate as dlvry_dt,\r\n    vps.inventdate as invtry_trans_dt,\r\n    vps.inventrefid as invtry_ref_id,\r\n    vps.externalitemid as vendor_item_id,\r\n    vps.name as item_desc,\r\n    vps.partdelivery as partial_dlvry_ind,\r\n    vps.destcountryregionid as dest_country_nm,\r\n    vps.deststate as dest_state_nm,\r\n    vps.destcounty as dest_county_nm,\r\n    vps.priceunit as per_unit_qty,\r\n    vps.ordered as ordr_qty,\r\n    vps.qty as received_qty,\r\n    vps.remain as remaining_qty,\r\n    vps.inventqty as invtry_qty,\r\n    vps.valuemst as opco_currency_trans_amt\r\n    from {{ source('AX_DEV', 'VENDPACKINGSLIPTRANS') }} vps\r\n    left join {{ ref('v_ax_opco_vendor_packing_slip_curr')}} ovps\r\n        on vps.dataareaid = ovps.opco_id\r\n        and vps.packingslipid = ovps.packing_slip_id\r\n        and vps.internalpackingslipid = ovps.internal_packing_slip_id\r\n        and ovps.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on vps.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on vps.dataareaid = oi.opco_id\r\n        and vps.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vps.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vps.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vps.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vps.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(vps.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo \r\n        on vps.dataareaid = opo.opco_id \r\n        and vps.purchid = opo.po_id\r\n        and opo.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo1 \r\n        on vps.dataareaid = opo1.opco_id \r\n        and vps.origpurchid = opo1.po_id\r\n        and opo1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa\r\n        on vps.dataareaid = oa.opco_id\r\n        and vps.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(vps.purchunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_ref_type_curr')}} oirt \r\n        on vps.inventreftype = oirt.invtry_ref_type_cd\r\n        and oirt.src_sys_nm = 'AX'\r\n    where vps.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'internal_packing_slip_id', 'invtry_trans_id']) }} as opco_vendor_packing_slip_line_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'internal_packing_slip_id', 'invtry_trans_id', 'opco_vendor_packing_slip_sk', 'opco_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_po_sk', 'orig_po_sk', 'opco_assctn_sk', 'opco_uom_sk', 'opco_invtry_ref_type_sk', 'line_nbr', 'dlvry_dt', 'invtry_trans_dt', 'invtry_ref_id', 'vendor_item_id', 'item_desc', 'partial_dlvry_ind', 'dest_country_nm', 'dest_state_nm', 'dest_county_nm', 'per_unit_qty', 'ordr_qty', 'received_qty', 'remaining_qty', 'invtry_qty', 'opco_currency_trans_amt']) }} as opco_vendor_packing_slip_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id, invtry_trans_id) as opco_vendor_packing_slip_line_ak,\r\n            * \r\n    from ax_opco_vendor_packing_slip_line \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_VENDOR_PACKING_SLIP_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_VENDOR_PACKING_SLIP_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_VENDOR_PACKING_SLIP_LINE_sk, OPCO_VENDOR_PACKING_SLIP_LINE_ck, opco_vendor_packing_slip_line_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id, invtry_trans_id, opco_vendor_packing_slip_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, orig_po_sk, opco_assctn_sk, opco_uom_sk, opco_invtry_ref_type_sk, line_nbr, dlvry_dt, invtry_trans_dt, invtry_ref_id, vendor_item_id, item_desc, partial_dlvry_ind, dest_country_nm, dest_state_nm, dest_county_nm, per_unit_qty, ordr_qty, received_qty, remaining_qty, invtry_qty, opco_currency_trans_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_PACKING_SLIP_LINE\r\n    {% if _load == 1 %}\r\n        where OPCO_VENDOR_PACKING_SLIP_LINE_ck not in (select distinct OPCO_VENDOR_PACKING_SLIP_LINE_ck from final)\r\n    {% else %}\r\n        where OPCO_VENDOR_PACKING_SLIP_LINE_ck not in (select distinct OPCO_VENDOR_PACKING_SLIP_LINE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_PACKING_SLIP_LINE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_PACKING_SLIP_LINE_ck not in (select distinct OPCO_VENDOR_PACKING_SLIP_LINE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_PACKING_SLIP_LINE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_PACKING_SLIP_LINE_ck in (select distinct OPCO_VENDOR_PACKING_SLIP_LINE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_PACKING_SLIP_LINE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS", "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "vendor", "ax_opco_vendor_packing_slip_line"], "unique_id": "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/vendor/ax_opco_vendor_packing_slip_line.sql", "original_file_path": "models/ax/vendor/ax_opco_vendor_packing_slip_line.sql", "name": "ax_opco_vendor_packing_slip_line", "alias": "ax_opco_vendor_packing_slip_line", "checksum": {"name": "sha256", "checksum": "f4fe7e4ad198ff714e1ac875d2f4582cd542a5564429b0baaf306f3a08642dfe"}, "tags": [], "refs": [["v_ax_opco_vendor_packing_slip_curr"], ["v_ax_opco_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_invtry_ref_type_curr"]], "sources": [["AX_DEV", "VENDPACKINGSLIPTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.8376522}, "model.OI_Foundation.ax_opco_vendor_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_TRANS') %}\r\n\r\nwith ax_opco_vendor_trans as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    vt._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vt._fivetran_deleted = true then vt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    vt.dataareaid as opco_id,\r\n    vt.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    ov.opco_vendor_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opo.opco_po_sk,\r\n    ogt.opco_gl_trans_type_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    opm.opco_pymnt_mode_sk,\r\n    ocd.opco_cash_dscnt_terms_sk,\r\n    opco1.opco_sk as ltst_settled_opco_sk,\r\n    ov1.opco_vendor_sk as ltst_settled_vendor_sk,\r\n    vt.txt as trans_desc,\r\n    vt.transdate as trans_dt,\r\n    vt.duedate as due_dt,\r\n    vt.closed as trans_close_dt,\r\n    vt.voucher as voucher_nbr,\r\n    vt.invoice as invoice_nbr,\r\n    vt.lastsettlevoucher as ltst_settled_voucher_nbr,\r\n    vt.lastsettledate as ltst_settle_dt,\r\n    vt.approved as trans_apprvd_ind,\r\n    vt.approvedby as trans_apprvd_by_txt,\r\n    vt.approveddate as trans_apprvd_dtm,\r\n    vt.documentnum as document_nbr,\r\n    vt.documentdate as document_dt,\r\n    vt.offsetrecid as offset_src_key_txt,\r\n    vt.invoiceproject as project_contract_orign_ind,\r\n    vt.correct as crrctn_trans_ind,\r\n    vt.settlement as auto_settle_ind,\r\n    vt.cancel as cancelled_ind,\r\n    vt.paymreference as pymnt_ref_txt,\r\n    vt.paymid as pymnt_id,\r\n    vt.amountcur as trans_currency_trans_amt,\r\n    vt.settleamountcur as trans_currency_settled_amt,\r\n    vt.amountmst as opco_currency_trans_amt,\r\n    vt.settleamountmst as opco_currency_settled_amt,\r\n    vt.exchrate as exchg_rt,\r\n    vt.lastexchadj as ltst_exchg_adjstmt_dt,\r\n    vt.exchadjustment as opco_currency_exchg_adjstmt_amt,\r\n    vt.vendexchadjustmentrealized as opco_currency_realized_exchg_adjstmt_amt,\r\n    vt.tax1099amount as opco_currency_tax_amt,\r\n    vt.settletax1099amount as opco_currency_settled_tax_amt,\r\n    vt.discdate_opi as dscnt_dt,\r\n    vt.discamt_opi as dscnt_amt\r\n    from {{ source('AX_DEV', 'VENDTRANS') }} vt \r\n    left join {{ ref('v_ax_opco_curr')}} opco1 \r\n        on vt.lastsettlecompany = opco1.opco_id\r\n        and opco1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco\r\n        on vt.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(vt.accountnum) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov1 \r\n        on upper(vt.lastsettleaccountnum) = ov1.vendor_id\r\n        and ov1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vt.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(vt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo \r\n        on vt.dataareaid = opo.opco_id \r\n        and vt.purchid_opi = opo.po_id\r\n        and opo.src_sys_nm = 'AX'\r\n        and vt.purchid_opi is not null\r\n        and vt.purchid_opi <> '0'\r\n    left join {{ ref('v_ax_opco_gl_trans_type_curr')}} ogt \r\n        on cast(vt.transtype as string) = cast(ogt.src_gl_trans_type_cd as string)\r\n        and ogt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(vt.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_pymnt_mode_curr')}} opm \r\n        on upper(vt.paymmode) = opm.src_pymnt_mode_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cash_dscnt_terms_curr')}} ocd \r\n        on upper(vt.cashdisccode) = ocd.src_cash_dscnt_terms_cd\r\n        and ocd.src_sys_nm = 'AX'\r\n    where vt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt']) }} as opco_vendor_trans_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_sk', 'opco_vendor_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_po_sk', 'opco_gl_trans_type_sk', 'trans_currency_sk', 'opco_pymnt_mode_sk', 'opco_cash_dscnt_terms_sk', 'ltst_settled_opco_sk', 'ltst_settled_vendor_sk', 'trans_desc', 'trans_dt', 'due_dt', 'trans_close_dt', 'voucher_nbr', 'invoice_nbr', 'ltst_settled_voucher_nbr', 'ltst_settle_dt', 'trans_apprvd_ind', 'trans_apprvd_by_txt', 'trans_apprvd_dtm', 'document_nbr', 'document_dt', 'offset_src_key_txt', 'project_contract_orign_ind', 'crrctn_trans_ind', 'auto_settle_ind', 'cancelled_ind', 'pymnt_ref_txt', 'pymnt_id', 'trans_currency_trans_amt', 'trans_currency_settled_amt', 'opco_currency_trans_amt', 'opco_currency_settled_amt', 'exchg_rt', 'ltst_exchg_adjstmt_dt', 'opco_currency_exchg_adjstmt_amt', 'opco_currency_realized_exchg_adjstmt_amt', 'opco_currency_tax_amt', 'opco_currency_settled_tax_amt', 'dscnt_dt', 'dscnt_amt']) }} as opco_vendor_trans_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_vendor_trans_ak,\r\n            * \r\n    from ax_opco_vendor_trans \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_VENDOR_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_VENDOR_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_VENDOR_TRANS_sk, OPCO_VENDOR_TRANS_ck, opco_vendor_trans_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, opco_gl_trans_type_sk, trans_currency_sk, opco_pymnt_mode_sk, opco_cash_dscnt_terms_sk, ltst_settled_opco_sk, ltst_settled_vendor_sk, trans_desc, trans_dt, due_dt, trans_close_dt, voucher_nbr, invoice_nbr, ltst_settled_voucher_nbr, ltst_settle_dt, trans_apprvd_ind, trans_apprvd_by_txt, trans_apprvd_dtm, document_nbr, document_dt, offset_src_key_txt, project_contract_orign_ind, crrctn_trans_ind, auto_settle_ind, cancelled_ind, pymnt_ref_txt, pymnt_id, trans_currency_trans_amt, trans_currency_settled_amt, opco_currency_trans_amt, opco_currency_settled_amt, exchg_rt, ltst_exchg_adjstmt_dt, opco_currency_exchg_adjstmt_amt, opco_currency_realized_exchg_adjstmt_amt, opco_currency_tax_amt, opco_currency_settled_tax_amt, dscnt_dt, dscnt_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_VENDOR_TRANS_ck not in (select distinct OPCO_VENDOR_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_VENDOR_TRANS_ck not in (select distinct OPCO_VENDOR_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_TRANS_ck not in (select distinct OPCO_VENDOR_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_TRANS_ck in (select distinct OPCO_VENDOR_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDTRANS", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "vendor", "ax_opco_vendor_trans"], "unique_id": "model.OI_Foundation.ax_opco_vendor_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/vendor/ax_opco_vendor_trans.sql", "original_file_path": "models/ax/vendor/ax_opco_vendor_trans.sql", "name": "ax_opco_vendor_trans", "alias": "ax_opco_vendor_trans", "checksum": {"name": "sha256", "checksum": "69df5915a94e529517cd7937a60fa6f25e9feb87e99aef0127944c18a3132170"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_gl_trans_type_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_cash_dscnt_terms_curr"]], "sources": [["AX_DEV", "VENDTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.8583035}, "model.OI_Foundation.ax_opco_vendor_packing_slip": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_PACKING_SLIP') %}\r\n\r\nwith ax_opco_vendor_packing_slip as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    vps._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vps._fivetran_deleted = true then vps._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    vps.dataareaid as opco_id,\r\n    vps.packingslipid as packing_slip_id,\r\n    vps.internalpackingslipid as internal_packing_slip_id,\r\n    opco.opco_sk, \r\n    ov.opco_vendor_sk,\r\n    ov1.opco_vendor_sk as opco_invoice_vendor_sk,\r\n    opo.opco_po_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    oln.opco_locn_sk as dlvry_locn_sk,\r\n    opr.opco_project_sk,\r\n    opt.opco_po_type_sk,\r\n    vps.deliverydate as dlvry_dt,\r\n    vps.deliveryname as dlvry_vendor_nm,\r\n    vps.ledgervoucher as gl_voucher_nbr,\r\n    vps.itembuyergroupid as item_buyer_grp_id,\r\n    vps.purchplacer_opi as purchaser_nm,\r\n    vps.requestedby_opi as rqstd_by_nm,\r\n    vps.requisitioner as requsitioner_nm,\r\n    vps.reqattention as attn_info_txt,\r\n    vps.qty as dlvry_qty,\r\n    vps.volume as dlvry_volume_amt,\r\n    vps.weight as dlvry_weight_amt\r\n    from {{ source('AX_DEV', 'VENDPACKINGSLIPJOUR') }} vps\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on vps.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'   \r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(vps.orderaccount) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov1 \r\n        on upper(vps.invoiceaccount) = ov1.vendor_id\r\n        and ov1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo \r\n        on vps.dataareaid = opo.opco_id \r\n        and vps.purchid = opo.po_id\r\n        and opo.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vps.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vps.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vps.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vps.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(vps.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(vps.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(vps.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} oln \r\n         on upper(vps.deliverystreet) = oln.addr_ln_1_txt\r\n        and upper(vps.deliverycity) = oln.city_nm\r\n        and upper(vps.dlvstate) = oln.state_nm\r\n        and upper(vps.dlvcountryregionid) = oln.country_nm\r\n        and upper(vps.dlvzipcode) = oln.zip_cd\r\n        and oln.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr \r\n        on vps.dataareaid = opr.opco_id\r\n        and vps.projid_opi = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_type_curr')}} opt \r\n        on vps.purchasetype = opt.src_po_type_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    where vps.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'internal_packing_slip_id']) }} as opco_vendor_packing_slip_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'packing_slip_id', 'internal_packing_slip_id', 'opco_sk', 'opco_vendor_sk', 'opco_invoice_vendor_sk', 'opco_po_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_dlvry_terms_sk', 'opco_dlvry_mode_sk', 'dlvry_locn_sk', 'opco_project_sk', 'opco_po_type_sk', 'dlvry_dt', 'dlvry_vendor_nm', 'gl_voucher_nbr', 'item_buyer_grp_id', 'purchaser_nm', 'rqstd_by_nm', 'requsitioner_nm', 'attn_info_txt', 'dlvry_qty', 'dlvry_volume_amt', 'dlvry_weight_amt']) }} as opco_vendor_packing_slip_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id) as opco_vendor_packing_slip_ak,\r\n            * \r\n    from ax_opco_vendor_packing_slip \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_opco_vendor_packing_slip') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'opco_vendor_packing_slip') and _load != 3%}\r\n    union\r\n    select\r\n    opco_vendor_packing_slip_sk, opco_vendor_packing_slip_ck, opco_vendor_packing_slip_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id, opco_sk, opco_vendor_sk, opco_invoice_vendor_sk, opco_po_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk, opco_project_sk, opco_po_type_sk, dlvry_dt, dlvry_vendor_nm, gl_voucher_nbr, item_buyer_grp_id, purchaser_nm, rqstd_by_nm, requsitioner_nm, attn_info_txt, dlvry_qty, dlvry_volume_amt, dlvry_weight_amt\r\n    {% if _load == 1 %}\r\n        where opco_vendor_packing_slip_ck not in (select distinct opco_vendor_packing_slip_ck from final)\r\n    {% else %}\r\n        where opco_vendor_packing_slip_ck not in (select distinct opco_vendor_packing_slip_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_vendor_packing_slip where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_vendor_packing_slip_ck not in (select distinct opco_vendor_packing_slip_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_vendor_packing_slip where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_vendor_packing_slip_ck in (select distinct opco_vendor_packing_slip_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_vendor_packing_slip where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_po_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "vendor", "ax_opco_vendor_packing_slip"], "unique_id": "model.OI_Foundation.ax_opco_vendor_packing_slip", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/vendor/ax_opco_vendor_packing_slip.sql", "original_file_path": "models/ax/vendor/ax_opco_vendor_packing_slip.sql", "name": "ax_opco_vendor_packing_slip", "alias": "ax_opco_vendor_packing_slip", "checksum": {"name": "sha256", "checksum": "11ed570a27620d62b596fea9f9750736b46b60ffa44d07d5111691ef62e45610"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_locn_curr"], ["v_ax_opco_project_curr"], ["v_ax_opco_po_type_curr"]], "sources": [["AX_DEV", "VENDPACKINGSLIPJOUR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.8804433}, "model.OI_Foundation.ax_opco_vendor_invoice_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_INVOICE_LINE') %}\r\n\r\nwith ax_opco_vendor_invoice_line as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    vit._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vit._fivetran_deleted = true then vit._fivetran_synced\r\n        else null \r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    vit.dataareaid as opco_id,\r\n    vit.invoiceid as invoice_nbr,\r\n    vit.internalinvoiceid as internal_invoice_nbr,\r\n    vit.inventtransid as invtry_trans_id,\r\n    ovi.opco_vendor_invoice_sk,\r\n    opco.opco_sk,\r\n    oi.opco_item_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opo.opco_po_sk,\r\n    opo1.opco_po_sk as orig_po_sk,\r\n    ocoa.opco_chart_of_accts_sk as gl_acct_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    oa.opco_assctn_sk,\r\n    oirt.opco_invtry_ref_type_sk,\r\n    ou.opco_uom_sk,\r\n    vit.linenum as line_nbr,\r\n    vit.invoicedate as invoice_dt,\r\n    vit.name as item_desc,\r\n    vit.externalitemid as vendor_item_id,\r\n    vit.inventrefid as invtry_ref_id,\r\n    vit.inventreftransid as invtry_ref_trans_id,\r\n    vit.inventdate as invtry_trans_dt,\r\n    vit.destcountryregionid as dest_country_nm,\r\n    vit.deststate as dest_state_nm,\r\n    vit.destcounty as dest_county_nm,\r\n    vit.taxgroup as tax_grp_id,\r\n    vit.taxitemgroup as tax_item_grp_id,\r\n    vit.priceunit as per_unit_qty,\r\n    vit.qty as purchase_qty,\r\n    vit.qtyphysical as received_qty,\r\n    vit.inventqty as invtry_qty,\r\n    vit.discpercent as dscnt_pct,\r\n    vit.linepercent as line_dscnt_pct,\r\n    vit.purchprice as per_unit_price_amt,\r\n    vit.lineamount as trans_currency_trans_amt,\r\n    vit.lineamountmst as opco_currency_trans_amt,\r\n    vit.purchmarkup as trans_currency_misc_chrgs_amt,\r\n    vit.discamount as trans_currency_dscnt_amt,\r\n    vit.linedisc as trans_currency_line_dscnt_amt,\r\n    vit.multilndisc as trans_currency_multi_line_dscnt_amt,\r\n    vit.lineamounttax as trans_currency_tax_amt,\r\n    vit.tax1099amount as opco_currency_tax_1099_amt\r\n    from {{ source('AX_DEV', 'VENDINVOICETRANS') }} vit \r\n    left join {{ ref('v_ax_opco_vendor_invoice_curr')}} ovi \r\n        on vit.dataareaid = ovi.opco_id\r\n        and vit.invoiceid = ovi.invoice_nbr\r\n        and vit.internalinvoiceid = ovi.internal_invoice_nbr\r\n        and ovi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on vit.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on vit.dataareaid = oi.opco_id\r\n        and vit.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vit.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vit.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vit.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vit.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(vit.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo \r\n        on vit.dataareaid = opo.opco_id \r\n        and vit.purchid = opo.po_id\r\n        and opo.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_po_curr')}} opo1\r\n        on vit.dataareaid = opo1.opco_id \r\n        and vit.origpurchid = opo1.po_id\r\n        and opo1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} ocoa\r\n        on vit.dataareaid = ocoa.opco_id\r\n        and vit.ledgeraccount = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr \r\n        on upper(vit.currencycode) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa\r\n        on vit.dataareaid = oa.opco_id\r\n        and vit.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_ref_type_curr')}} oirt \r\n        on vit.inventreftype = oirt.invtry_ref_type_cd\r\n        and oirt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(vit.purchunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where vit.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'invoice_nbr', 'internal_invoice_nbr', 'invtry_trans_id']) }} as opco_vendor_invoice_line_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'invoice_nbr', 'internal_invoice_nbr', 'invtry_trans_id', 'opco_vendor_invoice_sk', 'opco_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_po_sk', 'orig_po_sk', 'gl_acct_sk', 'trans_currency_sk', 'opco_assctn_sk', 'opco_invtry_ref_type_sk', 'opco_uom_sk', 'line_nbr', 'invoice_dt', 'item_desc', 'vendor_item_id', 'invtry_ref_id', 'invtry_ref_trans_id', 'invtry_trans_dt', 'dest_country_nm', 'dest_state_nm', 'dest_county_nm', 'tax_grp_id', 'tax_item_grp_id', 'per_unit_qty', 'purchase_qty', 'received_qty', 'invtry_qty', 'dscnt_pct', 'line_dscnt_pct', 'per_unit_price_amt', 'trans_currency_trans_amt', 'opco_currency_trans_amt', 'trans_currency_misc_chrgs_amt', 'trans_currency_dscnt_amt', 'trans_currency_line_dscnt_amt', 'trans_currency_multi_line_dscnt_amt', 'trans_currency_tax_amt', 'opco_currency_tax_1099_amt']) }} as opco_vendor_invoice_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr, invtry_trans_id) as opco_vendor_invoice_line_ak,\r\n            * \r\n    from ax_opco_vendor_invoice_line \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_VENDOR_INVOICE_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_VENDOR_INVOICE_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_VENDOR_INVOICE_LINE_sk, OPCO_VENDOR_INVOICE_LINE_ck, opco_vendor_invoice_line_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr, invtry_trans_id, opco_vendor_invoice_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, orig_po_sk, gl_acct_sk, trans_currency_sk, opco_assctn_sk, opco_invtry_ref_type_sk, opco_uom_sk, line_nbr, invoice_dt, item_desc, vendor_item_id, invtry_ref_id, invtry_ref_trans_id, invtry_trans_dt, dest_country_nm, dest_state_nm, dest_county_nm, tax_grp_id, tax_item_grp_id, per_unit_qty, purchase_qty, received_qty, invtry_qty, dscnt_pct, line_dscnt_pct, per_unit_price_amt, trans_currency_trans_amt, opco_currency_trans_amt, trans_currency_misc_chrgs_amt, trans_currency_dscnt_amt, trans_currency_line_dscnt_amt, trans_currency_multi_line_dscnt_amt, trans_currency_tax_amt, opco_currency_tax_1099_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE_LINE\r\n    {% if _load == 1 %}\r\n        where OPCO_VENDOR_INVOICE_LINE_ck not in (select distinct OPCO_VENDOR_INVOICE_LINE_ck from final)\r\n    {% else %}\r\n        where OPCO_VENDOR_INVOICE_LINE_ck not in (select distinct OPCO_VENDOR_INVOICE_LINE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE_LINE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_INVOICE_LINE_ck not in (select distinct OPCO_VENDOR_INVOICE_LINE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE_LINE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_INVOICE_LINE_ck in (select distinct OPCO_VENDOR_INVOICE_LINE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR_INVOICE_LINE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDINVOICETRANS", "model.OI_Foundation.v_ax_opco_vendor_invoice_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "vendor", "ax_opco_vendor_invoice_line"], "unique_id": "model.OI_Foundation.ax_opco_vendor_invoice_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/vendor/ax_opco_vendor_invoice_line.sql", "original_file_path": "models/ax/vendor/ax_opco_vendor_invoice_line.sql", "name": "ax_opco_vendor_invoice_line", "alias": "ax_opco_vendor_invoice_line", "checksum": {"name": "sha256", "checksum": "aee761169a56236c1fdb88187aa3367010f85ddce8e70039dc3982d13aa160db"}, "tags": [], "refs": [["v_ax_opco_vendor_invoice_curr"], ["v_ax_opco_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_po_curr"], ["v_ax_opco_chart_of_accts_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_invtry_ref_type_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "VENDINVOICETRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.8988788}, "model.OI_Foundation.ax_opco_item_invtry": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_INVTRY') %}\r\n\r\nwith ax_opco_item_invtry as (\r\n    select \r\n    oi.opco_item_sk,\r\n    oa.opco_assctn_sk,\r\n    current_timestamp as crt_dtm,\r\n    isu._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when isu._fivetran_deleted = true then isu._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    isu.availphysical as item_avbl_physical_qty,\r\n    isu.postedqty as item_posted_qty,\r\n    isu.postedvalue as item_posted_value_amt\r\n    from {{source('AX_DEV', 'INVENTSUM')}} isu \r\n    left join {{ref('v_ax_opco_item_curr')}} oi \r\n        on isu.dataareaid = oi.opco_id\r\n        and isu.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_assctn_curr')}} oa \r\n        on isu.dataareaid = oa.opco_id \r\n        and isu.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    where isu.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            opco_item_sk, opco_assctn_sk, \r\n            {{ dbt_utils.surrogate_key(['opco_item_sk', 'opco_assctn_sk', 'src_sys_nm', 'item_avbl_physical_qty', 'item_posted_qty', 'item_posted_value_amt'])}} as opco_item_invtry_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, item_avbl_physical_qty, item_posted_qty, item_posted_value_amt\r\n    from ax_opco_item_invtry \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_INVTRY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_INVTRY') and _load != 3%}\r\n    union\r\n    select\r\n    opco_item_sk, opco_assctn_sk,opco_item_invtry_ck,  crt_dtm, \r\n    (select MAX(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select MAX(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, item_avbl_physical_qty, item_posted_qty, item_posted_value_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_INVTRY\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_INVTRY_ck not in (select distinct OPCO_ITEM_INVTRY_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_INVTRY_ck not in (select distinct OPCO_ITEM_INVTRY_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_INVTRY where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_INVTRY_ck not in (select distinct OPCO_ITEM_INVTRY_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_INVTRY where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_INVTRY_ck in (select distinct OPCO_ITEM_INVTRY_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_INVTRY where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTSUM", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_assctn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_invtry"], "unique_id": "model.OI_Foundation.ax_opco_item_invtry", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_invtry.sql", "original_file_path": "models/ax/product/ax_opco_item_invtry.sql", "name": "ax_opco_item_invtry", "alias": "ax_opco_item_invtry", "checksum": {"name": "sha256", "checksum": "969d5963f09cf119a2b245552cdd2870f8a7f80a7d6c71f59972b95d0ed5603a"}, "tags": [], "refs": [["v_ax_opco_item_curr"], ["v_ax_opco_assctn_curr"]], "sources": [["AX_DEV", "INVENTSUM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.9214394}, "model.OI_Foundation.ax_opco_item_subtype": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_SUBTYPE') %}\r\n\r\nwith ax_opco_item_subtype as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    code_opi as src_item_subtype_cd,\r\n    upper(category_opi) as src_item_type_cd,\r\n    max(description_opi) as src_item_subtype_desc\r\n    from {{source('AX_DEV', 'INVENTPRECASTCODE_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_item_type_cd, src_item_subtype_cd, _fivetran_deleted\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_type_cd', 'src_item_subtype_cd']) }} as OPCO_ITEM_SUBTYPE_SK,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_type_cd', 'src_item_subtype_cd', 'src_item_subtype_desc']) }} as OPCO_ITEM_SUBTYPE_ck, \r\n            * \r\n    from ax_opco_item_subtype \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_SUBTYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_SUBTYPE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_SUBTYPE_SK, OPCO_ITEM_SUBTYPE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm,  src_item_type_cd,  src_item_subtype_cd,  src_item_subtype_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SUBTYPE\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_SUBTYPE_ck not in (select distinct OPCO_ITEM_SUBTYPE_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_SUBTYPE_ck not in (select distinct OPCO_ITEM_SUBTYPE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SUBTYPE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SUBTYPE_ck not in (select distinct OPCO_ITEM_SUBTYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SUBTYPE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SUBTYPE_ck in (select distinct OPCO_ITEM_SUBTYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SUBTYPE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_subtype"], "unique_id": "model.OI_Foundation.ax_opco_item_subtype", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_subtype.sql", "original_file_path": "models/ax/product/ax_opco_item_subtype.sql", "name": "ax_opco_item_subtype", "alias": "ax_opco_item_subtype", "checksum": {"name": "sha256", "checksum": "5fc1ae7a20ca0cd6ac92288da75fe33c01a770698278819ae8e21868da3face2"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTPRECASTCODE_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.9327316}, "model.OI_Foundation.ax_opco_vendor": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR') %}\r\n\r\nwith ax_opco_vendor as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    vt._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then vt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(vt.accountnum) as vendor_id,\r\n    vt.name as vendor_nm,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opm.opco_pymnt_mode_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    oc.opco_currency_sk,\r\n    '' as vendor_grp_cd,\r\n    vt.namealias as vendor_alt_nm,\r\n    vt.dba as vendor_dba_nm,\r\n    vt.foreignentityindicator as foreign_entity_ind,\r\n    case    \r\n        when vt.blocked = 0 then 'No'\r\n        when vt.blocked = 1 then 'Invoice'\r\n        when vt.blocked = 2 then 'All'\r\n    end as vendor_block_txt\r\n    from {{source('AX_DEV', 'VENDTABLE')}} vt\r\n    left join {{ ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(vt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dept_curr')}} od \r\n        on upper(vt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_type_curr')}} ot \r\n        on upper(vt.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(vt.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(vt.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_mode_curr')}} opm \r\n        on upper(vt.paymmode) = opm.src_pymnt_mode_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(vt.paymtermid) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(vt.currency) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(vt.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    where vt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'vendor_id']) }} as opco_vendor_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'vendor_id', 'vendor_nm', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_pymnt_mode_sk', 'opco_pymnt_terms_sk', 'opco_dlvry_mode_sk', 'opco_currency_sk', 'vendor_grp_cd', 'vendor_alt_nm', 'vendor_dba_nm', 'foreign_entity_ind', 'vendor_block_txt',]) }} as OPCO_VENDOR_ck,\r\n            * \r\n    from ax_opco_vendor\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_VENDOR') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_VENDOR') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_VENDOR_SK, OPCO_VENDOR_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, vendor_id, vendor_nm, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_pymnt_mode_sk, opco_pymnt_terms_sk, opco_dlvry_mode_sk, opco_currency_sk, vendor_grp_cd, namealias as vendor_alt_nm, vendor_dba_nm, foreign_entity_ind, vendor_block_txt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR\r\n    {% if _load == 1 %}\r\n        where OPCO_VENDOR_ck not in (select distinct OPCO_VENDOR_ck from final)\r\n    {% else %}\r\n        where OPCO_VENDOR_ck not in (select distinct OPCO_VENDOR_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_ck not in (select distinct OPCO_VENDOR_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_VENDOR_ck in (select distinct OPCO_VENDOR_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_VENDOR where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDTABLE", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_vendor"], "unique_id": "model.OI_Foundation.ax_opco_vendor", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_vendor.sql", "original_file_path": "models/ax/product/ax_opco_vendor.sql", "name": "ax_opco_vendor", "alias": "ax_opco_vendor", "checksum": {"name": "sha256", "checksum": "244c9cb374b72adf4e58f9aa1d5fe8e99e441d6d7798e7cd020c61618222c046"}, "tags": [], "refs": [["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_dlvry_mode_curr"]], "sources": [["AX_DEV", "VENDTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.9447381}, "model.OI_Foundation.ax_opco_item_opco_assctn_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_OPCO_ASSCTN_XREF') %}\r\n\r\n\r\nwith ax_opco_item_opco_assctn_xref as(\r\n    select \r\n    oi.opco_item_sk,\r\n    oa.opco_assctn_sk,\r\n    current_timestamp as crt_dtm,\r\n    iil._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when iil._fivetran_deleted = true then iil._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    '' as opco_item_count_grp_sk,\r\n    '' as opco_item_scrap_type_sk,\r\n    'AX' as src_sys_nm,\r\n    iil.binlocation_opi as bin_locn_txt,\r\n    iil.buildinglocation_opi as bldg_locn_txt,\r\n    iil.cyds_opi as cubic_yrds_amt,\r\n    iil.cydsfixed_opi as cubic_yrds_fixed_amt,\r\n    iil.cydsvariable_opi as cubic_yrds_variable_amt,\r\n    iil.fixedweight_opi as fixed_wt_amt,\r\n    iil.glprodqty_opi as gl_prodn_qty,\r\n    iil.glsalesqty_opi as gl_sls_qty,\r\n    iil.laborhours_opi as labor_hrs_nbr,\r\n    iil.maxqtyonhand_opi as max_on_hand_qty,\r\n    iil.netweight_opi as net_wt_amt,\r\n    iil.prodabcd_opi as prodn_abcd_cd,\r\n    iil.prodflushingprinciple_opi as prodn_flushing_principle_cd,\r\n    iil.variableweight_opi as variable_wt_amt\r\n    from {{source('AX_DEV', 'INVENTITEMLOCATION')}} iil\r\n    left join {{ref('v_ax_opco_item_curr')}} oi \r\n        on iil.itemid = oi.src_item_cd\r\n        and iil.dataareaid = oi.opco_id\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_assctn_curr')}} oa \r\n        on iil.dataareaid = oa.opco_id\r\n        and iil.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    where iil.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n        opco_item_sk, opco_assctn_sk, \r\n        {{ dbt_utils.surrogate_key(['opco_item_count_grp_sk', 'opco_item_scrap_type_sk', 'src_sys_nm', 'bin_locn_txt', 'bldg_locn_txt', 'cubic_yrds_amt', 'cubic_yrds_fixed_amt', 'cubic_yrds_variable_amt', 'fixed_wt_amt', 'gl_prodn_qty', 'gl_sls_qty', 'labor_hrs_nbr', 'max_on_hand_qty', 'net_wt_amt', 'prodn_abcd_cd', 'prodn_flushing_principle_cd', 'variable_wt_amt']) }} as opco_item_opco_assctn_xref_ck,\r\n        crt_dtm, stg_load_dtm, delete_dtm, opco_item_count_grp_sk, opco_item_scrap_type_sk, src_sys_nm, bin_locn_txt, bldg_locn_txt, cubic_yrds_amt, cubic_yrds_fixed_amt, cubic_yrds_variable_amt, fixed_wt_amt, gl_prodn_qty, gl_sls_qty, labor_hrs_nbr, max_on_hand_qty, net_wt_amt, prodn_abcd_cd, prodn_flushing_principle_cd, variable_wt_amt\r\n    from ax_opco_item_opco_assctn_xref \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_OPCO_ASSCTN_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_OPCO_ASSCTN_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_item_sk, opco_assctn_sk, opco_item_opco_assctn_xref_ck, crt_dtm, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    opco_item_count_grp_sk, opco_item_scrap_type_sk, src_sys_nm, bin_locn_txt, bldg_locn_txt, cubic_yrds_amt, cubic_yrds_fixed_amt, cubic_yrds_variable_amt, fixed_wt_amt, gl_prodn_qty, gl_sls_qty, labor_hrs_nbr, max_on_hand_qty, net_wt_amt, prodn_abcd_cd, prodn_flushing_principle_cd, variable_wt_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_OPCO_ASSCTN_XREF\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_OPCO_ASSCTN_XREF_ck not in (select distinct OPCO_ITEM_OPCO_ASSCTN_XREF_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_OPCO_ASSCTN_XREF_ck not in (select distinct OPCO_ITEM_OPCO_ASSCTN_XREF_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_OPCO_ASSCTN_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_OPCO_ASSCTN_XREF_ck not in (select distinct OPCO_ITEM_OPCO_ASSCTN_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_OPCO_ASSCTN_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_OPCO_ASSCTN_XREF_ck in (select distinct OPCO_ITEM_OPCO_ASSCTN_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_OPCO_ASSCTN_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTITEMLOCATION", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_assctn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_opco_assctn_xref"], "unique_id": "model.OI_Foundation.ax_opco_item_opco_assctn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_opco_assctn_xref.sql", "original_file_path": "models/ax/product/ax_opco_item_opco_assctn_xref.sql", "name": "ax_opco_item_opco_assctn_xref", "alias": "ax_opco_item_opco_assctn_xref", "checksum": {"name": "sha256", "checksum": "27292a3cebf1ea292926ca2f7ca471fc4a1e32f7982d3c4fcd50c11218fe5767"}, "tags": [], "refs": [["v_ax_opco_item_curr"], ["v_ax_opco_assctn_curr"]], "sources": [["AX_DEV", "INVENTITEMLOCATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.9605465}, "model.OI_Foundation.ax_opco_purpose": {"raw_sql": "{% set _load = load_type('AX_OPCO_PURPOSE') %}\r\n\r\nwith ax_opco_purpose as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(num)::varchar(20) as src_purpose_cd,\r\n    max(upper(description))::varchar(100) as src_purpose_desc,\r\n    {{ spcl_chr_rp('src_purpose_cd')}}::varchar(20) as purpose_wo_spcl_chr_cd\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 3 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_purpose_cd, _fivetran_deleted\r\n),\r\nactv_ind_grouping as(\r\n    select upper(num) as src_purpose_cd,\r\n    avg(closed) as actv_ind\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 3 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_purpose_cd\r\n),\r\npre_final as (\r\n    select {{ dbt_utils.surrogate_key(['oip.src_sys_nm', 'oip.src_purpose_cd']) }} as opco_purpose_sk, oip.* , iff(aig.actv_ind=1, 0, 1)::numeric(1,0) as actv_ind \r\n    from ax_opco_purpose oip\r\n    inner join actv_ind_grouping aig \r\n        using(src_purpose_cd)  \r\n),\r\nfinal as (\r\n    select  opco_purpose_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_purpose_cd', 'src_purpose_desc', 'purpose_wo_spcl_chr_cd', 'actv_ind']) }} as opco_purpose_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_purpose_cd, src_purpose_desc, purpose_wo_spcl_chr_cd, actv_ind\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PURPOSE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PURPOSE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PURPOSE_SK, OPCO_PURPOSE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_purpose_cd, src_purpose_desc, purpose_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE\r\n    {% if _load == 1 %}\r\n        where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final)\r\n    {% else %}\r\n        where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_purpose"], "unique_id": "model.OI_Foundation.ax_opco_purpose", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_purpose.sql", "original_file_path": "models/ax/product/ax_opco_purpose.sql", "name": "ax_opco_purpose", "alias": "ax_opco_purpose", "checksum": {"name": "sha256", "checksum": "8b377cceaa961a3ec023c159d5f230500dfc119c1776a04485515d882196fcb6"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DIMENSIONS"], ["AX_DEV", "DIMENSIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.9747791}, "model.OI_Foundation.ax_opco_invtry_trans_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_invtry_trans_type as (\r\n  {% set values = [ 'Sales Order', 'Production', 'Purchase Order', 'Transaction', 'Profit/Loss', 'Transfer', 'Weighted Average Inventory Closing', 'Production Line', 'BOM Line', 'BOM', 'Output Order', 'Project', 'Counting', 'Pallet Transport', 'Quarantine Order', 'Outdated', 'Fixed Assets', 'Transfer Order - Shipment', 'Tranfer Order - Receive', 'Transfer Order - Scrap', 'Quotation', 'Quality Order' ] %}\r\n  {% set num = [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 20, 21, 22, 23, 24, 25] %}\r\n\r\n  {% for i in range(22) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{num[i]}} as invtry_trans_type_cd,\r\n          '{{values[i]}}' as invtry_trans_type_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_trans_type_cd']) }} as opco_invtry_trans_type_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_trans_type_cd', 'invtry_trans_type_desc']) }} as opco_invtry_trans_type_ck,\r\n            *\r\n    from opco_invtry_trans_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_invtry_trans_type"], "unique_id": "model.OI_Foundation.ax_opco_invtry_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_invtry_trans_type.sql", "original_file_path": "models/ax/product/ax_opco_invtry_trans_type.sql", "name": "ax_opco_invtry_trans_type", "alias": "ax_opco_invtry_trans_type", "checksum": {"name": "sha256", "checksum": "57936e06f1a62a8ae297c29216ae0eec73dbd961f4808b2dcf00efe02dc0043e"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086793.987345}, "model.OI_Foundation.ax_opco_item_class": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_CLASS') %}\r\n\r\nwith ax_opco_item_class as(\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(inventproductclassid_opi) as src_item_class_cd,\r\n    max(name_opi) as src_item_class_desc\r\n    from {{source('AX_DEV', 'INVENTPRODUCTCLASS_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_item_class_cd, _fivetran_deleted \r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_class_cd']) }} as opco_item_class_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_class_cd', 'src_item_class_desc']) }} as opco_item_class_ck,\r\n            * \r\n    from ax_opco_item_class\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_CLASS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_CLASS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_CLASS_SK, OPCO_ITEM_CLASS_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_ITEM_CLASS_cd, src_ITEM_CLASS_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CLASS\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_CLASS_ck not in (select distinct OPCO_ITEM_CLASS_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_CLASS_ck not in (select distinct OPCO_ITEM_CLASS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CLASS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n   \r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_CLASS_ck not in (select distinct OPCO_ITEM_CLASS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CLASS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_CLASS_ck in (select distinct OPCO_ITEM_CLASS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CLASS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_class"], "unique_id": "model.OI_Foundation.ax_opco_item_class", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_class.sql", "original_file_path": "models/ax/product/ax_opco_item_class.sql", "name": "ax_opco_item_class", "alias": "ax_opco_item_class", "checksum": {"name": "sha256", "checksum": "c41bfdc3c8437cfeecce7bac405fce6908023cc0a48a80add63a792a9f0a9df4"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTPRODUCTCLASS_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086793.996925}, "model.OI_Foundation.ax_opco_item_type": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_TYPE') %}\r\n\r\nwith ax_opco_item_type as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(category_opi) as src_item_type_cd,\r\n    max(description_opi) as src_item_type_desc\r\n    from {{source('AX_DEV', 'INVENTPRECASTCATEGORY_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_item_type_cd, _fivetran_deleted\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_type_cd']) }} as opco_item_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_type_cd', 'src_item_type_desc']) }} as OPCO_ITEM_TYPE_ck, * \r\n    from ax_opco_item_type\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_TYPE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_TYPE_SK, OPCO_ITEM_TYPE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_type_cd, src_item_type_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_TYPE\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_TYPE_ck not in (select distinct OPCO_ITEM_TYPE_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_TYPE_ck not in (select distinct OPCO_ITEM_TYPE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_TYPE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_TYPE_ck not in (select distinct OPCO_ITEM_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_TYPE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_TYPE_ck in (select distinct OPCO_ITEM_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_TYPE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_type"], "unique_id": "model.OI_Foundation.ax_opco_item_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_type.sql", "original_file_path": "models/ax/product/ax_opco_item_type.sql", "name": "ax_opco_item_type", "alias": "ax_opco_item_type", "checksum": {"name": "sha256", "checksum": "84eca98a4817c1eaf58c9eeb8e11b930dabefaf66858518a77a76fc7b8e31b6a"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTPRECASTCATEGORY_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.0086448}, "model.OI_Foundation.ax_opco_item_cvrg_grp": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_CVRG_GRP') %}\r\n\r\nwith ax_opco_item_cvrg_grp as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(reqgroupid) as src_item_cvrg_grp_cd,\r\n    dataareaid as opco_id,\r\n    name as src_item_cvrg_grp_desc\r\n    from {{source('AX_DEV', 'REQGROUP')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_cvrg_grp_cd']) }} as opco_item_cvrg_grp_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_cvrg_grp_cd','src_item_cvrg_grp_desc']) }} as opco_ITEM_CVRG_GRP_ck,\r\n            * \r\n    from ax_opco_item_cvrg_grp \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_CVRG_GRP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_CVRG_GRP') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_CVRG_GRP_SK, OPCO_ITEM_CVRG_GRP_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_cvrg_grp_cd, opco_id, src_item_cvrg_grp_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CVRG_GRP\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_CVRG_GRP_ck not in (select distinct OPCO_ITEM_CVRG_GRP_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_CVRG_GRP_ck not in (select distinct OPCO_ITEM_CVRG_GRP_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CVRG_GRP where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n    \r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_CVRG_GRP_ck not in (select distinct OPCO_ITEM_CVRG_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CVRG_GRP where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_CVRG_GRP_ck in (select distinct OPCO_ITEM_CVRG_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_CVRG_GRP where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.REQGROUP"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_cvrg_grp"], "unique_id": "model.OI_Foundation.ax_opco_item_cvrg_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_cvrg_grp.sql", "original_file_path": "models/ax/product/ax_opco_item_cvrg_grp.sql", "name": "ax_opco_item_cvrg_grp", "alias": "ax_opco_item_cvrg_grp", "checksum": {"name": "sha256", "checksum": "0b81914c051aea746e9af544dd647f32ddf2c0d17dedfe121ab20c54fa5978ec"}, "tags": [], "refs": [], "sources": [["AX_DEV", "REQGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.020052}, "model.OI_Foundation.ax_opco_invtry_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_INVTRY_TRANS') %}\r\n\r\nwith ax_opco_invtry_trans as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    it._fivetran_synced as stg_load_dtm,\r\n    case \r\n        when it._fivetran_deleted = true then it._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    it.dataareaid as opco_id,\r\n    it.recid as src_key_txt,\r\n    opco.opco_sk,\r\n    oc.opco_cust_sk,\r\n    ov.opco_vendor_sk,\r\n    oi.opco_item_sk,\r\n    oa.opco_assctn_sk,\r\n    ocu.opco_currency_sk as trans_currency_sk,\r\n    oitt.opco_invtry_trans_type_sk,\r\n    op.opco_project_sk,\r\n    opc.opco_project_catgry_sk,\r\n    opl.opco_picking_list_sk,\r\n    oiis.opco_invtry_issue_status_sk,\r\n    oirc.opco_invtry_rcpt_status_sk,\r\n    it.inventtransid as invtry_trans_id,\r\n    it.inventtransidfather as parent_invtry_trans_id,\r\n    it.inventtransidreturn as invtry_return_trans_id,\r\n    it.inventtransidtransfer as invtry_transfer_trans_id,\r\n    it.inventreftransid as ref_invtry_trans_id,\r\n    it.transrefid as trans_ref_id,\r\n    it.itemrouteid as item_route_id,\r\n    it.itembomid as item_bom_id,\r\n    it.assetid as asset_id,\r\n    it.packingslipid as packing_slip_id,\r\n    it.projadjustrefid as project_adjstmt_ref_id,\r\n    it.datephysical as trans_dt,\r\n    it.datestatus as trans_status_dt,\r\n    it.datefinancial as financial_trans_dt,\r\n    it.dateclosed as financial_close_dt,\r\n    it.shippingdaterequested as rqst_ship_dt,\r\n    it.shippingdateconfirmed as cnfrm_ship_dt,\r\n    it.dateexpected as item_expctd_movement_dt,\r\n    case \r\n        when it.direction in (0,1) then it.dateinvent\r\n    end as invtry_qty_registered_dt,\r\n    case \r\n        when it.direction in (0,2) then it.dateinvent\r\n    end as invtry_qty_picked_dt,\r\n    it.invoiceid as invoice_nbr,\r\n    it.voucher as voucher_nbr,\r\n    it.voucherphysical as invtry_updt_voucher_nbr,\r\n    it.packingslipreturned as packing_slip_returned_item_ind,\r\n    it.invoicereturned as invoice_returned_item_ind,\r\n    it.intercompanytransfer_opi as intercompany_transfer_ind,\r\n    it.transchildrefid as invtry_order_prcs_nbr,\r\n    case \r\n        when it.transchildtype = 0 then NULL\r\n        when it.transchildtype = 1 then 'Output Order'\r\n        when it.transchildtype = 2 then 'Prod Picking List Journal'\r\n        when it.transchildtype = 3 then 'Prod Reported As Finished Journal'\r\n        when it.transchildtype = 4 then 'Inventory - Picking List Journal'\r\n    end as invtry_order_prcs_type_txt,\r\n    case\r\n        when it.valueopen = 0 then 'No'\r\n        when it.valueopen = 1 then 'Yes'\r\n        when it.valueopen = 2 then 'Quotation'\r\n    end as trans_open_txt,\r\n    case\r\n        when it.direction = 0 then NULL\r\n        when it.direction = 1 then 'Receipt'\r\n        when it.direction = 2 then 'Issue'\r\n    end as invtry_trans_direction_txt,\r\n    it.qty as trans_qty,\r\n    it.qtysettled as settled_qty,\r\n    it.costamountposted as posted_cost_amt,\r\n    it.costamountadjustment as adjstmt_cost_amt,\r\n    it.costamountoperations as operations_cost_amt,\r\n    it.costamountsettled as settled_cost_amt,\r\n    it.costamountstd as std_cost_amt,\r\n    it.costamountphysical as invtry_updt_qty_cost_amt,\r\n    it.revenueamountphysical as invtry_updt_qty_revenue_amt\r\n    from {{ source('AX_DEV', 'INVENTTRANS') }} it \r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on it.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} oc\r\n        on it.dataareaid = oc.opco_id\r\n        and it.custvendac = oc.cust_id\r\n        and it.direction = 2\r\n        and it.custvendac <> ''\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_vendor_curr')}} ov\r\n        on upper(it.custvendac) = ov.vendor_id\r\n        and it.direction = 1\r\n        and it.custvendac <> ''\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on it.dataareaid = oi.opco_id\r\n        and it.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa \r\n        on it.dataareaid = oa.opco_id\r\n        and it.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocu\r\n        on upper(it.currencycode) = ocu.src_currency_cd\r\n        and ocu.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_trans_type_curr')}} oitt \r\n        on it.transtype = oitt.invtry_trans_type_cd\r\n        and oitt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_curr')}} op \r\n        on it.dataareaid = op.opco_id\r\n        and it.projid = op.project_id\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc \r\n        on it.dataareaid = opc.opco_id\r\n        and it.projcategoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_picking_list_curr')}} opl \r\n        on it.dataareaid = opl.opco_id\r\n        and it.pickingrouteid = opl.picking_list_id\r\n        and opl.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_issue_status_curr')}} oiis \r\n        on it.statusissue = oiis.invtry_issue_status_cd\r\n        and oiis.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_invtry_rcpt_status_curr')}} oirc \r\n        on it.statusreceipt = oirc.invtry_rcpt_status_cd\r\n        and oirc.src_sys_nm = 'AX'\r\n    where it.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','src_key_txt']) }} as opco_invtry_trans_sk,\r\n\t\t\t{{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_sk', 'opco_cust_sk', 'opco_vendor_sk', 'opco_item_sk', 'opco_assctn_sk', 'trans_currency_sk', 'opco_invtry_trans_type_sk', 'opco_project_sk', 'opco_project_catgry_sk', 'opco_picking_list_sk', 'opco_invtry_issue_status_sk', 'opco_invtry_rcpt_status_sk', 'invtry_trans_id', 'parent_invtry_trans_id', 'invtry_return_trans_id', 'invtry_transfer_trans_id', 'ref_invtry_trans_id', 'trans_ref_id', 'item_route_id', 'item_bom_id', 'asset_id', 'packing_slip_id', 'project_adjstmt_ref_id', 'trans_dt', 'trans_status_dt', 'financial_trans_dt', 'financial_close_dt', 'rqst_ship_dt', 'cnfrm_ship_dt', 'item_expctd_movement_dt', 'invtry_qty_registered_dt', 'invtry_qty_picked_dt', 'invoice_nbr', 'voucher_nbr', 'invtry_updt_voucher_nbr', 'packing_slip_returned_item_ind', 'invoice_returned_item_ind', 'intercompany_transfer_ind', 'invtry_order_prcs_nbr', 'invtry_order_prcs_type_txt', 'trans_open_txt', 'invtry_trans_direction_txt', 'trans_qty', 'settled_qty', 'posted_cost_amt', 'adjstmt_cost_amt', 'operations_cost_amt', 'settled_cost_amt', 'std_cost_amt', 'invtry_updt_qty_cost_amt', 'invtry_updt_qty_revenue_amt']) }} as opco_invtry_trans_ck,\r\n\t\t\tconcat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_invtry_trans_ak, \r\n            * \t\t\r\n    from ax_opco_invtry_trans \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_INVTRY_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_INVTRY_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_INVTRY_TRANS_SK, OPCO_INVTRY_TRANS_CK, OPCO_INVTRY_TRANS_AK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n\tsrc_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_sk, opco_vendor_sk, opco_item_sk, opco_assctn_sk, trans_currency_sk, opco_invtry_trans_type_sk, opco_project_sk, opco_project_catgry_sk, opco_picking_list_sk, opco_invtry_issue_status_sk, opco_invtry_rcpt_status_sk, invtry_trans_id, parent_invtry_trans_id, invtry_return_trans_id, invtry_transfer_trans_id, ref_invtry_trans_id, trans_ref_id, item_route_id, item_bom_id, asset_id, packing_slip_id, project_adjstmt_ref_id, trans_dt, trans_status_dt, financial_trans_dt, financial_close_dt, rqst_ship_dt, cnfrm_ship_dt, item_expctd_movement_dt, invtry_qty_registered_dt, invtry_qty_picked_dt, invoice_nbr, voucher_nbr, invtry_updt_voucher_nbr, packing_slip_returned_item_ind, invoice_returned_item_ind, intercompany_transfer_ind, invtry_order_prcs_nbr, invtry_order_prcs_type_txt, trans_open_txt, invtry_trans_direction_txt, trans_qty, settled_qty, posted_cost_amt, adjstmt_cost_amt, operations_cost_amt, settled_cost_amt, std_cost_amt, invtry_updt_qty_cost_amt, invtry_updt_qty_revenue_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_INVTRY_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_INVTRY_TRANS_ck not in (select distinct OPCO_INVTRY_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_INVTRY_TRANS_ck not in (select distinct OPCO_INVTRY_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_INVTRY_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_INVTRY_TRANS_ck not in (select distinct OPCO_INVTRY_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_INVTRY_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_INVTRY_TRANS_ck in (select distinct OPCO_INVTRY_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_INVTRY_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTTRANS", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr", "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_invtry_trans"], "unique_id": "model.OI_Foundation.ax_opco_invtry_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_invtry_trans.sql", "original_file_path": "models/ax/product/ax_opco_invtry_trans.sql", "name": "ax_opco_invtry_trans", "alias": "ax_opco_invtry_trans", "checksum": {"name": "sha256", "checksum": "ffb5b2bb3648bfbe7a56340bf8bbcbb9eb057f8e96d9020bec643c6641bcdc33"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_invtry_trans_type_curr"], ["v_ax_opco_project_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_picking_list_curr"], ["v_ax_opco_invtry_issue_status_curr"], ["v_ax_opco_invtry_rcpt_status_curr"]], "sources": [["AX_DEV", "INVENTTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.0320175}, "model.OI_Foundation.ax_opco_item": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM') %}\r\n\r\nwith ax_opco_item as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    it._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when it._fivetran_deleted = true then it._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    it.itemid as src_item_cd,\r\n    it.dataareaid as opco_id,\r\n    it.itemname as src_item_nm,\r\n    oit.opco_item_type_sk,\r\n    ois.opco_item_subtype_sk,\r\n    ou.opco_uom_sk,\r\n    ocg.opco_commsn_grp_sk,\r\n    '' as opco_item_dim_grp_sk,\r\n    '' as opco_item_buyer_grp_sk,\r\n    oig.opco_item_grp_sk,\r\n    oim.opco_item_model_grp_sk,\r\n    ov.opco_vendor_sk as primary_vendor_sk,\r\n    oic.opco_item_class_sk,\r\n    oicg.opco_item_cvrg_grp_sk,\r\n    oisc.opco_item_sls_class_sk,\r\n    oip.opco_purpose_sk,\r\n    iff(it.stopped_opi=0, 1, 0) as actv_ind,\r\n    it.height as height_nbr,\r\n    it.width as width_nbr,\r\n    it.depth as depth_nbr,\r\n    it.netweight as net_wt_nbr,\r\n    it.costmodel as cost_model_ind,\r\n    it.costgroupid as cost_group_txt,\r\n    it.createddatetime as src_crt_dtm,\r\n    it.createdby as src_crt_by,\r\n    it.modifieddatetime as src_updt_dtm,\r\n    it.modifiedby as src_updt_by,\r\n    ol.opco_lob_sk,\r\n    it.explicitfreight_opi as explicit_freight_ind,\r\n    it.form_opi as form_id_txt,\r\n    it.formgroup_opi as form_grp_txt,\r\n    it.itemmold_opi as item_mold_txt,\r\n    case \r\n        when it.itemtype = 0\r\n        then 'Item'\r\n        when it.itemtype = 1\r\n        then 'BOM'\r\n        when it.itemtype = 2\r\n        then 'Service'\r\n        else null\r\n    end as item_admnstrn_type_desc,\r\n    it.kits_opi as kits_ind,\r\n    it.pcat_opi as item_catgry_txt,\r\n    it.phantom as phantom_item_ind,\r\n    it.purchmodel as purchase_price_updt_ind,\r\n    it.shippingclass_opi as shipping_class_txt,\r\n    it.skufamily_opi as sku_family_txt,\r\n    it.subpcat_opi as item_subcatgry_txt,\r\n    it.upccarton_opi as carton_upc_txt,\r\n    it.upcitem_opi as item_upc_txt,\r\n    it.vitalitydate_opi as vitality_dt,\r\n    case\r\n        when tier_opi = 0 then 'None'\r\n        when tier_opi = 1 then '1'\r\n        when tier_opi = 2 then '2'\r\n        when tier_opi = 3 then '3'\r\n        when tier_opi = 4 then 'A'\r\n        when tier_opi = 5 then 'B'\r\n        when tier_opi = 6 then 'C'\r\n    end as tier_txt\r\n    from {{source('AX_DEV', 'INVENTTABLE')}} it \r\n    left join {{ref('v_ax_opco_item_type_curr')}} oit \r\n        on upper(it.precastcategory_opi) = oit.src_item_type_cd\r\n        and oit.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_subtype_curr')}} ois \r\n        on it.precastcode_opi = ois.src_item_subtype_desc\r\n        and upper(it.precastcategory_opi) = ois.src_item_type_cd\r\n        and ois.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(it.bomunitid) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_commsn_grp_curr')}} ocg \r\n        on upper(it.commissiongroupid) = ocg.src_commsn_grp_cd\r\n        and ocg.src_sys_nm ='AX'\r\n    left join {{ref('v_ax_opco_item_grp_curr')}} oig \r\n        on upper(it.itemgroupid) = oig.src_item_grp_cd\r\n        and it.dataareaid = oig.opco_id\r\n        and oig.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_model_grp_curr')}} oim \r\n        on upper(it.modelgroupid) = oim.src_item_model_grp_cd\r\n        and oim.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(it.primaryvendorid) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_class_curr')}} oic \r\n        on upper(it.productclassid_opi) = oic.src_item_class_cd\r\n        and oic.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_cvrg_grp_curr')}} oicg \r\n        on upper(it.reqgroupid) = oicg.src_item_cvrg_grp_cd\r\n        and it.dataareaid = oicg.opco_id\r\n        and oicg.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_sls_class_curr')}} oisc \r\n        on upper(it.salesclassid_opi) = oisc.src_item_sls_class_cd\r\n        and oisc.src_sys_nm = 'AX' \r\n    left join {{ref('v_ax_opco_purpose_curr')}} oip \r\n        on upper(it.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(it.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    where it.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_cd']) }} as opco_item_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_cd', 'src_item_nm', 'opco_item_type_sk', 'opco_item_subtype_sk', 'opco_uom_sk', 'opco_commsn_grp_sk', 'opco_item_dim_grp_sk', 'opco_item_buyer_grp_sk', 'opco_item_grp_sk', 'opco_item_model_grp_sk', 'primary_vendor_sk', 'opco_item_class_sk', 'opco_item_cvrg_grp_sk', 'opco_item_sls_class_sk', 'opco_purpose_sk', 'actv_ind', 'height_nbr', 'width_nbr', 'depth_nbr', 'net_wt_nbr', 'cost_model_ind', 'cost_group_txt', 'src_crt_dtm', 'src_crt_by', 'src_updt_dtm', 'src_updt_by', 'opco_lob_sk', 'explicit_freight_ind', 'form_id_txt', 'form_grp_txt', 'item_mold_txt', 'item_admnstrn_type_desc', 'kits_ind', 'item_catgry_txt', 'phantom_item_ind', 'purchase_price_updt_ind', 'shipping_class_txt', 'sku_family_txt', 'item_subcatgry_txt', 'carton_upc_txt', 'item_upc_txt', 'vitality_dt', 'tier_txt']) }} as opco_ITEM_ck,\r\n            * \r\n    from ax_opco_item\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_SK, OPCO_ITEM_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_item_cd, src_item_nm, opco_item_type_sk, opco_item_subtype_sk, opco_uom_sk, opco_commsn_grp_sk, opco_item_dim_grp_sk, opco_item_buyer_grp_sk, opco_item_grp_sk, opco_item_model_grp_sk, primary_vendor_sk, opco_item_class_sk, opco_item_cvrg_grp_sk, opco_item_sls_class_sk, opco_purpose_sk, actv_ind, height_nbr, width_nbr, depth_nbr, net_wt_nbr, cost_model_ind, cost_group_txt, src_crt_dtm, src_crt_by, src_updt_dtm, src_updt_by, opco_lob_sk, explicit_freight_ind, form_id_txt, form_grp_txt, item_mold_txt, item_admnstrn_type_desc, kits_ind, item_catgry_txt, phantom_item_ind, purchase_price_updt_ind, shipping_class_txt, sku_family_txt, item_subcatgry_txt, carton_upc_txt, item_upc_txt, vitality_dt, tier_txt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_ck not in (select distinct OPCO_ITEM_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_ck not in (select distinct OPCO_ITEM_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_ck not in (select distinct OPCO_ITEM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_ck in (select distinct OPCO_ITEM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTTABLE", "model.OI_Foundation.v_ax_opco_item_type_curr", "model.OI_Foundation.v_ax_opco_item_subtype_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_commsn_grp_curr", "model.OI_Foundation.v_ax_opco_item_grp_curr", "model.OI_Foundation.v_ax_opco_item_model_grp_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_item_class_curr", "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr", "model.OI_Foundation.v_ax_opco_item_sls_class_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item"], "unique_id": "model.OI_Foundation.ax_opco_item", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item.sql", "original_file_path": "models/ax/product/ax_opco_item.sql", "name": "ax_opco_item", "alias": "ax_opco_item", "checksum": {"name": "sha256", "checksum": "6e57c6c579d289b9e7dcf122e4f4da765ed94ecfaf4f20c1600916a2e6d2c978"}, "tags": [], "refs": [["v_ax_opco_item_type_curr"], ["v_ax_opco_item_subtype_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_commsn_grp_curr"], ["v_ax_opco_item_grp_curr"], ["v_ax_opco_item_model_grp_curr"], ["v_ax_opco_vendor_curr"], ["v_ax_opco_item_class_curr"], ["v_ax_opco_item_cvrg_grp_curr"], ["v_ax_opco_item_sls_class_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"]], "sources": [["AX_DEV", "INVENTTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.0555048}, "model.OI_Foundation.ax_opco_invtry_issue_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_invtry_issue_status as (\r\n  {% set values = [ 'Sold', 'Deducted', 'Picked', 'Reserved Physical', 'Reserved Ordered', 'On Order', 'Quotation Issue' ] %}\r\n\r\n  {% for i in range(8) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{i}} as invtry_issue_status_cd,\r\n          {% if i == 0 %}\r\n            null as invtry_issue_status_desc\r\n          {% else %}\r\n            '{{values[i-1]}}' as invtry_issue_status_desc\r\n          {% endif %}\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_issue_status_cd']) }} as opco_invtry_issue_status_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_issue_status_cd', 'invtry_issue_status_desc']) }} as opco_invtry_issue_status_ck,\r\n            *\r\n    from opco_invtry_issue_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_invtry_issue_status"], "unique_id": "model.OI_Foundation.ax_opco_invtry_issue_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_invtry_issue_status.sql", "original_file_path": "models/ax/product/ax_opco_invtry_issue_status.sql", "name": "ax_opco_invtry_issue_status", "alias": "ax_opco_invtry_issue_status", "checksum": {"name": "sha256", "checksum": "49b75fd91eead51b62a3fefcc178bca12476592e0f36d88e1f6603be0fc056aa"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.0762715}, "model.OI_Foundation.ax_opco_item_model_grp": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_MODEL_GRP') %}\r\n\r\nwith ax_opco_item_model_grp as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(modelgroupid) as src_item_model_grp_cd,\r\n    max(name) as src_item_model_grp_nm\r\n    from {{source('AX_DEV', 'INVENTMODELGROUP')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_item_model_grp_cd, _fivetran_deleted   \r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_model_grp_cd']) }} as opco_item_model_grp_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_model_grp_cd', 'src_item_model_grp_nm']) }} as OPCO_ITEM_MODEL_GRP_ck, \r\n            * \r\n    from ax_opco_item_model_grp\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_MODEL_GRP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_MODEL_GRP') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_MODEL_GRP_SK, OPCO_ITEM_MODEL_GRP_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_model_grp_cd, src_item_model_grp_nm\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_MODEL_GRP\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_MODEL_GRP_ck not in (select distinct OPCO_ITEM_MODEL_GRP_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_MODEL_GRP_ck not in (select distinct OPCO_ITEM_MODEL_GRP_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_MODEL_GRP where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_MODEL_GRP_ck not in (select distinct OPCO_ITEM_MODEL_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_MODEL_GRP where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_MODEL_GRP_ck in (select distinct OPCO_ITEM_MODEL_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_MODEL_GRP where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTMODELGROUP"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_model_grp"], "unique_id": "model.OI_Foundation.ax_opco_item_model_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_model_grp.sql", "original_file_path": "models/ax/product/ax_opco_item_model_grp.sql", "name": "ax_opco_item_model_grp", "alias": "ax_opco_item_model_grp", "checksum": {"name": "sha256", "checksum": "fd7d89ef518eb2f33f73ed3982594ff7e1e53262aa95de3f1d9883f34374a075"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTMODELGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.0847418}, "model.OI_Foundation.ax_opco_item_grp": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_GRP') %}\r\n\r\nwith ax_opco_item_grp as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    itg._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when itg._fivetran_deleted = true then itg._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(itg.itemgroupid) as src_item_grp_cd,\r\n    itg.dataareaid as opco_id,\r\n    itg.name as src_item_grp_desc,\r\n    ou1.opco_uom_sk as prodn_uom_sk,\r\n    ou2.opco_uom_sk as sales_uom_sk,\r\n    oif.opco_item_freight_sk as opco_item_freight_sk,\r\n    itg.capexonly_opi as capex_only_ind,\r\n    itg.calccategory_opi as calc_category_cd,\r\n    itg.dimension_opi3_ as item_grp_type_txt,\r\n    itg.ef_opi as explicit_freight_ind,\r\n    itg.efpercentage_opi as explicit_freight_pct,\r\n    itg.freight_opi as freight_pct,\r\n    itg.icmarkuppercent_opi as ic_markup_pct,\r\n    itg.if_opi as imbedded_freight_ind,\r\n    itg.ifpercentage_opi as imbedded_freight_pct,\r\n    itg.markup_opi as markup_pct,\r\n    itg.projectonly_opi as project_only_ind,\r\n    itg.projcategoryid_opi as project_ctgry_cd\r\n    from {{source('AX_DEV', 'INVENTITEMGROUP')}} itg \r\n    left join {{ref('v_ax_opco_uom_curr')}} ou1 \r\n        on upper(itg.glproduom_opi) = ou1.src_uom_cd\r\n        and ou1.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou2 \r\n        on upper(itg.glsalesuom_opi) = ou2.src_uom_cd\r\n        and ou2.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_freight_curr')}} oif \r\n        on upper(itg.ifitemid_opi) = oif.src_item_freight_cd\r\n        and oif.src_sys_nm = 'AX'\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_grp_cd']) }} as opco_item_grp_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_grp_cd', 'opco_id', 'src_item_grp_desc', 'prodn_uom_sk', 'sales_uom_sk', 'opco_item_freight_sk', 'capex_only_ind', 'calc_category_cd', 'item_grp_type_txt', 'explicit_freight_ind', 'explicit_freight_pct', 'freight_pct', 'ic_markup_pct', 'imbedded_freight_ind', 'markup_pct', 'project_only_ind', 'project_ctgry_cd']) }} as OPCO_ITEM_GRP_ck,\r\n            * \r\n    from ax_opco_item_grp\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_GRP') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_GRP') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_GRP_SK, OPCO_ITEM_GRP_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_grp_cd, opco_id, src_item_grp_desc, prodn_uom_sk, sales_uom_sk, opco_item_freight_sk, capex_only_ind, calc_category_cd, item_grp_type_txt, explicit_freight_ind, explicit_freight_pct, freight_pct, ic_markup_pct, imbedded_freight_ind, markup_pct, project_only_ind, project_ctgry_cd\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_GRP\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_GRP_ck not in (select distinct OPCO_ITEM_GRP_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_GRP_ck not in (select distinct OPCO_ITEM_GRP_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_GRP where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_GRP_ck not in (select distinct OPCO_ITEM_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_GRP where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_GRP_ck in (select distinct OPCO_ITEM_GRP_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_GRP where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTITEMGROUP", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_item_freight_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_grp"], "unique_id": "model.OI_Foundation.ax_opco_item_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_grp.sql", "original_file_path": "models/ax/product/ax_opco_item_grp.sql", "name": "ax_opco_item_grp", "alias": "ax_opco_item_grp", "checksum": {"name": "sha256", "checksum": "67977197478add6f80ed0893de9eced1681655115d746a2476ff978d410eb8a8"}, "tags": [], "refs": [["v_ax_opco_uom_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_item_freight_curr"]], "sources": [["AX_DEV", "INVENTITEMGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.0969028}, "model.OI_Foundation.ax_opco_invtry_rcpt_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_invtry_rcpt_status as (\r\n  {% set values = [ 'Purchased', 'Received', 'Registered', 'Arrived', 'Ordered', 'Quotation Receipt' ] %}\r\n\r\n  {% for i in range(7) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{i}} as invtry_rcpt_status_cd,\r\n          {% if i == 0 %}\r\n            null as invtry_rcpt_status_desc\r\n          {% else %}\r\n            '{{values[i-1]}}' as invtry_rcpt_status_desc\r\n          {% endif %}\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_rcpt_status_cd']) }} as opco_invtry_rcpt_status_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'invtry_rcpt_status_cd', 'invtry_rcpt_status_desc']) }} as opco_invtry_rcpt_status_ck,\r\n            *\r\n    from opco_invtry_rcpt_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_invtry_rcpt_status"], "unique_id": "model.OI_Foundation.ax_opco_invtry_rcpt_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_invtry_rcpt_status.sql", "original_file_path": "models/ax/product/ax_opco_invtry_rcpt_status.sql", "name": "ax_opco_invtry_rcpt_status", "alias": "ax_opco_invtry_rcpt_status", "checksum": {"name": "sha256", "checksum": "f3960fad8f44313d138326a87bdd661fc7ec9b15348df1f3fc4d5a0e548c3ca2"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.1113384}, "model.OI_Foundation.ax_opco_item_freight": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_FREIGHT') %}\r\n\r\nwith ax_opco_item_freight as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    it._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when it._fivetran_deleted = true then it._fivetran_synced \r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(it.itemgroupid) as src_item_freight_cd,\r\n    it.dataareaid as opco_id,\r\n    it.itemname as src_item_freight_nm\r\n    from {{source('AX_DEV', 'INVENTTABLE')}} it\r\n    join {{source('AX_DEV', 'INVENTITEMGROUP')}} itg \r\n        on it.dataareaid = itg.dataareaid\r\n        and it.itemid = itg.ifitemid_opi\r\n        and itg._fivetran_deleted = false\r\n    where it.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_freight_cd']) }} as opco_item_freight_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_freight_cd','src_item_freight_nm']) }} as OPCO_ITEM_FREIGHT_ck,\r\n            * \r\n    from ax_opco_item_freight\r\n)\r\n    \r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_FREIGHT') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_FREIGHT') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_FREIGHT_SK, OPCO_ITEM_FREIGHT_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_freight_cd, opco_id, src_item_freight_nm\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_FREIGHT\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_FREIGHT_ck not in (select distinct OPCO_ITEM_FREIGHT_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_FREIGHT_ck not in (select distinct OPCO_ITEM_FREIGHT_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_FREIGHT where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_FREIGHT_ck not in (select distinct OPCO_ITEM_FREIGHT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_FREIGHT where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_FREIGHT_ck in (select distinct OPCO_ITEM_FREIGHT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_FREIGHT where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTTABLE", "source.OI_Foundation.AX_DEV.INVENTITEMGROUP"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_freight"], "unique_id": "model.OI_Foundation.ax_opco_item_freight", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_freight.sql", "original_file_path": "models/ax/product/ax_opco_item_freight.sql", "name": "ax_opco_item_freight", "alias": "ax_opco_item_freight", "checksum": {"name": "sha256", "checksum": "36dbdbcc3ca5216820f0f144eb48659b20af867c88b440be93346fe78bc15fa2"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTTABLE"], ["AX_DEV", "INVENTITEMGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1197777}, "model.OI_Foundation.ax_opco_item_psi_dtl": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_PSI_DTL') %}\r\n\r\nwith ax_opco_item_psi_dtl as (\r\n    select\r\n    current_timestamp as crt_dtm, \r\n    it._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when it._fivetran_deleted = true then it._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    it.itemid as src_item_cd,\r\n    it.dataareaid as opco_id,\r\n    case \r\n        when it.moduletype =  0 then 'Inventory'\r\n        when it.moduletype =  1 then 'Purchase Order'\r\n        when it.moduletype =  2 then 'Sales Order'\r\n    end as psi_type_txt,\r\n    oi.opco_item_sk,\r\n    ou.opco_uom_sk,\r\n    it.pricedate as psi_price_dt,\r\n    it.price as psi_price_amt,\r\n    it.priceunit as psi_price_unit_qty,\r\n    it.del_quantity as psi_dlvry_qty,\r\n    it.linedisc as psi_line_dscnt_amt\r\n    from {{source('AX_DEV', 'INVENTTABLEMODULE')}} it \r\n    left join {{ref('v_ax_opco_item_curr')}} oi \r\n        on it.dataareaid = oi.opco_id \r\n        and it.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(it.unitid) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where it.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_cd', 'psi_type_txt']) }} as opco_item_psi_dtl_sk,\r\n            {{ dbt_utils.surrogate_key([ 'src_sys_nm',  'src_item_cd',  'opco_id',  'psi_type_txt',  'opco_item_sk',  'opco_uom_sk',  'psi_price_dt',  'psi_price_amt',  'psi_price_unit_qty',  'psi_dlvry_qty',  'psi_line_dscnt_amt']) }} as opco_item_psi_dtl_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, src_item_cd, psi_type_txt) as opco_item_psi_dtl_ak, \r\n            * \r\n    from ax_opco_item_psi_dtl \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_PSI_DTL') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_PSI_DTL') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_PSI_DTL_SK, OPCO_ITEM_PSI_DTL_CK, opco_item_psi_dtl_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, src_item_cd, psi_type_txt, psi_price_dt, psi_price_amt, psi_price_unit_qty, psi_dlvry_qty, psi_line_dscnt_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_PSI_DTL\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_PSI_DTL_ck not in (select distinct OPCO_ITEM_PSI_DTL_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_PSI_DTL_ck not in (select distinct OPCO_ITEM_PSI_DTL_ck from final) \r\n             and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_PSI_DTL where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_PSI_DTL_ck not in (select distinct OPCO_ITEM_PSI_DTL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_PSI_DTL where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_PSI_DTL_ck in (select distinct OPCO_ITEM_PSI_DTL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_PSI_DTL where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTTABLEMODULE", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_psi_dtl"], "unique_id": "model.OI_Foundation.ax_opco_item_psi_dtl", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_psi_dtl.sql", "original_file_path": "models/ax/product/ax_opco_item_psi_dtl.sql", "name": "ax_opco_item_psi_dtl", "alias": "ax_opco_item_psi_dtl", "checksum": {"name": "sha256", "checksum": "2d1e856ad31dfc4e28e1e14a5efe9665184b3886f71c5fefb236391b51b0e31c"}, "tags": [], "refs": [["v_ax_opco_item_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "INVENTTABLEMODULE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1317637}, "model.OI_Foundation.ax_opco_lob": {"raw_sql": "{% set _load = load_type('AX_OPCO_LOB') %}\r\n\r\nwith ax_opco_lob as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(num) as src_lob_cd,\r\n    max(upper(description)) as src_lob_nm,\r\n    {{ spcl_chr_rp('src_lob_cd')}} as lob_wo_spcl_chr_cd\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 4\r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_lob_cd, _fivetran_deleted\r\n),\r\nactv_ind_grouping as(\r\n    select upper(num) as src_lob_cd,\r\n    avg(closed) as actv_ind\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 4 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_lob_cd\r\n),\r\npre_final as (\r\n    select {{ dbt_utils.surrogate_key(['ol.src_sys_nm', 'ol.src_lob_cd']) }} as opco_lob_sk, ol.*, iff(aig.actv_ind=1, 0, 1) as actv_ind \r\n    from ax_opco_lob ol\r\n    inner join actv_ind_grouping aig \r\n        using(src_lob_cd)  \r\n),\r\nfinal as (\r\n    select  opco_lob_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_lob_cd', 'src_lob_nm', 'lob_wo_spcl_chr_cd', 'actv_ind']) }} as opco_lob_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_lob_cd, src_lob_nm, lob_wo_spcl_chr_cd, actv_ind\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_LOB') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_LOB') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_LOB_SK, OPCO_LOB_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_lob_cd, src_lob_nm, lob_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB\r\n    {% if _load == 1 %}\r\n        where OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from final)\r\n    {% else %}\r\n        where OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_LOB_ck in (select distinct OPCO_LOB_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_lob"], "unique_id": "model.OI_Foundation.ax_opco_lob", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_lob.sql", "original_file_path": "models/ax/product/ax_opco_lob.sql", "name": "ax_opco_lob", "alias": "ax_opco_lob", "checksum": {"name": "sha256", "checksum": "0a8dd8d0e0adf1170790c6177845e7f64cd64616fafa13c2b247d84dd94f15a0"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DIMENSIONS"], ["AX_DEV", "DIMENSIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1451757}, "model.OI_Foundation.ax_opco_item_sls_class": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_SLS_CLASS') %}\r\n\r\nwith ax_opco_item_sls_class as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(inventsalesclassid) as src_item_sls_class_cd,\r\n    max(name) as src_item_sls_class_desc\r\n    from {{source('AX_DEV', 'INVENTSALESCLASS_OPI')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_item_sls_class_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_sls_class_cd']) }} as opco_item_sls_class_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_sls_class_cd','src_item_sls_class_desc']) }} as OPCO_ITEM_SLS_CLASS_ck,\r\n            * \r\n    from ax_opco_item_sls_class\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_SLS_CLASS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_SLS_CLASS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_SLS_CLASS_SK, OPCO_ITEM_SLS_CLASS_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_sls_class_cd, src_item_sls_class_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SLS_CLASS\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_SLS_CLASS_ck not in (select distinct OPCO_ITEM_SLS_CLASS_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_SLS_CLASS_ck not in (select distinct OPCO_ITEM_SLS_CLASS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SLS_CLASS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SLS_CLASS_ck not in (select distinct OPCO_ITEM_SLS_CLASS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SLS_CLASS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SLS_CLASS_ck in (select distinct OPCO_ITEM_SLS_CLASS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SLS_CLASS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_sls_class"], "unique_id": "model.OI_Foundation.ax_opco_item_sls_class", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_sls_class.sql", "original_file_path": "models/ax/product/ax_opco_item_sls_class.sql", "name": "ax_opco_item_sls_class", "alias": "ax_opco_item_sls_class", "checksum": {"name": "sha256", "checksum": "a740fc5bafeb5495fbc4551e05c680080f0c78878da86da67381991e6138df0e"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTSALESCLASS_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1577318}, "model.OI_Foundation.ax_opco_uom": {"raw_sql": "{% set _load = load_type('AX_OPCO_UOM') %}\r\n\r\nwith ax_opco_uom as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(unitid)::varchar(15) as src_uom_cd,\r\n    max(txt)::varchar(50) as src_uom_desc\r\n    from {{source('AX_DEV', 'UNIT')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_uom_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd']) }} as opco_uom_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd', 'src_uom_desc']) }} as opco_uom_ck,\r\n            * \r\n    from ax_opco_uom\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_UOM') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_UOM') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_UOM_SK, OPCO_UOM_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_uom_cd, src_uom_desc\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM\r\n        {% if _load == 1 %}\r\n            where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final)\r\n        {% else %}\r\n            where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'AX')\r\n        {% endif %} \r\n        and src_sys_nm = 'AX'\r\n    {% endif %}\r\n)\r\nselect * from final\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.UNIT"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_uom"], "unique_id": "model.OI_Foundation.ax_opco_uom", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_uom.sql", "original_file_path": "models/ax/product/ax_opco_uom.sql", "name": "ax_opco_uom", "alias": "ax_opco_uom", "checksum": {"name": "sha256", "checksum": "6a6bc88db91ef8aac2c4706cf1b1f57ee8f98b95434af9ad235d87233afe7b03"}, "tags": [], "refs": [], "sources": [["AX_DEV", "UNIT"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.169958}, "model.OI_Foundation.ax_opco_item_size": {"raw_sql": "{% set _load = load_type('AX_OPCO_ITEM_SIZE') %}\r\n\r\nwith ax_opco_item_size as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    its._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when its._fivetran_deleted = true then its._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(its .inventsizeid) as src_item_size_cd,\r\n    its.dataareaid as opco_id,\r\n    its.itemid as src_item_cd,\r\n    oi.opco_item_sk as src_item_sk,\r\n    its.name as src_item_size_nm,\r\n    its.description as src_item_size_desc\r\n    from {{source('AX_DEV', 'INVENTSIZE')}} its \r\n    left join {{ref('v_ax_opco_item_curr')}} oi \r\n        on its.dataareaid = oi.opco_id\r\n        and its.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_item_size_cd', 'src_item_cd']) }} as opco_item_size_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_item_size_cd', 'opco_id', 'src_item_cd', 'src_item_sk', 'src_item_size_nm', 'src_item_size_desc']) }} as opco_item_size_ck,\r\n            * \r\n    from ax_opco_item_size \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ITEM_SIZE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ITEM_SIZE') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_ITEM_SIZE_SK, OPCO_ITEM_SIZE_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_item_size_cd, opco_id, src_item_cd, src_item_sk, src_item_size_nm, src_item_size_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SIZE\r\n    {% if _load == 1 %}\r\n        where OPCO_ITEM_SIZE_ck not in (select distinct OPCO_ITEM_SIZE_ck from final)\r\n    {% else %}\r\n        where OPCO_ITEM_SIZE_ck not in (select distinct OPCO_ITEM_SIZE_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SIZE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SIZE_ck not in (select distinct OPCO_ITEM_SIZE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SIZE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ITEM_SIZE_ck in (select distinct OPCO_ITEM_SIZE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ITEM_SIZE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTSIZE", "model.OI_Foundation.v_ax_opco_item_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "product", "ax_opco_item_size"], "unique_id": "model.OI_Foundation.ax_opco_item_size", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/product/ax_opco_item_size.sql", "original_file_path": "models/ax/product/ax_opco_item_size.sql", "name": "ax_opco_item_size", "alias": "ax_opco_item_size", "checksum": {"name": "sha256", "checksum": "1a2c780efdac506872d723a916fed734cd4a66246caabd23e9c51fbbd186a5e2"}, "tags": [], "refs": [["v_ax_opco_item_curr"]], "sources": [["AX_DEV", "INVENTSIZE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1812747}, "model.OI_Foundation.ax_opco_cust_opco_locn_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_CUST_OPCO_LOCN_XREF') %}\r\n\r\nwith ax_opco_cust_opco_locn_xref as(\r\n    select\r\n    oc.opco_cust_sk, \r\n    ol.opco_locn_sk,\r\n    'MAIN' as opco_cust_opco_locn_asscn_type_txt,\r\n    current_timestamp as crt_dtm,\r\n    cp._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when cp._fivetran_deleted = true then cp._fivetran_synced \r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    cp.function_ as contact_type_txt,\r\n    cp.name as contact_nm,\r\n    cp.phone as contact_ph_nbr,\r\n    '' as contact_ph_extn_nbr,\r\n    cp.cellularphone as contact_cell_nbr,\r\n    cp.phonelocal as contact_local_ph_nbr,\r\n    cp.telefax as contact_fax_nbr,\r\n    '' as contact_telex_nbr,\r\n    cp.email as contact_email_id,\r\n    upper(cp.nativelanguage) as language_txt,\r\n    '' as start_dt,\r\n    '' as end_dt,\r\n    cp.leftcompany as actv_ind\r\n    from {{source('AX_DEV', 'CONTACTPERSON')}} cp\r\n    left join {{source('AX_DEV', 'CUSTTABLE')}} ct\r\n        on cp.contactpersonid = ct.contactpersonid\r\n        and cp.dataareaid = ct.dataareaid\r\n        and cp.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and ct.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and ct._fivetran_deleted = false\r\n    left join {{ref('v_ax_opco_locn_curr')}} ol\r\n        on upper(ct.street) = ol.addr_ln_1_txt\r\n        and upper(ct.city) = ol.city_nm\r\n        and upper(ct.state) = ol.state_nm\r\n        and upper(ct.countryregionid) = ol.country_nm\r\n        and upper(ct.zipcode) = ol.zip_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_curr')}} oc \r\n        on ct.accountnum = oc.cust_id\r\n        and ct.dataareaid = oc.opco_id\r\n        and oc.src_sys_nm = 'AX'\r\n),\r\nfinal as (\r\n    select distinct \r\n            {{dbt_utils.surrogate_key(['opco_cust_sk', 'opco_locn_sk',  'opco_cust_opco_locn_asscn_type_txt',  'src_sys_nm',  'contact_type_txt',  'contact_nm',  'contact_ph_nbr',  'contact_ph_extn_nbr',  'contact_cell_nbr',  'contact_local_ph_nbr',  'contact_fax_nbr',  'contact_telex_nbr',  'contact_email_id',  'language_txt',  'start_dt',  'end_dt',  'actv_ind'])}} as opco_cust_opco_locn_xref_ck,\r\n            * \r\n    from ax_opco_cust_opco_locn_xref\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_OPCO_LOCN_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_OPCO_LOCN_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cust_opco_locn_xref_ck, opco_cust_sk, opco_locn_sk, opco_cust_opco_locn_asscn_type_txt, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF\r\n    {% if _load == 1 %}\r\n        where opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from final)\r\n    {% else %}\r\n        where opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_opco_locn_xref_ck in (select distinct opco_cust_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.CONTACTPERSON", "source.OI_Foundation.AX_DEV.CUSTTABLE", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_cust_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "location", "ax_opco_cust_opco_locn_xref"], "unique_id": "model.OI_Foundation.ax_opco_cust_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/location/ax_opco_cust_opco_locn_xref.sql", "original_file_path": "models/ax/location/ax_opco_cust_opco_locn_xref.sql", "name": "ax_opco_cust_opco_locn_xref", "alias": "ax_opco_cust_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "ce9ef75b9bdda23ece56c33f336c2b7eb266e2c445bd8de520d7cab72f2896cf"}, "tags": [], "refs": [["v_ax_opco_locn_curr"], ["v_ax_opco_cust_curr"]], "sources": [["AX_DEV", "CONTACTPERSON"], ["AX_DEV", "CUSTTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.1939058}, "model.OI_Foundation.ax_opco_locn": {"raw_sql": "{% set _load = load_type('AX_OPCO_LOCN') %}\r\n\r\nwith ax_opco_locn1 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(street) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(city) as city_nm,\r\n    upper(state) as state_nm,\r\n    upper(countryregionid) as country_nm,\r\n    upper(zipcode) as zip_cd,\r\n    max(upper(county)) as county_nm\r\n    from {{source('AX_DEV', 'ADDRESS')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn2 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(street) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(city) as city_nm,\r\n    upper(state) as state_nm,\r\n    upper(countryregionid) as country_nm,\r\n    upper(zipcode) as zip_cd,\r\n    max(upper(county)) as county_nm\r\n    from {{source('AX_DEV', 'COMPANYINFO')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn3 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(street) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(city) as city_nm,\r\n    upper(state) as state_nm,\r\n    upper(countryregionid) as country_nm,\r\n    upper(zipcode) as zip_cd,\r\n    max(upper(county)) as county_nm\r\n    from {{source('AX_DEV', 'CUSTTABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn4 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(deliverystate) as state_nm,\r\n    upper(deliverycountryregionid) as country_nm,\r\n    upper(deliveryzipcode) as zip_cd,\r\n    max(upper(deliverycounty)) as county_nm\r\n    from {{source('AX_DEV', 'SALESTABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn5 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(street) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(city) as city_nm,\r\n    upper(state) as state_nm,\r\n    upper(countryregionid) as country_nm,\r\n    upper(zipcode) as zip_cd,\r\n    max(upper(county)) as county_nm\r\n    from {{source('AX_DEV', 'VENDTABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn6 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(dlvstate) as state_nm,\r\n    upper(dlvcountryregionid) as country_nm,\r\n    upper(dlvzipcode) as zip_cd,\r\n    max(upper(dlvcounty)) as county_nm\r\n    from {{source('AX_DEV', 'PROJTABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn7 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(dlvstate) as state_nm,\r\n    upper(dlvcountryregionid) as country_nm,\r\n    upper(dlvzipcode) as zip_cd,\r\n    max(upper(dlvcounty)) as county_nm\r\n    from {{source('AX_DEV', 'CUSTINVOICEJOUR')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn8 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(invoicestreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(invoicecity) as city_nm,\r\n    upper(invstate) as state_nm,\r\n    upper(invcountryregionid) as country_nm,\r\n    upper(invzipcode) as zip_cd,\r\n    max(upper(invcounty)) as county_nm\r\n    from {{source('AX_DEV', 'CUSTINVOICEJOUR')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn9 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(dlvstate) as state_nm,\r\n    upper(dlvcountryregionid) as country_nm,\r\n    upper(dlvzipcode) as zip_cd,\r\n    max(upper(dlvcounty)) as county_nm\r\n    from {{source('AX_DEV', 'CUSTPACKINGSLIPJOUR')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn10 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(dlvstate) as state_nm,\r\n    upper(dlvcountryregionid) as country_nm,\r\n    upper(deliveryzipcode) as zip_cd,\r\n    max(upper(dlvcounty)) as county_nm\r\n    from {{source('AX_DEV', 'PURCHTABLE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\nax_opco_locn11 as(\r\n    select distinct\r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    '' as std_locn_sk,\r\n    'AX' as src_sys_nm,\r\n    upper(deliverystreet) as addr_ln_1_txt,\r\n    '' as addr_ln_2_txt,\r\n    '' as addr_ln_3_txt,\r\n    upper(deliverycity) as city_nm,\r\n    upper(dlvstate) as state_nm,\r\n    upper(dlvcountryregionid) as country_nm,\r\n    upper(dlvzipcode) as zip_cd,\r\n    max(upper(dlvcounty)) as county_nm\r\n    from {{source('AX_DEV', 'VENDPACKINGSLIPJOUR')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, _fivetran_deleted\r\n),\r\npre_final as (\r\n    select * from ax_opco_locn1\r\n    union \r\n    select * from ax_opco_locn2\r\n    union\r\n    select * from ax_opco_locn3\r\n    union\r\n    select * from ax_opco_locn4\r\n    union\r\n    select * from ax_opco_locn5\r\n    union\r\n    select * from ax_opco_locn6\r\n    union\r\n    select * from ax_opco_locn7\r\n    union\r\n    select * from ax_opco_locn8\r\n    union\r\n    select * from ax_opco_locn9\r\n    union\r\n    select * from ax_opco_locn10\r\n    union\r\n    select * from ax_opco_locn11\r\n),\r\nfinal as(\r\n    select distinct \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'std_locn_sk', 'addr_ln_1_txt', 'addr_ln_2_txt', 'addr_ln_3_txt', 'city_nm', 'state_nm', 'country_nm', 'zip_cd'])}} as opco_locn_sk, \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'std_locn_sk', 'addr_ln_1_txt', 'addr_ln_2_txt', 'addr_ln_3_txt', 'city_nm', 'state_nm', 'country_nm', 'zip_cd','county_nm'])}} as opco_locn_ck, \r\n            * \r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_LOCN') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_LOCN') and _load != 3%}\r\n    union\r\n    select\r\n    opco_locn_sk, opco_locn_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, state_nm, country_nm, zip_cd, county_nm\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOCN\r\n    {% if _load == 1 %}\r\n        where opco_locn_ck not in (select distinct opco_locn_ck from final)\r\n    {% else %}\r\n        where opco_locn_ck not in (select distinct opco_locn_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOCN where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_locn_ck not in (select distinct opco_locn_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOCN where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_locn_ck in (select distinct opco_locn_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOCN where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.ADDRESS", "source.OI_Foundation.AX_DEV.COMPANYINFO", "source.OI_Foundation.AX_DEV.CUSTTABLE", "source.OI_Foundation.AX_DEV.SALESTABLE", "source.OI_Foundation.AX_DEV.VENDTABLE", "source.OI_Foundation.AX_DEV.PROJTABLE", "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR", "source.OI_Foundation.AX_DEV.PURCHTABLE", "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "location", "ax_opco_locn"], "unique_id": "model.OI_Foundation.ax_opco_locn", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/location/ax_opco_locn.sql", "original_file_path": "models/ax/location/ax_opco_locn.sql", "name": "ax_opco_locn", "alias": "ax_opco_locn", "checksum": {"name": "sha256", "checksum": "4e8929a93b7b34f38c65c078fc52bfcc4071bb75f7ee69e9c726ebd2b4fe14e7"}, "tags": [], "refs": [], "sources": [["AX_DEV", "ADDRESS"], ["AX_DEV", "COMPANYINFO"], ["AX_DEV", "CUSTTABLE"], ["AX_DEV", "SALESTABLE"], ["AX_DEV", "VENDTABLE"], ["AX_DEV", "PROJTABLE"], ["AX_DEV", "CUSTINVOICEJOUR"], ["AX_DEV", "CUSTINVOICEJOUR"], ["AX_DEV", "CUSTPACKINGSLIPJOUR"], ["AX_DEV", "PURCHTABLE"], ["AX_DEV", "VENDPACKINGSLIPJOUR"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.2075336}, "model.OI_Foundation.ax_opco_opco_locn_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_OPCO_LOCN_XREF') %}\r\n\r\nwith ax_opco_opco_locn_xref as (\r\n    select\r\n    opco.opco_sk,\r\n    ol.opco_locn_sk,\r\n    'MAIN' as opco_opco_locn_asscn_type_txt,\r\n    current_timestamp as crt_dtm,\r\n    ci._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when ci._fivetran_deleted = true then ci._fivetran_synced \r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    '' as contact_type_txt,\r\n    '' as contact_nm,\r\n    ci.phone as contact_ph_nbr,\r\n    '' as contact_ph_extn_nbr,\r\n    ci.cellularphone as contact_cell_nbr,\r\n    ci.phonelocal as contact_local_ph_nbr,\r\n    ci.telefax as contact_fax_nbr,\r\n    '' as contact_telex_nbr,\r\n    ci.email as contact_email_id,\r\n    upper(ci.languageid) as language_txt,\r\n    '' as start_dt,\r\n    '' as end_dt\r\n    from {{source('AX_DEV', 'COMPANYINFO')}} ci\r\n    left join {{ref('v_ax_opco_curr')}} opco \r\n        on ci.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_locn_curr')}} ol \r\n        on upper(ci.street) = ol.addr_ln_1_txt\r\n        and upper(ci.city) = ol.city_nm\r\n        and upper(ci.state) = ol.state_nm\r\n        and upper(ci.countryregionid) = ol.country_nm\r\n        and upper(ci.zipcode) = ol.zip_cd \r\n        and ol.src_sys_nm = 'AX'\r\n    where ci.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select distinct \r\n        {{dbt_utils.surrogate_key(['opco_sk', 'opco_locn_sk', 'opco_opco_locn_asscn_type_txt', 'contact_type_txt', 'contact_nm', 'contact_ph_nbr', 'contact_ph_extn_nbr', 'contact_cell_nbr', 'contact_local_ph_nbr', 'contact_fax_nbr', 'contact_telex_nbr', 'contact_email_id', 'language_txt', 'start_dt', 'end_dt'])}} as opco_opco_locn_xref_ck, \r\n        * \r\n    from ax_opco_opco_locn_xref \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_OPCO_LOCN_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_OPCO_LOCN_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_opco_locn_xref_ck, opco_sk, opco_locn_sk, opco_opco_locn_asscn_type_txt, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_LOCN_XREF\r\n    {% if _load == 1 %}\r\n        where opco_opco_locn_xref_ck not in (select distinct opco_opco_locn_xref_ck from final)\r\n    {% else %}\r\n        where opco_opco_locn_xref_ck not in (select distinct opco_opco_locn_xref_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_LOCN_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_opco_locn_xref_ck not in (select distinct opco_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_LOCN_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_opco_locn_xref_ck in (select distinct opco_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_OPCO_LOCN_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.COMPANYINFO", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "location", "ax_opco_opco_locn_xref"], "unique_id": "model.OI_Foundation.ax_opco_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/location/ax_opco_opco_locn_xref.sql", "original_file_path": "models/ax/location/ax_opco_opco_locn_xref.sql", "name": "ax_opco_opco_locn_xref", "alias": "ax_opco_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "3f21050768be5d06224d66627ee302ce7c4971b33e89a81cb33d5411f5d3925f"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "COMPANYINFO"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.2275405}, "model.OI_Foundation.ax_opco_vendor_opco_locn_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_VENDOR_OPCO_LOCN_XREF') %}\r\n\r\nwith ax_opco_vendor_opco_locn_xref as(\r\n    select \r\n    ov.opco_vendor_sk,\r\n    ol.opco_locn_sk,\r\n    'MAIN' as opco_vendor_opco_locn_asscn_type_txt,\r\n    current_timestamp as crt_dtm,\r\n    vt._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when vt._fivetran_deleted = true then vt._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    '' as contact_type_txt,\r\n    '' as contact_nm,\r\n    vt.phone as contact_ph_nbr,\r\n    '' as contact_ph_extn_nbr,\r\n    vt.cellularphone as contact_cell_nbr,\r\n    vt.phonelocal as contact_local_ph_nbr,\r\n    vt.telefax as contact_fax_nbr,\r\n    vt.telex as contact_telex_nbr,\r\n    vt.email as contact_email_id,\r\n    upper(vt.languageid) as language_txt,\r\n    '' as start_dt,\r\n    '' as end_dt\r\n    from {{source('AX_DEV', 'VENDTABLE')}} vt\r\n    left join {{ref('v_ax_opco_locn_curr')}} ol \r\n        on upper(vt.street) = ol.addr_ln_1_txt\r\n        and upper(vt.city) = ol.city_nm\r\n        and upper(vt.state) = ol.state_nm\r\n        and upper(vt.countryregionid) = ol.country_nm\r\n        and upper(vt.zipcode) = ol.zip_cd \r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_vendor_curr')}} ov \r\n        on upper(vt.accountnum) = ov.vendor_id\r\n        and ov.src_sys_nm = 'AX'\r\n    where vt.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select distinct \r\n            {{ dbt_utils.surrogate_key([ 'opco_vendor_sk',  'opco_locn_sk',  'opco_vendor_opco_locn_asscn_type_txt',  'src_sys_nm',  'contact_type_txt',  'contact_nm',  'contact_ph_nbr',  'contact_ph_extn_nbr',  'contact_cell_nbr',  'contact_local_ph_nbr',  'contact_fax_nbr',  'contact_telex_nbr',  'contact_email_id',  'language_txt',  'start_dt',  'end_dt'])}} as opco_vendor_opco_locn_xref_ck,\r\n            * \r\n    from ax_opco_vendor_opco_locn_xref\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_CUST_OPCO_LOCN_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CUST_OPCO_LOCN_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_vendor_opco_locn_xref_ck, opco_vendor_sk, opco_locn_sk, opco_vendor_opco_locn_asscn_type_txt, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF\r\n    {% if _load == 1 %}\r\n        where opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from final)\r\n    {% else %}\r\n        where opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_opco_locn_xref_ck not in (select distinct opco_cust_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cust_opco_locn_xref_ck in (select distinct opco_cust_opco_locn_xref_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CUST_OPCO_LOCN_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.VENDTABLE", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_vendor_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "location", "ax_opco_vendor_opco_locn_xref"], "unique_id": "model.OI_Foundation.ax_opco_vendor_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/location/ax_opco_vendor_opco_locn_xref.sql", "original_file_path": "models/ax/location/ax_opco_vendor_opco_locn_xref.sql", "name": "ax_opco_vendor_opco_locn_xref", "alias": "ax_opco_vendor_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "828aac6e8e472c690769aeabf8f96f65d3983588f1d66a59f428ea90b97d202b"}, "tags": [], "refs": [["v_ax_opco_locn_curr"], ["v_ax_opco_vendor_curr"]], "sources": [["AX_DEV", "VENDTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.2401707}, "model.OI_Foundation.ax_fscl_clndr": {"raw_sql": "{% set _load = load_type('AX_FSCL_CLNDR') %}\r\n\r\nwith ax_fscl_calendar as (\r\n    select \r\n    {{ dbt_utils.surrogate_key(['date(date_key)']) }} as fscl_clndr_sk,\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case \r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    1 as busn_apprvd_ind,\r\n    date(date_key) as clndr_dt,\r\n    date_altkey as dt_ak,\r\n    serial_month as serial_mnth_nbr,\r\n    year_id as fscl_yr_id,\r\n    year_name as fscl_yr_nm,\r\n    month_id as fscl_yr_mnth_id,\r\n    month_name as fscl_yr_mnth_nm,\r\n    month_no as fscl_mnth_nbr,\r\n    month_mmm as fscl_mnth_nm,\r\n    cntous_rate as cn_to_us_cnvrsn_rt,\r\n    date(begin_day) as fscl_mnth_strt_dt,\r\n    date(end_date) as fscl_mnth_end_dt,\r\n    date(prev_begin) as prev_fscl_mnth_strt_dt,\r\n    date(prev_end) as prev_fscl_mnth_end_dt,\r\n    date(year_begin) as fscl_yr_strt_dt,\r\n    date(year_end) as fscl_yr_end_dt,\r\n    days as fscl_mnth_days_nbr,\r\n    period_id as fscl_period_id,\r\n    day_of_week as fscl_wk_day_nbr,\r\n    is_week_day as wk_day_ind,\r\n    calendar_year as clndr_yr_nbr,\r\n    calendar_day_of_year as clndr_yr_day_nbr,\r\n    calendar_quarter as clndr_qtr_nbr,\r\n    calendar_quarter_of_year as clndr_yr_qtr_nbr,\r\n    calendar_day_of_quarter as clndr_qtr_day_nbr,\r\n    calendar_month_of_quarter as clndr_qtr_mnth_nbr,\r\n    calendar_month as clndr_mnth_nbr,\r\n    calendar_month_of_year as clndr_yr_mnth_nbr,\r\n    calendar_day_of_month as clndr_mnth_day_nbr,\r\n    calendar_week_year as clndr_wk_yr_nbr,\r\n    calendar_week_day_of_year as clndr_yr_wk_day_nbr,\r\n    calendar_week_week as clndr_wk_nbr,\r\n    calendar_week_week_of_year as clndr_yr_wk_nbr,\r\n    fiscal_year as fscl_yr_nbr,\r\n    fiscal_day_of_year as fscl_yr_day_nbr,\r\n    fiscal_quarter_of_year as fscl_qtr_nbr,\r\n    fiscal_quarter as fscl_yr_qtr_nbr,\r\n    fiscal_day_of_quarter as fscl_qtr_day_nbr,\r\n    fiscal_month_of_quarter as fscl_qtr_mnth_nbr,\r\n    fiscal_month as fscl_yr_mnth_nbr,\r\n    fiscal_month_of_year as fscl_mnth_nbr_1,\r\n    fiscal_day_of_month as fscl_mnth_day_nbr,\r\n    fiscal_week_year as fscl_wk_yr_nbr,\r\n    fiscal_week_day_of_year as fscl_yr_wk_day_nbr,\r\n    fiscal_week_week as fscl_yr_wk_nbr,\r\n    fiscal_week_week_of_year as fscl_wk_nbr,\r\n    datevalue_caption_1033 as dt_caption_1033_txt,\r\n    day_of_week_caption_1033 as wk_day_caption_1033_txt,\r\n    calendar_year_caption_1033 as clndr_yr_caption_1033_txt,\r\n    calendar_quarter_caption_1033 as clndr_qtr_caption_1033_txt,\r\n    calendar_quarter_of_year_caption_1033 as clndr_yr_qtr_caption_1033_txt,\r\n    calendar_month_caption_1033 as clndr_mnth_caption_1033_txt,\r\n    calendar_month_of_year_caption_1033 as clndr_yr_mnth_caption_1033_txt,\r\n    calendar_week_year_caption_1033 as clndr_wk_yr_caption_1033_txt,\r\n    calendar_week_week_caption_1033 as clndr_wk_caption_1033_txt,\r\n    calendar_week_week_of_year_caption_1033 as clndr_yr_wk_caption_1033_txt,\r\n    fiscal_year_caption_1033 as fscl_yr_caption_1033_txt,\r\n    fiscal_quarter_of_year_caption_1033 as fscl_qtr_caption_1033_txt,\r\n    fiscal_quarter_caption_1033 as fscl_yr_qtr_caption_1033_txt,\r\n    fiscal_month_of_year_caption_1033 as fscl_mnth_caption_1033_txt,\r\n    fiscal_month_caption_1033 as fscl_yr_mnth_caption_1033_txt,\r\n    fiscal_week_year_caption_1033 as fscl_wk_yr_caption_1033_txt,\r\n    fiscal_week_week_caption_1033 as fscl_yr_wk_caption_1033_txt,\r\n    fiscal_week_week_of_year_caption_1033 as fscl_wk_caption_1033_txt\r\n    from {{ source('AX_PRODVIEW', 'DIM_TIME_93')}}\r\n),\r\nfinal as(\r\n    select  fscl_clndr_sk,\r\n            {{ dbt_utils.surrogate_key(['busn_apprvd_ind', 'clndr_dt', 'dt_ak', 'serial_mnth_nbr', 'fscl_yr_id', 'fscl_yr_nm', 'fscl_yr_mnth_id', 'fscl_yr_mnth_nm', 'fscl_mnth_nbr', 'fscl_mnth_nm', 'cn_to_us_cnvrsn_rt', 'fscl_mnth_strt_dt', 'fscl_mnth_end_dt', 'prev_fscl_mnth_strt_dt', 'prev_fscl_mnth_end_dt', 'fscl_yr_strt_dt', 'fscl_yr_end_dt', 'fscl_mnth_days_nbr', 'fscl_period_id', 'fscl_wk_day_nbr', 'wk_day_ind', 'clndr_yr_nbr', 'clndr_yr_day_nbr', 'clndr_qtr_nbr', 'clndr_yr_qtr_nbr', 'clndr_qtr_day_nbr', 'clndr_qtr_mnth_nbr', 'clndr_mnth_nbr', 'clndr_yr_mnth_nbr', 'clndr_mnth_day_nbr', 'clndr_wk_yr_nbr', 'clndr_yr_wk_day_nbr', 'clndr_wk_nbr', 'clndr_yr_wk_nbr', 'fscl_yr_nbr', 'fscl_yr_day_nbr', 'fscl_qtr_nbr', 'fscl_yr_qtr_nbr', 'fscl_qtr_day_nbr', 'fscl_qtr_mnth_nbr', 'fscl_yr_mnth_nbr', 'fscl_mnth_nbr_1', 'fscl_mnth_day_nbr', 'fscl_wk_yr_nbr', 'fscl_yr_wk_day_nbr', 'fscl_yr_wk_nbr', 'fscl_wk_nbr', 'dt_caption_1033_txt', 'wk_day_caption_1033_txt', 'clndr_yr_caption_1033_txt', 'clndr_qtr_caption_1033_txt', 'clndr_yr_qtr_caption_1033_txt', 'clndr_mnth_caption_1033_txt', 'clndr_yr_mnth_caption_1033_txt', 'clndr_wk_yr_caption_1033_txt', 'clndr_wk_caption_1033_txt', 'clndr_yr_wk_caption_1033_txt', 'fscl_yr_caption_1033_txt', 'fscl_qtr_caption_1033_txt', 'fscl_yr_qtr_caption_1033_txt', 'fscl_mnth_caption_1033_txt', 'fscl_yr_mnth_caption_1033_txt', 'fscl_wk_yr_caption_1033_txt', 'fscl_yr_wk_caption_1033_txt', 'fscl_wk_caption_1033_txt']) }} as fscl_clndr_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, busn_apprvd_ind, clndr_dt, dt_ak, serial_mnth_nbr, fscl_yr_id, fscl_yr_nm, fscl_yr_mnth_id, fscl_yr_mnth_nm, fscl_mnth_nbr, fscl_mnth_nm, cn_to_us_cnvrsn_rt, fscl_mnth_strt_dt, fscl_mnth_end_dt, prev_fscl_mnth_strt_dt, prev_fscl_mnth_end_dt, fscl_yr_strt_dt, fscl_yr_end_dt, fscl_mnth_days_nbr, fscl_period_id, fscl_wk_day_nbr, wk_day_ind, clndr_yr_nbr, clndr_yr_day_nbr, clndr_qtr_nbr, clndr_yr_qtr_nbr, clndr_qtr_day_nbr, clndr_qtr_mnth_nbr, clndr_mnth_nbr, clndr_yr_mnth_nbr, clndr_mnth_day_nbr, clndr_wk_yr_nbr, clndr_yr_wk_day_nbr, clndr_wk_nbr, clndr_yr_wk_nbr, fscl_yr_nbr, fscl_yr_day_nbr, fscl_qtr_nbr, fscl_yr_qtr_nbr, fscl_qtr_day_nbr, fscl_qtr_mnth_nbr, fscl_yr_mnth_nbr, fscl_mnth_nbr_1, fscl_mnth_day_nbr, fscl_wk_yr_nbr, fscl_yr_wk_day_nbr, fscl_yr_wk_nbr, fscl_wk_nbr, dt_caption_1033_txt, wk_day_caption_1033_txt, clndr_yr_caption_1033_txt, clndr_qtr_caption_1033_txt, clndr_yr_qtr_caption_1033_txt, clndr_mnth_caption_1033_txt, clndr_yr_mnth_caption_1033_txt, clndr_wk_yr_caption_1033_txt, clndr_wk_caption_1033_txt, clndr_yr_wk_caption_1033_txt, fscl_yr_caption_1033_txt, fscl_qtr_caption_1033_txt, fscl_yr_qtr_caption_1033_txt, fscl_mnth_caption_1033_txt, fscl_yr_mnth_caption_1033_txt, fscl_wk_yr_caption_1033_txt, fscl_yr_wk_caption_1033_txt, fscl_wk_caption_1033_txt\r\n    from ax_fscl_calendar\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_FSCL_CLNDR') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'FSCL_CLNDR') and _load != 3%}\r\n        union\r\n        select\r\n        fscl_clndr_sk, fscl_clndr_ck, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        busn_apprvd_ind, clndr_dt, dt_ak, serial_mnth_nbr, fscl_yr_id, fscl_yr_nm, fscl_yr_mnth_id, fscl_yr_mnth_nm, fscl_mnth_nbr, fscl_mnth_nm, cn_to_us_cnvrsn_rt, fscl_mnth_strt_dt, fscl_mnth_end_dt, prev_fscl_mnth_strt_dt, prev_fscl_mnth_end_dt, fscl_yr_strt_dt, fscl_yr_end_dt, fscl_mnth_days_nbr, fscl_period_id, fscl_wk_day_nbr, wk_day_ind, clndr_yr_nbr, clndr_yr_day_nbr, clndr_qtr_nbr, clndr_yr_qtr_nbr, clndr_qtr_day_nbr, clndr_qtr_mnth_nbr, clndr_mnth_nbr, clndr_yr_mnth_nbr, clndr_mnth_day_nbr, clndr_wk_yr_nbr, clndr_yr_wk_day_nbr, clndr_wk_nbr, clndr_yr_wk_nbr, fscl_yr_nbr, fscl_yr_day_nbr, fscl_qtr_nbr, fscl_yr_qtr_nbr, fscl_qtr_day_nbr, fscl_qtr_mnth_nbr, fscl_yr_mnth_nbr, fscl_mnth_nbr_1, fscl_mnth_day_nbr, fscl_wk_yr_nbr, fscl_yr_wk_day_nbr, fscl_yr_wk_nbr, fscl_wk_nbr, dt_caption_1033_txt, wk_day_caption_1033_txt, clndr_yr_caption_1033_txt, clndr_qtr_caption_1033_txt, clndr_yr_qtr_caption_1033_txt, clndr_mnth_caption_1033_txt, clndr_yr_mnth_caption_1033_txt, clndr_wk_yr_caption_1033_txt, clndr_wk_caption_1033_txt, clndr_yr_wk_caption_1033_txt, fscl_yr_caption_1033_txt, fscl_qtr_caption_1033_txt, fscl_yr_qtr_caption_1033_txt, fscl_mnth_caption_1033_txt, fscl_yr_mnth_caption_1033_txt, fscl_wk_yr_caption_1033_txt, fscl_yr_wk_caption_1033_txt, fscl_wk_caption_1033_txt\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.FSCL_CLNDR\r\n        {% if _load == 1 %}\r\n            where FSCL_CLNDR_ck not in (select distinct FSCL_CLNDR_ck from final)\r\n        {% else %}\r\n            where FSCL_CLNDR_ck not in (select distinct FSCL_CLNDR_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.FSCL_CLNDR)\r\n        {% endif %} \r\n    {% endif %}\r\n)\r\nselect * from final\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and FSCL_CLNDR_ck not in (select distinct FSCL_CLNDR_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.FSCL_CLNDR)) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and FSCL_CLNDR_ck in (select distinct FSCL_CLNDR_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.FSCL_CLNDR) and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_fscl_clndr"], "unique_id": "model.OI_Foundation.ax_fscl_clndr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_fscl_clndr.sql", "original_file_path": "models/ax/organization/ax_fscl_clndr.sql", "name": "ax_fscl_clndr", "alias": "ax_fscl_clndr", "checksum": {"name": "sha256", "checksum": "0ff73afcfd8e54faa915315e72d0a90191b71a13624da3ae2bccc361a72dd499"}, "tags": [], "refs": [], "sources": [["AX_PRODVIEW", "DIM_TIME_93"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.2528896}, "model.OI_Foundation.ax_opco_type": {"raw_sql": "{% set _load = load_type('AX_OPCO_TYPE') %}\r\n\r\nwith ax_opco_type as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(num)::varchar(20) as src_type_cd,\r\n    max(description)::varchar(100) as src_type_desc,\r\n    {{ spcl_chr_rp('src_type_cd')}}::varchar(20) as type_wo_spcl_chr_cd\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 2\r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_type_cd, _fivetran_deleted\r\n),\r\nactv_ind_grouping as(\r\n    select upper(num) as src_type_cd,\r\n    avg(closed) as actv_ind\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 2 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_type_cd\r\n),\r\npre_final as (\r\n    select {{ dbt_utils.surrogate_key(['ot.src_sys_nm', 'ot.src_type_cd']) }} as opco_type_sk, ot.*, iff(aig.actv_ind=1, 0, 1)::numeric(1,0) as actv_ind \r\n    from ax_opco_type ot\r\n    inner join actv_ind_grouping aig \r\n        using(src_type_cd)\r\n),\r\nfinal as (\r\n    select  opco_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_type_cd', 'src_type_desc', 'type_wo_spcl_chr_cd', 'actv_ind']) }} as opco_type_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_type_cd, src_type_desc, type_wo_spcl_chr_cd, actv_ind\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_TYPE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_type_sk, opco_type_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm)) from final) as delete_dtm,\r\n    src_sys_nm, src_type_cd, src_type_desc, type_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE\r\n    {% if _load == 1 %}\r\n        where opco_type_ck not in (select distinct opco_type_ck from final)\r\n    {% else %}\r\n        where opco_type_ck not in (select distinct opco_type_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_type_ck not in (select distinct opco_type_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_type_ck in (select distinct opco_type_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco_type"], "unique_id": "model.OI_Foundation.ax_opco_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco_type.sql", "original_file_path": "models/ax/organization/ax_opco_type.sql", "name": "ax_opco_type", "alias": "ax_opco_type", "checksum": {"name": "sha256", "checksum": "90e4abd589395ec5a4dd8168a333386b31b3105b07b6f0d6d8a8d09939feeaec"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DIMENSIONS"], ["AX_DEV", "DIMENSIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.2739134}, "model.OI_Foundation.ax_opco_assctn": {"raw_sql": "{% set _load = load_type('AX_OPCO_ASSCTN') %}\r\n\r\nwith ax_opco_assctn as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    id._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when id._fivetran_deleted = true then id._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    id.inventdimid as src_assctn_cd,\r\n    id.dataareaid as opco_id,\r\n    opco.opco_sk,\r\n    site.opco_site_sk,\r\n    cc.opco_cost_center_sk as cost_center_sk,\r\n    wr.warehouse_sk,\r\n    1 as actv_ind\r\n    from {{source('AX_DEV', 'INVENTDIM')}} id \r\n    left join {{ref('v_ax_opco_curr')}} opco\r\n        on id.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX' \r\n    left join {{ref('v_ax_opco_site_curr')}} site\r\n        on upper(id.inventsiteid) = site.src_site_id\r\n        and site.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} cc\r\n        on upper(id.inventsiteid) = cc.src_cost_center_cd\r\n        and cc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_warehouse_curr')}} wr \r\n        on upper(id.inventlocationid) = wr.warehouse_id\r\n        and id.dataareaid = wr.opco_id\r\n        and wr.src_sys_nm = 'AX'\r\n    where id.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm','src_assctn_cd','opco_id']) }} as opco_assctn_sk,\r\n    {{ dbt_utils.surrogate_key(['src_sys_nm','src_assctn_cd', 'opco_id','opco_sk','opco_site_sk','cost_center_sk','warehouse_sk','actv_ind']) }} as opco_assctn_ck, \r\n    * \r\n    from ax_opco_assctn \r\n)\r\n\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_ASSCTN') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_ASSCTN') and _load != 3%}\r\n    union\r\n    select\r\n    opco_assctn_sk, opco_assctn_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_assctn_cd, opco_id, opco_sk, opco_site_sk, cost_center_sk, warehouse_sk, actv_ind  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ASSCTN\r\n    {% if _load == 1 %}\r\n        where opco_assctn_ck not in (select distinct opco_assctn_ck from final)\r\n    {% else %}\r\n        where opco_assctn_ck not in (select distinct opco_assctn_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ASSCTN where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_assctn_ck not in (select distinct opco_assctn_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ASSCTN where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_assctn_ck in (select distinct opco_assctn_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_ASSCTN where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTDIM", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_warehouse_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco_assctn"], "unique_id": "model.OI_Foundation.ax_opco_assctn", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco_assctn.sql", "original_file_path": "models/ax/organization/ax_opco_assctn.sql", "name": "ax_opco_assctn", "alias": "ax_opco_assctn", "checksum": {"name": "sha256", "checksum": "a6d6f9291bc130b166e89070bc92e91072622a16e1ba4d1261ea8850bba530b4"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_site_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_warehouse_curr"]], "sources": [["AX_DEV", "INVENTDIM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.286367}, "model.OI_Foundation.ax_region": {"raw_sql": "{% set _load = load_type('AX_REGION') %}\r\n\r\nwith ax_region as (\r\n    SELECT DISTINCT\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(region_opi)::varchar(25) as region_id,\r\n    region_opi::varchar(50) as region_nm,\r\n    1::numeric(1,0) as actv_ind\r\n    from {{source('AX_DEV', 'COMPANYINFO')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'region_id']) }} as region_sk, \r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'region_id', 'region_nm', 'actv_ind']) }} as region_ck,\r\n           * \r\n    from ax_region\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_REGION') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'REGION') and _load != 3%}\r\n        union\r\n        select\r\n        region_sk, region_ck, crt_dtm, \r\n        (select MAX(STG_LOAD_DTM) from final) as stg_load_dtm,\r\n        (select MAX(STG_LOAD_DTM) from final) as delete_dtm,\r\n        src_sys_nm, region_id, region_nm, actv_ind\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION\r\n        {% if _load == 1 %}\r\n            where REGION_ck not in (select distinct REGION_ck from final)\r\n        {% else %}\r\n            where REGION_ck not in (select distinct REGION_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'AX')\r\n        {% endif %} \r\n        and src_sys_nm = 'AX'\r\n    {% endif %}\r\n)\r\nselect * from final\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and REGION_ck not in (select distinct REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and REGION_ck in (select distinct REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.REGION where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.COMPANYINFO"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_region"], "unique_id": "model.OI_Foundation.ax_region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_region.sql", "original_file_path": "models/ax/organization/ax_region.sql", "name": "ax_region", "alias": "ax_region", "checksum": {"name": "sha256", "checksum": "4b1ac1f0207dcf94575a9bdc2c06747d23cd197905d7119773efe1fe081f120e"}, "tags": [], "refs": [], "sources": [["AX_DEV", "COMPANYINFO"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.3736029}, "model.OI_Foundation.ax_warehouse": {"raw_sql": "{% set _load = load_type('AX_WAREHOUSE') %}\r\n\r\nwith ax_warehouse as(\r\n    SELECT\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case \r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    dataareaid as opco_id,\r\n    upper(inventlocationid) as warehouse_id,\r\n    name as warehouse_nm,\r\n    1 as actv_ind\r\n    from {{source('AX_DEV', 'INVENTLOCATION')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'warehouse_id']) }} as warehouse_sk,\r\n    {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'warehouse_id','warehouse_nm','actv_ind']) }} as warehouse_ck, \r\n    * \r\n    from ax_warehouse  \r\n)\r\n\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_WAREHOUSE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'WAREHOUSE') and _load != 3%}\r\n    union\r\n    select\r\n    warehouse_sk, warehouse_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, warehouse_id, warehouse_nm, actv_ind \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.WAREHOUSE\r\n    {% if _load == 1 %}\r\n        where warehouse_ck not in (select distinct warehouse_ck from final)\r\n    {% else %}\r\n        where warehouse_ck not in (select distinct warehouse_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.WAREHOUSE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and warehouse_ck not in (select distinct warehouse_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.WAREHOUSE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and warehouse_ck in (select distinct warehouse_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.WAREHOUSE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTLOCATION"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_warehouse"], "unique_id": "model.OI_Foundation.ax_warehouse", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_warehouse.sql", "original_file_path": "models/ax/organization/ax_warehouse.sql", "name": "ax_warehouse", "alias": "ax_warehouse", "checksum": {"name": "sha256", "checksum": "4edd1dab392696a5bebabf90e4ae33e59471426994ffba1bb005adebfdc51f2a"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTLOCATION"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.3856757}, "model.OI_Foundation.ax_sub_region": {"raw_sql": "{% set _load = load_type('AX_SUB_REGION') %}\r\n\r\nwith ax_sub_region as(\r\n    SELECT DISTINCT\r\n    current_timestamp as crt_dtm,\r\n    _fivetran_synced as stg_load_dtm,\r\n    case\r\n        when _fivetran_deleted = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(subregion_opi)::varchar(20) as sub_region_id,\r\n    subregion_opi::varchar(20) as sub_region_nm,\r\n    1::numeric(1,0) as actv_ind\r\n    from {{source('AX_DEV', 'COMPANYINFO')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'sub_region_id']) }} as sub_region_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'sub_region_id', 'sub_region_nm', 'actv_ind']) }} as sub_region_ck,\r\n            * \r\n    from ax_sub_region    \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_SUB_REGION') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'SUB_REGION') and _load != 3%}\r\n    union\r\n    select\r\n    SUB_REGION_SK, SUB_REGION_CK, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, sub_region_id, sub_region_nm, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION\r\n    {% if _load == 1 %}\r\n        where SUB_REGION_ck not in (select distinct SUB_REGION_ck from final)\r\n    {% else %}\r\n        where SUB_REGION_ck not in (select distinct SUB_REGION_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SUB_REGION_ck not in (select distinct SUB_REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SUB_REGION_ck in (select distinct SUB_REGION_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SUB_REGION where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.COMPANYINFO"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_sub_region"], "unique_id": "model.OI_Foundation.ax_sub_region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_sub_region.sql", "original_file_path": "models/ax/organization/ax_sub_region.sql", "name": "ax_sub_region", "alias": "ax_sub_region", "checksum": {"name": "sha256", "checksum": "ed91ad55a2238de226c39c87d87db6043f22173fc79b8f75da49ec25154bc478"}, "tags": [], "refs": [], "sources": [["AX_DEV", "COMPANYINFO"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.397946}, "model.OI_Foundation.ax_opco_dept": {"raw_sql": "{% set _load = load_type('AX_OPCO_DEPT') %}\r\n\r\nwith ax_opco_dept as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(num)::varchar(20) as src_dept_cd,\r\n    max(upper(description))::varchar(100) as src_dept_desc,\r\n    {{ spcl_chr_rp('src_dept_cd')}}::varchar(100) as dept_wo_spcl_chr_cd\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 1\r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_dept_cd, _fivetran_deleted\r\n),\r\nactv_ind_grouping as(\r\n    select upper(num) as src_dept_cd,\r\n    avg(closed) as actv_ind\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 1 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}  \r\n    group by src_dept_cd\r\n),\r\npre_final as (\r\n    select {{ dbt_utils.surrogate_key(['od.src_sys_nm', 'od.src_dept_cd']) }} as opco_dept_sk, \r\n           od.*, iff(aig.actv_ind=1, 0, 1)::numeric(1,0) as actv_ind \r\n    from ax_opco_dept od\r\n    inner join actv_ind_grouping aig \r\n        using(src_dept_cd)\r\n),\r\nfinal as(\r\n    select  opco_dept_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dept_cd', 'src_dept_desc', 'dept_wo_spcl_chr_cd', 'actv_ind']) }} as opco_dept_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_dept_cd, src_dept_desc, dept_wo_spcl_chr_cd, actv_ind\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_DEPT') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_DEPT') and _load != 3%}\r\n    union\r\n    select\r\n    opco_dept_sk, opco_dept_ck, crt_dtm,   \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_dept_cd, src_dept_desc, dept_wo_spcl_chr_cd, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT\r\n    {% if _load == 1 %}\r\n        where opco_dept_ck not in (select distinct opco_dept_ck from final)\r\n    {% else %}\r\n        where opco_dept_ck not in (select distinct opco_dept_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dept_ck not in (select distinct opco_dept_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dept_ck in (select distinct opco_dept_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco_dept"], "unique_id": "model.OI_Foundation.ax_opco_dept", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco_dept.sql", "original_file_path": "models/ax/organization/ax_opco_dept.sql", "name": "ax_opco_dept", "alias": "ax_opco_dept", "checksum": {"name": "sha256", "checksum": "f6a54a1ec5101bc0877a87829a7414753d9b75190b3f8bdc4f74c2d773b34049"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DIMENSIONS"], ["AX_DEV", "DIMENSIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.4095511}, "model.OI_Foundation.ax_opco_site": {"raw_sql": "{% set _load = load_type('AX_OPCO_SITE') %}\r\n\r\nwith ax_opco_site as(\r\n    SELECT \r\n    current_timestamp() as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(siteid) as src_site_id,\r\n    max(name) as src_site_nm,\r\n    1 as actv_ind\r\n    from {{source('AX_DEV', 'INVENTSITE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_site_id, _fivetran_deleted \r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_site_id']) }} as opco_site_sk,\r\n    {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_site_id','src_site_nm','actv_ind']) }} as opco_site_ck, * \r\n    from ax_opco_site\r\n   \r\n)\r\n\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_SITE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_SITE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_site_sk, opco_site_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_site_id, src_site_nm, actv_ind  \r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SITE\r\n    {% if _load == 1 %}\r\n        where opco_site_ck not in (select distinct opco_site_ck from final)\r\n    {% else %}\r\n        where opco_site_ck not in (select distinct opco_site_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SITE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_site_ck not in (select distinct opco_site_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SITE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_site_ck in (select distinct opco_site_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SITE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.INVENTSITE"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco_site"], "unique_id": "model.OI_Foundation.ax_opco_site", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco_site.sql", "original_file_path": "models/ax/organization/ax_opco_site.sql", "name": "ax_opco_site", "alias": "ax_opco_site", "checksum": {"name": "sha256", "checksum": "ea7a0e22db8e4b903eae9b3ece158d9816f2a2405a49d8fd51694510787b82fd"}, "tags": [], "refs": [], "sources": [["AX_DEV", "INVENTSITE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.422068}, "model.OI_Foundation.ax_opco": {"raw_sql": "{% set _load = load_type('AX_OPCO') %}\r\n\r\nwith ax_opco as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    ci._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when ci._fivetran_deleted = true then ci._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    concat_ws('|', 'AX', ci.dataareaid)::varchar(255) as opco_ak,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    ci.dataareaid::varchar(15) as opco_id,\r\n    ci.name::varchar(120) as opco_nm,\r\n    oc.opco_currency_sk,\r\n    r.region_sk,\r\n    sr.sub_region_sk,\r\n    ci.dba::varchar(120) as dba_nm,\r\n    null::numeric(1,0) as enterprise_ind,\r\n    null::varchar(130) as govt_issued_id,\r\n    null::varchar(15) as  duns_nbr,\r\n    ci.vatnum::varchar(20) as vat_nbr,\r\n    null::date as acqstn_dt,\r\n    iff(ci.companyclosed_opi=0, 1, 0)::numeric(1,0) as actv_ind,\r\n    null::date as inactv_dt,\r\n    ci.importvatnum::varchar(40) as import_vat_nbr,\r\n    ci.url::varchar(510) as website_url_txt,\r\n    ci.languageid::varchar(20) as language_txt,\r\n    ci.conversiondate::date as conversion_dt,\r\n    ci.foreignentityindicator::numeric(1,0) as foreign_enty_ind,\r\n    ci.combinedfedstatefiler::numeric(1,0) as combined_fed_state_tax_filer_ind,\r\n    ci.validate1099onentry::numeric(1,0) as validate_1099_on_entry_ind,\r\n    ci.planningcompany::numeric(1,0) as planning_company_ind,\r\n    null::varchar(60) as sls_tax_global_id,\r\n    null::varchar(60) as sls_tax_local_id,\r\n    ci.productline_opi::varchar(20) as product_line_txt,\r\n    concat_ws('|', 'AX', ci.currentcompany_opi)::varchar(50) as prnt_opco_id,\r\n    ci.collectiontype_opi::varchar(50) as collection_type_txt,\r\n    ci.dashboard_opi::numeric(1,0) as dashboard_usage_id\r\n    from {{ source('AX_DEV', 'COMPANYINFO')}} ci\r\n    left join {{ref('v_ax_region_curr')}} r \r\n        on upper(ci.region_opi) = r.region_id\r\n        and r.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_sub_region_curr')}} sr \r\n        on upper(ci.subregion_opi) = sr.sub_region_id\r\n        and sr.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_currency_curr')}} oc \r\n        on upper(ci.currencycode) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'AX'\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id']) }} as opco_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'opco_nm', 'opco_currency_sk', 'region_sk', 'sub_region_sk', 'dba_nm', 'enterprise_ind', 'govt_issued_id', ' duns_nbr', 'vat_nbr', 'acqstn_dt', 'actv_ind', 'inactv_dt', 'import_vat_nbr', 'website_url_txt', 'language_txt', 'conversion_dt', 'foreign_enty_ind', 'combined_fed_state_tax_filer_ind', 'validate_1099_on_entry_ind', 'planning_company_ind', 'sls_tax_global_id', 'sls_tax_local_id', 'product_line_txt', 'prnt_opco_id', 'collection_type_txt', 'dashboard_usage_id']) }} as opco_ck,\r\n            *\r\n    from ax_opco \r\n    \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO') and _load != 3%}\r\n    union\r\n    select\r\n    opco_sk, opco_ck, CRT_DTM, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    opco_ak, src_sys_nm, opco_id, opco_nm, opco_currency_sk, region_sk, sub_region_sk, dba_nm, enterprise_ind, govt_issued_id,  duns_nbr, vat_nbr, acqstn_dt, actv_ind, inactv_dt, import_vat_nbr, website_url_txt, language_txt, conversion_dt, foreign_enty_ind, combined_fed_state_tax_filer_ind, validate_1099_on_entry_ind, planning_company_ind, sls_tax_global_id, sls_tax_local_id, product_line_txt, prnt_opco_id, collection_type_txt, dashboard_usage_id\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO\r\n    {% if _load == 1 %}\r\n        where opco_ck not in (select distinct opco_ck from final)\r\n    {% else %}\r\n        where opco_ck not in (select distinct opco_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_ck not in (select distinct opco_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_ck in (select distinct opco_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.COMPANYINFO", "model.OI_Foundation.v_ax_region_curr", "model.OI_Foundation.v_ax_sub_region_curr", "model.OI_Foundation.v_ax_opco_currency_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco"], "unique_id": "model.OI_Foundation.ax_opco", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco.sql", "original_file_path": "models/ax/organization/ax_opco.sql", "name": "ax_opco", "alias": "ax_opco", "checksum": {"name": "sha256", "checksum": "d75231ff153444aad52bca5176dc09b77396137bda6a6e563163a2868d159291"}, "tags": [], "refs": [["v_ax_region_curr"], ["v_ax_sub_region_curr"], ["v_ax_opco_currency_curr"]], "sources": [["AX_DEV", "COMPANYINFO"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.4345663}, "model.OI_Foundation.ax_opco_cost_center": {"raw_sql": "{% set _load = load_type('AX_OPCO_COST_CENTER') %}\r\n\r\nwith ax_opco_cost_center as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX'::varchar(20) as src_sys_nm,\r\n    upper(num)::varchar(20) as src_cost_center_cd,\r\n    max(upper(description))::varchar(100) as src_cost_center_desc,\r\n    {{ spcl_chr_rp('src_cost_center_cd')}}::varchar(100) as cost_center_wo_spcl_chr_cd\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 0\r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_cost_center_cd, _fivetran_deleted\r\n),\r\nactv_ind_grouping as(\r\n    select upper(num) as src_cost_center_cd,\r\n    avg(closed) as actv_ind\r\n    from {{source('AX_DEV', 'DIMENSIONS')}}\r\n    where dimensioncode = 0 \r\n    and dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_cost_center_cd\r\n),\r\npre_final as (\r\n    select {{ dbt_utils.surrogate_key(['occ.src_sys_nm', 'occ.src_cost_center_cd']) }} as opco_cost_center_sk, \r\n            occ.*, iff(aig.actv_ind=1, 0, 1)::numeric(1,0) as actv_ind, null::varchar(50) as src_cost_center_type_txt \r\n    from ax_opco_cost_center occ\r\n    inner join actv_ind_grouping aig \r\n        using(src_cost_center_cd)\r\n),\r\nfinal as(\r\n    select opco_cost_center_sk,\r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd', 'src_cost_center_desc', 'cost_center_wo_spcl_chr_cd', 'actv_ind', 'src_cost_center_type_txt']) }} as opco_cost_center_ck,\r\n           crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_cost_center_cd, src_cost_center_desc, cost_center_wo_spcl_chr_cd, actv_ind, src_cost_center_type_txt\r\n    from pre_final\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_COST_CENTER') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_COST_CENTER') and _load != 3%}\r\n    union\r\n    select\r\n    opco_cost_center_sk, opco_cost_center_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_cost_center_cd, src_cost_center_desc, cost_center_wo_spcl_chr_cd, actv_ind, src_cost_center_type_txt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER\r\n    {% if _load == 1 %}\r\n        where opco_cost_center_ck not in (select distinct opco_cost_center_ck from final)\r\n    {% else %}\r\n        where opco_cost_center_ck not in (select distinct opco_cost_center_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cost_center_ck not in (select distinct opco_cost_center_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_cost_center_ck in (select distinct opco_cost_center_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "organization", "ax_opco_cost_center"], "unique_id": "model.OI_Foundation.ax_opco_cost_center", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/organization/ax_opco_cost_center.sql", "original_file_path": "models/ax/organization/ax_opco_cost_center.sql", "name": "ax_opco_cost_center", "alias": "ax_opco_cost_center", "checksum": {"name": "sha256", "checksum": "9d431d0294d83f834142c642f6b96943e766eb1e2dce7f0cb50c8b4f4b0f7348"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DIMENSIONS"], ["AX_DEV", "DIMENSIONS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.4505057}, "model.OI_Foundation.ax_opco_sls_ordr_doc_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_sls_ordr_doc_status as (\r\n  {% set values = ['None', 'Quotation', 'Purchase Order', 'Confirmation', 'Picking List', 'Packing List', 'Receipts List', 'Invoice', 'Invoice Approval Journal', 'Project - Invoice', 'Project - Packing Slip', 'CRM Quotation', 'Lost', 'Canceled', 'Free Text Invoice', 'Request For Quote', 'Request For Quote - Accept', 'Request For Quote - Reject', 'Purchase Requisition'] %}\r\n\r\n  {% for i in range(19) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{ i }} as src_sls_ordr_doc_status_cd,\r\n          '{{values[i]}}' as src_sls_ordr_doc_status_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select \r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sls_ordr_doc_status_cd']) }} as opco_sls_ordr_doc_status_sk,\r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sls_ordr_doc_status_cd','src_sls_ordr_doc_status_desc']) }} as opco_sls_ordr_doc_status_ck, \r\n      *\r\n    from opco_sls_ordr_doc_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_sls_ordr_doc_status"], "unique_id": "model.OI_Foundation.ax_opco_sls_ordr_doc_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_sls_ordr_doc_status.sql", "original_file_path": "models/ax/sales_order/ax_opco_sls_ordr_doc_status.sql", "name": "ax_opco_sls_ordr_doc_status", "alias": "ax_opco_sls_ordr_doc_status", "checksum": {"name": "sha256", "checksum": "cbdd1c86fa4c39297b94071a34d573365a5b24992f151d331d7b9675e7c2ec9e"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.4629693}, "model.OI_Foundation.ax_opco_sls_ordr": {"raw_sql": "{% set _load = load_type('AX_OPCO_SLS_ORDR') %}\r\n\r\nwith ax_opco_sls_ordr as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    st._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when st._fivetran_deleted = true then st._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    st.dataareaid as opco_id,\r\n    st.salesid as sls_ordr_id,\r\n    st.salesname as sls_ordr_nm,\r\n    st.orderdate_opi as sls_ordr_dt,\r\n    st.deliverydate as ship_dt,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oc.opco_cust_sk,\r\n    oss.opco_trans_status_sk,\r\n    ocg.opco_cust_grp_sk,\r\n    os.opco_site_sk,\r\n    odt.opco_dlvry_terms_sk,\r\n    odm.opco_dlvry_mode_sk,\r\n    olc.opco_locn_sk as dlvry_loc_sk,\r\n    wr.warehouse_sk,\r\n    st.salesgroup as sls_grp_nm,\r\n    st.taxgroup as tax_grp_id,\r\n    st.quotationid as quotation_id,\r\n    st.purchorderformnum as cust_po_nbr,\r\n    ocu.opco_currency_sk as trans_currency_sk,\r\n    opt.opco_pymnt_terms_sk,\r\n    opm.opco_pymnt_mode_sk,\r\n    ocd.opco_cash_dscnt_terms_sk,\r\n    st.cashdiscpercent as cash_dscnt_pct,\r\n    st.createddatetime as sls_ordr_crt_dtm,\r\n    st.modifieddatetime as sls_ordr_modified_dtm,\r\n    st.createdby as sls_ordr_crt_by_nm,\r\n    st.modifiedby as sls_ordr_modified_by_nm,\r\n    st.onhold_opi as on_hold_ind,\r\n    st.onholdby_opi as on_hold_by_nm,\r\n    st.onholdreason_opi as on_hold_rsn_desc,\r\n    st.discpercent as dscnt_pct,\r\n    st.custendcustomerid_opi as end_cust_nm,\r\n    st.customerref as cust_ref_txt,\r\n    st.deliveryname as dlvry_cust_nm,\r\n    oso.opco_sls_ordr_doc_status_sk,\r\n    ocust.opco_cust_sk as invoice_cust_sk,\r\n    st.linedisc as line_dscnt_cd,\r\n    st.phaseid_opi as sls_ordr_phase_cd,\r\n    st.pricegroupid as trade_grp_cd,\r\n    -- pdg.name as trade_grp_nm,\r\n    '' as trade_grp_nm,\r\n    -- pdg.module as trade_grp_module_txt,\r\n    '' as trade_grp_module_txt,\r\n    -- pdg.type as trade_grp_type_txt,\r\n    '' as trade_grp_type_txt,\r\n    st.receiptdateconfirmed as rcpt_cnfrm_dt,\r\n    st.receiptdaterequested as rcpt_rqst_dt,\r\n    st.salestaker as sls_taker_nm,\r\n    osot.opco_sls_ordr_type_sk,\r\n    st.shippingdateconfirmed as ship_cnfrm_dt,\r\n    st.shippingdaterequested as ship_rqst_dt,\r\n    st.titanjobnum_opi as titan_job_nbr,\r\n    st.creatededi_ep_opi as online_ordr_ind,\r\n    st.specialinstructions_opi as spcl_instr_txt,\r\n    st.taxexemptnumber_opi as tax_exempt_nbr,\r\n    st.commissiongroup as commsn_grp_id,\r\n    ccg.name as commsn_grp_nm,\r\n    st.deadline as last_acceptance_dt,\r\n    st.fixedduedate as fixed_due_dt,\r\n    st.backlogcost_opi as backlog_cost_amt,\r\n    st.backlogsales_opi as backlog_sls_amt,\r\n    st.biddate_opi as bid_dt,\r\n    case\r\n        when st.donotprintinvoice_opi = 0 then 1\r\n        when st.donotprintinvoice_opi = 1 then 0\r\n    end as print_invoice_ind,\r\n    st.del_leadcode_opi as sls_lead_cd,\r\n    st.namealias_opi as cust_alt_nm,\r\n    st.dispatchlocation_opi as dsptch_locn_nm,\r\n    st.tmsequiptype_opi as equipment_type_txt\r\n    from {{source('AX_DEV', 'SALESTABLE')}} st \r\n    -- left join {{ source('AX_DEV', 'PRICEDISCGROUP') }} pdg \r\n    --     on st.dataareaid = pdg.dataareaid\r\n    --     and st.pricegroupid = pdg.groupid\r\n    --     and st.dataareaid not in {{ var('excluded_ax_companies')}}\r\n    --     and pdg.dataareaid not in {{ var('excluded_ax_companies')}}\r\n    --     and pdg._fivetran_deleted = false\r\n    left join {{ source('AX_DEV', 'COMMISSIONCUSTOMERGROUP') }} ccg\r\n        on st.dataareaid = ccg.dataareaid\r\n        and st.commissiongroup = ccg.groupid\r\n        and st.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and ccg.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and ccg._fivetran_deleted = false\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(st.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(st.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(st.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} oip \r\n        on upper(st.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(st.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_curr')}} oc \r\n        on st.dataareaid = oc.opco_id\r\n        and st.custaccount = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_trans_status_curr')}} oss \r\n        on st.salesstatus = oss.src_trans_status_cd\r\n        and oss.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_grp_curr')}} ocg \r\n        on upper(st.custgroup) = ocg.src_cust_grp_cd\r\n        and ocg.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_site_curr')}} os \r\n        on upper(st.inventsiteid) = os.src_site_id\r\n        and os.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_currency_curr')}} ocu \r\n        on upper(st.currencycode) = ocu.src_currency_cd\r\n        and ocu.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(st.payment) = opt.src_pymnt_terms_cd\r\n        and opt.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_pymnt_mode_curr')}} opm \r\n        on upper(st.paymmode) = opm.src_pymnt_mode_cd\r\n        and opm.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cash_dscnt_terms_curr')}} ocd \r\n        on upper(st.cashdisc) = ocd.src_cash_dscnt_terms_cd\r\n        and ocd.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_sls_ordr_doc_status_curr')}} oso \r\n        on st.documentstatus = oso.src_sls_ordr_doc_status_cd\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_sls_ordr_type_curr')}} osot\r\n        on st.salestype = osot.src_sls_ordr_type_cd\r\n        and osot.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_terms_curr')}} odt \r\n        on upper(st.dlvterm) = odt.src_dlvry_terms_cd\r\n        and odt.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(st.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_locn_curr')}} olc\r\n        on st.deliverystreet = olc.addr_ln_1_txt\r\n        and st.deliverycity = olc.city_nm\r\n        and st.deliverystate = olc.state_nm\r\n        and st.deliverycountryregionid = olc.country_nm\r\n        and st.deliveryzipcode = olc.zip_cd\r\n    left join {{ ref('v_ax_warehouse_curr')}} wr \r\n        on upper(st.inventlocationid) = wr.warehouse_id\r\n        and st.dataareaid = wr.opco_id\r\n        and wr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_cust_curr')}} ocust\r\n        on st.dataareaid = ocust.opco_id\r\n        and st.invoiceaccount = ocust.cust_id\r\n        and ocust.src_sys_nm = 'AX'\r\n    where st.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'sls_ordr_id']) }} as opco_sls_ordr_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'sls_ordr_id', 'sls_ordr_nm', 'sls_ordr_dt', 'ship_dt', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_cust_sk', 'opco_trans_status_sk', 'opco_cust_grp_sk', 'opco_site_sk', 'opco_dlvry_terms_sk', 'opco_dlvry_mode_sk', 'dlvry_loc_sk', 'warehouse_sk', 'sls_grp_nm', 'tax_grp_id', 'quotation_id', 'cust_po_nbr', 'trans_currency_sk', 'opco_pymnt_terms_sk', 'opco_pymnt_mode_sk', 'opco_cash_dscnt_terms_sk', 'cash_dscnt_pct', 'sls_ordr_crt_dtm', 'sls_ordr_modified_dtm', 'sls_ordr_crt_by_nm', 'sls_ordr_modified_by_nm', 'on_hold_ind', 'on_hold_by_nm', 'on_hold_rsn_desc', 'dscnt_pct', 'end_cust_nm', 'cust_ref_txt', 'dlvry_cust_nm', 'opco_sls_ordr_doc_status_sk', 'invoice_cust_sk', 'line_dscnt_cd', 'sls_ordr_phase_cd', 'trade_grp_cd', 'trade_grp_nm', 'trade_grp_module_txt', 'trade_grp_type_txt', 'rcpt_cnfrm_dt', 'rcpt_rqst_dt', 'sls_taker_nm', 'opco_sls_ordr_type_sk', 'ship_cnfrm_dt', 'ship_rqst_dt', 'titan_job_nbr', 'online_ordr_ind', 'spcl_instr_txt', 'tax_exempt_nbr', 'commsn_grp_id', 'commsn_grp_nm', 'last_acceptance_dt', 'fixed_due_dt', 'backlog_cost_amt', 'backlog_sls_amt', 'bid_dt', 'print_invoice_ind', 'sls_lead_cd', 'cust_alt_nm', 'dsptch_locn_nm', 'equipment_type_txt']) }} as opco_sls_ordr_ck, \r\n        concat_ws('|', src_sys_nm, opco_id, sls_ordr_id) as opco_sls_ordr_ak, \r\n        * \r\n    from ax_opco_sls_ordr \r\n)\r\n\r\nselect * from final   \r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_SLS_ORDR') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_SLS_ORDR') and _load != 3%}\r\n    union\r\n    select\r\n    opco_sls_ordr_sk, opco_sls_ordr_ck, opco_sls_ordr_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, sls_ordr_id, sls_ordr_nm, sls_ordr_dt, ship_dt, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, opco_cust_sk, opco_trans_status_sk, opco_cust_grp_sk, opco_site_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_loc_sk,\r\n    warehouse_sk, sls_grp_nm, tax_grp_id, quotation_id, cust_po_nbr, trans_currency_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk, opco_cash_dscnt_terms_sk,\r\n    cash_dscnt_pct, sls_ordr_crt_dtm, sls_ordr_modified_dtm, sls_ordr_crt_by_nm, sls_ordr_modified_by_nm, on_hold_ind, on_hold_by_nm, on_hold_rsn_desc, \r\n    dscnt_pct, end_cust_nm, cust_ref_txt, dlvry_cust_nm, opco_sls_ordr_doc_status_sk, invoice_cust_sk, line_dscnt_cd, sls_ordr_phase_cd, trade_grp_cd,\r\n    trade_grp_nm, trade_grp_module_txt, trade_grp_type_txt, rcpt_cnfrm_dt, rcpt_rqst_dt, sls_taker_nm, opco_sls_ordr_type_sk, ship_cnfrm_dt, \r\n    ship_rqst_dt, titan_job_nbr, online_ordr_ind, spcl_instr_txt, tax_exempt_nbr, commsn_grp_id, commsn_grp_nm, last_acceptance_dt, fixed_due_dt, \r\n    backlog_cost_amt, backlog_sls_amt, bid_dt, print_invoice_ind, sls_lead_cd, cust_alt_nm, dsptch_locn_nm, equipment_type_txt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR\r\n    {% if _load == 1 %}\r\n        where opco_sls_ordr_ck not in (select distinct opco_sls_ordr_ck from final)\r\n    {% else %}\r\n        where opco_sls_ordr_ck not in (select distinct opco_sls_ordr_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_sls_ordr_ck not in (select distinct opco_sls_ordr_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_sls_ordr_ck in (select distinct opco_sls_ordr_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.SALESTABLE", "source.OI_Foundation.AX_DEV.PRICEDISCGROUP", "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_warehouse_curr", "model.OI_Foundation.v_ax_opco_cust_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_sls_ordr"], "unique_id": "model.OI_Foundation.ax_opco_sls_ordr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_sls_ordr.sql", "original_file_path": "models/ax/sales_order/ax_opco_sls_ordr.sql", "name": "ax_opco_sls_ordr", "alias": "ax_opco_sls_ordr", "checksum": {"name": "sha256", "checksum": "8095c731a9f10049032b091aa084b085d0df527ac5f0beadaa4bbe51a71f7894"}, "tags": [], "refs": [["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_trans_status_curr"], ["v_ax_opco_cust_grp_curr"], ["v_ax_opco_site_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_pymnt_mode_curr"], ["v_ax_opco_cash_dscnt_terms_curr"], ["v_ax_opco_sls_ordr_doc_status_curr"], ["v_ax_opco_sls_ordr_type_curr"], ["v_ax_opco_dlvry_terms_curr"], ["v_ax_opco_dlvry_mode_curr"], ["v_ax_opco_locn_curr"], ["v_ax_warehouse_curr"], ["v_ax_opco_cust_curr"]], "sources": [["AX_DEV", "SALESTABLE"], ["AX_DEV", "PRICEDISCGROUP"], ["AX_DEV", "COMMISSIONCUSTOMERGROUP"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.4714894}, "model.OI_Foundation.ax_opco_trans_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_trans_status as (\r\n  {% set values = ['Open Order', 'Delivered', 'Invoiced', 'Canceled'] %}\r\n\r\n  {% for i in range(5) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{ i }} as src_trans_status_cd,\r\n          {% if i == 0 %}\r\n            null as src_trans_status_desc\r\n          {% else %}\r\n            '{{values[i-1]}}' as src_trans_status_desc\r\n          {% endif %}\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select \r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_trans_status_cd']) }} as opco_trans_status_sk, \r\n      {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_trans_status_cd','src_trans_status_desc']) }} as opco_trans_status_ck, \r\n      *\r\n    from opco_trans_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_trans_status"], "unique_id": "model.OI_Foundation.ax_opco_trans_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_trans_status.sql", "original_file_path": "models/ax/sales_order/ax_opco_trans_status.sql", "name": "ax_opco_trans_status", "alias": "ax_opco_trans_status", "checksum": {"name": "sha256", "checksum": "223d28d5b1b1ba5589eef3725849841a1cf0aacaadd05b65b09646301edce6d0"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.4995155}, "model.OI_Foundation.ax_opco_dlvry_terms": {"raw_sql": "{% set _load = load_type('AX_OPCO_DLVRY_TERMS') %}\r\n\r\nwith ax_opco_dlvry_terms as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(code) as src_dlvry_terms_cd,\r\n    max(txt) as src_dlvry_terms_desc\r\n    from {{source('AX_DEV', 'DLVTERM')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_dlvry_terms_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dlvry_terms_cd']) }} as opco_dlvry_terms_sk, \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dlvry_terms_cd','src_dlvry_terms_desc']) }} as opco_dlvry_terms_ck, \r\n        *\r\n    from ax_opco_dlvry_terms\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_DLVRY_TERMS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_DLVRY_TERMS') and _load != 3%}\r\n    union\r\n    select\r\n    opco_dlvry_terms_sk, opco_dlvry_terms_ck, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_dlvry_terms_cd, src_dlvry_terms_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_TERMS\r\n    {% if _load == 1 %}\r\n        where opco_dlvry_terms_ck not in (select distinct opco_dlvry_terms_ck from final)\r\n    {% else %}\r\n        where opco_dlvry_terms_ck not in (select distinct opco_dlvry_terms_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_TERMS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dlvry_terms_ck not in (select distinct opco_dlvry_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_TERMS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dlvry_terms_ck in (select distinct opco_dlvry_terms_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_TERMS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DLVTERM"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_dlvry_terms"], "unique_id": "model.OI_Foundation.ax_opco_dlvry_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_dlvry_terms.sql", "original_file_path": "models/ax/sales_order/ax_opco_dlvry_terms.sql", "name": "ax_opco_dlvry_terms", "alias": "ax_opco_dlvry_terms", "checksum": {"name": "sha256", "checksum": "2d94728518ee32aec7a100bd599a44f239ccfcfffd23788387e04cc05f234b79"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DLVTERM"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.5075908}, "model.OI_Foundation.ax_opco_sls_ordr_line": {"raw_sql": "{% set _load = load_type('AX_OPCO_SLS_ORDR_LINE') %}\r\n\r\nwith ax_opco_sls_ordr_line as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    sl._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when sl._fivetran_deleted = true then sl._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    sl.dataareaid as opco_id,\r\n    sl.salesid as sls_ordr_id,\r\n    sl.linenum as sls_ordr_line_nbr,\r\n    sl.inventtransid as invtry_trans_id,\r\n    opco.opco_sk,\r\n    oso.opco_sls_ordr_sk,\r\n    oi.opco_item_sk,\r\n    oc.opco_cust_sk,\r\n    ocu.opco_currency_sk as trans_currency_sk,\r\n    ou.opco_uom_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    oip.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    oa.opco_assctn_sk,\r\n    osos.opco_trans_status_sk,\r\n    osot.opco_sls_ordr_type_sk, \r\n    odm.opco_dlvry_mode_sk,\r\n    sl.blocked as line_blocked_ind,\r\n    sl.complete as line_dlvry_complete_ind,\r\n    sl.name as item_nm,\r\n    case\r\n        when sl.deliverytype = 0 then null\r\n        when sl.deliverytype = 1 then 'Direct Delivery'\r\n    end as dlvry_type_txt,\r\n    sl.purchorderformnum as po_form_nbr,\r\n    sl.drawing_opi as drawing_locn_txt,\r\n    sl.itembomid as item_bom_id,\r\n    sl.deliverydatecontroltype as dlvry_date_contrl_txt,\r\n    sl.createddatetime as sls_ordr_line_crt_dtm,\r\n    sl.receiptdaterequested as rqst_rcpt_dt,\r\n    sl.receiptdateconfirmed as cnfrm_rcpt_dt,\r\n    sl.shippingdaterequested as rqst_ship_dt,\r\n    sl.shippingdateconfirmed as cnfrm_ship_dt,\r\n    sl.confirmeddlv as cnfrm_dlvry_dt,\r\n    sl.groupname_opi as grp_nm,\r\n    sl.inventrefid as trans_ref_id,\r\n    sl.mark_opi as mrkt_cd,\r\n    sl.orderdetailid_opi as sls_ordr_dtl_id,\r\n    sl.phaseid_opi as phase_id,\r\n    sl.priority_opi as priority_cd,\r\n    sl.risktype_opi as risk_ind,\r\n    sl.special_opi as spcl_item_ind,\r\n    sl.specialinspecial_opi as spcl_in_spcl_item_ind,\r\n    sl.specialnumber_opi as spcl_item_id,\r\n    sl.titanjobnum_opi as titan_job_nbr,\r\n    sl.taxgroup as tax_grp_id,\r\n    sl.taxitemgroup as tax_item_grp_txt,\r\n    sl.salesgroup as sls_grp_txt,\r\n    sl.salesunit as sales_unit_cd,\r\n    sl.height_opi as item_height_nbr,\r\n    sl.itemnetweight_opi as item_net_weight_amt,\r\n    sl.remaininventphysical as invtry_qty,\r\n    sl.qtyordered as ordr_qty,\r\n    sl.remainsalesphysical as non_dlvrd_qty,\r\n    sl.remainsalesfinancial as non_invoiced_dlvrd_qty,\r\n    sl.salesqty as sls_qty,\r\n    sl.sisqty_opi as sis_qty,\r\n    sl.costprice as unit_cost_price_amt,\r\n    sl.salesprice as unit_sls_price_amt,\r\n    sl.defaultprice_opi as item_default_price_amt,\r\n    sl.ediprice_opi as item_online_price_amt,\r\n    sl.listprice_opi as item_list_price_amt,\r\n    sl.itemcost_opi as item_cost_amt,\r\n    sl.lineamount as total_sls_amt,\r\n    sl.salesmarkup as fixed_misc_amt,\r\n    sl.imbfrt_opi as imbedded_freight_amt,\r\n    sl.imbfrtcost_opi as imbedded_freight_cost_amt,\r\n    sl.overheadcostpct_opi as overhead_cost_pct,\r\n    sl.linepercent as line_dscnt_pct,\r\n    sl.engineeringhours_opi as engineering_hours_nbr,\r\n    sl.laborhours_opi as labor_hours_nbr   \r\n    from {{source('AX_DEV', 'SALESLINE')}} sl \r\n    left join {{ref('v_ax_opco_curr')}} opco \r\n        on sl.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_sls_ordr_curr')}} oso \r\n        on sl.dataareaid = oso.opco_id\r\n        and sl.salesid = oso.sls_ordr_id\r\n        and oso.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_item_curr')}} oi \r\n        on sl.dataareaid = oi.opco_id\r\n        and sl.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cust_curr')}} oc \r\n        on sl.dataareaid = oc.opco_id\r\n        and sl.custaccount = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_currency_curr')}} ocu \r\n        on upper(sl.currencycode) = ocu.src_currency_cd\r\n        and ocu.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(sl.salesunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(sl.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(sl.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(sl.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} oip \r\n        on upper(sl.dimension4_) = oip.src_purpose_cd\r\n        and oip.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(sl.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_assctn_curr')}} oa \r\n        on sl.inventdimid = oa.src_assctn_cd\r\n        and sl.dataareaid = oa.opco_id\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_sls_ordr_type_curr')}} osot \r\n        on sl.salestype = osot.src_sls_ordr_type_cd\r\n        and osot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_trans_status_curr')}} osos\r\n        on sl.salesstatus = osos.src_trans_status_cd\r\n        and osos.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_dlvry_mode_curr')}} odm \r\n        on upper(sl.dlvmode) = odm.src_dlvry_mode_cd\r\n        and odm.src_sys_nm = 'AX'\r\n    where sl.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select distinct\r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'sls_ordr_id', 'sls_ordr_line_nbr', 'invtry_trans_id']) }} as opco_sls_ordr_line_sk,\r\n           {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'sls_ordr_id', 'sls_ordr_line_nbr', 'invtry_trans_id', 'opco_sk', 'opco_sls_ordr_sk', 'opco_item_sk', 'opco_cust_sk', 'trans_currency_sk', 'opco_uom_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_assctn_sk', 'opco_trans_status_sk', 'opco_sls_ordr_type_sk', 'opco_dlvry_mode_sk', 'line_blocked_ind', 'line_dlvry_complete_ind', 'item_nm', 'dlvry_type_txt', 'po_form_nbr', 'drawing_locn_txt', 'item_bom_id', 'dlvry_date_contrl_txt', 'sls_ordr_line_crt_dtm', 'rqst_rcpt_dt', 'cnfrm_rcpt_dt', 'rqst_ship_dt', 'cnfrm_ship_dt', 'cnfrm_dlvry_dt', 'grp_nm', 'trans_ref_id', 'mrkt_cd', 'sls_ordr_dtl_id', 'phase_id', 'priority_cd', 'risk_ind', 'spcl_item_ind', 'spcl_in_spcl_item_ind', 'spcl_item_id', 'titan_job_nbr', 'tax_grp_id', 'tax_item_grp_txt', 'sls_grp_txt', 'sales_unit_cd', 'item_height_nbr', 'item_net_weight_amt', 'invtry_qty', 'ordr_qty', 'non_dlvrd_qty', 'non_invoiced_dlvrd_qty', 'sls_qty', 'sis_qty', 'unit_cost_price_amt', 'unit_sls_price_amt', 'item_default_price_amt', 'item_online_price_amt', 'item_list_price_amt', 'item_cost_amt', 'total_sls_amt', 'fixed_misc_amt', 'imbedded_freight_amt', 'imbedded_freight_cost_amt', 'overhead_cost_pct', 'line_dscnt_pct', 'engineering_hours_nbr', 'labor_hours_nbr']) }} as opco_sls_ordr_line_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, sls_ordr_id, sls_ordr_line_nbr, invtry_trans_id) as opco_sls_ordr_line_ak, \r\n            * \r\n    from ax_opco_sls_ordr_line \r\n    \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_SLS_ORDR_LINE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_SLS_ORDR_LINE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_sls_ordr_line_sk, opco_sls_ordr_line_ck, opco_sls_ordr_line_ak, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, opco_id, sls_ordr_id, sls_ordr_line_nbr, invtry_trans_id, opco_sk, opco_sls_ordr_sk, opco_item_sk, opco_cust_sk, trans_currency_sk,\r\n    opco_uom_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_assctn_sk, opco_trans_status_sk, opco_sls_ordr_type_sk,\r\n    opco_dlvry_mode_sk, line_blocked_ind, line_dlvry_complete_ind, item_nm, dlvry_type_txt, po_form_nbr, drawing_locn_txt, item_bom_id, dlvry_date_contrl_txt, \r\n    sls_ordr_line_crt_dtm, rqst_rcpt_dt, cnfrm_rcpt_dt, rqst_ship_dt, cnfrm_ship_dt, cnfrm_dlvry_dt, grp_nm, trans_ref_id, mrkt_cd, sls_ordr_dtl_id, phase_id, \r\n    priority_cd, risk_ind, spcl_item_ind, spcl_in_spcl_item_ind, spcl_item_id, titan_job_nbr, tax_grp_id, tax_item_grp_txt, sls_grp_txt, sales_unit_cd,\r\n    item_height_nbr, item_net_weight_amt, invtry_qty, ordr_qty, non_dlvrd_qty, non_invoiced_dlvrd_qty, sls_qty, sis_qty, unit_cost_price_amt, \r\n    unit_sls_price_amt, item_default_price_amt, item_online_price_amt, item_list_price_amt, item_cost_amt, total_sls_amt, fixed_misc_amt, imbedded_freight_amt,\r\n    imbedded_freight_cost_amt, overhead_cost_pct, line_dscnt_pct, engineering_hours_nbr, labor_hours_nbr\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR_LINE\r\n    {% if _load == 1 %}\r\n        where opco_sls_ordr_doc_status_ck not in (select distinct opco_sls_ordr_doc_status_ck from final)\r\n    {% else %}\r\n        where opco_sls_ordr_doc_status_ck not in (select distinct opco_sls_ordr_doc_status_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR_LINE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_sls_ordr_doc_status_ck not in (select distinct opco_sls_ordr_doc_status_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR_LINE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_sls_ordr_doc_status_ck in (select distinct opco_sls_ordr_doc_status_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SLS_ORDR_LINE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.SALESLINE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_sls_ordr_line"], "unique_id": "model.OI_Foundation.ax_opco_sls_ordr_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_sls_ordr_line.sql", "original_file_path": "models/ax/sales_order/ax_opco_sls_ordr_line.sql", "name": "ax_opco_sls_ordr_line", "alias": "ax_opco_sls_ordr_line", "checksum": {"name": "sha256", "checksum": "6cb1161d946cd1cb1b37eb4eddb0c9114bd2d004e7602cbfe873fd63bb3ad145"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_sls_ordr_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_sls_ordr_type_curr"], ["v_ax_opco_trans_status_curr"], ["v_ax_opco_dlvry_mode_curr"]], "sources": [["AX_DEV", "SALESLINE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.5191078}, "model.OI_Foundation.ax_sls_ordr_opco_locn_xref": {"raw_sql": "{% set _load = load_type('AX_SLS_ORDR_OPCO_LOCN_XREF') %}\r\n\r\nwith ax_sls_ordr_opco_locn_xref as (\r\n    select \r\n    {{ dbt_utils.surrogate_key([\"'AX'\", 'st.dataareaid', 'st.salesid']) }} as opco_sls_ordr_sk,\r\n    ol.opco_locn_sk,\r\n    'DELIVERY' as sls_ordr_opco_locn_asscn_type_txt,\r\n    current_timestamp as crt_dtm,\r\n    cp._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when cp._fivetran_deleted = true then cp._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    '' as contact_type_txt,\r\n    cp.name as contact_nm,\r\n    cp.phone as contact_ph_nbr,\r\n    '' as contact_ph_extn_nbr,\r\n    cp.cellularphone as contact_cell_nbr,\r\n    cp.phonelocal as contact_local_ph_nbr,\r\n    cp.telefax as contact_fax_nbr,\r\n    cp.telex as contact_telex_nbr,\r\n    cp.email as contact_email_id,\r\n    upper(st.languageid) as languate_txt,\r\n    '' as start_dt,\r\n    '' as end_dt\r\n    from {{source('AX_DEV', 'SALESTABLE')}} st\r\n    left join {{source('AX_DEV', 'CONTACTPERSON')}} cp  \r\n        on cp.dataareaid = st.dataareaid\r\n        and cp.contactpersonid = st.contactpersonid\r\n        and cp.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and st.dataareaid not in {{ var('excluded_ax_companies')}}\r\n        and cp._fivetran_deleted = false\r\n    left join {{ref('v_ax_opco_locn_curr')}} ol \r\n        on upper(st.deliverystreet) = ol.addr_ln_1_txt \r\n        and upper(st.deliverycity) = ol.city_nm\r\n        and upper(st.deliverystate) = ol.state_nm\r\n        and upper(st.deliverycountryregionid) = ol.country_nm\r\n        and upper(st.deliveryzipcode) = ol.zip_cd\r\n        and ol.src_sys_nm = 'AX'\r\n),\r\nfinal as (\r\n    select \r\n        opco_sls_ordr_sk, opco_locn_sk, sls_ordr_opco_locn_asscn_type_txt,\r\n        {{ dbt_utils.surrogate_key(['opco_sls_ordr_sk', 'opco_locn_sk', 'sls_ordr_opco_locn_asscn_type_txt', 'src_sys_nm', 'contact_type_txt', 'contact_nm', 'contact_ph_nbr', 'contact_ph_extn_nbr', 'contact_cell_nbr', 'contact_local_ph_nbr', 'contact_fax_nbr', 'contact_telex_nbr', 'contact_email_id', 'languate_txt', 'start_dt', 'end_dt'])}} as sls_ordr_opco_locn_xref_ck,\r\n        crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, languate_txt, start_dt, end_dt\r\n    from ax_sls_ordr_opco_locn_xref \r\n)\r\n\r\nselect * from final   \r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_SLS_ORDR_OPCO_LOCN_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'SLS_ORDR_OPCO_LOCN_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_sls_ordr_sk, opco_locn_sk, sls_ordr_opco_locn_asscn_type_txt, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, languate_txt, start_dt, end_dt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SLS_ORDR_OPCO_LOCN_XREF\r\n    {% if _load == 1 %}\r\n        where SLS_ORDR_OPCO_LOCN_XREF_ck not in (select distinct SLS_ORDR_OPCO_LOCN_XREF_ck from final)\r\n    {% else %}\r\n        where SLS_ORDR_OPCO_LOCN_XREF_ck not in (select distinct SLS_ORDR_OPCO_LOCN_XREF_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SLS_ORDR_OPCO_LOCN_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SLS_ORDR_OPCO_LOCN_XREF_ck not in (select distinct SLS_ORDR_OPCO_LOCN_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SLS_ORDR_OPCO_LOCN_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and SLS_ORDR_OPCO_LOCN_XREF_ck in (select distinct SLS_ORDR_OPCO_LOCN_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.SLS_ORDR_OPCO_LOCN_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.SALESTABLE", "source.OI_Foundation.AX_DEV.CONTACTPERSON", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_sls_ordr_opco_locn_xref"], "unique_id": "model.OI_Foundation.ax_sls_ordr_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_sls_ordr_opco_locn_xref.sql", "original_file_path": "models/ax/sales_order/ax_sls_ordr_opco_locn_xref.sql", "name": "ax_sls_ordr_opco_locn_xref", "alias": "ax_sls_ordr_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "807079ffbac32851a56257c9fc3faee6fd3baee467e451a9bcdfaa3860061eb2"}, "tags": [], "refs": [["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "SALESTABLE"], ["AX_DEV", "CONTACTPERSON"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.5449972}, "model.OI_Foundation.ax_opco_dlvry_mode": {"raw_sql": "{% set _load = load_type('AX_OPCO_DLVRY_MODE') %}\r\n\r\nwith ax_opco_dlvry_mode as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    max(_fivetran_synced) as stg_load_dtm,\r\n    case\r\n        when max(_fivetran_deleted) = true then stg_load_dtm\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    upper(code) as src_dlvry_mode_cd,\r\n    max(txt) as src_dlvry_mode_desc\r\n    from {{source('AX_DEV', 'DLVMODE')}}\r\n    where dataareaid not in {{ var('excluded_ax_companies')}}\r\n    group by src_sys_nm, src_dlvry_mode_cd, _fivetran_deleted\r\n),\r\nfinal as(\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dlvry_mode_cd']) }} as opco_dlvry_mode_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dlvry_mode_cd','src_dlvry_mode_desc']) }} as opco_dlvry_mode_ck, \r\n        *\r\n    from ax_opco_dlvry_mode\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_DLVRY_MODE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_DLVRY_MODE') and _load != 3%}\r\n    union\r\n    select\r\n    opco_dlvry_mode_sk, opco_dlvry_mode_ck, CRT_DTM, \r\n    (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n    (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n    src_sys_nm, src_dlvry_mode_cd, src_dlvry_mode_desc\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_MODE\r\n    {% if _load == 1 %}\r\n        where opco_dlvry_mode_ck not in (select distinct opco_dlvry_mode_ck from final)\r\n    {% else %}\r\n        where opco_dlvry_mode_ck not in (select distinct opco_dlvry_mode_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_MODE where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dlvry_mode_ck not in (select distinct opco_dlvry_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_MODE where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_dlvry_mode_ck in (select distinct opco_dlvry_mode_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DLVRY_MODE where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.DLVMODE"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_dlvry_mode"], "unique_id": "model.OI_Foundation.ax_opco_dlvry_mode", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_dlvry_mode.sql", "original_file_path": "models/ax/sales_order/ax_opco_dlvry_mode.sql", "name": "ax_opco_dlvry_mode", "alias": "ax_opco_dlvry_mode", "checksum": {"name": "sha256", "checksum": "0e7aa2bd06314161548d1c3836deabd5ced123dce9d372cd7132f1717075e6f5"}, "tags": [], "refs": [], "sources": [["AX_DEV", "DLVMODE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.560069}, "model.OI_Foundation.ax_opco_sls_ordr_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_sls_ordr_type as (\r\n  {% set values = ['Journal', 'Quotation', 'Subscription', 'Sales Order', 'Returned Order', 'Blanket Order', 'Item Requirements'] %}\r\n\r\n  {% for i in range(7) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{ i }} as src_sls_ordr_type_cd,\r\n          '{{values[i]}}' as src_sls_ordr_doc_status_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sls_ordr_type_cd']) }} as opco_sls_ordr_type_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sls_ordr_type_cd','src_sls_ordr_doc_status_desc']) }} as opco_sls_ordr_type_ck, \r\n        *\r\n    from opco_sls_ordr_type \r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "sales_order", "ax_opco_sls_ordr_type"], "unique_id": "model.OI_Foundation.ax_opco_sls_ordr_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/sales_order/ax_opco_sls_ordr_type.sql", "original_file_path": "models/ax/sales_order/ax_opco_sls_ordr_type.sql", "name": "ax_opco_sls_ordr_type", "alias": "ax_opco_sls_ordr_type", "checksum": {"name": "sha256", "checksum": "2cdeafb59896b1dbf6b4987b724914a5e1f0790cc2da353bb101ee36a1469231"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.5714939}, "model.OI_Foundation.ax_opco_project_cost_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_COST_TRANS') %}\r\n\r\nwith ax_opco_project_cost_trans as(\t\t\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    pt._fivetran_synced as stg_load_dtm,\r\n\tcase \r\n\t    when pt._fivetran_deleted = true then pt._fivetran_synced\r\n        else null\r\n\tend as delete_dtm,\r\n\t'AX' as src_sys_nm,\r\n\tpt.dataareaid as opco_id,\r\n\tpt.transid as project_cost_trans_id,\r\n\to.opco_sk,\r\n\top.opco_project_sk,\r\n\tooc.opco_cost_center_sk,\r\n\tod.opco_dept_sk,\r\n\tot.opco_type_sk,\r\n\topp.opco_purpose_sk,\r\n\tol.opco_lob_sk,\r\n\tou.opco_uom_sk,\r\n\ttc.opco_currency_sk as trans_currency_sk,\r\n\topc.opco_project_catgry_sk,\r\n\topts.opco_project_trans_status_sk,\r\n\topto.opco_project_trans_origin_sk,\r\n\tpt.transdate as trans_dt,\r\n\tpt.txt as trans_desc,\r\n\tcase \r\n        when pt.ledgerstatuscost = 0 then 'No Ledger'\r\n        when pt.ledgerstatuscost = 1 then 'Balance'\r\n        when pt.ledgerstatuscost = 2 then 'Profit and Loss'\r\n        when pt.ledgerstatuscost = 3 then 'Never Ledger'\r\n    end as cost_gl_status_txt,\r\n    pt.taxgroupid as tax_grp_id,\t\t\t\r\n\tpt.voucherjournal as voucher_nbr,\t\t\t\r\n\tpt.invoiceid_opi as invoice_nbr,\t\t\t\r\n\tpt.documentnum_opi as document_nbr,\t\t\r\n\tpt.transidref as ref_trans_id,\t\t\r\n\tpt.calculated_opi as calculated_ind,\t\r\n\tpt.qty as trans_qty,\t\t\t\t\t\t \r\n\tpt.costpricecurrency  as trans_currency_cost_price_amt,\t \r\n\tpt.costprice as opco_currency_cost_price_amt,\t \r\n\tpt.salesprice as opco_currency_sls_price_amt,\t\t \r\n\tpt.ledgersalesamount  as opco_currency_gl_sls_amt,\t\t \r\n\tpt.costamountledger as opco_currency_gl_cost_amt,\t\t \r\n\tpt.itemprice_opi as opco_currency_item_price_amt,\t \r\n\tpt.totalstdcost_opi as opco_currency_total_std_cost_amt, \r\n\tpt.totalcost_opi  as opco_currency_total_cost_amt,\t \r\n\tpt.totalrevenue_opi as opco_currency_total_revenue_amt,\t \r\n\tpt.salestaxamount_opi as opco_currency_sls_tax_amt,\t\t \r\n\tpt.freightamount_opi as opco_currency_freight_amt,\t\t \r\n\tpt.cashdiscamount_opi as opco_currency_cash_dscnt_amt,\t \r\n\tpt.mcpercent_opi as margin_contribution_pct\r\n    from {{source('AX_DEV', 'PROJCOSTTRANS')}} pt\r\n    left join {{ref('v_ax_opco_curr')}} o    \r\n        on pt.dataareaid = o.opco_id    \r\n        and o.src_sys_nm = 'AX'  \r\n\tleft join {{ref('v_ax_opco_project_curr')}} op \r\n        on pt.dataareaid = op.opco_id\r\n\t\tand pt.projid = op.project_id\r\n        and op.src_sys_nm = 'AX'  \t\t\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} ooc \r\n        on upper(pt.dimension) = ooc.src_cost_center_cd\r\n        and ooc.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od\r\n        on upper(pt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n\tleft join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pt.dimension3_) = ot.src_type_cd\t\r\n        and ot.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_purpose_curr')}} opp\r\n        on upper(pt.dimension4_) = opp.src_purpose_cd\t\r\n        and opp.src_sys_nm = 'AX'  \t\t\r\n\tleft join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(pt.dimension5_) = ol.src_lob_cd\t\r\n        and ol.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pt.unitid_opi) = ou.src_uom_cd\t\r\n        and ou.src_sys_nm = 'AX'  \r\n\tleft join {{ref('v_ax_opco_currency_curr')}} tc \r\n        on upper(pt.currencyidcost) = tc.src_currency_cd\r\n        and tc.src_sys_nm = 'AX'\r\n\tleft join {{ref('v_ax_opco_project_catgry_curr')}} opc \r\n        on pt.dataareaid = opc.opco_id\r\n\t\tand pt.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX' \r\n\tleft join {{ ref('v_ax_opco_project_trans_status_curr')}} opts\r\n\t\ton pt.transstatus = opts.project_trans_status_cd\r\n\t\tand opts.src_sys_nm = 'AX'\r\n\tleft join {{ ref('v_ax_opco_project_trans_origin_curr')}} opto\r\n\t\ton pt.transactionorigin = opto.project_trans_origin_cd\r\n\t\tand opto.src_sys_nm = 'AX'\r\n\twhere pt.dataareaid not in {{ var('excluded_ax_companies')}}    \r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select distinct\r\n\t\t\t{{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_cost_trans_id']) }} as opco_project_cost_trans_sk,\r\n\t\t\t{{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_cost_trans_id', 'opco_sk', 'opco_project_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_uom_sk', 'trans_currency_sk', 'opco_project_catgry_sk', 'opco_project_trans_status_sk', 'opco_project_trans_origin_sk', 'trans_dt', 'trans_desc', 'cost_gl_status_txt', 'tax_grp_id', 'voucher_nbr', 'invoice_nbr', 'document_nbr', 'ref_trans_id', 'calculated_ind', 'trans_qty', 'trans_currency_cost_price_amt', 'opco_currency_cost_price_amt', 'opco_currency_sls_price_amt', 'opco_currency_gl_sls_amt', 'opco_currency_gl_cost_amt', 'opco_currency_item_price_amt', 'opco_currency_total_std_cost_amt', 'opco_currency_total_cost_amt', 'opco_currency_total_revenue_amt', 'opco_currency_sls_tax_amt', 'opco_currency_freight_amt', 'opco_currency_cash_dscnt_amt', 'margin_contribution_pct']) }} as opco_project_cost_trans_ck,\r\n\t\t\tconcat_ws('|', src_sys_nm, opco_id, project_cost_trans_id) as opco_project_cost_trans_ak,\r\n            * \t\t\r\n    from ax_opco_project_cost_trans \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_COST_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_COST_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_COST_TRANS_sk, OPCO_PROJECT_COST_TRANS_ck, OPCO_PROJECT_COST_TRANS_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_cost_trans_id, opco_sk, opco_project_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_uom_sk, trans_currency_sk, opco_project_catgry_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_dt, trans_desc, cost_gl_status_txt, tax_grp_id, voucher_nbr, invoice_nbr, document_nbr, ref_trans_id, calculated_ind, trans_qty, trans_currency_cost_price_amt, opco_currency_cost_price_amt, opco_currency_sls_price_amt, opco_currency_gl_sls_amt, opco_currency_gl_cost_amt, opco_currency_item_price_amt, opco_currency_total_std_cost_amt, opco_currency_total_cost_amt, opco_currency_total_revenue_amt, opco_currency_sls_tax_amt, opco_currency_freight_amt, opco_currency_cash_dscnt_amt, margin_contribution_pct\r\n\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_COST_TRANS_ck not in (select distinct OPCO_PROJECT_COST_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_COST_TRANS_ck not in (select distinct OPCO_PROJECT_COST_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_COST_TRANS_ck not in (select distinct OPCO_PROJECT_COST_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_COST_TRANS_ck in (select distinct OPCO_PROJECT_COST_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJCOSTTRANS", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_cost_trans"], "unique_id": "model.OI_Foundation.ax_opco_project_cost_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_cost_trans.sql", "original_file_path": "models/ax/project/ax_opco_project_cost_trans.sql", "name": "ax_opco_project_cost_trans", "alias": "ax_opco_project_cost_trans", "checksum": {"name": "sha256", "checksum": "a768d1aeb20a2b7ba9e391f775d2e7fbe037e06a3f02796d1521674331b466bb"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_project_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_project_trans_status_curr"], ["v_ax_opco_project_trans_origin_curr"]], "sources": [["AX_DEV", "PROJCOSTTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.5794795}, "model.OI_Foundation.ax_opco_project_item_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_ITEM_TRANS') %}\r\n\r\nwith ax_opco_project_item_trans as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    pit._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pit._fivetran_deleted = true then pit._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pit.dataareaid as opco_id,\r\n    pit.projtransid as project_item_trans_id,\r\n    pit.inventtransid as invtry_trans_id,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    oi.opco_item_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opc.opco_project_catgry_sk,\r\n    ou.opco_uom_sk as trans_uom_sk,\r\n    oa.opco_assctn_sk,\r\n    opts.opco_project_trans_status_sk,\r\n    opto.opco_project_trans_origin_sk,\r\n    pit.transdate as trans_dt,\r\n    pit.txt as trans_desc,\r\n    pit.linepropertyid as line_property_id,\r\n    pit.taxgroupid as tax_grp_id,\r\n    taxitemgroupid as tax_item_grp_id,\r\n    voucherpackingslip as packing_slip_voucher_nbr,\r\n    salesinvoiceid as cust_invoice_nbr,\r\n    projadjustrefid as project_adjsmt_ref_id,\r\n    projtransidref as ref_project_item_trans_id,\r\n    calculated_opi as calc_ind,\r\n    convertedfromcosttrans_opi as project_cost_trans_conversion_ind,\r\n    qty as trans_qty,\r\n    salesprice as per_unit_sls_price_amt,\r\n    itemprice_opi as item_price_amt,\r\n    totalrevenue_opi as total_revenue_amt,\r\n    totalcost_opi as total_cost_amt,\r\n    totalstdcost_opi as total_std_cost_amt,\r\n    mcpercent_opi as margin_contribution_pct\r\n    from {{ source('AX_DEV', 'PROJITEMTRANS') }} pit\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pit.dataareaid = opr.opco_id\r\n        and pit.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on pit.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on pit.dataareaid = oi.opco_id\r\n        and pit.itemid = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pit.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pit.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pit.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(pit.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pit.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on pit.dataareaid = opc.opco_id\r\n        and pit.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pit.salesunit) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_assctn_curr')}} oa \r\n        on pit.dataareaid = oa.opco_id\r\n        and pit.inventdimid = oa.src_assctn_cd\r\n        and oa.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_trans_status_curr')}} opts\r\n\t\ton pit.transstatus = opts.project_trans_status_cd\r\n\t\tand opts.src_sys_nm = 'AX'\r\n\tleft join {{ ref('v_ax_opco_project_trans_origin_curr')}} opto\r\n\t\ton pit.transactionorigin = opto.project_trans_origin_cd\r\n\t\tand opto.src_sys_nm = 'AX'\r\n    where pit.dataareaid not in {{ var('excluded_ax_companies')}}\r\n    and pit.projtransid is not null\r\n    and pit.projtransid <> ''\r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_item_trans_id', 'invtry_trans_id']) }} as opco_project_item_trans_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_item_trans_id', 'invtry_trans_id', 'opco_project_sk', 'opco_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_project_catgry_sk', 'trans_uom_sk', 'opco_assctn_sk', 'opco_project_trans_status_sk', 'opco_project_trans_origin_sk', 'trans_dt', 'trans_desc', 'line_property_id', 'tax_grp_id', 'tax_item_grp_id', 'packing_slip_voucher_nbr', 'cust_invoice_nbr', 'project_adjsmt_ref_id', 'ref_project_item_trans_id', 'calc_ind', 'project_cost_trans_conversion_ind', 'trans_qty', 'per_unit_sls_price_amt', 'item_price_amt', 'total_revenue_amt', 'total_cost_amt', 'total_std_cost_amt', 'margin_contribution_pct']) }} as opco_project_item_trans_ck,\r\n        concat_ws('|', src_sys_nm, opco_id, project_item_trans_id, invtry_trans_id) as opco_project_item_trans_ak,\r\n        * \t\t\r\n    from ax_opco_project_item_trans \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_ITEM_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_ITEM_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_ITEM_TRANS_sk, OPCO_PROJECT_ITEM_TRANS_ck, OPCO_PROJECT_ITEM_TRANS_ak ,crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_item_trans_id, invtry_trans_id, opco_project_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_uom_sk, opco_assctn_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_dt, trans_desc, line_property_id, tax_grp_id, tax_item_grp_id, packing_slip_voucher_nbr, cust_invoice_nbr, project_adjsmt_ref_id, ref_project_item_trans_id, calc_ind, project_cost_trans_conversion_ind, trans_qty, per_unit_sls_price_amt, item_price_amt, total_revenue_amt, total_cost_amt, total_std_cost_amt, margin_contribution_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_ITEM_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_ITEM_TRANS_ck not in (select distinct OPCO_PROJECT_ITEM_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_ITEM_TRANS_ck not in (select distinct OPCO_PROJECT_ITEM_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_ITEM_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_ITEM_TRANS_ck not in (select distinct OPCO_PROJECT_ITEM_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_ITEM_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_ITEM_TRANS_ck in (select distinct OPCO_PROJECT_ITEM_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_ITEM_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJITEMTRANS", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_item_trans"], "unique_id": "model.OI_Foundation.ax_opco_project_item_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_item_trans.sql", "original_file_path": "models/ax/project/ax_opco_project_item_trans.sql", "name": "ax_opco_project_item_trans", "alias": "ax_opco_project_item_trans", "checksum": {"name": "sha256", "checksum": "4d9a6bcd165e25adf0100e378723707287c60a2885aa6a64c26aa51e2216d284"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_uom_curr"], ["v_ax_opco_assctn_curr"], ["v_ax_opco_project_trans_status_curr"], ["v_ax_opco_project_trans_origin_curr"]], "sources": [["AX_DEV", "PROJITEMTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.5990365}, "model.OI_Foundation.ax_opco_project_catgry": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_CATGRY') %}\r\n\r\nwith ax_opco_project_catgry as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    pt._fivetran_synced as stg_load_dtm,\r\n\tcase \r\n        when pt._fivetran_deleted = true then pt._fivetran_synced\r\n        else null\r\n\tend as delete_dtm,\r\n\t'AX' as src_sys_nm,\r\n\tpt.dataareaid as opco_id,\r\n\tpt.categoryid as catgry_cd,\r\n\to.opco_sk,\r\n\toi.opco_item_sk,\r\n\tocc.opco_cost_center_sk,\r\n\tod.opco_dept_sk,\r\n\tot.opco_type_sk,\r\n\top.opco_purpose_sk,\r\n\tol.opco_lob_sk,\r\n\tou.opco_uom_sk,\r\n\tpt.name as catgry_nm,\r\n\tpt.categorygroupid as catgry_grp_cd,\r\n\tcase \r\n        when pt.categorytype = 0 then 'None'\r\n        when pt.categorytype = 1 then 'Fee'\r\n        when pt.categorytype = 2 then 'Hour'\r\n        when pt.categorytype = 3 then 'Expense'\r\n        when pt.categorytype = 4 then 'Item'\r\n    end as catgry_type_txt,\r\n\tcase \r\n        when pt.projcategoryemploption = 0 then 'Mandatory'\r\n        when pt.projcategoryemploption = 1 then 'Optional'\r\n        when pt.projcategoryemploption = 2 then 'Never'\r\n    end as empl_applicable_ind,\r\n\tpt.active as actv_ind\r\n    from {{source('AX_DEV', 'PROJCATEGORY')}} pt\r\n    left join {{ref('v_ax_opco_curr')}} o    \r\n        on pt.dataareaid = o.opco_id    \r\n        and o.src_sys_nm = 'AX'  \r\n\tleft join {{ref('v_ax_opco_item_curr')}} oi \r\n        on pt.dataareaid = oi.opco_id\r\n\t\tand pt.itemid_opi = oi.src_item_cd\r\n        and oi.src_sys_nm = 'AX'  \t\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pt.dimension_opi) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od\r\n        on upper(pt.dimension_opi2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n\tleft join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pt.dimension_opi3_) = ot.src_type_cd\t\r\n        and ot.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_purpose_curr')}} op\r\n        on upper(pt.dimension_opi4_) = op.src_purpose_cd\t\r\n        and op.src_sys_nm = 'AX'  \t\t\r\n\tleft join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(pt.dimension_opi5_) = ol.src_lob_cd\t\r\n        and ol.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pt.unitid_opi) = ou.src_uom_cd\t\r\n        and ou.src_sys_nm = 'AX'  \r\n    where pt.dataareaid not in {{ var('excluded_ax_companies')}} \r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','catgry_cd']) }} as opco_project_catgry_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','catgry_cd', 'opco_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_uom_sk', 'catgry_nm', 'catgry_grp_cd', 'catgry_type_txt', 'empl_applicable_ind', 'actv_ind']) }} as opco_project_catgry_ck,\r\n            * \t\t\r\n    from ax_opco_project_catgry \t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_CATGRY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_CATGRY') and _load != 3%}\r\n    union\r\n    select\r\n    opco_project_catgry_sk, opco_project_catgry_ck, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, catgry_cd, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_uom_sk, catgry_nm, catgry_grp_cd, catgry_type_txt, empl_applicable_ind, actv_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT_CATGRY\r\n    {% if _load == 1 %}\r\n        where opco_PROJECT_CATGRY_ck not in (select distinct opco_PROJECT_CATGRY_ck from final)\r\n    {% else %}\r\n        where opco_PROJECT_CATGRY_ck not in (select distinct opco_PROJECT_CATGRY_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT_CATGRY where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_PROJECT_CATGRY_ck not in (select distinct opco_PROJECT_CATGRY_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT_CATGRY where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_PROJECT_CATGRY_ck in (select distinct opco_PROJECT_CATGRY_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT_CATGRY where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJCATEGORY", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_catgry"], "unique_id": "model.OI_Foundation.ax_opco_project_catgry", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_catgry.sql", "original_file_path": "models/ax/project/ax_opco_project_catgry.sql", "name": "ax_opco_project_catgry", "alias": "ax_opco_project_catgry", "checksum": {"name": "sha256", "checksum": "2b3ae975fc63edaab1384fd28ebadc41a2883263c0f1aa4709368bb4573e9645"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "PROJCATEGORY"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.6184342}, "model.OI_Foundation.ax_opco_project_cost_frcst": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_COST_FRCST') %}\r\n\r\nwith ax_opco_project_cost_frcst as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    pfc._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pfc._fivetran_deleted = true then pfc._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pfc.dataareaid as opco_id,\r\n    pfc.transid as project_cost_frcst_id,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opc.opco_project_catgry_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    ou.opco_uom_sk,\r\n    pfc.linepropertyid as line_property_id,\r\n    pfc.invoicedate as invoice_expctd_dt,\r\n    pfc.startdate as budget_amt_applctn_dt,\r\n    pfc.salespaymdate as revenue_pymnt_expctd_dt,\r\n    pfc.costpaymdate as cost_pymnt_expctd_dt,\r\n    pfc.eliminationdate as elimination_expctd_dt,\r\n    pfc.modelid as frcst_model_id,\r\n    pfc.taxgroupid as tax_grp_id,\r\n    pfc.report as include_in_rpt_ind,\r\n    pfc.islock_opi as lock_ind,\r\n    pfc.active as include_amt_ind,\r\n    pfc.qty as trans_qty,\r\n    pfc.costprice as opco_currency_cost_price_amt,\r\n    pfc.salesprice as trans_currency_sls_price_amt,\r\n    pfc.totalrevenue_opi as total_revenue_amt,\r\n    pfc.totalcost_opi as total_cost_amt,\r\n    pfc.mcpercent_opi as marging_contribution_pct\r\n    from {{ source('AX_DEV', 'PROJFORECASTCOST') }} pfc\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pfc.dataareaid = opr.opco_id\r\n        and pfc.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on pfc.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pfc.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pfc.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pfc.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(pfc.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pfc.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on pfc.dataareaid = opc.opco_id\r\n        and pfc.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr\r\n        on upper(pfc.currencyid) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pfc.unitid_opi) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'Ax'\r\n    where pfc.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select distinct\r\n\t\t\t{{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_cost_frcst_id']) }} as opco_project_cost_frcst_sk,\r\n\t\t\t{{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_cost_frcst_id', 'opco_project_sk', 'opco_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_project_catgry_sk', 'trans_currency_sk', 'opco_uom_sk', 'line_property_id', 'invoice_expctd_dt', 'budget_amt_applctn_dt', 'revenue_pymnt_expctd_dt', 'cost_pymnt_expctd_dt', 'elimination_expctd_dt', 'frcst_model_id', 'tax_grp_id', 'include_in_rpt_ind', 'lock_ind', 'include_amt_ind', 'trans_qty', 'opco_currency_cost_price_amt', 'trans_currency_sls_price_amt', 'total_revenue_amt', 'total_cost_amt', 'marging_contribution_pct']) }} as opco_project_cost_frcst_ck,\r\n\t\t\tconcat_ws('|', src_sys_nm, opco_id, project_cost_frcst_id) as opco_project_cost_frcst_ak,\r\n            * \t\t\r\n    from ax_opco_project_cost_frcst \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_COST_FRCST') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_COST_FRCST') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_COST_FRCST_sk, OPCO_PROJECT_COST_FRCST_ck, OPCO_PROJECT_COST_FRCST_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_cost_frcst_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_currency_sk, opco_uom_sk, line_property_id, invoice_expctd_dt, budget_amt_applctn_dt, revenue_pymnt_expctd_dt, cost_pymnt_expctd_dt, elimination_expctd_dt, frcst_model_id, tax_grp_id, include_in_rpt_ind, lock_ind, include_amt_ind, trans_qty, opco_currency_cost_price_amt, trans_currency_sls_price_amt, total_revenue_amt, total_cost_amt, marging_contribution_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_FRCST\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_COST_FRCST_ck not in (select distinct OPCO_PROJECT_COST_FRCST_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_COST_FRCST_ck not in (select distinct OPCO_PROJECT_COST_FRCST_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_FRCST where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_COST_FRCST_ck not in (select distinct OPCO_PROJECT_COST_FRCST_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_FRCST where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_COST_FRCST_ck in (select distinct OPCO_PROJECT_COST_FRCST_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_COST_FRCST where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJFORECASTCOST", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_cost_frcst"], "unique_id": "model.OI_Foundation.ax_opco_project_cost_frcst", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_cost_frcst.sql", "original_file_path": "models/ax/project/ax_opco_project_cost_frcst.sql", "name": "ax_opco_project_cost_frcst", "alias": "ax_opco_project_cost_frcst", "checksum": {"name": "sha256", "checksum": "aca31112f06bd1b5863206a775c3f808bddf6752ebaee7cec123cabf8222f729"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "PROJFORECASTCOST"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.6347113}, "model.OI_Foundation.ax_opco_project_empl_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_EMPL_TRANS') %}\r\n\r\nwith ax_opco_project_empl_trans as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    pet._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pet._fivetran_deleted = true then pet._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pet.dataareaid as opco_id,\r\n    pet.transid as project_empl_trans_id,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opc.opco_project_catgry_sk,\r\n    opts.opco_project_trans_status_sk,\r\n    opto.opco_project_trans_origin_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    pet.emplid as empl_id,\r\n    pet.linepropertyid as line_property_id,\r\n    pet.transidref as ref_project_empl_trans_id,\r\n    pet.taxgroupid as tax_grp_id,\r\n    pet.transdate as trans_dt,\r\n    pet.voucherjournal as gl_voucher_nbr,\r\n    case\r\n        when pet.ledgerstatuscost = 0 then 'No Ledger'\r\n        when pet.ledgerstatuscost = 1 then 'Balance'\r\n        when pet.ledgerstatuscost = 2 then 'Profit and Loss'\r\n        when pet.ledgerstatuscost = 3 then 'Never Ledger'\r\n        when pet.ledgerstatuscost = 100 then 'Undefined'\r\n    end as gl_section_txt,\r\n    pet.txt as project_empl_trans_desc,\r\n    pet.calculated_opi as calc_ind,\r\n    pet.qty as trans_hour_qty,\r\n    pet.costprice as opco_currency_hrly_cost_price_amt,\r\n    pet.salesprice as trans_currency_hrly_sls_price_amt,\r\n    pet.itemprice_opi as item_price_amt,\r\n    pet.totalrevenue_opi as total_revenue_amt,\r\n    pet.totalcost_opi as total_cost_amt,\r\n    pet.totalstdcost_opi as total_std_cost_amt,\r\n    pet.mcpercent_opi as margin_contribution_pct\r\n    from {{ source('AX_DEV', 'PROJEMPLTRANS') }} pet\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pet.dataareaid = opr.opco_id\r\n        and pet.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on pet.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pet.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pet.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pet.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(pet.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pet.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on pet.dataareaid = opc.opco_id\r\n        and pet.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_trans_status_curr')}} opts\r\n\t\ton pet.transstatus = opts.project_trans_status_cd\r\n\t\tand opts.src_sys_nm = 'AX'\r\n\tleft join {{ ref('v_ax_opco_project_trans_origin_curr')}} opto\r\n\t\ton pet.transactionorigin = opto.project_trans_origin_cd\r\n\t\tand opto.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr\r\n        on upper(pet.currencyid) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    where pet.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_empl_trans_id']) }} as opco_project_empl_trans_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_empl_trans_id', 'opco_project_sk', 'opco_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_project_catgry_sk', 'opco_project_trans_status_sk', 'opco_project_trans_origin_sk', 'trans_currency_sk', 'empl_id', 'line_property_id', 'ref_project_empl_trans_id', 'tax_grp_id', 'trans_dt', 'gl_voucher_nbr', 'gl_section_txt', 'project_empl_trans_desc', 'calc_ind', 'trans_hour_qty', 'opco_currency_hrly_cost_price_amt', 'trans_currency_hrly_sls_price_amt', 'item_price_amt', 'total_revenue_amt', 'total_cost_amt', 'total_std_cost_amt', 'margin_contribution_pct']) }} as opco_project_empl_trans_ck,\r\n        concat_ws('|', src_sys_nm, opco_id, project_empl_trans_id) as opco_project_empl_trans_ak,\r\n        * \t\t\r\n    from ax_opco_project_empl_trans opet\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_EMPL_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_EMPL_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_EMPL_TRANS_sk, OPCO_PROJECT_EMPL_TRANS_ck, OPCO_PROJECT_EMPL_TRANS_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_empl_trans_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_currency_sk, empl_id, line_property_id, ref_project_empl_trans_id, tax_grp_id, trans_dt, gl_voucher_nbr, gl_section_txt, project_empl_trans_desc, calc_ind, trans_hour_qty, opco_currency_hrly_cost_price_amt , trans_currency_hrly_sls_price_amt, item_price_amt, total_revenue_amt, total_cost_amt, total_std_cost_amt, margin_contribution_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_EMPL_TRANS_ck not in (select distinct OPCO_PROJECT_EMPL_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_EMPL_TRANS_ck not in (select distinct OPCO_PROJECT_EMPL_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_EMPL_TRANS_ck not in (select distinct OPCO_PROJECT_EMPL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_EMPL_TRANS_ck in (select distinct OPCO_PROJECT_EMPL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJEMPLTRANS", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_currency_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_empl_trans"], "unique_id": "model.OI_Foundation.ax_opco_project_empl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_empl_trans.sql", "original_file_path": "models/ax/project/ax_opco_project_empl_trans.sql", "name": "ax_opco_project_empl_trans", "alias": "ax_opco_project_empl_trans", "checksum": {"name": "sha256", "checksum": "37f9c29d24837200f3676e7a837c53b6a9dcf37ec36739b9a309c58b6b96762f"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_project_trans_status_curr"], ["v_ax_opco_project_trans_origin_curr"], ["v_ax_opco_currency_curr"]], "sources": [["AX_DEV", "PROJEMPLTRANS"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.652598}, "model.OI_Foundation.ax_opco_project": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT') %}\r\n\r\nwith ax_opco_project as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    pt._fivetran_synced as stg_load_dtm,\r\n\tcase \r\n        when pt._fivetran_deleted = true then pt._fivetran_synced\r\n        else null\r\n\tend as delete_dtm,\r\n\t'AX' as src_sys_nm,\r\n\tpt.dataareaid as opco_id,\r\n\tpt.projid as project_id,\r\n\to.opco_sk,\r\n\toc.opco_cust_sk,\r\n\tocc.opco_cost_center_sk,\r\n\tod.opco_dept_sk,\r\n\tot.opco_type_sk,\r\n\top.opco_purpose_sk,\r\n\tol.opco_lob_sk,\r\n\topt.opco_pymnt_terms_sk,\r\n\tolc.opco_locn_sk as dlvry_locn_sk,\r\n\tpt.name as project_nm,\r\n\tcase \r\n        when pt.status = 0 then 'Created'\r\n        when pt.status = 1 then 'Estimated'\r\n        when pt.status = 2 then 'Scheduled'\r\n        when pt.status = 3 then 'In Process'\r\n        when pt.status = 4 then 'Finished'\r\n    end as project_status_txt,\r\n\tcase \r\n        when pt.type = 0 then 'Time and Material'\r\n        when pt.type = 1 then 'Fixed Price'\r\n        when pt.type = 2 then 'Investment'\r\n\t\twhen pt.type = 3 then 'Cost Project'\r\n        when pt.type = 4 then 'Internal'\r\n        when pt.type = 5 then 'Time Project'\r\n\t\twhen pt.type = 6 then 'Summary'\r\n    end as project_type_txt,\r\n\tpt.created as  project_crt_dt,     \r\n\tpt.startdate as project_start_dt ,  \r\n\tpt.enddate as project_end_dt ,    \r\n\tpt.estimatestartdate_opi as estimated_start_dt, \r\n\tpt.estimateenddate_opi  as estimated_end_dt,   \r\n\tpt.actualstartdate_opi as actual_start_dt,    \r\n\tpt.actualenddate_opi as actual_end_dt,      \r\n\tpt.estimator_opi as estimator_nm,       \r\n\tpt.projmanager_opi  as project_mgr_nm,     \r\n\tpt.projledgerposting  as gl_posting_ind,     \r\n\tpt.sortingid as sort_1_id,          \r\n\tpt.sortingid2_ as sort_2_id,          \r\n\tpt.sortingid3_ as sort_3_id,          \r\n\tpt.salesgroup_opi  as sls_grp_txt,        \r\n\tpt.taxgroupid as tax_grp_id,         \r\n\tpt.location1_opi as locn_1_txt ,         \r\n\tpt.location2_opi as locn_2_txt ,         \r\n\tpt.retentionterms_opi as retention_terms_txt ,\r\n\tpt.retentionduedate_opi as retention_due_dt ,   \r\n\tpt.payusetax_opi as use_tax_ind        \r\n    from {{source('AX_DEV', 'PROJTABLE')}} pt\r\n    left join {{ref('v_ax_opco_curr')}} o    \r\n        on pt.dataareaid = o.opco_id    \r\n        and o.src_sys_nm = 'AX'  \r\n\tleft join {{ref('v_ax_opco_cust_curr')}} oc \r\n        on pt.dataareaid = oc.opco_id\r\n\t\tand pt.custaccount = oc.cust_id\r\n        and oc.src_sys_nm = 'AX'  \t\t\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pt.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od\r\n        on upper(pt.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n\tleft join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pt.dimension3_) = ot.src_type_cd\t\r\n        and ot.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_purpose_curr')}} op\r\n        on upper(pt.dimension4_) = op.src_purpose_cd\t\r\n        and op.src_sys_nm = 'AX'  \t\t\r\n\tleft join {{ref('v_ax_opco_lob_curr')}} ol \r\n        on upper(pt.dimension5_) = ol.src_lob_cd\t\r\n        and ol.src_sys_nm = 'AX'  \t\r\n\tleft join {{ref('v_ax_opco_pymnt_terms_curr')}} opt \r\n        on upper(pt.payment_opi) = opt.src_pymnt_terms_cd\t\r\n        and opt.src_sys_nm = 'AX'  \r\n\tleft join {{ ref('v_ax_opco_locn_curr')}} olc \r\n\t\ton upper(pt.deliverystreet) = olc.addr_ln_1_txt \r\n\t\tand upper(pt.deliverycity) = olc.city_nm\r\n\t\tand upper(pt.dlvstate) = olc.state_nm\r\n\t\tand upper(pt.dlvcountryregionid) = olc.country_nm\r\n\t\tand upper(pt.dlvzipcode) = olc.zip_cd\r\n        and olc.src_sys_nm = 'AX'\r\n\twhere pt.dataareaid not in {{ var('excluded_ax_companies')}} \r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_id']) }} as opco_project_sk,\t\t\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_id', 'opco_sk', 'opco_cust_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_pymnt_terms_sk', 'dlvry_locn_sk', 'project_nm', 'project_status_txt', 'project_type_txt', 'project_crt_dt', 'project_start_dt', 'project_end_dt', 'estimated_start_dt', 'estimated_end_dt', 'actual_start_dt', 'actual_end_dt', 'estimator_nm', 'project_mgr_nm', 'gl_posting_ind', 'sort_1_id', 'sort_2_id', 'sort_3_id', 'sls_grp_txt', 'tax_grp_id', 'locn_1_txt', 'locn_2_txt', 'retention_terms_txt', 'retention_due_dt', 'use_tax_ind']) }} as opco_project_ck,\r\n            concat_ws('|', src_sys_nm, opco_id, project_id) as opco_project_ak,\r\n            * \t\t\r\n    from ax_opco_project \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT') and _load != 3%}\r\n    union\r\n    select\r\n    opco_PROJECT_sk, opco_PROJECT_ck, OPCO_PROJECT_AK, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_id, opco_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_pymnt_terms_sk, dlvry_locn_sk, project_nm, project_status_txt, project_type_txt, project_crt_dt, project_start_dt, project_end_dt, estimated_start_dt, estimated_end_dt, actual_start_dt, actual_end_dt, estimator_nm, project_mgr_nm, gl_posting_ind, sort_1_id, sort_2_id, sort_3_id, sls_grp_txt, tax_grp_id, locn_1_txt, locn_2_txt, retention_terms_txt, retention_due_dt, use_tax_ind\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT\r\n    {% if _load == 1 %}\r\n        where opco_PROJECT_ck not in (select distinct opco_PROJECT_ck from final)\r\n    {% else %}\r\n        where opco_PROJECT_ck not in (select distinct opco_PROJECT_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_PROJECT_ck not in (select distinct opco_PROJECT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_PROJECT_ck in (select distinct opco_PROJECT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_PROJECT where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJTABLE", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_locn_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project"], "unique_id": "model.OI_Foundation.ax_opco_project", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project.sql", "original_file_path": "models/ax/project/ax_opco_project.sql", "name": "ax_opco_project", "alias": "ax_opco_project", "checksum": {"name": "sha256", "checksum": "24d59c97da73e38639752d6b356a6a0fd611f857e015e5740538f216f8a172e6"}, "tags": [], "refs": [["v_ax_opco_curr"], ["v_ax_opco_cust_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_pymnt_terms_curr"], ["v_ax_opco_locn_curr"]], "sources": [["AX_DEV", "PROJTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.6709538}, "model.OI_Foundation.ax_opco_project_revenue_trans": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_REVENUE_TRANS') %}\r\n\r\nwith ax_opco_project_revenue_trans as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    pro._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pro._fivetran_deleted = true then pro._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pro.recid as src_key_txt,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    pro.changeno_opi as chg_nbr,\r\n    pro.projrevenuetype_opi as project_revenue_trans_type_cd,\r\n    pro.comment_opi as project_revenue_trans_desc,\r\n    pro.transdate_opi as trans_dt,\r\n    pro.approved_opi as apprvd_ind,\r\n    pro.projrevenueamount_opi as project_revenue_trans_amt\r\n    from {{ source('AX_DEV', 'PROJREVENUE_OPI') }} pro\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pro.dataareaid = opr.opco_id\r\n        and pro.projid_opi = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco\r\n        on pro.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    where pro.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm','src_key_txt']) }} as opco_project_revenue_trans_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'opco_project_sk', 'opco_sk', 'chg_nbr', 'project_revenue_trans_type_cd', 'project_revenue_trans_desc', 'trans_dt', 'apprvd_ind', 'project_revenue_trans_amt']) }} as opco_project_revenue_trans_ck,\r\n        concat_ws('|', src_sys_nm, src_key_txt) as opco_project_revenue_trans_ak,\r\n        * \t\t\r\n    from ax_opco_project_revenue_trans \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_REVENUE_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_REVENUE_TRANS') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_REVENUE_TRANS_sk, OPCO_PROJECT_REVENUE_TRANS_ck,OPCO_PROJECT_REVENUE_TRANS_AK ,crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, src_key_txt, opco_project_sk, opco_sk, chg_nbr, project_revenue_trans_type_cd, project_revenue_trans_desc, trans_dt, apprvd_ind, project_revenue_trans_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_REVENUE_TRANS\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_REVENUE_TRANS_ck not in (select distinct OPCO_PROJECT_REVENUE_TRANS_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_REVENUE_TRANS_ck not in (select distinct OPCO_PROJECT_REVENUE_TRANS_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_REVENUE_TRANS where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_REVENUE_TRANS_ck not in (select distinct OPCO_PROJECT_REVENUE_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_REVENUE_TRANS where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_REVENUE_TRANS_ck in (select distinct OPCO_PROJECT_REVENUE_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_REVENUE_TRANS where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJREVENUE_OPI", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_revenue_trans"], "unique_id": "model.OI_Foundation.ax_opco_project_revenue_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_revenue_trans.sql", "original_file_path": "models/ax/project/ax_opco_project_revenue_trans.sql", "name": "ax_opco_project_revenue_trans", "alias": "ax_opco_project_revenue_trans", "checksum": {"name": "sha256", "checksum": "6c0b6a78a354eec0822ca92d66dacd512ca3ea9a50e969285332b8ac6bb97a2f"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"]], "sources": [["AX_DEV", "PROJREVENUE_OPI"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.6894195}, "model.OI_Foundation.ax_opco_project_invoice_project_xref": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF') %}\r\n\r\nwith ax_opco_project_invoice_project_xref as(  \r\n    select \r\n    op1.opco_project_sk,\r\n    op2.opco_project_sk as invoice_project_sk,\r\n    current_timestamp as crt_dtm,\r\n    pt._fivetran_synced as stg_load_dtm,\r\n\tcase \r\n\t    when pt._fivetran_deleted = true then pt._fivetran_synced\r\n\t    else null\r\n\tend as delete_dtm,\r\n\t'AX' as src_sys_nm,\r\n\tpt.dataareaid as opco_id,\r\n\tpt.projinvoiceprojid as invoice_project_id\r\n    from {{source('AX_DEV', 'PROJTABLE')}} pt\r\n    left join {{ref('v_ax_opco_project_curr')}} op1    \r\n        on pt.dataareaid = op1.opco_id   \r\n\t\tand pt.projid = op1.project_id\t\t\r\n        and op1.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_project_curr')}} op2    \r\n        on pt.dataareaid = op2.opco_id   \r\n\t\tand pt.projinvoiceprojid = op2.project_id\t\t\r\n        and op2.src_sys_nm = 'AX'\r\n\twhere pt.dataareaid not in {{ var('excluded_ax_companies')}} \r\n),\r\nfinal as (\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n    select \r\n        opco_project_sk, invoice_project_sk,\r\n        {{ dbt_utils.surrogate_key([ 'opco_project_sk',  'invoice_project_sk',  'src_sys_nm',  'opco_id',  'invoice_project_id'])}} as opco_project_invoice_project_xref_ck,\r\n        crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, opco_id, invoice_project_id \t\t\r\n    from ax_opco_project_invoice_project_xref  \r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_INVOICE_PROJECT_XREF') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_INVOICE_PROJECT_XREF') and _load != 3%}\r\n    union\r\n    select\r\n    opco_project_sk, invoice_project_sk, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, invoice_project_id\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_INVOICE_PROJECT_XREF\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_INVOICE_PROJECT_XREF_ck not in (select distinct OPCO_PROJECT_INVOICE_PROJECT_XREF_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_INVOICE_PROJECT_XREF_ck not in (select distinct OPCO_PROJECT_INVOICE_PROJECT_XREF_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_INVOICE_PROJECT_XREF where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_INVOICE_PROJECT_XREF_ck not in (select distinct OPCO_PROJECT_INVOICE_PROJECT_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_INVOICE_PROJECT_XREF where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_INVOICE_PROJECT_XREF_ck in (select distinct OPCO_PROJECT_INVOICE_PROJECT_XREF_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_INVOICE_PROJECT_XREF where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJTABLE", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_invoice_project_xref"], "unique_id": "model.OI_Foundation.ax_opco_project_invoice_project_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_invoice_project_xref.sql", "original_file_path": "models/ax/project/ax_opco_project_invoice_project_xref.sql", "name": "ax_opco_project_invoice_project_xref", "alias": "ax_opco_project_invoice_project_xref", "checksum": {"name": "sha256", "checksum": "a9244c59958590db62d9031abd9c5c788f826f141f1fd85d52e674ea6bdeb4a0"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_project_curr"]], "sources": [["AX_DEV", "PROJTABLE"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.7030785}, "model.OI_Foundation.ax_opco_project_trans_origin": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_project_trans_origin as (\r\n  {% set values = ['None', 'Hour Journal', 'Expense Journal', 'General Journal', 'Invoice Journal', 'Invoice Approval Journal', 'Expense Management', 'Elimination Investment', 'Estimate Accrued Loss', 'Item Journal', 'Purchase Order', 'Item Requirement', 'Sales Order', 'Production-FInished', 'Production-Consumed', 'Fee Journal', 'Estimate Fee', 'Subscription', 'Prepayment', 'Deduction', 'Milestone', 'Invoice', 'Inventory Closing', 'Adjustment', 'Post Cost', 'Accrue Revenue', 'Post Estimate', 'Reverse Estimate', 'Eliminate Estimate', 'Reverse Elimination', 'Accrue Subscription Revenue'] %}\r\n  {% set num = [0, 1, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59] %}\r\n\r\n  {% for i in range(31) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{num[i]}} as project_trans_origin_cd,\r\n          '{{values[i]}}' as project_trans_origin_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'project_trans_origin_cd']) }} as opco_project_trans_origin_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'project_trans_origin_cd', 'project_trans_origin_desc']) }} as opco_project_trans_origin_ck,\r\n        *\r\n    from opco_project_trans_origin\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_trans_origin"], "unique_id": "model.OI_Foundation.ax_opco_project_trans_origin", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_trans_origin.sql", "original_file_path": "models/ax/project/ax_opco_project_trans_origin.sql", "name": "ax_opco_project_trans_origin", "alias": "ax_opco_project_trans_origin", "checksum": {"name": "sha256", "checksum": "003a74cba15e049c0e8f869c94c6849aaa07597b47ca1235db3908a478399391"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.7152681}, "model.OI_Foundation.ax_opco_project_empl_frcst": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_EMPL_FRCST') %}\r\n\r\nwith ax_opco_project_empl_frcst as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    pfc._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when pfc._fivetran_deleted = true then pfc._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    pfc.dataareaid as opco_id,\r\n    pfc.transid as project_empl_frcst_id,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opc.opco_project_catgry_sk,\r\n    ocr.opco_currency_sk as trans_currency_sk,\r\n    ou.opco_uom_sk,\r\n    pfc.linenum as line_nbr,\r\n    pfc.linepropertyid as line_property_id,\r\n    pfc.emplid as empl_id,\r\n    pfc.modelid as model_id,\r\n    pfc.taxgroupid as tax_grp_id,\r\n    pfc.active as include_amt_ind,\r\n    pfc.islock_opi as lock_ind,\r\n    pfc.schedlinktype as sched_link_type_txt,\r\n    pfc.schedlink as sched_link_txt,\r\n    pfc.schedfromdate as sched_from_dt,\r\n    pfc.schedworktime as sched_worktime_ind,\r\n    pfc.schedcapacity as sched_capacity_ind,\r\n    pfc.salespaymdate as revenue_pymnt_expctd_dt,\r\n    pfc.costpaymdate as cost_pymnt_expctd_dt,\r\n    pfc.invoicedate as invoice_expctd_dt,\r\n    pfc.eliminationdate as eliminatin_expctd_dt,\r\n    pfc.qty as trans_hours_qty,\r\n    pfc.schedloadpct as sched_load_pct,\r\n    pfc.costprice as trans_currency_cost_price_amt,\r\n    pfc.salesprice as trans_currency_sls_price_amt,\r\n    pfc.totalrevenue_opi as total_revenue_amt,\r\n    pfc.totalcost_opi as total_cost_amt,\r\n    pfc.mcpercent_opi as margin_contribution_pct\r\n    from {{ source('AX_DEV', 'PROJFORECASTEMPL') }} pfc\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on pfc.dataareaid = opr.opco_id\r\n        and pfc.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on pfc.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(pfc.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(pfc.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(pfc.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(pfc.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(pfc.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on pfc.dataareaid = opc.opco_id\r\n        and pfc.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_currency_curr')}} ocr\r\n        on upper(pfc.currencyid) = ocr.src_currency_cd\r\n        and ocr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_uom_curr')}} ou \r\n        on upper(pfc.unitid_opi) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'AX'\r\n    where pfc.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','project_empl_frcst_id']) }} as opco_project_empl_frcst_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'project_empl_frcst_id', 'opco_project_sk', 'opco_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_project_catgry_sk', 'trans_currency_sk', 'opco_uom_sk', 'line_nbr', 'line_property_id', 'empl_id', 'model_id', 'tax_grp_id', 'include_amt_ind', 'lock_ind', 'sched_link_type_txt', 'sched_link_txt', 'sched_from_dt', 'sched_worktime_ind', 'sched_capacity_ind', 'revenue_pymnt_expctd_dt', 'cost_pymnt_expctd_dt', 'invoice_expctd_dt', 'eliminatin_expctd_dt', 'trans_hours_qty', 'sched_load_pct', 'trans_currency_cost_price_amt', 'trans_currency_sls_price_amt', 'total_revenue_amt', 'total_cost_amt', 'margin_contribution_pct']) }} as opco_project_empl_frcst_ck,\r\n        concat_ws('|', src_sys_nm, opco_id, project_empl_frcst_id) as opco_project_empl_frcst_ak,\r\n        * \t\t\r\n        from ax_opco_project_empl_frcst\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_EMPL_FRCST') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_EMPL_FRCST') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_EMPL_FRCST_sk, OPCO_PROJECT_EMPL_FRCST_ck, OPCO_PROJECT_EMPL_FRCST_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, project_empl_frcst_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_currency_sk, opco_uom_sk, line_nbr, line_property_id, empl_id, model_id, tax_grp_id, include_amt_ind, lock_ind, sched_link_type_txt, sched_link_txt, sched_from_dt, sched_worktime_ind, sched_capacity_ind, revenue_pymnt_expctd_dt, cost_pymnt_expctd_dt, invoice_expctd_dt, eliminatin_expctd_dt, trans_hours_qty, sched_load_pct, trans_currency_cost_price_amt, trans_currency_sls_price_amt, total_revenue_amt, total_cost_amt, margin_contribution_pct\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_FRCST\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_EMPL_FRCST_ck not in (select distinct OPCO_PROJECT_EMPL_FRCST_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_EMPL_FRCST_ck not in (select distinct OPCO_PROJECT_EMPL_FRCST_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_FRCST where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_EMPL_FRCST_ck not in (select distinct OPCO_PROJECT_EMPL_FRCST_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_FRCST where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_EMPL_FRCST_ck in (select distinct OPCO_PROJECT_EMPL_FRCST_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_EMPL_FRCST where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJFORECASTEMPL", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_empl_frcst"], "unique_id": "model.OI_Foundation.ax_opco_project_empl_frcst", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_empl_frcst.sql", "original_file_path": "models/ax/project/ax_opco_project_empl_frcst.sql", "name": "ax_opco_project_empl_frcst", "alias": "ax_opco_project_empl_frcst", "checksum": {"name": "sha256", "checksum": "af4c286358c9bc3f23f58365409ecbac194ca2a28c81047b7d4c42a72c9aa4a9"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_currency_curr"], ["v_ax_opco_uom_curr"]], "sources": [["AX_DEV", "PROJFORECASTEMPL"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.725444}, "model.OI_Foundation.ax_opco_project_trans_posting": {"raw_sql": "{% set _load = load_type('AX_OPCO_PROJECT_TRANS_POSTING') %}\r\n\r\nwith ax_opco_project_trans_posting as (\r\n    select\r\n    current_timestamp as crt_dtm,\r\n    ptp._fivetran_synced as stg_load_dtm,\r\n    case\r\n        when ptp._fivetran_deleted = true then ptp._fivetran_synced\r\n        else null\r\n    end as delete_dtm,\r\n    'AX' as src_sys_nm,\r\n    ptp.dataareaid as opco_id,\r\n    ptp.recid as src_key_txt,\r\n    opr.opco_project_sk,\r\n    opco.opco_sk,\r\n    oi.opco_item_sk,\r\n    occ.opco_cost_center_sk,\r\n    od.opco_dept_sk,\r\n    ot.opco_type_sk,\r\n    op.opco_purpose_sk,\r\n    ol.opco_lob_sk,\r\n    opc.opco_project_catgry_sk,\r\n    opto.opco_project_trans_origin_sk,\r\n    opto1.opco_project_trans_origin_sk as opco_gl_trans_origin_sk,\r\n    ogtp.opco_gl_trans_posting_type_sk,\r\n    ocoa.opco_chart_of_accts_sk as opco_gl_acct_sk,\r\n    ptp.transid as project_trans_posting_id,\r\n    ptp.ledgertransdate as gl_trans_dt,\r\n    ptp.voucher as voucher_nbr,\r\n    ptp.projtransdate as project_trans_dt,\r\n    case \r\n        when ptp.projtranstype = 0 then null\r\n        when ptp.projtranstype = 1 then 'Fee'\r\n        when ptp.projtranstype = 2 then 'Hour'\r\n        when ptp.projtranstype = 3 then 'Expense'\r\n        when ptp.projtranstype = 4 then 'Item'\r\n        when ptp.projtranstype = 5 then 'On Account'\r\n        when ptp.projtranstype = 6 then 'WIP'\r\n    end as project_trans_type_txt,\r\n    case\r\n        when ptp.projtype = 0 then 'Time and Material'\r\n        when ptp.projtype = 1 then 'Fixed Price'\r\n        when ptp.projtype = 2 then 'Investment'\r\n        when ptp.projtype = 3 then 'Cost Project'\r\n        when ptp.projtype = 4 then 'Internal'\r\n        when ptp.projtype = 5 then 'Time Project'\r\n        when ptp.projtype = 6 then 'Summary'\r\n    end as project_type_txt,\r\n    case\r\n        when ptp.costsales = 0 then null\r\n        when ptp.costsales = 1 then 'Cost'\r\n        when ptp.costsales = 2 then 'Sales'\r\n    end as project_cost_or_sls_txt,\r\n    ptp.projadjustrefid as project_adjstmt_ref_id,\r\n    ptp.paymentdate as pymnt_dt,\r\n    case \r\n        when ptp.paymentstatus = 0 then 'No Payment'\r\n        when ptp.paymentstatus = 1 then 'Expected Payment'\r\n        when ptp.paymentstatus = 2 then 'Paid'\r\n    end as pymnt_status_txt,\r\n    ptp.inventtransid as invtry_trans_id,\r\n    case\r\n        when ptp.projtranstype = 2 then ptp.emplitemid\r\n        else null\r\n    end as empl_id,\r\n    ptp.qty as trans_qty,\r\n    ptp.amountmst as opco_currency_trans_amt\r\n    from {{ source('AX_DEV', 'PROJTRANSPOSTING') }} ptp\r\n    left join {{ ref('v_ax_opco_project_curr')}} opr\r\n        on ptp.dataareaid = opr.opco_id\r\n        and ptp.projid = opr.project_id\r\n        and opr.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_curr')}} opco \r\n        on ptp.dataareaid = opco.opco_id\r\n        and opco.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_item_curr')}} oi \r\n        on ptp.emplitemid = oi.src_item_cd\r\n        and ptp.dataareaid = oi.opco_id\r\n        and oi.src_sys_nm = 'AX'\r\n        and ptp.projtranstype = 4\r\n        and ptp.emplitemid is not null\r\n    left join {{ref('v_ax_opco_cost_center_curr')}} occ \r\n        on upper(ptp.dimension) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_dept_curr')}} od \r\n        on upper(ptp.dimension2_) = od.src_dept_cd\r\n        and od.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_type_curr')}} ot \r\n        on upper(ptp.dimension3_) = ot.src_type_cd\r\n        and ot.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_purpose_curr')}} op \r\n        on upper(ptp.dimension4_) = op.src_purpose_cd\r\n        and op.src_sys_nm = 'AX'\r\n    left join {{ref('v_ax_opco_lob_curr')}} ol\r\n        on upper(ptp.dimension5_) = ol.src_lob_cd\r\n        and ol.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_catgry_curr')}} opc\r\n        on ptp.dataareaid = opc.opco_id\r\n        and ptp.categoryid = opc.catgry_cd\r\n        and opc.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_trans_origin_curr')}} opto\r\n        on ptp.transactionorigin = opto.project_trans_origin_cd\r\n        and opto.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_project_trans_origin_curr')}} opto1\r\n        on ptp.ledgerorigin = opto1.project_trans_origin_cd\r\n        and opto1.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_gl_trans_posting_type_curr')}} ogtp\r\n        on ptp.postingtype = ogtp.src_gl_trans_posting_type_cd\r\n        and ogtp.src_sys_nm = 'AX'\r\n    left join {{ ref('v_ax_opco_chart_of_accts_curr')}} ocoa\r\n        on ptp.dataareaid = ocoa.opco_id\r\n        and ptp.account = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'AX'\r\n    where ptp.dataareaid not in {{ var('excluded_ax_companies')}}\r\n),\r\nfinal as (\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm','opco_id','src_key_txt']) }} as opco_project_trans_posting_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'src_key_txt', 'opco_project_sk', 'opco_sk', 'opco_item_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_project_catgry_sk', 'opco_project_trans_origin_sk', 'opco_gl_trans_origin_sk', 'opco_gl_trans_posting_type_sk', 'opco_gl_acct_sk', 'project_trans_posting_id', 'gl_trans_dt', 'voucher_nbr', 'project_trans_dt', 'project_trans_type_txt', 'project_type_txt', 'project_cost_or_sls_txt', 'project_adjstmt_ref_id', 'pymnt_dt', 'pymnt_status_txt', 'invtry_trans_id', 'empl_id', 'trans_qty', 'opco_currency_trans_amt']) }} as opco_project_trans_posting_ck,\r\n        concat_ws('|', src_sys_nm, opco_id, src_key_txt) as opco_project_trans_posting_ak,\r\n        * \t\t\r\n    from ax_opco_project_trans_posting optp\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n)\r\n\r\nselect * from final\r\n{% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'AX_OPCO_PROJECT_TRANS_POSTING') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PROJECT_TRANS_POSTING') and _load != 3%}\r\n    union\r\n    select\r\n    OPCO_PROJECT_TRANS_POSTING_sk, OPCO_PROJECT_TRANS_POSTING_ck,OPCO_PROJECT_TRANS_POSTING_ak, crt_dtm, \r\n    (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n    (select max(stg_load_dtm) from final) as delete_dtm,\r\n    src_sys_nm, opco_id, src_key_txt, opco_project_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, opco_project_trans_origin_sk, opco_gl_trans_origin_sk, opco_gl_trans_posting_type_sk, opco_gl_acct_sk, project_trans_posting_id, gl_trans_dt, voucher_nbr, project_trans_dt, project_trans_type_txt, project_type_txt, project_cost_or_sls_txt, project_adjstmt_ref_id, pymnt_dt, pymnt_status_txt, invtry_trans_id, empl_id, trans_qty, opco_currency_trans_amt\r\n    from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_TRANS_POSTING\r\n    {% if _load == 1 %}\r\n        where OPCO_PROJECT_TRANS_POSTING_ck not in (select distinct OPCO_PROJECT_TRANS_POSTING_ck from final)\r\n    {% else %}\r\n        where OPCO_PROJECT_TRANS_POSTING_ck not in (select distinct OPCO_PROJECT_TRANS_POSTING_ck from final) \r\n            and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_TRANS_POSTING where src_sys_nm = 'AX')\r\n    {% endif %} \r\n    and src_sys_nm = 'AX'\r\n{% endif %}\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_TRANS_POSTING_ck not in (select distinct OPCO_PROJECT_TRANS_POSTING_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_TRANS_POSTING where src_sys_nm = 'AX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PROJECT_TRANS_POSTING_ck in (select distinct OPCO_PROJECT_TRANS_POSTING_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PROJECT_TRANS_POSTING where src_sys_nm = 'AX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.AX_DEV.PROJTRANSPOSTING", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_trans_posting"], "unique_id": "model.OI_Foundation.ax_opco_project_trans_posting", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_trans_posting.sql", "original_file_path": "models/ax/project/ax_opco_project_trans_posting.sql", "name": "ax_opco_project_trans_posting", "alias": "ax_opco_project_trans_posting", "checksum": {"name": "sha256", "checksum": "bdf756e7e29598f387934def40e51da5afc6d8a939e976b17e8be1bd4d9e8cfd"}, "tags": [], "refs": [["v_ax_opco_project_curr"], ["v_ax_opco_curr"], ["v_ax_opco_item_curr"], ["v_ax_opco_cost_center_curr"], ["v_ax_opco_dept_curr"], ["v_ax_opco_type_curr"], ["v_ax_opco_purpose_curr"], ["v_ax_opco_lob_curr"], ["v_ax_opco_project_catgry_curr"], ["v_ax_opco_project_trans_origin_curr"], ["v_ax_opco_project_trans_origin_curr"], ["v_ax_opco_gl_trans_posting_type_curr"], ["v_ax_opco_chart_of_accts_curr"]], "sources": [["AX_DEV", "PROJTRANSPOSTING"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.7444544}, "model.OI_Foundation.ax_opco_project_trans_status": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_project_trans_status as (\r\n  {% set values = ['No Status', 'Registered', 'Posted', 'Invoice Proposal', 'Invoiced', 'Selected For Credit Note', 'Credit Note Proposal', 'Estimated', 'Eliminated', 'Adjusted'] %}\r\n\r\n  {% for i in range(10) %}\r\n    select current_timestamp as crt_dtm,\r\n          'AX' as src_sys_nm,\r\n          {{i}} as project_trans_status_cd,\r\n          '{{values[i]}}' as project_trans_status_desc\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'project_trans_status_cd']) }} as opco_project_trans_status_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'project_trans_status_cd','project_trans_status_desc']) }} as opco_project_trans_status_ck,\r\n        *\r\n    from opco_project_trans_status\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "ax", "project", "ax_opco_project_trans_status"], "unique_id": "model.OI_Foundation.ax_opco_project_trans_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "ax/project/ax_opco_project_trans_status.sql", "original_file_path": "models/ax/project/ax_opco_project_trans_status.sql", "name": "ax_opco_project_trans_status", "alias": "ax_opco_project_trans_status", "checksum": {"name": "sha256", "checksum": "8a52f59c36791fd6a908c434d5f335b7207ae819a3da688cda127d1e4aeb491b"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.7631884}, "model.OI_Foundation.primex_opco_gl_trans": {"raw_sql": "-- depends_on: {{ ref('v_primex_opco_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_chart_of_accts_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_gl_trans_type_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_cost_center_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_type_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_dept_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_purpose_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_lob_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_uom_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_sub_ledger_type_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_currency_curr') }}\r\n\r\n{% set _load = load_type('PRIMEX_OPCO_GL_TRANS') %}\r\n\r\nwith primex_opco_gl_trans as(\r\n    {% set tables = table_check('COMPANY', '_DBO_GENJOURNALDETAIL') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        {{ dbt_utils.surrogate_key([\"'SYSPRO-PRMX'\", 'src_comp', 'trim(gjd.glyear)', 'trim(gjd.glperiod)', 'upper(trim(gjd.journal))', 'trim(gjd.entrynumber)']) }} as opco_gl_trans_sk, \r\n        concat_ws('|', 'SYSPRO-PRMX', src_comp, trim(gjd.glyear), trim(gjd.glperiod), upper(trim(gjd.journal)), trim(gjd.entrynumber)) as opco_gl_trans_ak,\r\n        concat_ws('|', src_comp, trim(gjd.glyear), trim(gjd.glperiod), upper(trim(gjd.journal)), trim(gjd.entrynumber)) as src_key_txt,\r\n        iff(gjd.transactiondate is null, gjd.entrydate, gjd.transactiondate) as trans_dt,\r\n        opco.opco_sk,\r\n        ocoa.opco_chart_of_accts_sk,\r\n        ogtt.opco_gl_trans_type_sk,\r\n        null as opco_gl_trans_posting_type_sk,\r\n        occ.opco_cost_center_sk,\r\n        od.opco_dept_sk,\r\n        ot.opco_type_sk,\r\n        op.opco_purpose_sk,\r\n        ol.opco_lob_sk,\r\n        ifnull(oc.opco_currency_sk, (select opco_currency_sk from {{ ref('v_primex_opco_curr')}} where src_sys_nm = 'SYSPRO-PRMX' and opco_id = '{{ tbl}}')) as trans_currency_sk,\r\n        null as opco_proj_sk,\r\n        null as original_gl_opco_sk,\r\n        null as original_gl_voucher_nbr,\r\n        null as voucher_nbr,\r\n        null as journal_batch_nbr,\r\n        null as gl_desc,\r\n        null as document_nbr,\r\n        null as document_dt,\r\n        null as crrctn_trans_ind,\r\n        case \r\n            when gjd.entrytype = 'C' then 1\r\n            when gjd.entrytype = 'D' then 0\r\n        end::numeric(1,0) as credit_ind,\r\n        null as gl_qty,\r\n        case \r\n            when gjd.entrytype = 'C' then (-1)*gjd.currencyvalue\r\n            else gjd.currencyvalue\r\n        end as trans_currency_gl_amt,\r\n        case \r\n            when gjd.entrytype = 'C' then (-1)*gjd.entryvalue\r\n            else gjd.entryvalue\r\n        end as opco_currency_gl_amt,\r\n        gjd.glyear as fscl_yr_nbr,\r\n        gjd.glperiod as fscl_mnth_nbr,\r\n        iff(gjd.entryposted = 'Y', 1, 0)::numeric(1,0) as posted_ind,\r\n        ou.opco_uom_sk,\r\n        null as opco_brand_sk,\r\n        oslt.opco_sub_ledger_type_sk,\r\n        null as sub_ledger_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENJOURNALDETAIL gjd\r\n        left join {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_ cgm\r\n            on trim(gjd.glcode) = trim(cgm.glcode)\r\n        left join {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENMASTER cm\r\n            on trim(gjd.company) = trim(cm.company)\r\n            and trim(gjd.glcode) = trim(cm.glcode)\r\n        left join {{ ref('v_primex_opco_curr')}} opco \r\n            on opco.opco_id = '{{tbl}}'\r\n            and opco.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_chart_of_accts_curr')}} ocoa \r\n            on ocoa.opco_id = '{{tbl}}'\r\n            and ocoa.gl_acct_nbr = upper(trim(gjd.glcode))\r\n            and ocoa.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_gl_trans_type_curr')}} ogtt \r\n            on ogtt.src_gl_trans_type_cd = upper(trim(gjd.source))\r\n            and ogtt.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_cost_center_curr')}} occ \r\n            on occ.src_cost_center_cd = upper(trim(cgm.cc))\r\n            and occ.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_dept_curr')}} od \r\n            on od.src_dept_cd = upper(trim(cgm.dept))\r\n            and od.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_type_curr')}} ot \r\n            on ot.src_type_cd = upper(trim(cgm.type))\r\n            and ot.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_purpose_curr')}} op\r\n            on op.src_purpose_cd = upper(trim(cgm.purpose))\r\n            and op.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_lob_curr')}} ol\r\n            on ol.src_lob_cd = upper(trim(cgm.fsgroup4buname))\r\n            and ol.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_uom_curr')}} ou \r\n            on ou.src_uom_cd = upper(trim(cm.glunitofmeasure))\r\n            and ou.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_sub_ledger_type_curr')}} oslt \r\n            on oslt.src_sub_ledger_type_cd = upper(trim(gjd.type))\r\n            and oslt.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_currency_curr')}} oc \r\n            on oc.src_currency_cd = upper(trim(gjd.postcurrency))\r\n            and oc.src_sys_nm = 'SYSPRO-PRMX'\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by opco_gl_trans_ak order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_gl_trans\r\n),\r\nfinal as(\r\n    select  distinct \r\n            OPCO_GL_TRANS_SK,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'trans_dt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'opco_proj_sk', 'original_gl_opco_sk', 'original_gl_voucher_nbr', 'voucher_nbr', 'journal_batch_nbr', 'gl_desc', 'document_nbr', 'document_dt', 'crrctn_trans_ind', 'credit_ind', 'gl_qty', 'trans_currency_gl_amt', 'opco_currency_gl_amt', 'fscl_yr_nbr', 'fscl_mnth_nbr', 'posted_ind', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd'])}} as OPCO_GL_TRANS_CK,\r\n            OPCO_GL_TRANS_AK, \r\n            CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_KEY_TXT, TRANS_DT, OPCO_SK, OPCO_CHART_OF_ACCTS_SK, OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_POSTING_TYPE_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, TRANS_CURRENCY_SK, OPCO_PROJ_SK, ORIGINAL_GL_OPCO_SK, ORIGINAL_GL_VOUCHER_NBR, VOUCHER_NBR, JOURNAL_BATCH_NBR, GL_DESC, DOCUMENT_NBR, DOCUMENT_DT, CRRCTN_TRANS_IND, CREDIT_IND, GL_QTY, TRANS_CURRENCY_GL_AMT, OPCO_CURRENCY_GL_AMT, FSCL_YR_NBR, FSCL_MNTH_NBR, POSTED_IND, OPCO_UOM_SK, OPCO_BRAND_SK, OPCO_SUB_LEDGER_TYPE_SK, SUB_LEDGER_CD\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_GL_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_GL_TRANS_sk, OPCO_GL_TRANS_ck,  OPCO_GL_TRANS_AK, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        SRC_SYS_NM, SRC_KEY_TXT, TRANS_DT, OPCO_SK, OPCO_CHART_OF_ACCTS_SK, OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_POSTING_TYPE_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, TRANS_CURRENCY_SK, OPCO_PROJ_SK, ORIGINAL_GL_OPCO_SK, ORIGINAL_GL_VOUCHER_NBR, VOUCHER_NBR, JOURNAL_BATCH_NBR, GL_DESC, DOCUMENT_NBR, DOCUMENT_DT, CRRCTN_TRANS_IND, CREDIT_IND, GL_QTY, TRANS_CURRENCY_GL_AMT, OPCO_CURRENCY_GL_AMT, FSCL_YR_NBR, FSCL_MNTH_NBR, POSTED_IND, OPCO_UOM_SK, OPCO_BRAND_SK, OPCO_SUB_LEDGER_TYPE_SK, SUB_LEDGER_CD\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS\r\n        {% if _load == 1 %}\r\n            where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final)\r\n        {% else %}\r\n            where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["model.OI_Foundation.v_primex_opco_curr", "model.OI_Foundation.v_primex_opco_chart_of_accts_curr", "model.OI_Foundation.v_primex_opco_gl_trans_type_curr", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_type_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.v_primex_opco_uom_curr", "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr", "model.OI_Foundation.v_primex_opco_currency_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_gl_trans"], "unique_id": "model.OI_Foundation.primex_opco_gl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_gl_trans.sql", "original_file_path": "models/primex/general_ledger/primex_opco_gl_trans.sql", "name": "primex_opco_gl_trans", "alias": "primex_opco_gl_trans", "checksum": {"name": "sha256", "checksum": "e8b52e7e7f9c85c60f26dfabbe341dbf8c97b66d127e88eb04528e86f217a360"}, "tags": [], "refs": [["v_primex_opco_curr"], ["v_primex_opco_chart_of_accts_curr"], ["v_primex_opco_gl_trans_type_curr"], ["v_primex_opco_cost_center_curr"], ["v_primex_opco_type_curr"], ["v_primex_opco_dept_curr"], ["v_primex_opco_purpose_curr"], ["v_primex_opco_lob_curr"], ["v_primex_opco_uom_curr"], ["v_primex_opco_sub_ledger_type_curr"], ["v_primex_opco_currency_curr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.7717364}, "model.OI_Foundation.primex_opco_chart_of_accts_type": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE') %}\r\n\r\nwith primex_opco_chart_of_accts_type as(\r\n    {% set tables = table_check('COMPANY', '_DBO_GENGROUPS') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(glgroup)) as src_acct_type_cd,\r\n        trim(description) as src_acct_type_desc\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENGROUPS\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_acct_type_cd order by src_comp) as rnk\r\n    from primex_opco_chart_of_accts_type\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_acct_type_cd']) }} as opco_chart_of_accts_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_acct_type_cd','src_acct_type_desc']) }} as opco_chart_of_accts_type_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_acct_type_cd, src_acct_type_desc       \r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_CHART_OF_ACCTS_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CHART_OF_ACCTS_TYPE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CHART_OF_ACCTS_TYPE_SK, OPCO_CHART_OF_ACCTS_TYPE_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_acct_type_cd, src_acct_type_desc   \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS_TYPE\r\n        {% if _load == 1 %}\r\n            where OPCO_CHART_OF_ACCTS_TYPE_ck not in (select distinct OPCO_CHART_OF_ACCTS_TYPE_ck from final)\r\n        {% else %}\r\n            where OPCO_CHART_OF_ACCTS_TYPE_ck not in (select distinct OPCO_CHART_OF_ACCTS_TYPE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS_TYPE where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_TYPE_ck not in (select distinct OPCO_CHART_OF_ACCTS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS_TYPE where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_TYPE_ck in (select distinct OPCO_CHART_OF_ACCTS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS_TYPE where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_chart_of_accts_type"], "unique_id": "model.OI_Foundation.primex_opco_chart_of_accts_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_chart_of_accts_type.sql", "original_file_path": "models/primex/general_ledger/primex_opco_chart_of_accts_type.sql", "name": "primex_opco_chart_of_accts_type", "alias": "primex_opco_chart_of_accts_type", "checksum": {"name": "sha256", "checksum": "49051443e5662f7aa0ac3c5215c304122d5c583916066c826c4f52cde009bc4b"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.8000271}, "model.OI_Foundation.primex_opco_chart_of_accts": {"raw_sql": "-- depends_on: {{ ref('chart_of_accts') }}\r\n-- depends_on: {{ ref('v_primex_opco_cost_center_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_type_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_dept_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_purpose_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_lob_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_chart_of_accts_type_curr') }}\r\n\r\n{% set _load = load_type('PRIMEX_OPCO_CHART_OF_ACCTS') %}\r\n\r\nwith primex_opco_chart_of_accts as(\r\n    {% set tables = table_check('COMPANY', '_DBO_GENMASTER') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(cdg.glcode)) as gl_acct_nbr,\r\n        upper(trim(cdg.company)) as opco_id,\r\n        trim(cdg.description) as gl_acct_nm,\r\n        coa.chart_of_accts_sk,\r\n        occ.opco_cost_center_sk,\r\n        od.opco_dept_sk,\r\n        ot.opco_type_sk,\r\n        oip.opco_purpose_sk,\r\n        ol.opco_lob_sk,\r\n        ocoa.opco_chart_of_accts_type_sk,\r\n        null as opco_uom_sk,\r\n        null as gl_acct_alias_nm,\r\n        iff(trim(cdg.controlaccflag) = 'Y', 0, 1) as manual_entry_allowed_ind,\r\n        null as dpo_exclusion_ind,\r\n        null as movement_allowed_ind,\r\n        null as cost_center_reqd_txt,\r\n        null as dept_reqd_txt,\r\n        null as type_reqd_txt,\r\n        null as prnt_gl_acct_nbr,\r\n        null as related_gl_acct_nbr,\r\n        null as monetary_gl_acct_ind,\r\n        iff(trim(cdg.acconhldflag) in ('', 'N'), 1 , 0) as actv_ind,\r\n        iff(trim(cdc.financialstatement) = 'BS', 1, 0) as balance_sheet_acct_ind,\r\n        null as summary_acct_ind,\r\n        null as opco_brand_sk,\r\n        null as acct_clssfctn_cd,\r\n        null as sub_acct_nbr\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENMASTER cdg\r\n        left join {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_ cdc \r\n            on trim(cdg.glcode) = trim(cdc.glcode)\r\n        left join {{ ref('chart_of_accts')}} coa \r\n            on coa.gl_acct_nbr = trim(cdc.gl)\r\n        left join {{ ref('v_primex_opco_cost_center_curr')}} occ \r\n            on occ.src_cost_center_cd = upper(trim(cdc.cc))\r\n            and occ.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_dept_curr')}} od \r\n            on od.src_dept_cd = upper(trim(cdc.dept))\r\n            and od.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_type_curr')}} ot \r\n            on ot.src_type_cd = upper(trim(cdc.type))\r\n            and ot.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_purpose_curr')}} oip \r\n            on oip.src_purpose_cd = upper(trim(cdc.purpose))\r\n            and oip.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_lob_curr')}} ol \r\n            on ol.src_lob_cd = upper(trim(cdc.fsgroup4buname))\r\n            and ol.src_sys_nm = 'SYSPRO-PRMX'\r\n        left join {{ ref('v_primex_opco_chart_of_accts_type_curr')}} ocoa \r\n            on ocoa.src_acct_type_cd = upper(trim(cdg.glgroup))\r\n            and ocoa.src_sys_nm = 'SYSPRO-PRMX'\r\n        where upper(trim(cdg.company)) = '{{tbl}}'\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by opco_id, gl_acct_nbr order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_chart_of_accts\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'gl_acct_nbr']) }} as opco_chart_of_accts_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'gl_acct_nbr', 'opco_id', 'gl_acct_nm', 'chart_of_accts_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'opco_chart_of_accts_type_sk', 'opco_uom_sk', 'GL_ACCT_ALIAS_NM', 'manual_entry_allowed_ind', 'dpo_exclusion_ind', 'movement_allowed_ind', 'cost_center_reqd_txt', 'dept_reqd_txt', 'type_reqd_txt', 'prnt_gl_acct_nbr', 'related_gl_acct_nbr', 'monetary_gl_acct_ind', 'balance_sheet_acct_ind', 'summary_acct_ind', 'OPCO_BRAND_SK', 'acct_clssfctn_cd', 'sub_acct_nbr']) }} as opco_chart_of_accts_ck,\r\n            CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, GL_ACCT_NBR, OPCO_ID, GL_ACCT_NM, CHART_OF_ACCTS_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, OPCO_CHART_OF_ACCTS_TYPE_SK, OPCO_UOM_SK, GL_ACCT_ALIAS_NM, MANUAL_ENTRY_ALLOWED_IND, DPO_EXCLUSION_IND, MOVEMENT_ALLOWED_IND, COST_CENTER_REQD_TXT, DEPT_REQD_TXT, TYPE_REQD_TXT, PRNT_GL_ACCT_NBR, RELATED_GL_ACCT_NBR, MONETARY_GL_ACCT_IND, ACTV_IND, BALANCE_SHEET_ACCT_IND, SUMMARY_ACCT_IND, OPCO_BRAND_SK, ACCT_CLSSFCTN_CD, SUB_ACCT_NBR\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_CHART_OF_ACCTS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CHART_OF_ACCTS') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CHART_OF_ACCTS_sk, OPCO_CHART_OF_ACCTS_ck, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        SRC_SYS_NM, GL_ACCT_NBR, OPCO_ID, GL_ACCT_NM, CHART_OF_ACCTS_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, OPCO_CHART_OF_ACCTS_TYPE_SK, OPCO_UOM_SK, GL_ACCT_ALIAS_NM, MANUAL_ENTRY_ALLOWED_IND, DPO_EXCLUSION_IND, MOVEMENT_ALLOWED_IND, COST_CENTER_REQD_TXT, DEPT_REQD_TXT, TYPE_REQD_TXT, PRNT_GL_ACCT_NBR, RELATED_GL_ACCT_NBR, MONETARY_GL_ACCT_IND, ACTV_IND, BALANCE_SHEET_ACCT_IND, SUMMARY_ACCT_IND, OPCO_BRAND_SK, ACCT_CLSSFCTN_CD, SUB_ACCT_NBR\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS\r\n        {% if _load == 1 %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final)\r\n        {% else %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["model.OI_Foundation.chart_of_accts", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_type_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_chart_of_accts"], "unique_id": "model.OI_Foundation.primex_opco_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_chart_of_accts.sql", "original_file_path": "models/primex/general_ledger/primex_opco_chart_of_accts.sql", "name": "primex_opco_chart_of_accts", "alias": "primex_opco_chart_of_accts", "checksum": {"name": "sha256", "checksum": "f03f6834d142d278717d63cb3679181c72c108f64f41a8450396e00ba491815b"}, "tags": [], "refs": [["chart_of_accts"], ["v_primex_opco_cost_center_curr"], ["v_primex_opco_type_curr"], ["v_primex_opco_dept_curr"], ["v_primex_opco_purpose_curr"], ["v_primex_opco_lob_curr"], ["v_primex_opco_chart_of_accts_type_curr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.813372}, "model.OI_Foundation.primex_opco_gl_trans_type": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_GL_TRANS_TYPE') %}\r\n\r\nwith primex_opco_gl_trans_type as(\r\n    {% set tables = table_check('COMPANY', '_DBO_GENJOURNALCTL') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(journalsource)) as src_gl_trans_type_cd,\r\n        case \r\n            when trim(journalsource) = 'AP' then 'Accounts Payable'\r\n            when trim(journalsource) = 'AR' then 'Accounts Receivable'\r\n            when trim(journalsource) = 'CS' then 'Cash'\r\n            when trim(journalsource) = 'GR' then 'Goods Receipt'\r\n            when trim(journalsource) = 'IN' then 'Inventory'\r\n            when trim(journalsource) = 'SA' then 'Sales'\r\n            when trim(journalsource) = 'WP' then 'WIP Labour'\r\n            else trim(journalsource)\r\n        end as src_gl_trans_type_desc\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENJOURNALCTL\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_gl_trans_type_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_gl_trans_type\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd']) }} as opco_gl_trans_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd','src_gl_trans_type_desc']) }} as opco_gl_trans_type_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_gl_trans_type_cd, src_gl_trans_type_desc\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\n\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_GL_TRANS_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS_TYPE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_TYPE_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, src_gl_trans_type_cd, src_gl_trans_type_desc  \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE\r\n        {% if _load == 1 %}\r\n            where OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from final)\r\n        {% else %}\r\n            where OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_TYPE_ck in (select distinct OPCO_GL_TRANS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_gl_trans_type"], "unique_id": "model.OI_Foundation.primex_opco_gl_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_gl_trans_type.sql", "original_file_path": "models/primex/general_ledger/primex_opco_gl_trans_type.sql", "name": "primex_opco_gl_trans_type", "alias": "primex_opco_gl_trans_type", "checksum": {"name": "sha256", "checksum": "5212bc0adf6a1d23022cd945cac859dcb195bf9012d7650358fc2d79c276f5df"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.8343103}, "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal": {"raw_sql": "-- depends_on: {{ ref('v_primex_opco_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_chart_of_accts_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_cost_center_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_type_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_dept_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_purpose_curr') }}\r\n-- depends_on: {{ ref('v_primex_opco_lob_curr') }}\r\n-- depends_on: {{ ref('fscl_clndr') }}\r\n\r\n{% set _load = load_type('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL') %}\r\n\r\nwith primex_opco_fscl_yr_gl_opening_bal as (\r\n   {% set tables = table_check('COMPANY', '_DBO_GENHISTORY') %}\r\n   {% for tbl in tables %}\r\n      select \r\n      '{{tbl}}' as src_comp,\r\n      current_timestamp as crt_dtm,\r\n      null::timestamp_tz as stg_load_dtm,\r\n      null::timestamp_tz as delete_dtm,\r\n      {{ dbt_utils.surrogate_key([\"'SYSPRO-PRMX'\", \"ifnull(trim(gh.company), '{{tbl}}')\", 'trim(gh.glyear)', 'trim(gh.glcode)']) }} as opco_fscl_yr_gl_opening_bal_sk, \r\n      concat_ws('|', 'SYSPRO-PRMX', ifnull(trim(gh.company), '{{tbl}}'), trim(gh.glyear), trim(gh.glcode)) as opco_fscl_yr_gl_opening_bal_ak,\r\n      'SYSPRO-PRMX' as src_sys_nm,\r\n      null as src_key_txt,\r\n      opco.opco_sk,\r\n      ocoa.opco_chart_of_accts_sk,\r\n      null as opco_gl_trans_type_sk,\r\n      null as opco_gl_trans_posting_type_sk,\r\n      occ.opco_cost_center_sk,\r\n      od.opco_dept_sk,\r\n      ot.opco_type_sk,\r\n      op.opco_purpose_sk,\r\n      ol.opco_lob_sk,\r\n      opco.opco_currency_sk as trans_currency_sk,\r\n      case \r\n         when trim(gh.glyear) >= 2020 then fc.fscl_yr_strt_dt\r\n         when trim(gh.glyear) < 2020 then concat(trim(gh.glyear), '-04-01')::date\r\n      end as fscl_yr_strt_dt,\r\n      trim(gh.glyear) as fscl_yr_nbr,\r\n      null as credit_ind,\r\n      null as opening_bal_qty,\r\n      trim(gh.beginyearbalance) as trans_currency_opening_bal_amt,\r\n      trim(gh.beginyearbalance) as opco_currency_opening_bal_amt,\r\n      null as opco_uom_sk,\r\n      null as opco_brand_sk,\r\n      null as opco_sub_ledger_type_sk,\r\n      null as sub_ledger_cd\r\n      from {{var('primex_db')}}.{{var('primex_schema')}}.COMPANY{{tbl}}_DBO_GENHISTORY as gh\r\n      left join  {{var('primex_db')}}.{{var('primex_schema')}}.COMPANY{{tbl}}_DBO_CUSGENMASTER_ as cgm\r\n         on gh.glcode=cgm.glcode\r\n      left join {{ref('v_primex_opco_curr')}} opco \r\n         on opco.opco_id = iff(trim(gh.company) is null, '{{ tbl}}', trim(gh.company))\r\n         and opco.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_chart_of_accts_curr')}} ocoa \r\n         on ocoa.gl_acct_nbr = trim(gh.glcode)\r\n         and ocoa.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_cost_center_curr')}} occ\r\n         on occ.src_cost_center_cd = upper(trim(cgm.cc)) \r\n         and occ.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_dept_curr')}} od \r\n         on od.src_dept_cd = upper(trim(cgm.dept)) \r\n         and od.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_type_curr')}} ot \r\n         on ot.src_type_cd = upper(trim(cgm.type)) \r\n         and ot.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_purpose_curr')}} op \r\n         on op.src_purpose_cd = upper(trim(cgm.purpose)) \r\n         and op.src_sys_nm = 'SYSPRO-PRMX'\r\n      left join {{ref('v_primex_opco_lob_curr')}} ol \r\n         on ol.src_lob_cd = upper(trim(cgm.fsgroup4buname)) \r\n         and ol.src_sys_nm = 'SYSPRO-PRMX' \r\n      left join {{ ref('fscl_clndr')}} fc \r\n         on fc.fscl_yr_id = trim(gh.glyear)\r\n      where trim(gh.glyear) >= 2020 and trim(gh.company) in (null, '{{ tbl}}')\r\n      {% if not loop.last %} union all {% endif %}\r\n   {% endfor %}  \r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by opco_fscl_yr_gl_opening_bal_ak order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_fscl_yr_gl_opening_bal\r\n),\r\n\r\nfinal as(\r\n    select  distinct \r\n            opco_fscl_yr_gl_opening_bal_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'fscl_yr_strt_dt', 'fscl_yr_nbr', 'credit_ind', 'opening_bal_qty', 'trans_currency_opening_bal_amt', 'opco_currency_opening_bal_amt', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd'])}} as OPCO_FSCL_YR_GL_OPENING_BAL_CK,\r\n            opco_fscl_yr_gl_opening_bal_ak,\r\n            CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_KEY_TXT, OPCO_SK, OPCO_CHART_OF_ACCTS_SK, OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_POSTING_TYPE_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, TRANS_CURRENCY_SK, FSCL_YR_STRT_DT, FSCL_YR_NBR, CREDIT_IND, OPENING_BAL_QTY, TRANS_CURRENCY_OPENING_BAL_AMT, OPCO_CURRENCY_OPENING_BAL_AMT, OPCO_UOM_SK, OPCO_BRAND_SK, OPCO_SUB_LEDGER_TYPE_SK, SUB_LEDGER_CD\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\n\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_FSCL_YR_GL_OPENING_BAL') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_FSCL_YR_GL_OPENING_BAL_sk, OPCO_FSCL_YR_GL_OPENING_BAL_ck, OPCO_FSCL_YR_GL_OPENING_BAL_ak, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        SRC_SYS_NM, SRC_KEY_TXT, OPCO_SK, OPCO_CHART_OF_ACCTS_SK, OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_POSTING_TYPE_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, TRANS_CURRENCY_SK, FSCL_YR_STRT_DT, FSCL_YR_NBR, CREDIT_IND, OPENING_BAL_QTY, TRANS_CURRENCY_OPENING_BAL_AMT, OPCO_CURRENCY_OPENING_BAL_AMT, OPCO_UOM_SK, OPCO_BRAND_SK, OPCO_SUB_LEDGER_TYPE_SK, SUB_LEDGER_CD     \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL\r\n        {% if _load == 1 %}\r\n            where OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from final)\r\n        {% else %}\r\n            where OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_FSCL_YR_GL_OPENING_BAL_ck in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["model.OI_Foundation.v_primex_opco_curr", "model.OI_Foundation.v_primex_opco_chart_of_accts_curr", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_type_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.fscl_clndr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_fscl_yr_gl_opening_bal"], "unique_id": "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_fscl_yr_gl_opening_bal.sql", "original_file_path": "models/primex/general_ledger/primex_opco_fscl_yr_gl_opening_bal.sql", "name": "primex_opco_fscl_yr_gl_opening_bal", "alias": "primex_opco_fscl_yr_gl_opening_bal", "checksum": {"name": "sha256", "checksum": "32ff0d87d245bb25b6b01e130090e2bf08380d8eb3d3c2e9e130ccf58d7bc09f"}, "tags": [], "refs": [["v_primex_opco_curr"], ["v_primex_opco_chart_of_accts_curr"], ["v_primex_opco_cost_center_curr"], ["v_primex_opco_type_curr"], ["v_primex_opco_dept_curr"], ["v_primex_opco_purpose_curr"], ["v_primex_opco_lob_curr"], ["fscl_clndr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.8489575}, "model.OI_Foundation.primex_opco_sub_ledger_type": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_SUB_LEDGER_TYPE') %}\r\n\r\nwith opco_sub_ledger_type as(\r\n    {% set tables = table_check('COMPANY', '_DBO_GENJOURNALDETAIL') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(type)) as src_sub_ledger_type_cd,\r\n        case \r\n            when trim(type) = 'BIL' then 'Billing'\r\n            when trim(type) = 'CASH' then 'Cash'\r\n            when trim(type) = 'CSBK' then 'Cashbook'\r\n            when trim(type) = 'DBS' then 'Disbursement'\r\n            when trim(type) = 'EXP' then 'Expense'\r\n            when trim(type) = 'GRN' then 'Goods Receive Note'\r\n            when trim(type) = 'INV' then 'Inventory'\r\n            when trim(type) = 'LAB' then 'Labour'\r\n            when trim(type) = 'SALE' then 'Sales'\r\n            else trim(type)  \r\n        end as src_sub_ledger_type_desc,\r\n        1::number(1,0) as actv_ind\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_GENJOURNALDETAIL\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_sub_ledger_type_cd order by src_comp) as rnk\r\n    from opco_sub_ledger_type\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sub_ledger_type_cd']) }} as opco_sub_ledger_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sub_ledger_type_cd', 'src_sub_ledger_type_desc', 'actv_ind']) }} as opco_sub_ledger_type_ck,\r\n            crt_dtm,stg_load_dtm, delete_dtm, src_sys_nm, src_sub_ledger_type_cd, src_sub_ledger_type_desc, actv_ind            \r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_SUB_LEDGER_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_SUB_LEDGER_TYPE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_SUB_LEDGER_TYPE_SK, OPCO_SUB_LEDGER_TYPE_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, src_sub_ledger_type_cd, src_sub_ledger_type_desc, actv_ind\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SUB_LEDGER_TYPE\r\n        {% if _load == 1 %}\r\n            where OPCO_SUB_LEDGER_TYPE_ck not in (select distinct OPCO_SUB_LEDGER_TYPE_ck from final)\r\n        {% else %}\r\n            where OPCO_SUB_LEDGER_TYPE_ck not in (select distinct OPCO_SUB_LEDGER_TYPE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SUB_LEDGER_TYPE where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_SUB_LEDGER_TYPE_ck not in (select distinct OPCO_SUB_LEDGER_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SUB_LEDGER_TYPE where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_SUB_LEDGER_TYPE_ck in (select distinct OPCO_SUB_LEDGER_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_SUB_LEDGER_TYPE where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "general_ledger", "primex_opco_sub_ledger_type"], "unique_id": "model.OI_Foundation.primex_opco_sub_ledger_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/general_ledger/primex_opco_sub_ledger_type.sql", "original_file_path": "models/primex/general_ledger/primex_opco_sub_ledger_type.sql", "name": "primex_opco_sub_ledger_type", "alias": "primex_opco_sub_ledger_type", "checksum": {"name": "sha256", "checksum": "75744c2a2942ab925a058b8ed572d4788c7ec50423c79a5fcf59a66a4a256c26"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.869306}, "model.OI_Foundation.v_primex_opco_gl_trans_curr": {"raw_sql": "with v_primex_opco_gl_trans as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_gl_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_gl_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_gl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_gl_trans_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_gl_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_gl_trans_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_gl_trans_curr.sql", "name": "v_primex_opco_gl_trans_curr", "alias": "v_primex_opco_gl_trans_curr", "checksum": {"name": "sha256", "checksum": "e699a578ab4eb9c112d983349d33d870ebe9112bb4438c74984940bcf75956fa"}, "tags": [], "refs": [["primex_opco_gl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8836691}, "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr": {"raw_sql": "with v_primex_opco_chart_of_accts_type as(\r\n    select *\r\n    from {{ ref('primex_opco_chart_of_accts_type') }}\r\n)\r\n\r\nselect * from v_primex_opco_chart_of_accts_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_chart_of_accts_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_chart_of_accts_type_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_chart_of_accts_type_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_chart_of_accts_type_curr.sql", "name": "v_primex_opco_chart_of_accts_type_curr", "alias": "v_primex_opco_chart_of_accts_type_curr", "checksum": {"name": "sha256", "checksum": "58a334232af272bfe36ab97f98804250ccddf0d59177bb77519e7bfac6e0d21e"}, "tags": [], "refs": [["primex_opco_chart_of_accts_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8857589}, "model.OI_Foundation.v_primex_opco_chart_of_accts_curr": {"raw_sql": "with v_primex_opco_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by opco_chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_chart_of_accts') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_chart_of_accts_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_chart_of_accts_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_chart_of_accts_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_chart_of_accts_curr.sql", "name": "v_primex_opco_chart_of_accts_curr", "alias": "v_primex_opco_chart_of_accts_curr", "checksum": {"name": "sha256", "checksum": "8677fb92454f4e13c097548d6df518abc7c523f96539fec6de386fac1b4bedc9"}, "tags": [], "refs": [["primex_opco_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8878508}, "model.OI_Foundation.v_primex_opco_gl_trans_type_curr": {"raw_sql": "with v_primex_opco_gl_trans_type as(\r\n    select *\r\n    from {{ ref('primex_opco_gl_trans_type') }}\r\n)\r\n\r\nselect * from v_primex_opco_gl_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_gl_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_gl_trans_type_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_gl_trans_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_gl_trans_type_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_gl_trans_type_curr.sql", "name": "v_primex_opco_gl_trans_type_curr", "alias": "v_primex_opco_gl_trans_type_curr", "checksum": {"name": "sha256", "checksum": "280d2c7f4d4340442f9a1d97758272af2258fc68b5dd64a1f380c8191c0a83dd"}, "tags": [], "refs": [["primex_opco_gl_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.889886}, "model.OI_Foundation.v_primex_opco_fscl_yr_gl_opening_bal_curr": {"raw_sql": "with v_primex_opco_fscl_yr_gl_opening_bal as(\r\n    select *,\r\n    rank() over(partition by opco_fscl_yr_gl_opening_bal_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_fscl_yr_gl_opening_bal') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_fscl_yr_gl_opening_bal\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_fscl_yr_gl_opening_bal_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_fscl_yr_gl_opening_bal_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_fscl_yr_gl_opening_bal_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_fscl_yr_gl_opening_bal_curr.sql", "name": "v_primex_opco_fscl_yr_gl_opening_bal_curr", "alias": "v_primex_opco_fscl_yr_gl_opening_bal_curr", "checksum": {"name": "sha256", "checksum": "de219ac804aa39b11e63ad85d6b041937a6fc16bfe71f484af594ec559bee909"}, "tags": [], "refs": [["primex_opco_fscl_yr_gl_opening_bal"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8920507}, "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr": {"raw_sql": "with v_primex_opco_sub_ledger_type as(\r\n    select *\r\n    from {{ ref('primex_opco_sub_ledger_type') }}\r\n)\r\n\r\nselect * from v_primex_opco_sub_ledger_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_sub_ledger_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "general_ledger", "v_primex_opco_sub_ledger_type_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/general_ledger/v_primex_opco_sub_ledger_type_curr.sql", "original_file_path": "models/primex/current_views/general_ledger/v_primex_opco_sub_ledger_type_curr.sql", "name": "v_primex_opco_sub_ledger_type_curr", "alias": "v_primex_opco_sub_ledger_type_curr", "checksum": {"name": "sha256", "checksum": "8518feef2920a5c8f2fd3a0d82807059bcaff50c34092efad2dda28add6b9883"}, "tags": [], "refs": [["primex_opco_sub_ledger_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.894173}, "model.OI_Foundation.v_primex_opco_currency_curr": {"raw_sql": "with v_primex_opco_currency as(\r\n    select *,\r\n    rank() over(partition by opco_currency_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_currency') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_currency\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "customer", "v_primex_opco_currency_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_currency_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/customer/v_primex_opco_currency_curr.sql", "original_file_path": "models/primex/current_views/customer/v_primex_opco_currency_curr.sql", "name": "v_primex_opco_currency_curr", "alias": "v_primex_opco_currency_curr", "checksum": {"name": "sha256", "checksum": "2f7f286fcad9b8afa71a6c001bf8afb7d54fbdb7116b477234d3183b4db93333"}, "tags": [], "refs": [["primex_opco_currency"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8961773}, "model.OI_Foundation.v_primex_opco_purpose_curr": {"raw_sql": "with v_primex_opco_purpose as(\r\n    select *,\r\n    rank() over(partition by opco_purpose_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_purpose') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_purpose\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_purpose"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "product", "v_primex_opco_purpose_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_purpose_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/product/v_primex_opco_purpose_curr.sql", "original_file_path": "models/primex/current_views/product/v_primex_opco_purpose_curr.sql", "name": "v_primex_opco_purpose_curr", "alias": "v_primex_opco_purpose_curr", "checksum": {"name": "sha256", "checksum": "580d5942e5bc46f5124e7c6490bf57b3764624a39a09af32057a81a169b8cc2a"}, "tags": [], "refs": [["primex_opco_purpose"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.8982947}, "model.OI_Foundation.v_primex_opco_uom_curr": {"raw_sql": "with v_primex_opco_uom as(\r\n    select *,\r\n    rank() over(partition by opco_uom_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_uom') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_uom\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_uom"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "product", "v_primex_opco_uom_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_uom_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/product/v_primex_opco_uom_curr.sql", "original_file_path": "models/primex/current_views/product/v_primex_opco_uom_curr.sql", "name": "v_primex_opco_uom_curr", "alias": "v_primex_opco_uom_curr", "checksum": {"name": "sha256", "checksum": "0254c54abfb8c5a57b9f85961a8d8a34e6db8235bf06db7116957257d0a60399"}, "tags": [], "refs": [["primex_opco_uom"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.9004989}, "model.OI_Foundation.v_primex_opco_lob_curr": {"raw_sql": "with v_primex_opco_lob as(\r\n    select *,\r\n    rank() over(partition by opco_lob_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_lob') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_lob\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_lob"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "product", "v_primex_opco_lob_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_lob_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/product/v_primex_opco_lob_curr.sql", "original_file_path": "models/primex/current_views/product/v_primex_opco_lob_curr.sql", "name": "v_primex_opco_lob_curr", "alias": "v_primex_opco_lob_curr", "checksum": {"name": "sha256", "checksum": "dcc33bde788363efe0f8e207dc4999d2f1f67ee1426cf59bed7cb9d5c3edf785"}, "tags": [], "refs": [["primex_opco_lob"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.9025898}, "model.OI_Foundation.v_primex_opco_type_curr": {"raw_sql": "with v_primex_opco_type as(\r\n    select *,\r\n    rank() over(partition by opco_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "organization", "v_primex_opco_type_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/organization/v_primex_opco_type_curr.sql", "original_file_path": "models/primex/current_views/organization/v_primex_opco_type_curr.sql", "name": "v_primex_opco_type_curr", "alias": "v_primex_opco_type_curr", "checksum": {"name": "sha256", "checksum": "783a141d11d56d96cd0837a45ac4d1f51c4e89b30071a46ab8f929a3c3278991"}, "tags": [], "refs": [["primex_opco_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.9046087}, "model.OI_Foundation.v_primex_opco_curr": {"raw_sql": "with v_primex_opco as(\r\n    select *\r\n    from {{ ref('primex_opco') }}\r\n)\r\n\r\nselect * from v_primex_opco", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "organization", "v_primex_opco_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/organization/v_primex_opco_curr.sql", "original_file_path": "models/primex/current_views/organization/v_primex_opco_curr.sql", "name": "v_primex_opco_curr", "alias": "v_primex_opco_curr", "checksum": {"name": "sha256", "checksum": "160e98200c92e630aad4dfb8769db1be7132604aa6460edddadbc7a1c6fa618c"}, "tags": [], "refs": [["primex_opco"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.9065862}, "model.OI_Foundation.v_primex_opco_cost_center_curr": {"raw_sql": "with v_primex_opco_cost_center as(\r\n    select *,\r\n    rank() over(partition by opco_cost_center_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_cost_center') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_cost_center\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_cost_center"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "organization", "v_primex_opco_cost_center_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_cost_center_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/organization/v_primex_opco_cost_center_curr.sql", "original_file_path": "models/primex/current_views/organization/v_primex_opco_cost_center_curr.sql", "name": "v_primex_opco_cost_center_curr", "alias": "v_primex_opco_cost_center_curr", "checksum": {"name": "sha256", "checksum": "4ab62767e79d31722c247f3f459ef42567259f039ba75972225b8db59a3f27cc"}, "tags": [], "refs": [["primex_opco_cost_center"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.908868}, "model.OI_Foundation.v_primex_opco_dept_curr": {"raw_sql": "with v_primex_opco_dept as(\r\n    select *,\r\n    rank() over(partition by opco_dept_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('primex_opco_dept') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_primex_opco_dept\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.primex_opco_dept"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "current_views", "organization", "v_primex_opco_dept_curr"], "unique_id": "model.OI_Foundation.v_primex_opco_dept_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/current_views/organization/v_primex_opco_dept_curr.sql", "original_file_path": "models/primex/current_views/organization/v_primex_opco_dept_curr.sql", "name": "v_primex_opco_dept_curr", "alias": "v_primex_opco_dept_curr", "checksum": {"name": "sha256", "checksum": "f1c2a1f6b13ff97b1def9d5ad643b8dc797f2dd3212a9b0a30603bc61253cbd1"}, "tags": [], "refs": [["primex_opco_dept"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086794.9108534}, "model.OI_Foundation.primex_opco_currency": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_CURRENCY') %}\r\n\r\nwith opco_currency as(\r\n    {% set tables = table_check('COMPANY', '_DBO_TBLCURRENCY') %}\r\n    {% for tbl in tables %}\r\n        select \r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm, \r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX'::varchar as src_sys_nm,\r\n        upper(trim(currency)) as src_currency_cd,\r\n        trim(description) as src_currency_nm\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_TBLCURRENCY\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_currency_cd order by stg_load_dtm, src_comp) as rnk\r\n    from opco_currency\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd']) }} as opco_currency_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd', 'src_currency_nm']) }} as opco_currency_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_currency_cd, src_currency_nm\r\n    from de_duplication\r\n    where rnk = 1\r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_CURRENCY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CURRENCY') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CURRENCY_SK, OPCO_CURRENCY_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, SRC_CURRENCY_CD, SRC_CURRENCY_NM  \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency\r\n        {% if _load == 1 %}\r\n            where opco_currency_ck not in (select distinct opco_currency_ck from final)\r\n        {% else %}\r\n            where opco_currency_ck not in (select distinct opco_currency_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck not in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "customer", "primex_opco_currency"], "unique_id": "model.OI_Foundation.primex_opco_currency", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/customer/primex_opco_currency.sql", "original_file_path": "models/primex/customer/primex_opco_currency.sql", "name": "primex_opco_currency", "alias": "primex_opco_currency", "checksum": {"name": "sha256", "checksum": "ae14df6b4553e8091934929f228c72652d8682559a365ca22811cf9d6aceb7ea"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.9129407}, "model.OI_Foundation.primex_opco_purpose": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_PURPOSE') %}\r\n\r\nwith primex_opco_purpose as(\r\n    {% set tables = table_check('COMPANY', '_DBO_CUSGENMASTER_') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(purpose)) as src_purpose_cd,\r\n        trim(purpose) as src_purpose_desc,\r\n        1::number(1,0) as actv_ind,\r\n        {{ spcl_chr_rp('src_purpose_desc')}} as purpose_wo_spcl_chr_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_purpose_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_purpose\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_purpose_cd']) }} as opco_purpose_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_purpose_cd', 'src_purpose_desc','actv_ind', 'purpose_wo_spcl_chr_cd']) }} as opco_purpose_ck, \r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_purpose_cd, src_purpose_desc, actv_ind, purpose_wo_spcl_chr_cd\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_PURPOSE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_PURPOSE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_PURPOSE_SK, OPCO_PURPOSE_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_purpose_cd, src_purpose_desc, actv_ind, purpose_wo_spcl_chr_cd  \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE\r\n        {% if _load == 1 %}\r\n            where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final)\r\n        {% else %}\r\n            where OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck not in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_PURPOSE_ck in (select distinct OPCO_PURPOSE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_PURPOSE where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "product", "primex_opco_purpose"], "unique_id": "model.OI_Foundation.primex_opco_purpose", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/product/primex_opco_purpose.sql", "original_file_path": "models/primex/product/primex_opco_purpose.sql", "name": "primex_opco_purpose", "alias": "primex_opco_purpose", "checksum": {"name": "sha256", "checksum": "f4864d1a055ebd57618635dc619c0ebb3a9cbef1795621e408f0fd1ce8b954e7"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.9278667}, "model.OI_Foundation.primex_opco_uom": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\n{% set values = ['$','HRS'] %}\r\n{% set num = ['Amount','Hours'] %}\r\n\r\nwith opco_uom as(\r\n  {% for i in range(2) %}\r\n    select \r\n    current_timestamp::timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'SYSPRO-PRMX'::varchar as src_sys_nm,\r\n    '{{num[i]}}'::varchar as src_uom_cd,\r\n    '{{values[i]}}'::varchar as src_uom_desc\r\n    {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd']) }} as opco_uom_sk,\r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd', 'src_uom_desc']) }} as opco_uom_ck,\r\n        *\r\n    from opco_uom\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "product", "primex_opco_uom"], "unique_id": "model.OI_Foundation.primex_opco_uom", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/product/primex_opco_uom.sql", "original_file_path": "models/primex/product/primex_opco_uom.sql", "name": "primex_opco_uom", "alias": "primex_opco_uom", "checksum": {"name": "sha256", "checksum": "3836d7acb2ade3bfdac33290132af66003e1308b2bdefb05582046b6c169fdb3"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.9418888}, "model.OI_Foundation.primex_opco_lob": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_LOB') %}\r\n\r\nwith primex_opco_lob as(\r\n    {% set tables = table_check('COMPANY', '_DBO_CUSGENMASTER_') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(fsgroup4buname)) as src_lob_cd,\r\n        trim(fsgroup4buname) as src_lob_nm,\r\n        1::number(1,0) as actv_ind,\r\n        {{ spcl_chr_rp('src_lob_nm')}} as lob_wo_spcl_chr_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_lob_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_lob\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_lob_cd']) }} as opco_lob_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_lob_cd', 'src_lob_nm','actv_ind', 'lob_wo_spcl_chr_cd']) }} as opco_lob_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_lob_cd, src_lob_nm, actv_ind, lob_wo_spcl_chr_cd\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_LOB') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_LOB') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_LOB_SK, OPCO_LOB_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_lob_cd, src_lob_nm, actv_ind, lob_wo_spcl_chr_cd\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB\r\n        {% if _load == 1 %}\r\n            where OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from final)\r\n        {% else %}\r\n            where OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_LOB_ck not in (select distinct OPCO_LOB_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_LOB_ck in (select distinct OPCO_LOB_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_LOB where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "product", "primex_opco_lob"], "unique_id": "model.OI_Foundation.primex_opco_lob", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/product/primex_opco_lob.sql", "original_file_path": "models/primex/product/primex_opco_lob.sql", "name": "primex_opco_lob", "alias": "primex_opco_lob", "checksum": {"name": "sha256", "checksum": "a4382a13acf8afd848c8163f8da66511f6e96f88563371d342c3485167145039"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.9502509}, "model.OI_Foundation.primex_opco_type": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_TYPE') %}\r\n\r\nwith primex_opco_type as(\r\n    {% set tables = table_check('COMPANY', '_DBO_CUSGENMASTER_') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(type)) as src_type_cd,\r\n        trim(type) as src_type_desc,\r\n        1::number(1,0) as actv_ind,\r\n        {{ spcl_chr_rp('src_type_desc')}} as type_wo_spcl_chr_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_type_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_type\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_type_cd']) }} as opco_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_type_cd', 'src_type_desc', 'actv_ind', 'type_wo_spcl_chr_cd']) }} as opco_type_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_type_cd, src_type_desc, actv_ind, type_wo_spcl_chr_cd\r\n    from de_duplication\r\n    where rnk = 1 \r\n),\r\n\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_TYPE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_TYPE_SK, OPCO_TYPE_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, src_type_cd, src_type_desc, actv_ind, type_wo_spcl_chr_cd \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE\r\n        {% if _load == 1 %}\r\n            where OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from final)\r\n        {% else %}\r\n            where OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_TYPE_ck not in (select distinct OPCO_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_TYPE_ck in (select distinct OPCO_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_TYPE where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "organization", "primex_opco_type"], "unique_id": "model.OI_Foundation.primex_opco_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/organization/primex_opco_type.sql", "original_file_path": "models/primex/organization/primex_opco_type.sql", "name": "primex_opco_type", "alias": "primex_opco_type", "checksum": {"name": "sha256", "checksum": "dde1d1a7980e4c5171020be938597c2d57fb2625b9ee56f9f8e9c84b1072ab2d"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.9641774}, "model.OI_Foundation.primex_opco": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith primex_opco as(\r\n    {% for tbl in var('primex_companies') %}\r\n        select \r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        concat_ws('|', 'SYSPRO-PRMX', '{{ tbl}}') as opco_ak,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        '{{ tbl}}' as opco_id,\r\n        case \r\n            when '{{ tbl}}' = 'A' then 'Primex Manufacturing Ltd.'\r\n            when '{{ tbl}}' = 'C' then 'Primex Manufacturing Corp'\r\n            when '{{ tbl}}' = 'P' then 'Primex Technologies Inc.'\r\n            when '{{ tbl}}' = 'X' then 'Primex Elimination Co.'\r\n        end as opco_nm,\r\n        (select upper(trim(currency)) as currency_cd from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_TBLCURRENCY where buyexchangerate = 1) as opco_currency_key,\r\n        case \r\n            when '{{ tbl}}' = 'A' then '2019-07-07'::date\r\n            when '{{ tbl}}' = 'C' then '2020-03-11'::date\r\n            when '{{ tbl}}' = 'X' then '2019-07-07'::date\r\n            else null\r\n        end as acqstn_dt,\r\n        iff('{{ tbl}}' in ('A', 'C', 'X'), 1, 0)::number(1,0) as actv_ind,\r\n        case \r\n            when '{{ tbl}}' = 'P' then '2022-01-01'::date\r\n            else null\r\n        end as inactv_dt\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['o.src_sys_nm', 'opco_id']) }} as opco_sk,\r\n            {{ dbt_utils.surrogate_key(['o.src_sys_nm', 'opco_id', 'opco_nm', 'acqstn_dt', 'actv_ind', 'inactv_dt']) }} as opco_ck,\r\n            o.opco_ak, o.crt_dtm, o.stg_load_dtm, o.delete_dtm, o.src_sys_nm, o.opco_id, o.opco_nm, o.acqstn_dt, o.actv_ind, o.inactv_dt, oc.opco_currency_sk\r\n    from primex_opco o\r\n    left join {{ ref('v_primex_opco_currency_curr')}} oc \r\n        on oc.src_currency_cd = opco_currency_key\r\n        and oc.src_sys_nm = 'SYSPRO-PRMX'\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": ["model.OI_Foundation.v_primex_opco_currency_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "organization", "primex_opco"], "unique_id": "model.OI_Foundation.primex_opco", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/organization/primex_opco.sql", "original_file_path": "models/primex/organization/primex_opco.sql", "name": "primex_opco", "alias": "primex_opco", "checksum": {"name": "sha256", "checksum": "e4fc913c4cc3547b4cc2c987311b1ab2155d4887197041ecd82973b9f8ea3ab0"}, "tags": [], "refs": [["v_primex_opco_currency_curr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086794.9783132}, "model.OI_Foundation.primex_opco_cost_center": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_COST_CENTER') %}\r\n\r\nwith primex_opco_cost_center as(\r\n    {% set tables = table_check('COMPANY', '_DBO_CUSGENMASTER_') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(cc)) as src_cost_center_cd,\r\n        trim(cc) as src_cost_center_desc,\r\n        1::number(1,0) as actv_ind,\r\n        null as src_cost_center_type_txt,\r\n        {{ spcl_chr_rp('src_cost_center_desc')}} as cost_center_wo_spcl_chr_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_cost_center_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_cost_center\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd']) }} as opco_cost_center_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd', 'src_cost_center_desc', 'actv_ind', 'src_cost_center_type_txt', 'cost_center_wo_spcl_chr_cd']) }} as opco_cost_center_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_cost_center_cd, src_cost_center_desc, actv_ind, src_cost_center_type_txt, cost_center_wo_spcl_chr_cd \r\n    from de_duplication\r\n    where rnk = 1\r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_COST_CENTER') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_COST_CENTER') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_COST_CENTER_SK, OPCO_COST_CENTER_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, src_cost_center_cd, src_cost_center_desc, actv_ind, src_cost_center_type_txt, cost_center_wo_spcl_chr_cd \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER\r\n        {% if _load == 1 %}\r\n            where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final)\r\n        {% else %}\r\n            where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "organization", "primex_opco_cost_center"], "unique_id": "model.OI_Foundation.primex_opco_cost_center", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/organization/primex_opco_cost_center.sql", "original_file_path": "models/primex/organization/primex_opco_cost_center.sql", "name": "primex_opco_cost_center", "alias": "primex_opco_cost_center", "checksum": {"name": "sha256", "checksum": "60f065e38d07baa61cff661af4257f338ec22e0f7a86aa60414e4c7e9ebd445c"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086794.9892192}, "model.OI_Foundation.primex_opco_dept": {"raw_sql": "{% set _load = load_type('PRIMEX_OPCO_DEPT') %}\r\n\r\nwith primex_opco_dept as(\r\n    {% set tables = table_check('COMPANY', '_DBO_CUSGENMASTER_') %}\r\n    {% for tbl in tables %}\r\n        select\r\n        '{{ tbl}}' as src_comp,\r\n        current_timestamp as crt_dtm,\r\n        null::timestamp_tz as stg_load_dtm,\r\n        null::timestamp_tz as delete_dtm,\r\n        'SYSPRO-PRMX' as src_sys_nm,\r\n        upper(trim(dept)) as src_dept_cd,\r\n        trim(dept) as src_dept_desc,\r\n        1::number(1,0) as actv_ind,\r\n        {{ spcl_chr_rp('src_dept_desc')}} as dept_wo_spcl_chr_cd\r\n        from {{ var('primex_db')}}.{{ var('primex_schema')}}.COMPANY{{ tbl}}_DBO_CUSGENMASTER_\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n),\r\nde_duplication as(\r\n    select *\r\n           , rank() over(partition by src_dept_cd order by stg_load_dtm, src_comp) as rnk\r\n    from primex_opco_dept\r\n),\r\nfinal as(\r\n    select distinct\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dept_cd']) }} as opco_dept_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_dept_cd','src_dept_desc', 'actv_ind', 'dept_wo_spcl_chr_cd']) }} as opco_dept_ck,\r\n            crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_dept_cd, src_dept_desc, actv_ind, dept_wo_spcl_chr_cd\r\n    from de_duplication\r\n    where rnk = 1\r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'PRIMEX_OPCO_DEPT') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_DEPT') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_DEPT_SK, OPCO_DEPT_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, src_dept_cd, src_dept_desc, actv_ind, dept_wo_spcl_chr_cd  \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT\r\n        {% if _load == 1 %}\r\n            where OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from final)\r\n        {% else %}\r\n            where OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'SYSPRO-PRMX')\r\n        {% endif %} \r\n        and src_sys_nm = 'SYSPRO-PRMX'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_DEPT_ck not in (select distinct OPCO_DEPT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'SYSPRO-PRMX')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_DEPT_ck in (select distinct OPCO_DEPT_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_DEPT where src_sys_nm = 'SYSPRO-PRMX') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.table_check", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "primex", "organization", "primex_opco_dept"], "unique_id": "model.OI_Foundation.primex_opco_dept", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "primex/organization/primex_opco_dept.sql", "original_file_path": "models/primex/organization/primex_opco_dept.sql", "name": "primex_opco_dept", "alias": "primex_opco_dept", "checksum": {"name": "sha256", "checksum": "639ca9c2055653ad584c6a3442f24b1aac8ad9dc4c6fcdfdc961c430caed62ab"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.0036862}, "model.OI_Foundation.jde_opco_gl_trans": {"raw_sql": "{% set _load = load_type('JDE_OPCO_GL_TRANS') %}\r\n\r\nwith grouped_data as(\r\n    select \r\n    'JDE-HNCK' as src_sys_nm,\r\n    upper(trim(f0911.glco)) as glco,\r\n    upper(trim(f0911.gldoc)) as gldoc,\r\n    upper(trim(f0911.gldct)) as gldct,\r\n    upper(trim(f0911.gljeln)) as gljeln,\r\n    upper(trim(f0911.glextl)) as glextl,\r\n    upper(trim(f0911.glani)) as glani,\r\n    upper(trim(f0911.gldgj)) as gldgj,\r\n    max(trim(f0911.gldicj)) as gldicj,\r\n    max(trim(f0911.glicu)) as glicu,\r\n    max(trim(f0911.glmcu)) as glmcu,\r\n    max(trim(f0911.glcrcd)) as glcrcd,\r\n    max(trim(f0911.glodoc)) as glodoc,\r\n    max(trim(f0911.glexa)) as glexa,\r\n    max(trim(f0911.glpost)) as glpost,\r\n    max(trim(f0911.glum)) as glum,\r\n    max(trim(f0911.glsblt)) as glsblt,\r\n    max(trim(f0911.glsbl)) as glsbl,\r\n    max(trim(f0911.glctry))*100 + max(trim(f0911.glfy)) as fscl_yr_nbr,\r\n    max(trim(f0911.glpn)) as fscl_mnth_nbr,\r\n    max(trim(f0911.glkco)) as sub_document_nbr,\r\n    sum(trim(f0911.glu))/(select pow(10, frcdec::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'U') as gl_qty,\r\n    sum(iff(trim(f0911.glacr) = 0 or trim(f0911.glacr) = trim(f0911.glaa), trim(f0911.glaa), trim(f0911.glacr)))/(select pow(10, frcdec::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'AA') as trans_currency_gl_amt,\r\n    sum(trim(f0911.glaa))/(select pow(10, frcdec::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'AA') as opco_currency_gl_amt\r\n    from {{ source('JDE_DEV', 'JDE_PRODUCTION_PRODDTA_F0911') }}  f0911 \r\n    where trim(f0911.gllt) = 'AA' and trim(f0911.glco) = '03000'\r\n    and trim(f0911.glani) not in ('30.6001', '30.6002', '30.6003', '30.6004', '30.6005', '30.6006', '30.6020', '30.6021', '30.6022', '30.6023', '30.6026', '30.6028', '30.6030', '30.6032', '30.6034', '31.6001', '31.6002', '31.6004', '31.6005', '31.6006', '31.6020', '31.6021', '31.6022', '31.6023', '31.6026', '31.6028', '31.6030', '31.6032', '31.6034', '32.6001', '32.6002', '32.6004', '32.6005', '32.6020', '32.6021', '32.6022', '32.6023', '32.6026', '32.6028', '32.6030', '32.6032', '32.6034', '33.6001', '33.6002', '33.6004', '33.6004.1', '33.6005', '33.6006', '33.6020', '33.6021', '33.6022', '33.6023', '33.6026', '33.6028', '33.6030', '33.6032', '33.6034', '301.2102', '301.5201', '301.5210', '301.5210.3', '301.5290', '301.6001', '301.6002', '301.6004', '301.6004.1', '301.6005', '301.6006', '301.6007', '301.6020', '301.6021', '301.6022', '301.6023', '301.6026', '301.6028', '301.6030', '301.6032', '301.6034', '302.2102', '302.5201', '302.5210', '302.5210.3', '302.5290', '302.6001', '302.6002', '302.6004', '302.6004.1', '302.6005', '302.6006', '302.6007', '302.6020', '302.6021', '302.6022', '302.6023', '302.6026', '302.6028', '302.6030', '302.6032', '302.6034', '303.2102', '303.5201', '303.5210', '303.5210.3', '303.5290', '303.6001', '303.6002', '303.6004', '303.6004.1', '303.6005', '303.6006', '303.6007', '303.6020', '303.6021', '303.6022', '303.6023', '303.6026', '303.6028', '303.6030', '303.6032', '303.6034', '304.2102', '304.5201', '304.5210', '304.5210.3', '304.5290', '304.6001', '304.6002', '304.6004', '304.6004.1', '304.6005', '304.6006', '304.6007', '304.6020', '304.6021', '304.6022', '304.6023', '304.6026', '304.6028', '304.6030', '304.6032', '304.6034', '306.2102', '306.5201', '306.5210', '306.5210.3', '306.5290', '306.6001', '306.6002', '306.6004', '306.6004.1', '306.6005', '306.6006', '306.6007', '306.6020', '306.6021', '306.6022', '306.6023', '306.6026', '306.6028', '306.6030', '306.6032', '306.6034', '307.2102', '307.5201', '307.5210', '307.5210.3', '307.5290', '307.6001', '307.6002', '307.6004', '307.6004.1', '307.6005', '307.6006', '307.6007', '307.6020', '307.6021', '307.6022', '307.6023', '307.6026', '307.6028', '307.6030', '307.6032', '307.6034', '312.6001', '312.6002', '312.6004', '312.6004.1', '312.6005', '312.6006', '312.6020', '312.6021', '312.6022', '312.6023', '312.6026', '312.6028', '312.6030', '312.6032', '312.6034', '322.6001', '322.6002', '322.6004', '322.6005', '322.6006', '322.6020', '322.6021', '322.6022', '322.6023', '322.6026', '322.6028', '322.6030', '322.6032', '322.6034', '332.6001', '332.6002', '332.6004', '332.6005', '332.6006', '332.6020', '332.6021', '332.6022', '332.6023', '332.6026', '332.6028', '332.6030', '332.6032', '332.6034', '342.6001', '342.6002', '342.6004', '342.6005', '342.6006', '342.6020', '342.6021', '342.6022', '342.6023', '342.6026', '342.6028', '342.6030', '342.6032', '342.6034', '362.6001', '362.6002', '362.6004', '362.6005', '362.6006', '362.6020', '362.6021', '362.6022', '362.6023', '362.6026', '362.6028', '362.6030', '362.6032', '362.6034', '372.6001', '372.6002', '372.6004', '372.6005', '372.6006', '372.6020', '372.6021', '372.6022', '372.6023', '372.6026', '372.6028', '372.6030', '372.6032', '372.6034', '3000.2102', '3000.2103', '3000.6001', '3000.6002', '3000.6004', '3000.6004.1', '3000.6005', '3000.6006', '3000.6007', '3000.6020', '3000.6021', '3000.6022', '3000.6023', '3000.6026', '3000.6028', '3000.6030', '3000.6032', '3000.6034', '3000.6161')\r\n    group by glco, gldoc, gldct, gljeln, glextl, glani, gldgj\r\n),\r\nopco_gl_trans as (\r\n    select \r\n    {{ dbt_utils.surrogate_key(['gd.src_sys_nm', 'glco', 'gldoc', 'gldct', 'gljeln', 'glextl', 'glani', 'gldgj']) }} as opco_gl_trans_sk,\r\n    concat_ws('|', gd.src_sys_nm, glco, gldoc, gldct, gljeln, glextl, glani, gldgj) as opco_gl_trans_ak,\r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    gd.src_sys_nm, \r\n    null as src_key_txt,\r\n    case \r\n        when trim(gd.gldgj) = 0 then iff(length(gd.gldicj) = 6, {{ julian_to_clndr_dt('gd.gldicj')}}, null)\r\n        else iff(length(gd.gldgj) = 6, {{ julian_to_clndr_dt('gd.gldgj')}}, null)\r\n    end as trans_dt,\r\n    opco.opco_sk,\r\n    ocoa.opco_chart_of_accts_sk,\r\n    ogtt.opco_gl_trans_type_sk, \r\n    null as opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    null as opco_dept_sk,\r\n    null as opco_type_sk,\r\n    null as opco_purpose_sk,\r\n    null as opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    null as opco_proj_sk,\r\n    null as original_gl_opco_sk,\r\n    gd.glodoc as original_gl_voucher_nbr,\r\n    gd.gldoc as voucher_nbr,\r\n    gd.glicu as journal_batch_nbr,\r\n    gd.glexa as gl_desc,\r\n    gd.gldoc as document_nbr,\r\n    case \r\n        when trim(gd.gldgj) = 0 then iff(length(gd.gldicj) = 6, {{ julian_to_clndr_dt('gd.gldicj')}}, null)\r\n        else iff(length(gd.gldgj) = 6, {{ julian_to_clndr_dt('gd.gldgj')}}, null)\r\n    end as document_dt,\r\n    null as crrctn_trans_ind,\r\n    null as credit_ind,\r\n    gd.gl_qty,\r\n    gd.trans_currency_gl_amt,\r\n    gd.opco_currency_gl_amt,\r\n    gd.fscl_yr_nbr,\r\n    gd.fscl_mnth_nbr,\r\n    iff(gd.glpost = 'P', 1, 0) as posted_ind,\r\n    ou.opco_uom_sk,\r\n    null as opco_brand_sk,\r\n    oslt.opco_sub_ledger_type_sk,\r\n    gd.glsbl as sub_ledger_cd,\r\n    gd.sub_document_nbr\r\n    from grouped_data gd \r\n    left join {{ ref('v_jde_opco_curr') }} opco \r\n        on gd.glco = opco.opco_id \r\n        and opco.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ ref('v_jde_opco_chart_of_accts_curr') }} ocoa \r\n        on gd.glani = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'JDE-HNCK'    \r\n    left join {{ ref('v_jde_opco_gl_trans_type_curr')}} ogtt \r\n        on gd.gldct = ogtt.src_gl_trans_type_cd\r\n        and ogtt.src_sys_nm = 'JDE-HNCK'  \r\n    left join {{ ref('v_jde_opco_cost_center_curr')}} occ \r\n        on upper(gd.glmcu) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'JDE-HNCK'  \r\n    left join {{ ref('v_jde_opco_currency_curr')}} oc    \r\n        on upper(gd.glcrcd) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'JDE_HNCK'\r\n    left join {{ ref('v_jde_opco_uom_curr')}} ou \r\n        on upper(gd.glum) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ ref('v_jde_opco_sub_ledger_type_curr')}} oslt \r\n        on upper(gd.glsblt) = oslt.src_sub_ledger_type_cd\r\n        and oslt.src_sys_nm = 'JDE-HNCK'\r\n),\r\nfinal as (\r\n    select distinct \r\n        OPCO_GL_TRANS_SK,  \r\n        {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'trans_dt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'opco_proj_sk', 'original_gl_opco_sk', 'original_gl_voucher_nbr', 'voucher_nbr', 'journal_batch_nbr', 'gl_desc', 'document_nbr', 'document_dt', 'crrctn_trans_ind', 'credit_ind', 'gl_qty', 'trans_currency_gl_amt', 'opco_currency_gl_amt', 'fscl_yr_nbr', 'fscl_mnth_nbr', 'posted_ind', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd', 'sub_document_nbr']) }} as opco_gl_trans_ck,\r\n        OPCO_GL_TRANS_AK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_KEY_TXT, TRANS_DT, OPCO_SK, OPCO_CHART_OF_ACCTS_SK, OPCO_GL_TRANS_TYPE_SK, OPCO_GL_TRANS_POSTING_TYPE_SK, OPCO_COST_CENTER_SK, OPCO_DEPT_SK, OPCO_TYPE_SK, OPCO_PURPOSE_SK, OPCO_LOB_SK, TRANS_CURRENCY_SK, OPCO_PROJ_SK, ORIGINAL_GL_OPCO_SK, ORIGINAL_GL_VOUCHER_NBR, VOUCHER_NBR, JOURNAL_BATCH_NBR, GL_DESC, DOCUMENT_NBR, DOCUMENT_DT, CRRCTN_TRANS_IND, CREDIT_IND, GL_QTY, TRANS_CURRENCY_GL_AMT, OPCO_CURRENCY_GL_AMT, fscl_yr_nbr, fscl_mnth_nbr, POSTED_IND, OPCO_UOM_SK, OPCO_BRAND_SK, opco_sub_ledger_type_sk, sub_ledger_cd, sub_document_nbr\r\n    from opco_gl_trans\r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_GL_TRANS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_GL_TRANS_sk, OPCO_GL_TRANS_ck, OPCO_GL_TRANS_AK, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        src_sys_nm, src_key_txt, trans_dt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, opco_proj_sk, original_gl_opco_sk, original_gl_voucher_nbr, voucher_nbr, journal_batch_nbr, gl_desc, document_nbr, document_dt, crrctn_trans_ind, credit_ind, gl_qty, trans_currency_gl_amt, opco_currency_gl_amt, fscl_yr_nbr, fscl_mnth_nbr, posted_ind, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd, sub_document_nbr\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS\r\n        {% if _load == 1 %}\r\n            where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final)\r\n        {% else %}\r\n            where OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck not in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_ck in (select distinct OPCO_GL_TRANS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.julian_to_clndr_dt", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911", "model.OI_Foundation.v_jde_opco_curr", "model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "model.OI_Foundation.v_jde_opco_gl_trans_type_curr", "model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_currency_curr", "model.OI_Foundation.v_jde_opco_uom_curr", "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "general_ledger", "jde_opco_gl_trans"], "unique_id": "model.OI_Foundation.jde_opco_gl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/general_ledger/jde_opco_gl_trans.sql", "original_file_path": "models/jde/general_ledger/jde_opco_gl_trans.sql", "name": "jde_opco_gl_trans", "alias": "jde_opco_gl_trans", "checksum": {"name": "sha256", "checksum": "056bfc5392620533ea9dc70ee87c3074237667f5416f7b2c2061152f2b7592df"}, "tags": [], "refs": [["v_jde_opco_curr"], ["v_jde_opco_chart_of_accts_curr"], ["v_jde_opco_gl_trans_type_curr"], ["v_jde_opco_cost_center_curr"], ["v_jde_opco_currency_curr"], ["v_jde_opco_uom_curr"], ["v_jde_opco_sub_ledger_type_curr"]], "sources": [["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0911"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.017382}, "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal": {"raw_sql": "{% set _load = load_type('JDE_OPCO_FSCL_YR_GL_OPENING_BAL') %}\r\n\r\nwith opco_fscl_yr_gl_opening_bal as(\r\n    select \r\n    {{ dbt_utils.surrogate_key([\"'JDE-HNCK'\", 'f0902.gbco', 'f0902.gbmcu', 'f0902.gbobj', 'f0902.gbsub', 'f0902.gbsblt', 'f0902.gbsbl', 'f0902.gbctry', 'f0902.gbfy'])}} as opco_fscl_yr_gl_opening_bal_sk,\r\n    concat_ws('|', 'JDE-HNCK', trim(f0902.gbco), trim(f0902.gbmcu), trim(f0902.gbobj), trim(f0902.gbsub), trim(f0902.gbsblt), trim(f0902.gbsbl), trim(f0902.gbctry), trim(f0902.gbfy)) as opco_fscl_yr_gl_opening_bal_ak,\r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE-HNCK' as src_sys_nm,\r\n    null as src_key_txt,\r\n    opco.opco_sk,\r\n    ocoa.opco_chart_of_accts_sk,\r\n    null as opco_gl_trans_type_sk,\r\n    null as opco_gl_trans_posting_type_sk,\r\n    occ.opco_cost_center_sk,\r\n    null as opco_dept_sk,\r\n    null as opco_type_sk,\r\n    null as opco_purpose_sk,\r\n    null as opco_lob_sk,\r\n    oc.opco_currency_sk as trans_currency_sk,\r\n    fc.fscl_yr_strt_dt,\r\n    concat(trim(f0902.gbctry), trim(f0902.gbfy)) as fscl_yr_nbr,\r\n    iff(trim(f0902.gbapyc) < 0, 1, 0) as credit_ind,\r\n    iff(trim(f0902.gblt) = 'AU', trim(f0902.gbapyc)/(select pow(10, trim(frcdec)::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'APYC'), null) as opening_bal_qty,\r\n    iff(trim(f0902.gblt) = 'AA', trim(f0902.gbapyc)/(select pow(10, trim(frcdec)::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'APYC'), null) as trans_currency_opening_bal_amt,\r\n    iff(trim(f0902.gblt) = 'AA', trim(f0902.gbapyc)/(select pow(10, trim(frcdec)::number) from {{ source('JDE_DEV', 'JDE920_DD920_F9210') }} where trim(frdtai) = 'APYC'), null) as opco_currency_opening_bal_amt,\r\n    null as opco_uom_sk,\r\n    null as opco_brand_sk,\r\n    oslt.opco_sub_ledger_type_sk,\r\n    trim(f0902.gbsbl) as sub_ledger_cd\r\n    from {{ source('JDE_DEV', 'JDE_PRODUCTION_PRODDTA_F0902') }} f0902\r\n    left join {{ ref('v_jde_opco_curr')}} opco \r\n        on upper(trim(f0902.gbco)) = opco.opco_id\r\n        and opco.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ ref('v_jde_opco_chart_of_accts_curr')}} ocoa \r\n        on iff(trim(f0902.gbsub) <> '', concat_ws('.', upper(trim(f0902.gbmcu)), trim(f0902.gbobj), trim(f0902.gbsub)), concat_ws('.', upper(trim(f0902.gbmcu)), trim(f0902.gbobj))) = ocoa.gl_acct_nbr\r\n        and ocoa.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ref('v_jde_opco_cost_center_curr')}} occ \r\n        on upper(trim(f0902.gbmcu)) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ref('v_jde_opco_currency_curr')}} oc \r\n        on upper(trim(f0902.gbcrcd)) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ref('fscl_clndr')}} fc \r\n        on concat(trim(f0902.gbctry), trim(f0902.gbfy)) = fc.fscl_yr_id   \r\n    left join {{ref('v_jde_opco_sub_ledger_type_curr')}} oslt \r\n        on upper(trim(f0902.gbsblt)) = oslt.src_sub_ledger_type_cd\r\n        and oslt.src_sys_nm = 'JDE-HNCK'\r\n    where trim(f0902.gbco) = '03000' and trim(f0902.gblt) in ('AA', 'AU')\r\n    and iff(trim(f0902.gbsub) <> '', concat_ws('.', upper(trim(f0902.gbmcu)), trim(f0902.gbobj), trim(f0902.gbsub)), concat_ws('.', upper(trim(f0902.gbmcu)), trim(f0902.gbobj))) not in ('30.6001', '30.6002', '30.6003', '30.6004', '30.6005', '30.6006', '30.6020', '30.6021', '30.6022', '30.6023', '30.6026', '30.6028', '30.6030', '30.6032', '30.6034', '31.6001', '31.6002', '31.6004', '31.6005', '31.6006', '31.6020', '31.6021', '31.6022', '31.6023', '31.6026', '31.6028', '31.6030', '31.6032', '31.6034', '32.6001', '32.6002', '32.6004', '32.6005', '32.6020', '32.6021', '32.6022', '32.6023', '32.6026', '32.6028', '32.6030', '32.6032', '32.6034', '33.6001', '33.6002', '33.6004', '33.6004.1', '33.6005', '33.6006', '33.6020', '33.6021', '33.6022', '33.6023', '33.6026', '33.6028', '33.6030', '33.6032', '33.6034', '301.2102', '301.5201', '301.5210', '301.5210.3', '301.5290', '301.6001', '301.6002', '301.6004', '301.6004.1', '301.6005', '301.6006', '301.6007', '301.6020', '301.6021', '301.6022', '301.6023', '301.6026', '301.6028', '301.6030', '301.6032', '301.6034', '302.2102', '302.5201', '302.5210', '302.5210.3', '302.5290', '302.6001', '302.6002', '302.6004', '302.6004.1', '302.6005', '302.6006', '302.6007', '302.6020', '302.6021', '302.6022', '302.6023', '302.6026', '302.6028', '302.6030', '302.6032', '302.6034', '303.2102', '303.5201', '303.5210', '303.5210.3', '303.5290', '303.6001', '303.6002', '303.6004', '303.6004.1', '303.6005', '303.6006', '303.6007', '303.6020', '303.6021', '303.6022', '303.6023', '303.6026', '303.6028', '303.6030', '303.6032', '303.6034', '304.2102', '304.5201', '304.5210', '304.5210.3', '304.5290', '304.6001', '304.6002', '304.6004', '304.6004.1', '304.6005', '304.6006', '304.6007', '304.6020', '304.6021', '304.6022', '304.6023', '304.6026', '304.6028', '304.6030', '304.6032', '304.6034', '306.2102', '306.5201', '306.5210', '306.5210.3', '306.5290', '306.6001', '306.6002', '306.6004', '306.6004.1', '306.6005', '306.6006', '306.6007', '306.6020', '306.6021', '306.6022', '306.6023', '306.6026', '306.6028', '306.6030', '306.6032', '306.6034', '307.2102', '307.5201', '307.5210', '307.5210.3', '307.5290', '307.6001', '307.6002', '307.6004', '307.6004.1', '307.6005', '307.6006', '307.6007', '307.6020', '307.6021', '307.6022', '307.6023', '307.6026', '307.6028', '307.6030', '307.6032', '307.6034', '312.6001', '312.6002', '312.6004', '312.6004.1', '312.6005', '312.6006', '312.6020', '312.6021', '312.6022', '312.6023', '312.6026', '312.6028', '312.6030', '312.6032', '312.6034', '322.6001', '322.6002', '322.6004', '322.6005', '322.6006', '322.6020', '322.6021', '322.6022', '322.6023', '322.6026', '322.6028', '322.6030', '322.6032', '322.6034', '332.6001', '332.6002', '332.6004', '332.6005', '332.6006', '332.6020', '332.6021', '332.6022', '332.6023', '332.6026', '332.6028', '332.6030', '332.6032', '332.6034', '342.6001', '342.6002', '342.6004', '342.6005', '342.6006', '342.6020', '342.6021', '342.6022', '342.6023', '342.6026', '342.6028', '342.6030', '342.6032', '342.6034', '362.6001', '362.6002', '362.6004', '362.6005', '362.6006', '362.6020', '362.6021', '362.6022', '362.6023', '362.6026', '362.6028', '362.6030', '362.6032', '362.6034', '372.6001', '372.6002', '372.6004', '372.6005', '372.6006', '372.6020', '372.6021', '372.6022', '372.6023', '372.6026', '372.6028', '372.6030', '372.6032', '372.6034', '3000.2102', '3000.2103', '3000.6001', '3000.6002', '3000.6004', '3000.6004.1', '3000.6005', '3000.6006', '3000.6007', '3000.6020', '3000.6021', '3000.6022', '3000.6023', '3000.6026', '3000.6028', '3000.6030', '3000.6032', '3000.6034', '3000.6161')\r\n),\r\npre_final as(\r\n    select distinct \r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ak,\r\n    crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt, opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd \r\n    from opco_fscl_yr_gl_opening_bal\r\n),\r\nqty_cte as (\r\n    select distinct\r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ak,\r\n    crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt, opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd \r\n    from pre_final\r\n    where opening_bal_qty is not null\r\n),\r\namt_cte as (\r\n    select distinct \r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ak,\r\n    crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt, opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd \r\n    from pre_final\r\n    where opening_bal_qty is null\r\n),\r\nfinal as (\r\n    select distinct\r\n    coalesce(ac.opco_fscl_yr_gl_opening_bal_sk, qc.opco_fscl_yr_gl_opening_bal_sk) as opco_fscl_yr_gl_opening_bal_sk,\r\n    {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_key_txt', 'opco_sk', 'opco_chart_of_accts_sk', 'opco_gl_trans_type_sk', 'opco_gl_trans_posting_type_sk', 'opco_cost_center_sk', 'opco_dept_sk', 'opco_type_sk', 'opco_purpose_sk', 'opco_lob_sk', 'trans_currency_sk', 'fscl_yr_strt_dt', 'fscl_yr_nbr', 'credit_ind', 'opening_bal_qty', 'trans_currency_opening_bal_amt', 'opco_currency_opening_bal_amt', 'opco_uom_sk', 'opco_brand_sk', 'opco_sub_ledger_type_sk', 'sub_ledger_cd']) }} as opco_fscl_yr_gl_opening_bal_ck,\r\n    coalesce(ac.opco_fscl_yr_gl_opening_bal_ak, qc.opco_fscl_yr_gl_opening_bal_ak) as opco_fscl_yr_gl_opening_bal_ak,\r\n    coalesce(ac.crt_dtm, qc.crt_dtm) as crt_dtm,\r\n    coalesce(ac.stg_load_dtm, qc.stg_load_dtm) as stg_load_dtm,\r\n    coalesce(ac.delete_dtm, qc.delete_dtm) as delete_dtm,\r\n    coalesce(ac.src_sys_nm, qc.src_sys_nm) as src_sys_nm,\r\n    coalesce(ac.src_key_txt, qc.src_key_txt) as src_key_txt,\r\n    coalesce(ac.opco_sk, qc.opco_sk) as opco_sk,\r\n    coalesce(ac.opco_chart_of_accts_sk, qc.opco_chart_of_accts_sk) as opco_chart_of_accts_sk,\r\n    coalesce(ac.opco_gl_trans_type_sk, qc.opco_gl_trans_type_sk) as opco_gl_trans_type_sk,\r\n    coalesce(ac.opco_gl_trans_posting_type_sk, qc.opco_gl_trans_posting_type_sk) as opco_gl_trans_posting_type_sk,\r\n    coalesce(ac.opco_cost_center_sk, qc.opco_cost_center_sk) as opco_cost_center_sk,\r\n    coalesce(ac.opco_dept_sk, qc.opco_dept_sk) as opco_dept_sk,\r\n    coalesce(ac.opco_type_sk, qc.opco_type_sk) as opco_type_sk,\r\n    coalesce(ac.opco_purpose_sk, qc.opco_purpose_sk) as opco_purpose_sk,\r\n    coalesce(ac.opco_lob_sk, qc.opco_lob_sk) as opco_lob_sk,\r\n    coalesce(ac.trans_currency_sk, qc.trans_currency_sk) as trans_currency_sk,\r\n    coalesce(ac.fscl_yr_strt_dt, qc.fscl_yr_strt_dt) as fscl_yr_strt_dt,\r\n    coalesce(ac.fscl_yr_nbr, qc.fscl_yr_nbr) as fscl_yr_nbr,\r\n    case\r\n        when ac.trans_currency_opening_bal_amt is null and ac.opco_currency_opening_bal_amt is null then qc.credit_ind\r\n        else ac.credit_ind\r\n    end as credit_ind,\r\n    coalesce(qc.opening_bal_qty, ac.opening_bal_qty) as opening_bal_qty,\r\n    coalesce(ac.trans_currency_opening_bal_amt, qc.trans_currency_opening_bal_amt) as trans_currency_opening_bal_amt,\r\n    coalesce(ac.opco_currency_opening_bal_amt, qc.opco_currency_opening_bal_amt) as opco_currency_opening_bal_amt,\r\n    coalesce(ac.opco_uom_sk, qc.opco_uom_sk) as opco_uom_sk,\r\n    coalesce(ac.opco_brand_sk, qc.opco_brand_sk) as opco_brand_sk,\r\n    coalesce(ac.opco_sub_ledger_type_sk, qc.opco_sub_ledger_type_sk) as opco_sub_ledger_type_sk,\r\n    coalesce(ac.sub_ledger_cd , qc.sub_ledger_cd) as sub_ledger_cd\r\n    from amt_cte ac \r\n    full outer join qty_cte qc \r\n        using(opco_fscl_yr_gl_opening_bal_sk)\r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_FSCL_YR_GL_OPENING_BAL') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_FSCL_YR_GL_OPENING_BAL') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_FSCL_YR_GL_OPENING_BAL_SK, OPCO_FSCL_YR_GL_OPENING_BAL_CK, opco_fscl_yr_gl_opening_bal_ak, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt, opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL\r\n        {% if _load == 1 %}\r\n            where OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from final)\r\n        {% else %}\r\n            where OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_FSCL_YR_GL_OPENING_BAL_ck not in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_FSCL_YR_GL_OPENING_BAL_ck in (select distinct OPCO_FSCL_YR_GL_OPENING_BAL_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_FSCL_YR_GL_OPENING_BAL where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902", "model.OI_Foundation.v_jde_opco_curr", "model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_currency_curr", "model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "general_ledger", "jde_opco_fscl_yr_gl_opening_bal"], "unique_id": "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/general_ledger/jde_opco_fscl_yr_gl_opening_bal.sql", "original_file_path": "models/jde/general_ledger/jde_opco_fscl_yr_gl_opening_bal.sql", "name": "jde_opco_fscl_yr_gl_opening_bal", "alias": "jde_opco_fscl_yr_gl_opening_bal", "checksum": {"name": "sha256", "checksum": "a282f475ae0d4ce6a677c02db4d6d1db32514176d42b73bbb114a6161963b2bb"}, "tags": [], "refs": [["v_jde_opco_curr"], ["v_jde_opco_chart_of_accts_curr"], ["v_jde_opco_cost_center_curr"], ["v_jde_opco_currency_curr"], ["fscl_clndr"], ["v_jde_opco_sub_ledger_type_curr"]], "sources": [["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE920_DD920_F9210"], ["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0902"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.043877}, "model.OI_Foundation.jde_opco_sub_ledger_type": {"raw_sql": "{{\r\n    config(\r\n        materialized='table',\r\n        transient=false\r\n    )\r\n}}\r\n\r\nwith opco_sub_ledger_type as(\r\n    {% set values = [ 'Address Book', 'Cost Center', 'Equipment', 'Case Number', 'Service Contract', 'Item Number', 'Lease Number', 'Order Number', 'Unit Number', 'Free Form, Alpha, left Justified', 'Free Form, Numeric, zero fill', 'Free Form, Alpha, blank fill' ] %}\r\n    {% set num = [ 'A', 'C', 'E', 'F', 'G', 'I', 'L', 'O', 'U', 'W', 'Y', 'Z' ] %}\r\n\r\n  {% for i in range(12) %}\r\n    select current_timestamp as crt_dtm,\r\n          'JDE-HNCK'::varchar(20) as src_sys_nm,\r\n          '{{num[i]}}'::varchar(20) as src_sub_ledger_type_cd,\r\n          '{{values[i]}}'::varchar(50) as src_sub_ledger_type_desc,\r\n          '1'::number(1,0) as actv_ind\r\n          {% if not loop.last %} union all {% endif %}\r\n  {% endfor %}\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sub_ledger_type_cd']) }} as opco_sub_ledger_type_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_sub_ledger_type_cd', 'src_sub_ledger_type_desc', 'actv_ind']) }} as opco_sub_ledger_type_ck,\r\n            *\r\n    from opco_sub_ledger_type\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": ["macro.dbt_utils.surrogate_key"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "general_ledger", "jde_opco_sub_ledger_type"], "unique_id": "model.OI_Foundation.jde_opco_sub_ledger_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/general_ledger/jde_opco_sub_ledger_type.sql", "original_file_path": "models/jde/general_ledger/jde_opco_sub_ledger_type.sql", "name": "jde_opco_sub_ledger_type", "alias": "jde_opco_sub_ledger_type", "checksum": {"name": "sha256", "checksum": "53e3e195aa9b341d0dd9f9773bdf41b9eac252ec61be82b95758dbeb44f4f81b"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086795.0632474}, "model.OI_Foundation.jde_opco_chart_of_accts": {"raw_sql": "{% set _load = load_type('JDE_OPCO_CHART_OF_ACCTS') %}\r\n\r\nwith jde_opco_chart_of_accts as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE-HNCK'::varchar(20) as src_sys_nm,\r\n    iff(trim(f1.gmsub) <> '', concat_ws('.', upper(trim(f1.gmmcu)), trim(f1.gmobj), trim(f1.gmsub)), concat_ws('.', upper(trim(f1.gmmcu)), trim(f1.gmobj)))::varchar(20) as gl_acct_nbr,\r\n    trim(f1.gmco)::varchar(15) as opco_id,\r\n    trim(f1.gmdl01)::varchar(100) as gl_acct_nm,\r\n    null::varchar(32) as chart_of_accts_sk,\r\n    occ.opco_cost_center_sk,\r\n    null::varchar(32) as opco_dept_sk,\r\n    null::varchar(32) as opco_type_sk,\r\n    null::varchar(32) as opco_purpose_sk,\r\n    null::varchar(32) as opco_lob_sk,\r\n    null::varchar(32) as opco_chart_of_accts_type_sk,\r\n    ou.opco_uom_sk,\r\n    null::varchar(120) as gl_acct_alias_nm,\r\n    case \r\n        when trim(f1.gmpec) = 'M' then 1 \r\n        else 0 \r\n    end::number(1,0) as manual_entry_allowed_ind,\r\n    null::number(1,0) as dpo_exclusion_ind,\r\n    null::number(1,0) as movement_allowed_ind,\r\n    null::varchar(50) as cost_center_reqd_txt,\r\n    null::varchar(50) as dept_reqd_txt,\r\n    null::varchar(50) as type_reqd_txt,\r\n    null::varchar(10) as prnt_gl_acct_nbr,\r\n    null::varchar(10) as related_gl_acct_nbr,\r\n    null::varchar(10) as monetary_gl_acct_ind,\r\n    iff(trim(f1.gmpec) in ('I', 'N'), 0, 1)::number(1,0) as actv_ind,\r\n    iff(trim(f0.mcstyl) = 'BS', 1, 0)::number(1,0) as balance_sheet_acct_ind,\r\n    iff(trim(f1.gmpec) = 'N', 1, 0)::number(1,0) as summary_acct_ind,\r\n    null::varchar(32) as opco_brand_sk,\r\n    upper(trim(f1.gmobj))::varchar(20) as acct_clssfctn_cd,\r\n    upper(trim(f1.gmsub))::varchar(20) as sub_acct_nbr\r\n    from {{source('JDE_DEV','JDE_PRODUCTION_PRODDTA_F0901')}} f1\r\n    left join {{source('JDE_DEV','JDE_PRODUCTION_PRODDTA_F0006')}} f0\r\n        on trim(f1.gmmcu) = trim(f0.mcmcu)\r\n    left join {{ ref('v_jde_opco_cost_center_curr')}} occ \r\n        on upper(trim(f1.gmmcu)) = occ.src_cost_center_cd\r\n        and occ.src_sys_nm = 'JDE-HNCK'\r\n    left join {{ ref('v_jde_opco_uom_curr')}} ou \r\n        on upper(trim(f1.gmum)) = ou.src_uom_cd\r\n        and ou.src_sys_nm = 'JDE-HNCK'\r\n    where gl_acct_nbr is not null\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'gl_acct_nbr']) }} as opco_chart_of_accts_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'gl_acct_nbr',  'opco_id',  'gl_acct_nm',  'chart_of_accts_sk',  'opco_cost_center_sk',  'opco_dept_sk',  'opco_type_sk',  'opco_purpose_sk',  'opco_lob_sk',  'opco_chart_of_accts_type_sk',  'opco_uom_sk',  'gl_acct_alias_nm',  'manual_entry_allowed_ind',  'dpo_exclusion_ind',  'movement_allowed_ind',  'cost_center_reqd_txt',  'dept_reqd_txt',  'type_reqd_txt',  'prnt_gl_acct_nbr',  'related_gl_acct_nbr',  'monetary_gl_acct_ind',  'actv_ind',  'balance_sheet_acct_ind',  'summary_acct_ind',  'opco_brand_sk',  'acct_clssfctn_cd',  'sub_acct_nbr']) }} as opco_chart_of_accts_ck,\r\n            * \r\n    from jde_opco_chart_of_accts\r\n),\r\ndelete_captured as(\r\n    select * from final    \r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_CHART_OF_ACCTS') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CHART_OF_ACCTS') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CHART_OF_ACCTS_sk, OPCO_CHART_OF_ACCTS_ck, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        src_sys_nm, gl_acct_nbr, opco_id, gl_acct_nm, chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, manual_entry_allowed_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind, opco_brand_sk, acct_clssfctn_cd, sub_acct_nbr\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS\r\n        {% if _load == 1 %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final)\r\n        {% else %}\r\n            where OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck not in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_CHART_OF_ACCTS_ck in (select distinct OPCO_CHART_OF_ACCTS_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_CHART_OF_ACCTS where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006", "model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_uom_curr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "general_ledger", "jde_opco_chart_of_accts"], "unique_id": "model.OI_Foundation.jde_opco_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/general_ledger/jde_opco_chart_of_accts.sql", "original_file_path": "models/jde/general_ledger/jde_opco_chart_of_accts.sql", "name": "jde_opco_chart_of_accts", "alias": "jde_opco_chart_of_accts", "checksum": {"name": "sha256", "checksum": "523c0c8d8a8f19078156dc9837a7431efeb20a8a50beb7601ddc999203650dc3"}, "tags": [], "refs": [["v_jde_opco_cost_center_curr"], ["v_jde_opco_uom_curr"]], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0901"], ["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0006"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.0723922}, "model.OI_Foundation.jde_opco_gl_trans_type": {"raw_sql": "{% set _load = load_type('JDE_OPCO_GL_TRANS_TYPE') %}\r\n\r\nwith jde_opco_gl_trans_type as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE_HNCK'::varchar(20) as src_sys_nm,\r\n    upper(trim(drky))::varchar(50) as src_gl_trans_type_cd,\r\n    trim(drdl01)::varchar(100) as src_gl_trans_type_desc\r\n    from {{source('JDE_DEV', 'JDE_PRODUCTION_PRODCTL_F0005')}}\r\n    where trim(drsy) = '00' and trim(drrt) = 'DT'\t\t\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd']) }} as opco_gl_trans_type_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_gl_trans_type_cd', 'src_gl_trans_type_desc']) }} as opco_gl_trans_type_ck,\r\n            * \r\n    from jde_opco_gl_trans_type\r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_GL_TRANS_TYPE') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_GL_TRANS_TYPE') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_GL_TRANS_TYPE_sk, OPCO_GL_TRANS_TYPE_ck, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        src_sys_nm, src_gl_trans_type_cd, src_gl_trans_type_desc\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE\r\n        {% if _load == 1 %}\r\n            where OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from final)\r\n        {% else %}\r\n            where OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_TYPE_ck not in (select distinct OPCO_GL_TRANS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_GL_TRANS_TYPE_ck in (select distinct OPCO_GL_TRANS_TYPE_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_GL_TRANS_TYPE where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "general_ledger", "jde_opco_gl_trans_type"], "unique_id": "model.OI_Foundation.jde_opco_gl_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/general_ledger/jde_opco_gl_trans_type.sql", "original_file_path": "models/jde/general_ledger/jde_opco_gl_trans_type.sql", "name": "jde_opco_gl_trans_type", "alias": "jde_opco_gl_trans_type", "checksum": {"name": "sha256", "checksum": "d6017ea7b6029a2411de433597e148ba2b6ffcc0b77dd6b12c02b659085d68ed"}, "tags": [], "refs": [], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODCTL_F0005"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.0889208}, "model.OI_Foundation.v_jde_opco_gl_trans_curr": {"raw_sql": "with v_jde_opco_gl_trans as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_gl_trans') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_gl_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_gl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "general_ledger", "v_jde_opco_gl_trans_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_gl_trans_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/general_ledger/v_jde_opco_gl_trans_curr.sql", "original_file_path": "models/jde/current_views/general_ledger/v_jde_opco_gl_trans_curr.sql", "name": "v_jde_opco_gl_trans_curr", "alias": "v_jde_opco_gl_trans_curr", "checksum": {"name": "sha256", "checksum": "c58317e4c8a5c5bfa0d5885795fa8785619681bac22fe9525b115eb98ed0d7e9"}, "tags": [], "refs": [["jde_opco_gl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.10037}, "model.OI_Foundation.v_jde_opco_fscl_yr_gl_opening_bal_curr": {"raw_sql": "with v_jde_opco_fscl_yr_gl_opening_bal as(\r\n    select *,\r\n    rank() over(partition by opco_fscl_yr_gl_opening_bal_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_fscl_yr_gl_opening_bal') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_fscl_yr_gl_opening_bal\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "general_ledger", "v_jde_opco_fscl_yr_gl_opening_bal_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_fscl_yr_gl_opening_bal_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/general_ledger/v_jde_opco_fscl_yr_gl_opening_bal_curr.sql", "original_file_path": "models/jde/current_views/general_ledger/v_jde_opco_fscl_yr_gl_opening_bal_curr.sql", "name": "v_jde_opco_fscl_yr_gl_opening_bal_curr", "alias": "v_jde_opco_fscl_yr_gl_opening_bal_curr", "checksum": {"name": "sha256", "checksum": "71afa4452474f4584d99f473062cb1e2d4e61fcacf3001a2eaa36520f8007d78"}, "tags": [], "refs": [["jde_opco_fscl_yr_gl_opening_bal"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1026857}, "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr": {"raw_sql": "with v_jde_opco_sub_ledger_type as(\r\n    select *\r\n    from {{ ref('jde_opco_sub_ledger_type') }}\r\n)\r\n\r\nselect * from v_jde_opco_sub_ledger_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_sub_ledger_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "general_ledger", "v_jde_opco_sub_ledger_type_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/general_ledger/v_jde_opco_sub_ledger_type_curr.sql", "original_file_path": "models/jde/current_views/general_ledger/v_jde_opco_sub_ledger_type_curr.sql", "name": "v_jde_opco_sub_ledger_type_curr", "alias": "v_jde_opco_sub_ledger_type_curr", "checksum": {"name": "sha256", "checksum": "527895260845b8f6fef9cc240dd85079590602cd24e01bfc5e53ca43eb2bb36d"}, "tags": [], "refs": [["jde_opco_sub_ledger_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1046674}, "model.OI_Foundation.v_jde_opco_chart_of_accts_curr": {"raw_sql": "with v_jde_opco_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by opco_chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_chart_of_accts') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "general_ledger", "v_jde_opco_chart_of_accts_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/general_ledger/v_jde_opco_chart_of_accts_curr.sql", "original_file_path": "models/jde/current_views/general_ledger/v_jde_opco_chart_of_accts_curr.sql", "name": "v_jde_opco_chart_of_accts_curr", "alias": "v_jde_opco_chart_of_accts_curr", "checksum": {"name": "sha256", "checksum": "ba5457857e029bd884c3e7524d6dac84275c31edbe67d6e6a09f61ed8b52fd3c"}, "tags": [], "refs": [["jde_opco_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1067295}, "model.OI_Foundation.v_jde_opco_gl_trans_type_curr": {"raw_sql": "with v_jde_opco_gl_trans_type as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_gl_trans_type') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_gl_trans_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_gl_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "general_ledger", "v_jde_opco_gl_trans_type_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_gl_trans_type_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/general_ledger/v_jde_opco_gl_trans_type_curr.sql", "original_file_path": "models/jde/current_views/general_ledger/v_jde_opco_gl_trans_type_curr.sql", "name": "v_jde_opco_gl_trans_type_curr", "alias": "v_jde_opco_gl_trans_type_curr", "checksum": {"name": "sha256", "checksum": "0f0abdd8fa9e9e4d3d70ca3f64d67a78def6a165f479158660b3d5c0fecedcd9"}, "tags": [], "refs": [["jde_opco_gl_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.108713}, "model.OI_Foundation.v_jde_opco_currency_curr": {"raw_sql": "with v_jde_opco_currency as(\r\n    select *,\r\n    rank() over(partition by opco_currency_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_currency') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_currency\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "customer", "v_jde_opco_currency_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_currency_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/customer/v_jde_opco_currency_curr.sql", "original_file_path": "models/jde/current_views/customer/v_jde_opco_currency_curr.sql", "name": "v_jde_opco_currency_curr", "alias": "v_jde_opco_currency_curr", "checksum": {"name": "sha256", "checksum": "b05aeaf8c7fdc8e002d2d1b5976879ce6651396f66a98abc0020871da3026c0c"}, "tags": [], "refs": [["jde_opco_currency"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1109726}, "model.OI_Foundation.v_jde_opco_uom_curr": {"raw_sql": "with v_jde_opco_uom as(\r\n    select *,\r\n    rank() over(partition by opco_uom_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_uom') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_uom\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_uom"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "product", "v_jde_opco_uom_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_uom_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/product/v_jde_opco_uom_curr.sql", "original_file_path": "models/jde/current_views/product/v_jde_opco_uom_curr.sql", "name": "v_jde_opco_uom_curr", "alias": "v_jde_opco_uom_curr", "checksum": {"name": "sha256", "checksum": "5a906c0d1b444b521dde6f7364ecf4f8616070a8f7925b84ac9b4b616bf777bd"}, "tags": [], "refs": [["jde_opco_uom"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1129725}, "model.OI_Foundation.v_jde_opco_curr": {"raw_sql": "with v_jde_opco as(\r\n    select *,\r\n    rank() over(partition by opco_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "organization", "v_jde_opco_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/organization/v_jde_opco_curr.sql", "original_file_path": "models/jde/current_views/organization/v_jde_opco_curr.sql", "name": "v_jde_opco_curr", "alias": "v_jde_opco_curr", "checksum": {"name": "sha256", "checksum": "de11352a8219dbd721a1aa79ac8b91ed6add249b4f5f6c4775dfff6c0c322925"}, "tags": [], "refs": [["jde_opco"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1149375}, "model.OI_Foundation.v_jde_opco_cost_center_curr": {"raw_sql": "with v_jde_opco_cost_center as(\r\n    select *,\r\n    rank() over(partition by opco_cost_center_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('jde_opco_cost_center') }}\r\n),\r\nfinal as(\r\n    select \r\n    *\r\n    from v_jde_opco_cost_center\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.jde_opco_cost_center"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "ephemeral", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "current_views", "organization", "v_jde_opco_cost_center_curr"], "unique_id": "model.OI_Foundation.v_jde_opco_cost_center_curr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/current_views/organization/v_jde_opco_cost_center_curr.sql", "original_file_path": "models/jde/current_views/organization/v_jde_opco_cost_center_curr.sql", "name": "v_jde_opco_cost_center_curr", "alias": "v_jde_opco_cost_center_curr", "checksum": {"name": "sha256", "checksum": "729e048a8c7546ac01cc254d8b6a7254f58018c4f47f0fa75240e6d460c6bbb5"}, "tags": [], "refs": [["jde_opco_cost_center"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "ephemeral", "transient": false}, "created_at": 1659086795.1170416}, "model.OI_Foundation.jde_opco_currency": {"raw_sql": "{% set _load = load_type('JDE_OPCO_CURRENCY') %}\r\n\r\nwith jde_opco_currency as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE-HNCK'::varchar(20) as src_sys_nm,\r\n    upper(trim(cvcrcd))::varchar(10) as src_currency_cd,\r\n    trim(cvdl01)::varchar(50) as src_currency_nm\r\n    from {{source('JDE_DEV', 'JDE_PRODUCTION_PRODDTA_F0013')}}\r\n),\r\nfinal as(\r\n    select  {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd'])}} as opco_currency_sk, \r\n            {{dbt_utils.surrogate_key(['src_sys_nm', 'src_currency_cd', 'src_currency_nm'])}} as opco_currency_ck,\r\n            *\r\n    from jde_opco_currency\r\n),\r\ndelete_captured as(\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_CURRENCY') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_CURRENCY') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_CURRENCY_SK, OPCO_CURRENCY_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        SRC_SYS_NM, SRC_CURRENCY_CD, SRC_CURRENCY_NM  \r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency\r\n        {% if _load == 1 %}\r\n            where opco_currency_ck not in (select distinct opco_currency_ck from final)\r\n        {% else %}\r\n            where opco_currency_ck not in (select distinct opco_currency_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck not in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and opco_currency_ck in (select distinct opco_currency_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.opco_currency where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "customer", "jde_opco_currency"], "unique_id": "model.OI_Foundation.jde_opco_currency", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/customer/jde_opco_currency.sql", "original_file_path": "models/jde/customer/jde_opco_currency.sql", "name": "jde_opco_currency", "alias": "jde_opco_currency", "checksum": {"name": "sha256", "checksum": "d9acd565aa4262e82927b4f0cce50627e0e4057214586ea9505c28435b28fe2a"}, "tags": [], "refs": [], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0013"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.1191766}, "model.OI_Foundation.jde_opco_uom": {"raw_sql": "{% set _load = load_type('JDE_OPCO_UOM') %}\r\n\r\nwith jde_opco_uom as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE_HNCK'::varchar(20) as src_sys_nm,\r\n    upper(trim(drky))::varchar(15) as src_uom_cd,\r\n    trim(drdl01)::varchar(50) as src_uom_desc\r\n    from {{source('JDE_DEV', 'JDE_PRODUCTION_PRODCTL_F0005')}}\r\n    where trim(drsy) = '00' and trim(drrt) = 'UM'\t\t\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd']) }} as opco_uom_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_uom_cd', 'src_uom_desc']) }} as opco_uom_ck,\r\n            * \r\n    from jde_opco_uom\r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_UOM') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_UOM') and _load != 3%}\r\n        union\r\n        select\r\n        opco_uom_sk, opco_uom_ck, crt_dtm, \r\n        (select max(stg_load_dtm) from final) as stg_load_dtm,\r\n        (select max(stg_load_dtm) from final) as delete_dtm,\r\n        src_sys_nm, src_uom_cd, src_uom_desc\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM\r\n        {% if _load == 1 %}\r\n            where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final)\r\n        {% else %}\r\n            where OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck not in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_UOM_ck in (select distinct OPCO_UOM_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_UOM where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "product", "jde_opco_uom"], "unique_id": "model.OI_Foundation.jde_opco_uom", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/product/jde_opco_uom.sql", "original_file_path": "models/jde/product/jde_opco_uom.sql", "name": "jde_opco_uom", "alias": "jde_opco_uom", "checksum": {"name": "sha256", "checksum": "606048aadb194661560853786911fa415ce481be1c26e56511df5401757a733a"}, "tags": [], "refs": [], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODCTL_F0005"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.1312213}, "model.OI_Foundation.jde_opco": {"raw_sql": "{% set _load = load_type('JDE_OPCO') %}\r\n\r\nwith jde_opco as(\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    concat_ws('|','JDE-HNCK', ccco)::varchar(255) as opco_ak,\r\n    'JDE-HNCK'::varchar(20) as src_sys_nm,\r\n    trim(f0.ccco)::varchar(15) as opco_id,\r\n    trim(f0.ccname)::varchar(120) as opco_nm,\r\n    oc.opco_currency_sk,\r\n    null::varchar(32) as region_sk,\r\n    null::varchar(32) as sub_region_sk,\r\n    trim(f0.ccaltc)::varchar(120) as dba_nm,\r\n    '0'::number(1,0) as enterprise_ind,\r\n    trim(f1.abtax)::varchar(130) as govt_issued_id,\r\n    trim(f1.abduns)::varchar(15) as  duns_nbr,\r\n    null::varchar(40) as vat_nbr,\r\n    '2021-03-12'::date as acqstn_dt,\r\n    '1'::number(1,0) as actv_ind,\r\n    null::date as inactv_dt,\r\n    null::varchar(40) as import_vat_nbr,\r\n    trim(f0.ccan8) as website_url_txt_join,\r\n    trim(f1.ablngp)::varchar(20) as language_txt,\r\n    null::date as conversion_dt,\r\n    '0'::number(1,0) as foreign_enty_ind,\r\n    null::number(1,0) as combined_fed_state_tax_filer_ind,\r\n    null::number(1,0) as validate_1099_on_entry_ind,\r\n    null::number(1,0) as planning_company_ind,\r\n    null::varchar(60) as sls_tax_global_id,\r\n    null::varchar(60) as sls_tax_local_id,\r\n    null::varchar(20) as product_line_txt,\r\n    null::varchar(50) as prnt_opco_id,\r\n    null::varchar(50) as collection_type_txt,\r\n    null::number(1,0) as dashboard_usage_id\r\n    from {{source('JDE_DEV','JDE_PRODUCTION_PRODDTA_F0010')}} as f0\r\n    left join {{source('JDE_DEV','JDE_PRODUCTION_PRODDTA_F0101')}} as f1\r\n        on trim(f0.ccan8) = trim(f1.aban8)\r\n    left join {{ ref('jde_opco_currency')}} oc \r\n        on upper(trim(f0.cccrcd)) = oc.src_currency_cd\r\n        and oc.src_sys_nm = 'JDE_HNCK'\r\n),\r\nwebsite_url_col as(\r\n    select \r\n    jde_opco.*,\r\n    trim(f11.eaemal)::varchar(510) as website_url_txt\r\n    from jde_opco\r\n    left join {{source('JDE_DEV','JDE_PRODUCTION_PRODDTA_F01151')}} as f11\r\n        on jde_opco.website_url_txt_join = trim(f11.eaan8)\r\n        and trim(f11.eaidln) = 0 \r\n        and trim(f11.eaetp) = 'I'\r\n),\r\nfinal as(\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id']) }} as opco_sk,\r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'opco_id', 'opco_nm', 'opco_currency_sk', 'region_sk', 'sub_region_sk', 'dba_nm', 'enterprise_ind', 'govt_issued_id', 'duns_nbr', 'vat_nbr', 'acqstn_dt', 'actv_ind', 'inactv_dt', 'import_vat_nbr', 'website_url_txt', 'language_txt', 'conversion_dt', 'foreign_enty_ind', 'combined_fed_state_tax_filer_ind', 'validate_1099_on_entry_ind', 'planning_company_ind', 'sls_tax_global_id', 'sls_tax_local_id', 'product_line_txt', 'prnt_opco_id', 'collection_type_txt', 'dashboard_usage_id']) }} as opco_ck, \r\n    crt_dtm, stg_load_dtm, delete_dtm, opco_ak, src_sys_nm, opco_id, opco_nm, opco_currency_sk, region_sk, sub_region_sk, dba_nm, enterprise_ind, govt_issued_id, duns_nbr, vat_nbr, acqstn_dt, actv_ind, inactv_dt, import_vat_nbr, website_url_txt, language_txt, conversion_dt, foreign_enty_ind, combined_fed_state_tax_filer_ind, validate_1099_on_entry_ind, planning_company_ind, sls_tax_global_id, sls_tax_local_id, product_line_txt, prnt_opco_id, collection_type_txt, dashboard_usage_id\r\n    from website_url_col  \r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_SK, OPCO_CK, opco_ak, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, opco_id, opco_nm, opco_currency_sk, region_sk, sub_region_sk, dba_nm, enterprise_ind, govt_issued_id,  duns_nbr, vat_nbr, acqstn_dt, actv_ind, inactv_dt, import_vat_nbr, website_url_txt, language_txt, conversion_dt, foreign_enty_ind, combined_fed_state_tax_filer_ind, validate_1099_on_entry_ind, planning_company_ind, sls_tax_global_id, sls_tax_local_id, product_line_txt, prnt_opco_id, collection_type_txt, dashboard_usage_id\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO\r\n        {% if _load == 1 %}\r\n            where OPCO_ck not in (select distinct OPCO_ck from final)\r\n        {% else %}\r\n            where OPCO_ck not in (select distinct OPCO_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ck not in (select distinct OPCO_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_ck in (select distinct OPCO_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151", "model.OI_Foundation.jde_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "organization", "jde_opco"], "unique_id": "model.OI_Foundation.jde_opco", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/organization/jde_opco.sql", "original_file_path": "models/jde/organization/jde_opco.sql", "name": "jde_opco", "alias": "jde_opco", "checksum": {"name": "sha256", "checksum": "fea92c0ca5c5bc0613030d008a339d3db33629d2e7832ea3e05a56d7b73315f2"}, "tags": [], "refs": [["jde_opco_currency"]], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0010"], ["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0101"], ["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F01151"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.1425292}, "model.OI_Foundation.jde_opco_cost_center": {"raw_sql": "{% set _load = load_type('JDE_OPCO_COST_CENTER') %}\r\n\r\nwith jde_opco_cost_center as (\r\n    select \r\n    current_timestamp as crt_dtm,\r\n    null::timestamp_tz as stg_load_dtm,\r\n    null::timestamp_tz as delete_dtm,\r\n    'JDE-HNCK'::varchar(20) as src_sys_nm,\r\n    upper(trim(mcmcu))::varchar(20) as src_cost_center_cd,\r\n    trim(mcdl01)::varchar(100) as src_cost_center_desc,\r\n    '1'::number(1,0) as actv_ind,\r\n    trim(mcstyl)::varchar(50) as src_cost_center_type_txt,\r\n    {{ spcl_chr_rp('src_cost_center_desc')}}::varchar(100) as cost_center_wo_spcl_chr_cd\r\n    from {{source('JDE_DEV', 'JDE_PRODUCTION_PRODDTA_F0006')}}\r\n),\r\nfinal as (\r\n    select  {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd']) }} as opco_cost_center_sk, \r\n            {{ dbt_utils.surrogate_key(['src_sys_nm', 'src_cost_center_cd', 'actv_ind', 'src_cost_center_type_txt', 'cost_center_wo_spcl_chr_cd']) }} as opco_cost_center_ck,\r\n            *\r\n    from jde_opco_cost_center\r\n),\r\ndelete_captured as (\r\n    select * from final\r\n    {% if tb_check(var('fnd_tbl_db'), var('intermediate_tbl_sch'), 'JDE_OPCO_COST_CENTER') and tb_check(var('fnd_tbl_db'), var('fnd_tbl_sch'), 'OPCO_COST_CENTER') and _load != 3%}\r\n        union\r\n        select\r\n        OPCO_COST_CENTER_SK, OPCO_COST_CENTER_CK, CRT_DTM, \r\n        (select MAX(STG_LOAD_DTM) from final) as STG_LOAD_DTM,\r\n        (select MAX(STG_LOAD_DTM) from final) as DELETE_DTM,\r\n        src_sys_nm, src_cost_center_cd, src_cost_center_desc, actv_ind, src_cost_center_type_txt, cost_center_wo_spcl_chr_cd\r\n        from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER\r\n        {% if _load == 1 %}\r\n            where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final)\r\n        {% else %}\r\n            where OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from final) \r\n                and date(stg_load_dtm) = (select date(max(stg_load_dtm)) from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'JDE-HNCK')\r\n        {% endif %} \r\n        and src_sys_nm = 'JDE-HNCK'\r\n    {% endif %}\r\n)\r\n\r\nselect * from delete_captured\r\n\r\n\r\n{% if is_incremental() %}\r\n    {% if _load == 3 %}\r\n        where stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) \r\n    {% else %}\r\n        where \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck not in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'JDE-HNCK')) \r\n            or \r\n            (stg_load_dtm > (select max(stg_load_dtm) from {{this}} ) and OPCO_COST_CENTER_ck in (select distinct OPCO_COST_CENTER_ck from {{ var('fnd_tbl_db')}}.{{ var('fnd_tbl_sch')}}.OPCO_COST_CENTER where src_sys_nm = 'JDE-HNCK') and delete_dtm is not null)\r\n    {% endif %}\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.load_type", "macro.OI_Foundation.spcl_chr_rp", "macro.dbt_utils.surrogate_key", "macro.OI_Foundation.tb_check", "macro.dbt.is_incremental"], "nodes": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "jde", "organization", "jde_opco_cost_center"], "unique_id": "model.OI_Foundation.jde_opco_cost_center", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "jde/organization/jde_opco_cost_center.sql", "original_file_path": "models/jde/organization/jde_opco_cost_center.sql", "name": "jde_opco_cost_center", "alias": "jde_opco_cost_center", "checksum": {"name": "sha256", "checksum": "fa7d353193e630f41d96777034a92a51441c7d2f90127f02ed64215426e23f25"}, "tags": [], "refs": [], "sources": [["JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0006"]], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "incremental", "transient": false}, "created_at": 1659086795.1587224}, "model.OI_Foundation._foundation_load_config": {"raw_sql": "with _foundation_load_config as(\r\n    \r\n    {% set models = [\r\n                    'AX_OPCO_CASH_DSCNT_TERMS','AX_OPCO_COMMSN_GRP','AX_OPCO_CURRENCY','AX_OPCO_CUST_CODE','AX_OPCO_CUST_GRP','AX_OPCO_CUST_INVOICE_LINE','AX_OPCO_CUST_INVOICE','AX_OPCO_CUST_OPEN_TRANS','AX_OPCO_CUST_PACKING_SLIP_LINE','AX_OPCO_CUST_PACKING_SLIP','AX_OPCO_CUST_SETTLED_TRANS','AX_OPCO_CUST_TRANS','AX_OPCO_CUST_TYPE','AX_OPCO_CUST','AX_OPCO_OPCO_CUST_XREF','AX_OPCO_PICKING_LIST','AX_OPCO_PYMNT_MODE','AX_OPCO_PYMNT_TERMS',\r\n                    'AX_CHART_OF_ACCTS','AX_OPCO_CHART_OF_ACCTS','AX_OPCO_FSCL_YR_GL_OPENING_BAL','AX_OPCO_GL_TRANS', \r\n                    'AX_OPCO_CUST_OPCO_LOCN_XREF','AX_OPCO_LOCN','AX_OPCO_OPCO_LOCN_XREF','AX_OPCO_VENDOR_OPCO_LOCN_XREF', \r\n                    'AX_FSCL_CLNDR','AX_OPCO_ASSCTN','AX_OPCO_COST_CENTER','AX_OPCO_DEPT','AX_OPCO_SITE','AX_OPCO_TYPE','AX_OPCO','AX_REGION','AX_SUB_REGION','AX_WAREHOUSE',                    \r\n                    'AX_OPCO_INVTRY_TRANS','AX_OPCO_ITEM_CLASS','AX_OPCO_INVTRY_TRANS','AX_OPCO_ITEM_CVRG_GRP','AX_OPCO_ITEM_FREIGHT','AX_OPCO_ITEM_GRP','AX_OPCO_ITEM_INVTRY','AX_OPCO_ITEM_MODEL_GRP','AX_OPCO_ITEM_OPCO_ASSCTN_XREF','AX_OPCO_ITEM_PSI_DTL','AX_OPCO_ITEM_SIZE','AX_OPCO_ITEM_SLS_CLASS','AX_OPCO_ITEM_SUBTYPE','AX_OPCO_ITEM_TYPE','AX_OPCO_ITEM','AX_OPCO_LOB','AX_OPCO_PURPOSE','AX_OPCO_UOM','AX_OPCO_VENDOR',\r\n                    'AX_OPCO_PROJECT_CATGRY','AX_OPCO_PROJECT_COST_FRCST','AX_OPCO_PROJECT_COST_TRANS','AX_OPCO_PROJECT_EMPL_FRCST','AX_OPCO_PROJECT_EMPL_TRANS','AX_OPCO_PROJECT_INVOICE_PROJECT_XREF','AX_OPCO_PROJECT_ITEM_TRANS','AX_OPCO_PROJECT_REVENUE_TRANS','AX_OPCO_PROJECT_TRANS_POSTING','AX_OPCO_PROJECT',\r\n                    'AX_OPCO_PO_LINE','AX_OPCO_PO',\r\n                    'AX_OPCO_DLVRY_MODE','AX_OPCO_DLVRY_TERMS','AX_OPCO_SLS_ORDR_LINE','AX_OPCO_SLS_ORDR','AX_SLS_ORDR_OPCO_LOCN_XREF',\r\n                    'AX_OPCO_VENDOR_INVOICE_LINE','AX_OPCO_VENDOR_INVOICE','AX_OPCO_VENDOR_PACKING_SLIP_LINE','AX_OPCO_VENDOR_PACKING_SLIP','AX_OPCO_VENDOR_TRANS',\r\n\r\n                    'NS_OPCO_CURRENCY','NS_OPCO_PYMNT_MODE','NS_OPCO_PYMNT_TERMS',\r\n                    'NS_OPCO_CHART_OF_ACCTS','NS_OPCO_FSCL_YR_GL_OPENING_BAL','NS_OPCO_GL_TRANS',\r\n                    'NS_OPCO_COST_CENTER','NS_OPCO_DEPT','NS_OPCO_TYPE','NS_OPCO','NS_REGION','NS_SUB_REGION',\r\n                    'NS_OPCO_BRAND','NS_OPCO_PURPOSE','NS_OPCO_UOM',\r\n\r\n                    'JDE_OPCO_CURRENCY', \r\n                    'JDE_OPCO_FSCL_YR_GL_OPENING_BAL','JDE_OPCO_CHART_OF_ACCTS', 'JDE_OPCO_GL_TRANS_TYPE', 'JDE_OPCO_GL_TRANS',\r\n                    'JDE_OPCO_COST_CENTER', 'JDE_OPCO', \r\n                    'JDE_OPCO_UOM', \r\n\r\n                    'PRIMEX_OPCO_CURRENCY',\r\n                    'PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', 'PRIMEX_OPCO_CHART_OF_ACCTS', 'PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', 'PRIMEX_OPCO_GL_TRANS_TYPE', 'PRIMEX_OPCO_GL_TRANS', 'PRIMEX_OPCO_SUB_LEDGER_TYPE',\r\n                    'PRIMEX_OPCO_COST_CENTER', 'PRIMEX_OPCO_DEPT', 'PRIMEX_OPCO_TYPE',\r\n                    'PRIMEX_OPCO_LOB', 'PRIMEX_OPCO_PURPOSE'] %}\r\n\r\n    {% for _model in models %}\r\n        select \r\n        '{{_model}}' as model_nm,\r\n        replace('{{_model}}', concat(split_part('{{_model}}', '_', 1), '_')) as target_model_nm,\r\n        case \r\n            when replace('{{_model}}', concat(split_part('{{_model}}', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\r\n            else null \r\n        end as incrmnt_load_on,\r\n        {% if tb_check( var('fnd_tbl_db'), var('intermediate_tbl_sch'), _model) %}\r\n            max(stg_load_dtm) as max_stg_load_dtm,\r\n            case \r\n                when split_part('{{_model}}', '_', 1) = 'AX' then 3\r\n                when split_part('{{_model}}', '_', 1) = 'NS' then 3\r\n                when split_part('{{_model}}', '_', 1) = 'JDE' then 1\r\n                when split_part('{{_model}}', '_', 1) = 'PRIMEX' then 1\r\n            end as load_type,\r\n            case \r\n                when split_part('{{_model}}', '_', 1) = 'AX' then 'Incremental'\r\n                when split_part('{{_model}}', '_', 1) = 'NS' then 'Incremental'\r\n                when split_part('{{_model}}', '_', 1) = 'JDE' then 'Full Load'\r\n                when split_part('{{_model}}', '_', 1) = 'PRIMEX' then 'Full Load'\r\n            end as load_desc\r\n            from {{ var('fnd_tbl_db')}}.{{ var('intermediate_tbl_sch')}}.{{_model}}\r\n        {% else %}\r\n            null::timestamp_tz as max_stg_load_dtm,\r\n            case \r\n                when split_part('{{_model}}', '_', 0) = 'AX' then 3\r\n                when split_part('{{_model}}', '_', 0) = 'NS' then 3\r\n                when split_part('{{_model}}', '_', 0) = 'JDE' then 1\r\n                when split_part('{{_model}}', '_', 0) = 'PRIMEX' then 1\r\n            end as load_type,\r\n            case \r\n                when split_part('{{_model}}', '_', 0) = 'AX' then 'Incremental'\r\n                when split_part('{{_model}}', '_', 0) = 'NS' then 'Incremental'\r\n                when split_part('{{_model}}', '_', 0) = 'JDE' then 'Full Load'\r\n                when split_part('{{_model}}', '_', 0) = 'PRIMEX' then 'Full Load'\r\n            end as load_desc\r\n        {% endif %}\r\n        {% if not loop.last %} union all {% endif %}\r\n    {% endfor %}\r\n)\r\n\r\nselect * from _foundation_load_config", "compiled": true, "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.tb_check", "macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": []}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "support_tables", "_foundation_load_config"], "unique_id": "model.OI_Foundation._foundation_load_config", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "support_tables/_foundation_load_config.sql", "original_file_path": "models/support_tables/_foundation_load_config.sql", "name": "_foundation_load_config", "alias": "_foundation_load_config", "checksum": {"name": "sha256", "checksum": "16f1fa10ea0489b5256a7c2027c8b2161d1d947b420caf413d9af59992e9fbd4"}, "tags": [], "refs": [], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": "target/compiled/OI_Foundation/models/support_tables/_foundation_load_config.sql", "build_path": "target/run/OI_Foundation/models/support_tables/_foundation_load_config.sql", "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "table", "transient": false}, "created_at": 1659086795.1704018, "compiled_sql": "with _foundation_load_config as(\n    \n    \n\n    \n        select \n        'AX_OPCO_CASH_DSCNT_TERMS' as model_nm,\n        replace('AX_OPCO_CASH_DSCNT_TERMS', concat(split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CASH_DSCNT_TERMS', concat(split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CASH_DSCNT_TERMS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CASH_DSCNT_TERMS\n        \n         union all \n    \n        select \n        'AX_OPCO_COMMSN_GRP' as model_nm,\n        replace('AX_OPCO_COMMSN_GRP', concat(split_part('AX_OPCO_COMMSN_GRP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_COMMSN_GRP', concat(split_part('AX_OPCO_COMMSN_GRP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_COMMSN_GRP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_COMMSN_GRP\n        \n         union all \n    \n        select \n        'AX_OPCO_CURRENCY' as model_nm,\n        replace('AX_OPCO_CURRENCY', concat(split_part('AX_OPCO_CURRENCY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CURRENCY', concat(split_part('AX_OPCO_CURRENCY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CURRENCY\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_CODE' as model_nm,\n        replace('AX_OPCO_CUST_CODE', concat(split_part('AX_OPCO_CUST_CODE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_CODE', concat(split_part('AX_OPCO_CUST_CODE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_CODE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_CODE\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_GRP' as model_nm,\n        replace('AX_OPCO_CUST_GRP', concat(split_part('AX_OPCO_CUST_GRP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_GRP', concat(split_part('AX_OPCO_CUST_GRP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_GRP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_GRP\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_INVOICE_LINE' as model_nm,\n        replace('AX_OPCO_CUST_INVOICE_LINE', concat(split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_INVOICE_LINE', concat(split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_INVOICE_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_INVOICE_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_INVOICE' as model_nm,\n        replace('AX_OPCO_CUST_INVOICE', concat(split_part('AX_OPCO_CUST_INVOICE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_INVOICE', concat(split_part('AX_OPCO_CUST_INVOICE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_INVOICE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_INVOICE\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_OPEN_TRANS' as model_nm,\n        replace('AX_OPCO_CUST_OPEN_TRANS', concat(split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_OPEN_TRANS', concat(split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_OPEN_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_OPEN_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_PACKING_SLIP_LINE' as model_nm,\n        replace('AX_OPCO_CUST_PACKING_SLIP_LINE', concat(split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_PACKING_SLIP_LINE', concat(split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_PACKING_SLIP_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_PACKING_SLIP' as model_nm,\n        replace('AX_OPCO_CUST_PACKING_SLIP', concat(split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_PACKING_SLIP', concat(split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_PACKING_SLIP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_PACKING_SLIP\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_SETTLED_TRANS' as model_nm,\n        replace('AX_OPCO_CUST_SETTLED_TRANS', concat(split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_SETTLED_TRANS', concat(split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_SETTLED_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_SETTLED_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_TRANS' as model_nm,\n        replace('AX_OPCO_CUST_TRANS', concat(split_part('AX_OPCO_CUST_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_TRANS', concat(split_part('AX_OPCO_CUST_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_TYPE' as model_nm,\n        replace('AX_OPCO_CUST_TYPE', concat(split_part('AX_OPCO_CUST_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_TYPE', concat(split_part('AX_OPCO_CUST_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_TYPE\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST' as model_nm,\n        replace('AX_OPCO_CUST', concat(split_part('AX_OPCO_CUST', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST', concat(split_part('AX_OPCO_CUST', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST\n        \n         union all \n    \n        select \n        'AX_OPCO_OPCO_CUST_XREF' as model_nm,\n        replace('AX_OPCO_OPCO_CUST_XREF', concat(split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_OPCO_CUST_XREF', concat(split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_OPCO_CUST_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_OPCO_CUST_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_PICKING_LIST' as model_nm,\n        replace('AX_OPCO_PICKING_LIST', concat(split_part('AX_OPCO_PICKING_LIST', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PICKING_LIST', concat(split_part('AX_OPCO_PICKING_LIST', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PICKING_LIST', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PICKING_LIST\n        \n         union all \n    \n        select \n        'AX_OPCO_PYMNT_MODE' as model_nm,\n        replace('AX_OPCO_PYMNT_MODE', concat(split_part('AX_OPCO_PYMNT_MODE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PYMNT_MODE', concat(split_part('AX_OPCO_PYMNT_MODE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PYMNT_MODE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PYMNT_MODE\n        \n         union all \n    \n        select \n        'AX_OPCO_PYMNT_TERMS' as model_nm,\n        replace('AX_OPCO_PYMNT_TERMS', concat(split_part('AX_OPCO_PYMNT_TERMS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PYMNT_TERMS', concat(split_part('AX_OPCO_PYMNT_TERMS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PYMNT_TERMS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PYMNT_TERMS\n        \n         union all \n    \n        select \n        'AX_CHART_OF_ACCTS' as model_nm,\n        replace('AX_CHART_OF_ACCTS', concat(split_part('AX_CHART_OF_ACCTS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_CHART_OF_ACCTS', concat(split_part('AX_CHART_OF_ACCTS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'AX' then 3\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'NS' then 3\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'JDE' then 1\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_CHART_OF_ACCTS\n        \n         union all \n    \n        select \n        'AX_OPCO_CHART_OF_ACCTS' as model_nm,\n        replace('AX_OPCO_CHART_OF_ACCTS', concat(split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CHART_OF_ACCTS', concat(split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CHART_OF_ACCTS\n        \n         union all \n    \n        select \n        'AX_OPCO_FSCL_YR_GL_OPENING_BAL' as model_nm,\n        replace('AX_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_FSCL_YR_GL_OPENING_BAL\n        \n         union all \n    \n        select \n        'AX_OPCO_GL_TRANS' as model_nm,\n        replace('AX_OPCO_GL_TRANS', concat(split_part('AX_OPCO_GL_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_GL_TRANS', concat(split_part('AX_OPCO_GL_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_GL_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_CUST_OPCO_LOCN_XREF' as model_nm,\n        replace('AX_OPCO_CUST_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_CUST_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_CUST_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_CUST_OPCO_LOCN_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_LOCN' as model_nm,\n        replace('AX_OPCO_LOCN', concat(split_part('AX_OPCO_LOCN', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_LOCN', concat(split_part('AX_OPCO_LOCN', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_LOCN', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_LOCN', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_LOCN', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_LOCN\n        \n         union all \n    \n        select \n        'AX_OPCO_OPCO_LOCN_XREF' as model_nm,\n        replace('AX_OPCO_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_OPCO_LOCN_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_OPCO_LOCN_XREF' as model_nm,\n        replace('AX_OPCO_VENDOR_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_OPCO_LOCN_XREF', concat(split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_OPCO_LOCN_XREF\n        \n         union all \n    \n        select \n        'AX_FSCL_CLNDR' as model_nm,\n        replace('AX_FSCL_CLNDR', concat(split_part('AX_FSCL_CLNDR', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_FSCL_CLNDR', concat(split_part('AX_FSCL_CLNDR', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'AX' then 3\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'NS' then 3\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'JDE' then 1\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_FSCL_CLNDR', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_FSCL_CLNDR\n        \n         union all \n    \n        select \n        'AX_OPCO_ASSCTN' as model_nm,\n        replace('AX_OPCO_ASSCTN', concat(split_part('AX_OPCO_ASSCTN', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ASSCTN', concat(split_part('AX_OPCO_ASSCTN', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ASSCTN', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ASSCTN\n        \n         union all \n    \n        select \n        'AX_OPCO_COST_CENTER' as model_nm,\n        replace('AX_OPCO_COST_CENTER', concat(split_part('AX_OPCO_COST_CENTER', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_COST_CENTER', concat(split_part('AX_OPCO_COST_CENTER', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_COST_CENTER\n        \n         union all \n    \n        select \n        'AX_OPCO_DEPT' as model_nm,\n        replace('AX_OPCO_DEPT', concat(split_part('AX_OPCO_DEPT', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_DEPT', concat(split_part('AX_OPCO_DEPT', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_DEPT', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_DEPT', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_DEPT', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_DEPT\n        \n         union all \n    \n        select \n        'AX_OPCO_SITE' as model_nm,\n        replace('AX_OPCO_SITE', concat(split_part('AX_OPCO_SITE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_SITE', concat(split_part('AX_OPCO_SITE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_SITE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_SITE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_SITE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_SITE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_SITE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_SITE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_SITE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_SITE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_SITE\n        \n         union all \n    \n        select \n        'AX_OPCO_TYPE' as model_nm,\n        replace('AX_OPCO_TYPE', concat(split_part('AX_OPCO_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_TYPE', concat(split_part('AX_OPCO_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_TYPE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_TYPE\n        \n         union all \n    \n        select \n        'AX_OPCO' as model_nm,\n        replace('AX_OPCO', concat(split_part('AX_OPCO', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO', concat(split_part('AX_OPCO', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO\n        \n         union all \n    \n        select \n        'AX_REGION' as model_nm,\n        replace('AX_REGION', concat(split_part('AX_REGION', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_REGION', concat(split_part('AX_REGION', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_REGION', '_', 1) = 'AX' then 3\n                when split_part('AX_REGION', '_', 1) = 'NS' then 3\n                when split_part('AX_REGION', '_', 1) = 'JDE' then 1\n                when split_part('AX_REGION', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_REGION', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_REGION', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_REGION', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_REGION', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_REGION\n        \n         union all \n    \n        select \n        'AX_SUB_REGION' as model_nm,\n        replace('AX_SUB_REGION', concat(split_part('AX_SUB_REGION', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_SUB_REGION', concat(split_part('AX_SUB_REGION', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_SUB_REGION', '_', 1) = 'AX' then 3\n                when split_part('AX_SUB_REGION', '_', 1) = 'NS' then 3\n                when split_part('AX_SUB_REGION', '_', 1) = 'JDE' then 1\n                when split_part('AX_SUB_REGION', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_SUB_REGION', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_SUB_REGION', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_SUB_REGION', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_SUB_REGION', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_SUB_REGION\n        \n         union all \n    \n        select \n        'AX_WAREHOUSE' as model_nm,\n        replace('AX_WAREHOUSE', concat(split_part('AX_WAREHOUSE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_WAREHOUSE', concat(split_part('AX_WAREHOUSE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_WAREHOUSE', '_', 1) = 'AX' then 3\n                when split_part('AX_WAREHOUSE', '_', 1) = 'NS' then 3\n                when split_part('AX_WAREHOUSE', '_', 1) = 'JDE' then 1\n                when split_part('AX_WAREHOUSE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_WAREHOUSE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_WAREHOUSE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_WAREHOUSE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_WAREHOUSE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_WAREHOUSE\n        \n         union all \n    \n        select \n        'AX_OPCO_INVTRY_TRANS' as model_nm,\n        replace('AX_OPCO_INVTRY_TRANS', concat(split_part('AX_OPCO_INVTRY_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_INVTRY_TRANS', concat(split_part('AX_OPCO_INVTRY_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_INVTRY_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_CLASS' as model_nm,\n        replace('AX_OPCO_ITEM_CLASS', concat(split_part('AX_OPCO_ITEM_CLASS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_CLASS', concat(split_part('AX_OPCO_ITEM_CLASS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_CLASS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_CLASS\n        \n         union all \n    \n        select \n        'AX_OPCO_INVTRY_TRANS' as model_nm,\n        replace('AX_OPCO_INVTRY_TRANS', concat(split_part('AX_OPCO_INVTRY_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_INVTRY_TRANS', concat(split_part('AX_OPCO_INVTRY_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_INVTRY_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_INVTRY_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_CVRG_GRP' as model_nm,\n        replace('AX_OPCO_ITEM_CVRG_GRP', concat(split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_CVRG_GRP', concat(split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_CVRG_GRP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_CVRG_GRP\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_FREIGHT' as model_nm,\n        replace('AX_OPCO_ITEM_FREIGHT', concat(split_part('AX_OPCO_ITEM_FREIGHT', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_FREIGHT', concat(split_part('AX_OPCO_ITEM_FREIGHT', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_FREIGHT', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_FREIGHT\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_GRP' as model_nm,\n        replace('AX_OPCO_ITEM_GRP', concat(split_part('AX_OPCO_ITEM_GRP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_GRP', concat(split_part('AX_OPCO_ITEM_GRP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_GRP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_GRP\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_INVTRY' as model_nm,\n        replace('AX_OPCO_ITEM_INVTRY', concat(split_part('AX_OPCO_ITEM_INVTRY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_INVTRY', concat(split_part('AX_OPCO_ITEM_INVTRY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_INVTRY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_INVTRY\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_MODEL_GRP' as model_nm,\n        replace('AX_OPCO_ITEM_MODEL_GRP', concat(split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_MODEL_GRP', concat(split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_MODEL_GRP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_MODEL_GRP\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_OPCO_ASSCTN_XREF' as model_nm,\n        replace('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', concat(split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', concat(split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_OPCO_ASSCTN_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_OPCO_ASSCTN_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_PSI_DTL' as model_nm,\n        replace('AX_OPCO_ITEM_PSI_DTL', concat(split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_PSI_DTL', concat(split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_PSI_DTL', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_PSI_DTL\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_SIZE' as model_nm,\n        replace('AX_OPCO_ITEM_SIZE', concat(split_part('AX_OPCO_ITEM_SIZE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_SIZE', concat(split_part('AX_OPCO_ITEM_SIZE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_SIZE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_SIZE\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_SLS_CLASS' as model_nm,\n        replace('AX_OPCO_ITEM_SLS_CLASS', concat(split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_SLS_CLASS', concat(split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_SLS_CLASS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_SLS_CLASS\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_SUBTYPE' as model_nm,\n        replace('AX_OPCO_ITEM_SUBTYPE', concat(split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_SUBTYPE', concat(split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_SUBTYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_SUBTYPE\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM_TYPE' as model_nm,\n        replace('AX_OPCO_ITEM_TYPE', concat(split_part('AX_OPCO_ITEM_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM_TYPE', concat(split_part('AX_OPCO_ITEM_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM_TYPE\n        \n         union all \n    \n        select \n        'AX_OPCO_ITEM' as model_nm,\n        replace('AX_OPCO_ITEM', concat(split_part('AX_OPCO_ITEM', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_ITEM', concat(split_part('AX_OPCO_ITEM', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_ITEM', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_ITEM', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_ITEM', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_ITEM\n        \n         union all \n    \n        select \n        'AX_OPCO_LOB' as model_nm,\n        replace('AX_OPCO_LOB', concat(split_part('AX_OPCO_LOB', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_LOB', concat(split_part('AX_OPCO_LOB', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_LOB', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_LOB', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_LOB', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_LOB', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_LOB', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_LOB', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_LOB', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_LOB', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_LOB\n        \n         union all \n    \n        select \n        'AX_OPCO_PURPOSE' as model_nm,\n        replace('AX_OPCO_PURPOSE', concat(split_part('AX_OPCO_PURPOSE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PURPOSE', concat(split_part('AX_OPCO_PURPOSE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PURPOSE\n        \n         union all \n    \n        select \n        'AX_OPCO_UOM' as model_nm,\n        replace('AX_OPCO_UOM', concat(split_part('AX_OPCO_UOM', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_UOM', concat(split_part('AX_OPCO_UOM', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_UOM', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_UOM', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_UOM', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_UOM', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_UOM', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_UOM', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_UOM', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_UOM', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_UOM\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR' as model_nm,\n        replace('AX_OPCO_VENDOR', concat(split_part('AX_OPCO_VENDOR', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR', concat(split_part('AX_OPCO_VENDOR', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_CATGRY' as model_nm,\n        replace('AX_OPCO_PROJECT_CATGRY', concat(split_part('AX_OPCO_PROJECT_CATGRY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_CATGRY', concat(split_part('AX_OPCO_PROJECT_CATGRY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_CATGRY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_CATGRY\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_COST_FRCST' as model_nm,\n        replace('AX_OPCO_PROJECT_COST_FRCST', concat(split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_COST_FRCST', concat(split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_COST_FRCST', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_COST_FRCST\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_COST_TRANS' as model_nm,\n        replace('AX_OPCO_PROJECT_COST_TRANS', concat(split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_COST_TRANS', concat(split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_COST_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_COST_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_EMPL_FRCST' as model_nm,\n        replace('AX_OPCO_PROJECT_EMPL_FRCST', concat(split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_EMPL_FRCST', concat(split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_EMPL_FRCST', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_EMPL_FRCST\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_EMPL_TRANS' as model_nm,\n        replace('AX_OPCO_PROJECT_EMPL_TRANS', concat(split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_EMPL_TRANS', concat(split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_EMPL_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_EMPL_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_INVOICE_PROJECT_XREF' as model_nm,\n        replace('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', concat(split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', concat(split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_INVOICE_PROJECT_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_INVOICE_PROJECT_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_ITEM_TRANS' as model_nm,\n        replace('AX_OPCO_PROJECT_ITEM_TRANS', concat(split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_ITEM_TRANS', concat(split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_ITEM_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_ITEM_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_REVENUE_TRANS' as model_nm,\n        replace('AX_OPCO_PROJECT_REVENUE_TRANS', concat(split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_REVENUE_TRANS', concat(split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_REVENUE_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_REVENUE_TRANS\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT_TRANS_POSTING' as model_nm,\n        replace('AX_OPCO_PROJECT_TRANS_POSTING', concat(split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT_TRANS_POSTING', concat(split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT_TRANS_POSTING', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT_TRANS_POSTING\n        \n         union all \n    \n        select \n        'AX_OPCO_PROJECT' as model_nm,\n        replace('AX_OPCO_PROJECT', concat(split_part('AX_OPCO_PROJECT', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PROJECT', concat(split_part('AX_OPCO_PROJECT', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PROJECT', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PROJECT\n        \n         union all \n    \n        select \n        'AX_OPCO_PO_LINE' as model_nm,\n        replace('AX_OPCO_PO_LINE', concat(split_part('AX_OPCO_PO_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PO_LINE', concat(split_part('AX_OPCO_PO_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PO_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PO_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_PO' as model_nm,\n        replace('AX_OPCO_PO', concat(split_part('AX_OPCO_PO', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_PO', concat(split_part('AX_OPCO_PO', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_PO', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_PO', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_PO', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_PO', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_PO', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_PO', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_PO', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_PO', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_PO\n        \n         union all \n    \n        select \n        'AX_OPCO_DLVRY_MODE' as model_nm,\n        replace('AX_OPCO_DLVRY_MODE', concat(split_part('AX_OPCO_DLVRY_MODE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_DLVRY_MODE', concat(split_part('AX_OPCO_DLVRY_MODE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_DLVRY_MODE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_DLVRY_MODE\n        \n         union all \n    \n        select \n        'AX_OPCO_DLVRY_TERMS' as model_nm,\n        replace('AX_OPCO_DLVRY_TERMS', concat(split_part('AX_OPCO_DLVRY_TERMS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_DLVRY_TERMS', concat(split_part('AX_OPCO_DLVRY_TERMS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_DLVRY_TERMS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_DLVRY_TERMS\n        \n         union all \n    \n        select \n        'AX_OPCO_SLS_ORDR_LINE' as model_nm,\n        replace('AX_OPCO_SLS_ORDR_LINE', concat(split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_SLS_ORDR_LINE', concat(split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_SLS_ORDR_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_SLS_ORDR_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_SLS_ORDR' as model_nm,\n        replace('AX_OPCO_SLS_ORDR', concat(split_part('AX_OPCO_SLS_ORDR', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_SLS_ORDR', concat(split_part('AX_OPCO_SLS_ORDR', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_SLS_ORDR', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_SLS_ORDR\n        \n         union all \n    \n        select \n        'AX_SLS_ORDR_OPCO_LOCN_XREF' as model_nm,\n        replace('AX_SLS_ORDR_OPCO_LOCN_XREF', concat(split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_SLS_ORDR_OPCO_LOCN_XREF', concat(split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'AX' then 3\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'NS' then 3\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 1\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_SLS_ORDR_OPCO_LOCN_XREF', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_SLS_ORDR_OPCO_LOCN_XREF\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_INVOICE_LINE' as model_nm,\n        replace('AX_OPCO_VENDOR_INVOICE_LINE', concat(split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_INVOICE_LINE', concat(split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_INVOICE_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_INVOICE_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_INVOICE' as model_nm,\n        replace('AX_OPCO_VENDOR_INVOICE', concat(split_part('AX_OPCO_VENDOR_INVOICE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_INVOICE', concat(split_part('AX_OPCO_VENDOR_INVOICE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_INVOICE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_INVOICE\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_PACKING_SLIP_LINE' as model_nm,\n        replace('AX_OPCO_VENDOR_PACKING_SLIP_LINE', concat(split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_PACKING_SLIP_LINE', concat(split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP_LINE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_PACKING_SLIP_LINE\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_PACKING_SLIP' as model_nm,\n        replace('AX_OPCO_VENDOR_PACKING_SLIP', concat(split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_PACKING_SLIP', concat(split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_PACKING_SLIP', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_PACKING_SLIP\n        \n         union all \n    \n        select \n        'AX_OPCO_VENDOR_TRANS' as model_nm,\n        replace('AX_OPCO_VENDOR_TRANS', concat(split_part('AX_OPCO_VENDOR_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('AX_OPCO_VENDOR_TRANS', concat(split_part('AX_OPCO_VENDOR_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'AX' then 3\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'NS' then 3\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('AX_OPCO_VENDOR_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.AX_OPCO_VENDOR_TRANS\n        \n         union all \n    \n        select \n        'NS_OPCO_CURRENCY' as model_nm,\n        replace('NS_OPCO_CURRENCY', concat(split_part('NS_OPCO_CURRENCY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_CURRENCY', concat(split_part('NS_OPCO_CURRENCY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_CURRENCY\n        \n         union all \n    \n        select \n        'NS_OPCO_PYMNT_MODE' as model_nm,\n        replace('NS_OPCO_PYMNT_MODE', concat(split_part('NS_OPCO_PYMNT_MODE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_PYMNT_MODE', concat(split_part('NS_OPCO_PYMNT_MODE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_PYMNT_MODE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_PYMNT_MODE\n        \n         union all \n    \n        select \n        'NS_OPCO_PYMNT_TERMS' as model_nm,\n        replace('NS_OPCO_PYMNT_TERMS', concat(split_part('NS_OPCO_PYMNT_TERMS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_PYMNT_TERMS', concat(split_part('NS_OPCO_PYMNT_TERMS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_PYMNT_TERMS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_PYMNT_TERMS\n        \n         union all \n    \n        select \n        'NS_OPCO_CHART_OF_ACCTS' as model_nm,\n        replace('NS_OPCO_CHART_OF_ACCTS', concat(split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_CHART_OF_ACCTS', concat(split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_CHART_OF_ACCTS\n        \n         union all \n    \n        select \n        'NS_OPCO_FSCL_YR_GL_OPENING_BAL' as model_nm,\n        replace('NS_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_FSCL_YR_GL_OPENING_BAL\n        \n         union all \n    \n        select \n        'NS_OPCO_GL_TRANS' as model_nm,\n        replace('NS_OPCO_GL_TRANS', concat(split_part('NS_OPCO_GL_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_GL_TRANS', concat(split_part('NS_OPCO_GL_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_GL_TRANS\n        \n         union all \n    \n        select \n        'NS_OPCO_COST_CENTER' as model_nm,\n        replace('NS_OPCO_COST_CENTER', concat(split_part('NS_OPCO_COST_CENTER', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_COST_CENTER', concat(split_part('NS_OPCO_COST_CENTER', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_COST_CENTER\n        \n         union all \n    \n        select \n        'NS_OPCO_DEPT' as model_nm,\n        replace('NS_OPCO_DEPT', concat(split_part('NS_OPCO_DEPT', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_DEPT', concat(split_part('NS_OPCO_DEPT', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_DEPT', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_DEPT', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_DEPT', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_DEPT\n        \n         union all \n    \n        select \n        'NS_OPCO_TYPE' as model_nm,\n        replace('NS_OPCO_TYPE', concat(split_part('NS_OPCO_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_TYPE', concat(split_part('NS_OPCO_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_TYPE', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_TYPE\n        \n         union all \n    \n        select \n        'NS_OPCO' as model_nm,\n        replace('NS_OPCO', concat(split_part('NS_OPCO', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO', concat(split_part('NS_OPCO', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO\n        \n         union all \n    \n        select \n        'NS_REGION' as model_nm,\n        replace('NS_REGION', concat(split_part('NS_REGION', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_REGION', concat(split_part('NS_REGION', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_REGION', '_', 1) = 'AX' then 3\n                when split_part('NS_REGION', '_', 1) = 'NS' then 3\n                when split_part('NS_REGION', '_', 1) = 'JDE' then 1\n                when split_part('NS_REGION', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_REGION', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_REGION', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_REGION', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_REGION', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_REGION\n        \n         union all \n    \n        select \n        'NS_SUB_REGION' as model_nm,\n        replace('NS_SUB_REGION', concat(split_part('NS_SUB_REGION', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_SUB_REGION', concat(split_part('NS_SUB_REGION', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_SUB_REGION', '_', 1) = 'AX' then 3\n                when split_part('NS_SUB_REGION', '_', 1) = 'NS' then 3\n                when split_part('NS_SUB_REGION', '_', 1) = 'JDE' then 1\n                when split_part('NS_SUB_REGION', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_SUB_REGION', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_SUB_REGION', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_SUB_REGION', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_SUB_REGION', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_SUB_REGION\n        \n         union all \n    \n        select \n        'NS_OPCO_BRAND' as model_nm,\n        replace('NS_OPCO_BRAND', concat(split_part('NS_OPCO_BRAND', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_BRAND', concat(split_part('NS_OPCO_BRAND', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_BRAND', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_BRAND', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_BRAND', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_BRAND\n        \n         union all \n    \n        select \n        'NS_OPCO_PURPOSE' as model_nm,\n        replace('NS_OPCO_PURPOSE', concat(split_part('NS_OPCO_PURPOSE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_PURPOSE', concat(split_part('NS_OPCO_PURPOSE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_PURPOSE\n        \n         union all \n    \n        select \n        'NS_OPCO_UOM' as model_nm,\n        replace('NS_OPCO_UOM', concat(split_part('NS_OPCO_UOM', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('NS_OPCO_UOM', concat(split_part('NS_OPCO_UOM', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('NS_OPCO_UOM', '_', 1) = 'AX' then 3\n                when split_part('NS_OPCO_UOM', '_', 1) = 'NS' then 3\n                when split_part('NS_OPCO_UOM', '_', 1) = 'JDE' then 1\n                when split_part('NS_OPCO_UOM', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('NS_OPCO_UOM', '_', 1) = 'AX' then 'Incremental'\n                when split_part('NS_OPCO_UOM', '_', 1) = 'NS' then 'Incremental'\n                when split_part('NS_OPCO_UOM', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('NS_OPCO_UOM', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.NS_OPCO_UOM\n        \n         union all \n    \n        select \n        'JDE_OPCO_CURRENCY' as model_nm,\n        replace('JDE_OPCO_CURRENCY', concat(split_part('JDE_OPCO_CURRENCY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_CURRENCY', concat(split_part('JDE_OPCO_CURRENCY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_CURRENCY\n        \n         union all \n    \n        select \n        'JDE_OPCO_FSCL_YR_GL_OPENING_BAL' as model_nm,\n        replace('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_FSCL_YR_GL_OPENING_BAL\n        \n         union all \n    \n        select \n        'JDE_OPCO_CHART_OF_ACCTS' as model_nm,\n        replace('JDE_OPCO_CHART_OF_ACCTS', concat(split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_CHART_OF_ACCTS', concat(split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_CHART_OF_ACCTS\n        \n         union all \n    \n        select \n        'JDE_OPCO_GL_TRANS_TYPE' as model_nm,\n        replace('JDE_OPCO_GL_TRANS_TYPE', concat(split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_GL_TRANS_TYPE', concat(split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_GL_TRANS_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_GL_TRANS_TYPE\n        \n         union all \n    \n        select \n        'JDE_OPCO_GL_TRANS' as model_nm,\n        replace('JDE_OPCO_GL_TRANS', concat(split_part('JDE_OPCO_GL_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_GL_TRANS', concat(split_part('JDE_OPCO_GL_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_GL_TRANS\n        \n         union all \n    \n        select \n        'JDE_OPCO_COST_CENTER' as model_nm,\n        replace('JDE_OPCO_COST_CENTER', concat(split_part('JDE_OPCO_COST_CENTER', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_COST_CENTER', concat(split_part('JDE_OPCO_COST_CENTER', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_COST_CENTER\n        \n         union all \n    \n        select \n        'JDE_OPCO' as model_nm,\n        replace('JDE_OPCO', concat(split_part('JDE_OPCO', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO', concat(split_part('JDE_OPCO', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO\n        \n         union all \n    \n        select \n        'JDE_OPCO_UOM' as model_nm,\n        replace('JDE_OPCO_UOM', concat(split_part('JDE_OPCO_UOM', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('JDE_OPCO_UOM', concat(split_part('JDE_OPCO_UOM', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('JDE_OPCO_UOM', '_', 1) = 'AX' then 3\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'NS' then 3\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'JDE' then 1\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('JDE_OPCO_UOM', '_', 1) = 'AX' then 'Incremental'\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'NS' then 'Incremental'\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('JDE_OPCO_UOM', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.JDE_OPCO_UOM\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_CURRENCY' as model_nm,\n        replace('PRIMEX_OPCO_CURRENCY', concat(split_part('PRIMEX_OPCO_CURRENCY', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_CURRENCY', concat(split_part('PRIMEX_OPCO_CURRENCY', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_CURRENCY', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_CURRENCY\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_CHART_OF_ACCTS_TYPE' as model_nm,\n        replace('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', concat(split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', concat(split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_CHART_OF_ACCTS_TYPE\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_CHART_OF_ACCTS' as model_nm,\n        replace('PRIMEX_OPCO_CHART_OF_ACCTS', concat(split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_CHART_OF_ACCTS', concat(split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_CHART_OF_ACCTS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_CHART_OF_ACCTS\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL' as model_nm,\n        replace('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', concat(split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_FSCL_YR_GL_OPENING_BAL\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_GL_TRANS_TYPE' as model_nm,\n        replace('PRIMEX_OPCO_GL_TRANS_TYPE', concat(split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_GL_TRANS_TYPE', concat(split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_GL_TRANS_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_GL_TRANS_TYPE\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_GL_TRANS' as model_nm,\n        replace('PRIMEX_OPCO_GL_TRANS', concat(split_part('PRIMEX_OPCO_GL_TRANS', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_GL_TRANS', concat(split_part('PRIMEX_OPCO_GL_TRANS', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_GL_TRANS', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_GL_TRANS\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_SUB_LEDGER_TYPE' as model_nm,\n        replace('PRIMEX_OPCO_SUB_LEDGER_TYPE', concat(split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_SUB_LEDGER_TYPE', concat(split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_SUB_LEDGER_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_SUB_LEDGER_TYPE\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_COST_CENTER' as model_nm,\n        replace('PRIMEX_OPCO_COST_CENTER', concat(split_part('PRIMEX_OPCO_COST_CENTER', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_COST_CENTER', concat(split_part('PRIMEX_OPCO_COST_CENTER', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_COST_CENTER', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_COST_CENTER\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_DEPT' as model_nm,\n        replace('PRIMEX_OPCO_DEPT', concat(split_part('PRIMEX_OPCO_DEPT', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_DEPT', concat(split_part('PRIMEX_OPCO_DEPT', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_DEPT', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_DEPT\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_TYPE' as model_nm,\n        replace('PRIMEX_OPCO_TYPE', concat(split_part('PRIMEX_OPCO_TYPE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_TYPE', concat(split_part('PRIMEX_OPCO_TYPE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_TYPE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_TYPE\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_LOB' as model_nm,\n        replace('PRIMEX_OPCO_LOB', concat(split_part('PRIMEX_OPCO_LOB', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_LOB', concat(split_part('PRIMEX_OPCO_LOB', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_LOB', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_LOB\n        \n         union all \n    \n        select \n        'PRIMEX_OPCO_PURPOSE' as model_nm,\n        replace('PRIMEX_OPCO_PURPOSE', concat(split_part('PRIMEX_OPCO_PURPOSE', '_', 1), '_')) as target_model_nm,\n        case \n            when replace('PRIMEX_OPCO_PURPOSE', concat(split_part('PRIMEX_OPCO_PURPOSE', '_', 1), '_')) = 'OPCO_GL_TRANS' then 'TRANS_DT'\n            else null \n        end as incrmnt_load_on,\n        \n            max(stg_load_dtm) as max_stg_load_dtm,\n            case \n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'AX' then 3\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'NS' then 3\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'JDE' then 1\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 1\n            end as load_type,\n            case \n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'AX' then 'Incremental'\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'NS' then 'Incremental'\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'JDE' then 'Full Load'\n                when split_part('PRIMEX_OPCO_PURPOSE', '_', 1) = 'PRIMEX' then 'Full Load'\n            end as load_desc\n            from OI_DATA_DEV_V2.INTERMEDIATE_FND_BKP.PRIMEX_OPCO_PURPOSE\n        \n        \n    \n)\n\nselect * from _foundation_load_config", "extra_ctes_injected": true, "extra_ctes": [], "relation_name": "OI_DATA_DEV_V2.intermediate_fnd_bkp._foundation_load_config"}, "model.OI_Foundation.opco_gl_trans": {"raw_sql": "{{\r\n    config(\r\n        materialized='incremental',\r\n        transient=false,\r\n        unique_key='opco_gl_trans_sk'\r\n    )\r\n}}\r\n\r\n{% set incrmnt_col=increment_col('OPCO_GL_TRANS') %}\r\n\r\nwith opco_gl_trans as(\r\n    select *,\r\n    rank() over(partition by opco_gl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_gl_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_gl_trans_SK, opco_gl_trans_CK, opco_gl_trans_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, src_key_txt, trans_dt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, opco_proj_sk, original_gl_opco_sk, original_gl_voucher_nbr, voucher_nbr, journal_batch_nbr, gl_desc, document_nbr, document_dt, crrctn_trans_ind, credit_ind, gl_qty, trans_currency_gl_amt, opco_currency_gl_amt, fscl_yr_nbr, fscl_mnth_nbr, posted_ind, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd, sub_document_nbr  \r\n    from opco_gl_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final\r\n\r\n{% if is_incremental() %}\r\n    where {{ incrmnt_col}} >= (select min({{ incrmnt_col}}) from {{ var('fnd_tbl_db')}}.{{ var('intermediate_tbl_sch')}}.V_OPCO_GL_TRANS_LINEAGE where stg_load_dtm >= \r\n                                (select min(max_stg_load_dtm) from {{ var('fnd_tbl_db')}}.{{ var('intermediate_tbl_sch')}}._FOUNDATION_LOAD_CONFIG where target_model_nm = 'OPCO_GL_TRANS'))\r\n{% endif %}", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.increment_col", "macro.dbt.is_incremental"], "nodes": ["model.OI_Foundation.v_opco_gl_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "incremental", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "unique_key": "opco_gl_trans_sk", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_gl_trans"], "unique_id": "model.OI_Foundation.opco_gl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_gl_trans.sql", "original_file_path": "models/foundation/general_ledger/opco_gl_trans.sql", "name": "opco_gl_trans", "alias": "opco_gl_trans", "checksum": {"name": "sha256", "checksum": "a8841853aa396d9bafd7ae1280c45e0dd8aa82c287f299246ba7eea694d8f93b"}, "tags": [], "refs": [["v_opco_gl_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "incremental", "transient": false, "unique_key": "opco_gl_trans_sk"}, "created_at": 1659086795.2911046}, "model.OI_Foundation.opco_gl_trans_posting_type": {"raw_sql": "with opco_gl_trans_posting_type as(\r\n    select *\r\n    from {{ ref('v_opco_gl_trans_posting_type_lineage') }}\r\n)\r\n\r\nselect * from opco_gl_trans_posting_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_gl_trans_posting_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_gl_trans_posting_type"], "unique_id": "model.OI_Foundation.opco_gl_trans_posting_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_gl_trans_posting_type.sql", "original_file_path": "models/foundation/general_ledger/opco_gl_trans_posting_type.sql", "name": "opco_gl_trans_posting_type", "alias": "opco_gl_trans_posting_type", "checksum": {"name": "sha256", "checksum": "d701a418102c992c35b2b1af629484e5b1939344be3ba39860373b5c53055f8f"}, "tags": [], "refs": [["v_opco_gl_trans_posting_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3005366}, "model.OI_Foundation.opco_chart_of_accts_type": {"raw_sql": "with opco_chart_of_accts_type as(\r\n    select *\r\n    from {{ ref('v_opco_chart_of_accts_type_lineage') }}\r\n)\r\n\r\nselect * from opco_chart_of_accts_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_chart_of_accts_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_chart_of_accts_type"], "unique_id": "model.OI_Foundation.opco_chart_of_accts_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_chart_of_accts_type.sql", "original_file_path": "models/foundation/general_ledger/opco_chart_of_accts_type.sql", "name": "opco_chart_of_accts_type", "alias": "opco_chart_of_accts_type", "checksum": {"name": "sha256", "checksum": "d7af7d5255f72eba01f51df101e9f80e003a89644eb9a2e4e669dc529f324e97"}, "tags": [], "refs": [["v_opco_chart_of_accts_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.302667}, "model.OI_Foundation.chart_of_accts": {"raw_sql": "with chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_chart_of_accts_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    chart_of_accts_sk, chart_of_accts_ck, crt_dtm, stg_load_dtm, delete_dtm, gl_acct_nbr, gl_acct_nm, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, blocked_in_journal_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind\r\n    from chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_chart_of_accts_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "chart_of_accts"], "unique_id": "model.OI_Foundation.chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/chart_of_accts.sql", "original_file_path": "models/foundation/general_ledger/chart_of_accts.sql", "name": "chart_of_accts", "alias": "chart_of_accts", "checksum": {"name": "sha256", "checksum": "ff9cdc9b752d76b0dcce21c60641b275a3c85bfda0d787eb38d69481662ace30"}, "tags": [], "refs": [["v_chart_of_accts_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.304485}, "model.OI_Foundation.opco_chart_of_accts": {"raw_sql": "with opco_chart_of_accts as(\r\n    select *,\r\n    rank() over(partition by opco_chart_of_accts_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_chart_of_accts_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_chart_of_accts_sk, opco_chart_of_accts_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, gl_acct_nbr, opco_id, gl_acct_nm, chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_chart_of_accts_type_sk, opco_uom_sk, gl_acct_alias_nm, manual_entry_allowed_ind, dpo_exclusion_ind, movement_allowed_ind, cost_center_reqd_txt, dept_reqd_txt, type_reqd_txt, prnt_gl_acct_nbr, related_gl_acct_nbr, monetary_gl_acct_ind, actv_ind, balance_sheet_acct_ind, summary_acct_ind, opco_brand_sk, acct_clssfctn_cd, sub_acct_nbr\r\n    from opco_chart_of_accts\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_chart_of_accts_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_chart_of_accts"], "unique_id": "model.OI_Foundation.opco_chart_of_accts", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_chart_of_accts.sql", "original_file_path": "models/foundation/general_ledger/opco_chart_of_accts.sql", "name": "opco_chart_of_accts", "alias": "opco_chart_of_accts", "checksum": {"name": "sha256", "checksum": "4d0989e2a34579f3d909a8fd2635b127cf4f98c414353cdb8fb16552ec3801f2"}, "tags": [], "refs": [["v_opco_chart_of_accts_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3062727}, "model.OI_Foundation.opco_gl_trans_type": {"raw_sql": "with opco_gl_trans_type as(\r\n    select *\r\n    from {{ ref('v_opco_gl_trans_type_lineage') }}\r\n)\r\n\r\nselect * from opco_gl_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_gl_trans_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_gl_trans_type"], "unique_id": "model.OI_Foundation.opco_gl_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_gl_trans_type.sql", "original_file_path": "models/foundation/general_ledger/opco_gl_trans_type.sql", "name": "opco_gl_trans_type", "alias": "opco_gl_trans_type", "checksum": {"name": "sha256", "checksum": "99535297971b0f2776d07990086baa6634b5037cfec93666e47bb003511de8a7"}, "tags": [], "refs": [["v_opco_gl_trans_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.308154}, "model.OI_Foundation.opco_sub_ledger_type": {"raw_sql": "with opco_sub_ledger_type as(\r\n    select *\r\n    from {{ ref('v_opco_sub_ledger_type_lineage') }}\r\n)\r\n\r\nselect * from opco_sub_ledger_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_sub_ledger_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_sub_ledger_type"], "unique_id": "model.OI_Foundation.opco_sub_ledger_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_sub_ledger_type.sql", "original_file_path": "models/foundation/general_ledger/opco_sub_ledger_type.sql", "name": "opco_sub_ledger_type", "alias": "opco_sub_ledger_type", "checksum": {"name": "sha256", "checksum": "92795f3c07d0ff0add3ff2974385dfc4684adff3af9fb314ed1c2b424dafd0c1"}, "tags": [], "refs": [["v_opco_sub_ledger_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3099406}, "model.OI_Foundation.opco_fscl_yr_gl_opening_bal": {"raw_sql": "with opco_fscl_yr_gl_opening_bal as(\r\n    select *,\r\n    rank() over(partition by opco_fscl_yr_gl_opening_bal_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_fscl_yr_gl_opening_bal_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_fscl_yr_gl_opening_bal_sk, opco_fscl_yr_gl_opening_bal_ck, opco_fscl_yr_gl_opening_bal_ak, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_key_txt, opco_sk, opco_chart_of_accts_sk, opco_gl_trans_type_sk, opco_gl_trans_posting_type_sk, opco_cost_center_sk, opco_dept_sk,\r\n    opco_type_sk, opco_purpose_sk, opco_lob_sk, trans_currency_sk, fscl_yr_strt_dt, fscl_yr_nbr, credit_ind, opening_bal_qty, trans_currency_opening_bal_amt,\r\n    opco_currency_opening_bal_amt, opco_uom_sk, opco_brand_sk, opco_sub_ledger_type_sk, sub_ledger_cd\r\n    from opco_fscl_yr_gl_opening_bal\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "general_ledger", "opco_fscl_yr_gl_opening_bal"], "unique_id": "model.OI_Foundation.opco_fscl_yr_gl_opening_bal", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/general_ledger/opco_fscl_yr_gl_opening_bal.sql", "original_file_path": "models/foundation/general_ledger/opco_fscl_yr_gl_opening_bal.sql", "name": "opco_fscl_yr_gl_opening_bal", "alias": "opco_fscl_yr_gl_opening_bal", "checksum": {"name": "sha256", "checksum": "0e70f67a0e1efdfe231732da4c68c5d20005c3e9449b74e45a0e5f350e7613ce"}, "tags": [], "refs": [["v_opco_fscl_yr_gl_opening_bal_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3119173}, "model.OI_Foundation.opco_cust_invoice_line": {"raw_sql": "with opco_cust_invoice_line as(\r\n    select *,\r\n    rank() over(partition by opco_cust_invoice_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_invoice_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_invoice_line_sk, opco_cust_invoice_line_ck, opco_cust_invoice_line_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_sls_ordr_sk, orig_sls_ordr_sk, opco_item_sk, opco_chart_of_accts_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, trans_currency_sk, sls_uom_sk, gl_prod_uom_sk,  gl_sls_uom_sk, opco_assctn_sk, opco_invtry_ref_type_sk, invoice_nbr, line_nbr, invtry_trans_id,  cust_item_id, tax_grp_id,\r\n    tax_item_grp_id, invtry_ref_id, item_bom_id, item_desc, sls_grp_txt, shpmt_country_nm, dlvry_country_nm, dlvry_state_nm,  dlvry_county_nm, mark_txt, grp_nm, ship_dt, partial_dlvry_ind,\r\n    risk_type_ind, kits_ind, commsn_calc_ind, dlvry_type_txt, invoice_line_txt, spcl_item_ind, spcl_in_spcl_ind, spcl_item_nbr, labor_hours_nbr, engineering_hours_nbr, item_weight_amt,\r\n    per_unit_qty, invoice_item_qty, ordr_qty, dlvrd_qty, prev_invoiced_qty, remaining_qty, invtry_units_qty, gl_prod_qty, gl_sls_qty, sis_qty, dscnt_pct, line_dscnt_pct, \r\n    overhead_cost_pct, margin_contribution_pct, trans_currency_sls_amt, opco_currency_sls_amt, trans_currency_incl_sls_tax_amt, opco_currency_incl_sls_tax_amt, trans_currency_sum_line_dscnt_amt,\r\n    opco_currency_sum_line_dscnt_amt, trans_currency_tax_amt, opco_currency_tax_amt, trans_currency_commsn_amt, opco_currency_commsn_amt, sls_markup_amt, per_unit_sls_price_amt, \r\n    online_price_amt, list_price_amt, imbedded_freight_cost_amt, imbedded_freight_amt, total_cost_amt, item_cost_amt, default_item_price_amt, item_price_amt\r\n\r\n    from opco_cust_invoice_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_invoice_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_invoice_line"], "unique_id": "model.OI_Foundation.opco_cust_invoice_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_invoice_line.sql", "original_file_path": "models/foundation/customer/opco_cust_invoice_line.sql", "name": "opco_cust_invoice_line", "alias": "opco_cust_invoice_line", "checksum": {"name": "sha256", "checksum": "038e383a74b8d1b19fda417eae5df5d3fe637f40c024cce031d40f61fe499184"}, "tags": [], "refs": [["v_opco_cust_invoice_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3138218}, "model.OI_Foundation.opco_cust_packing_slip": {"raw_sql": "with opco_cust_packing_slip as(\r\n    select *,\r\n    rank() over(partition by opco_cust_packing_slip_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_packing_slip_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_packing_slip_sk, opco_cust_packing_slip_ck, opco_cust_packing_slip_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,src_sys_nm,\r\n    opco_id, packing_slip_id, opco_sls_ordr_sk, opco_sls_ordr_type_sk, opco_cust_sk, invoice_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, \r\n    opco_lob_sk, opco_picking_list_sk, opco_site_sk, trans_currency_sk, opco_pymnt_terms_sk, warehouse_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk, gl_voucher_nbr, \r\n    po_form_nbr, ship_dt, cust_ref_txt, tax_grp_id, print_invoice_ind, credit_reason_id, spcl_instr_txt, registered_Ind, dlvry_cust_nm, invoice_cust_nm, invoice_address_txt, \r\n    load_nbr, pl_load_cnt, miles_cnt, dlvry_qty, pallet_qty, pallet_rate_amt, dlvry_volume_amt, dlvry_weight_amt, dlvry_cost_amt, packing_slip_amt, invoice_nbr, invoice_dt,\r\n    invoice_sent_ind, invoice_amt\r\n    from opco_cust_packing_slip\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_packing_slip_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_packing_slip"], "unique_id": "model.OI_Foundation.opco_cust_packing_slip", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_packing_slip.sql", "original_file_path": "models/foundation/customer/opco_cust_packing_slip.sql", "name": "opco_cust_packing_slip", "alias": "opco_cust_packing_slip", "checksum": {"name": "sha256", "checksum": "cfa2bd1c33dc1169257b250f6439a4851b59d61f9cd74da73c639f1225b42b47"}, "tags": [], "refs": [["v_opco_cust_packing_slip_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3156123}, "model.OI_Foundation.opco_pymnt_terms": {"raw_sql": "with opco_pymnt_terms as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_pymnt_terms_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_pymnt_terms_sk, opco_pymnt_terms_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_pymnt_terms_cd, src_pymnt_terms_desc\r\n    from opco_pymnt_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_pymnt_terms_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_pymnt_terms"], "unique_id": "model.OI_Foundation.opco_pymnt_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_pymnt_terms.sql", "original_file_path": "models/foundation/customer/opco_pymnt_terms.sql", "name": "opco_pymnt_terms", "alias": "opco_pymnt_terms", "checksum": {"name": "sha256", "checksum": "e415479ecf7e66deb3214eca6a63f8c286c9d4e16e05cc71485faf46fa9d2b77"}, "tags": [], "refs": [["v_opco_pymnt_terms_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3174334}, "model.OI_Foundation.opco_cust_settled_trans": {"raw_sql": "with opco_cust_settled_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_settled_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_settled_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_settled_trans_sk, opco_cust_settled_trans_ck, opco_cust_settled_trans_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_trans_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk,\r\n    cash_dscnt_gl_acct_sk, trans_dt, due_dt, src_crt_dtm, offset_cust_sk, offset_cust_trans_sk, offset_voucher_nbr, cust_cash_dscnt_dt, latest_interest_calc_dt, \r\n    reversible_ind, settlement_grp_txt, settled_voucher_nbr, trans_currency_settled_amt, opco_currency_settled_amt, exch_adjstmnt_amt, utilized_cash_dscnt_amt\r\n\r\n    from opco_cust_settled_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_settled_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_settled_trans"], "unique_id": "model.OI_Foundation.opco_cust_settled_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_settled_trans.sql", "original_file_path": "models/foundation/customer/opco_cust_settled_trans.sql", "name": "opco_cust_settled_trans", "alias": "opco_cust_settled_trans", "checksum": {"name": "sha256", "checksum": "a2e5662355ab53011d1b2f98e3e9facac17964d65ce08b68b3967ff86c69a037"}, "tags": [], "refs": [["v_opco_cust_settled_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3193119}, "model.OI_Foundation.opco_cust_trans": {"raw_sql": "with opco_cust_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_trans_sk, opco_cust_trans_ck, opco_cust_trans_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_sls_ordr_sk, opco_gl_trans_type_sk,\r\n    trans_currency_sk, opco_pymnt_mode_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_mode_sk, opco_project_sk, trans_dt, trans_apprvd_ind,\r\n    voucher_nbr, invoice_nbr, offset_src_key_txt, due_dt, crrctn_trans_ind, auto_settle_ind, pymnt_cancelled_ind, interest_calc_allowed_ind, collection_letter_allowed_ind,\r\n    cod_cash_pymnt_ind, pymnt_ref_txt, pymnt_method_txt, retention_cd, check_retention_ind, document_nbr, document_dt, trans_dscnt_dt, ltst_interest_dt,\r\n    collection_letter_txt, po_form_nbr, ltst_settled_opco_sk, ltst_settled_cust_sk, ltst_settled_dt, ltst_settled_voucher_nbr, trans_closed_dt, trans_currency_trans_amt,\r\n    opco_currency_trans_amt, trans_currency_total_settled_amt, opco_currency_total_settled_amt, trans_dscnt_amt, sum_tax_amt, trans_exch_rt\r\n   \r\n    from opco_cust_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_trans"], "unique_id": "model.OI_Foundation.opco_cust_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_trans.sql", "original_file_path": "models/foundation/customer/opco_cust_trans.sql", "name": "opco_cust_trans", "alias": "opco_cust_trans", "checksum": {"name": "sha256", "checksum": "db1e9bc932dc2ff8349cbccd5b86715bcb9826f2afda7cbc3ad1d622b9a32b21"}, "tags": [], "refs": [["v_opco_cust_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3213272}, "model.OI_Foundation.opco_cash_dscnt_terms": {"raw_sql": "with opco_cash_dscnt_terms as(\r\n    select *,\r\n    rank() over(partition by opco_cash_dscnt_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cash_dscnt_terms_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_CASH_DSCNT_TERMS_sk, opco_CASH_DSCNT_TERMS_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_cash_dscnt_terms_cd, src_cash_dscnt_terms_desc,pymnt_period_in_days_nbr,dscnt_pct\r\n    from opco_cash_dscnt_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cash_dscnt_terms_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cash_dscnt_terms"], "unique_id": "model.OI_Foundation.opco_cash_dscnt_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cash_dscnt_terms.sql", "original_file_path": "models/foundation/customer/opco_cash_dscnt_terms.sql", "name": "opco_cash_dscnt_terms", "alias": "opco_cash_dscnt_terms", "checksum": {"name": "sha256", "checksum": "3e0257779c9f71b65b9deceafd474d64f94b2b6549df17380172644e54f12390"}, "tags": [], "refs": [["v_opco_cash_dscnt_terms_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3231184}, "model.OI_Foundation.opco_pymnt_mode": {"raw_sql": "with opco_pymnt_mode as(\r\n    select *,\r\n    rank() over(partition by opco_pymnt_mode_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_pymnt_mode_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_pymnt_mode_sk, opco_pymnt_mode_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_pymnt_mode_cd, src_pymnt_mode_desc\r\n    from opco_pymnt_mode\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_pymnt_mode_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_pymnt_mode"], "unique_id": "model.OI_Foundation.opco_pymnt_mode", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_pymnt_mode.sql", "original_file_path": "models/foundation/customer/opco_pymnt_mode.sql", "name": "opco_pymnt_mode", "alias": "opco_pymnt_mode", "checksum": {"name": "sha256", "checksum": "cd0dd91327b373b458822f9d2ece60a06993eef55c82daeef3b24912c9cb0fe3"}, "tags": [], "refs": [["v_opco_pymnt_mode_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.325022}, "model.OI_Foundation.opco_handling_status": {"raw_sql": "with opco_handling_status as(\r\n    select *\r\n    from {{ ref('v_opco_handling_status_lineage') }}\r\n)\r\n\r\nselect * from opco_handling_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_handling_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_handling_status"], "unique_id": "model.OI_Foundation.opco_handling_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_handling_status.sql", "original_file_path": "models/foundation/customer/opco_handling_status.sql", "name": "opco_handling_status", "alias": "opco_handling_status", "checksum": {"name": "sha256", "checksum": "181bd83eaa21f0db0b34be7fc7e72fef6459b923db7f04364f606f3f50a1be23"}, "tags": [], "refs": [["v_opco_handling_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3268116}, "model.OI_Foundation.opco_picking_list": {"raw_sql": "with opco_picking_list as(\r\n    select *,\r\n    rank() over(partition by opco_picking_list_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_picking_list_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_picking_list_sk, opco_picking_list_ck, opco_picking_list_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, picking_list_id, shpmnt_id, opco_cust_sk, invoice_cust_sk, opco_invtry_trans_type_sk, opco_handling_status_sk, opco_dlvry_terms_sk,\r\n    opco_dlvry_mode_sk, opco_site_sk, opco_pymnt_terms_sk, src_crt_dt, trans_ref_id, handling_type_txt, start_dtm, end_dtm, activation_dtm, rqstd_ship_dt,\r\n    actl_ship_dt, cust_dlvry_dt, shpmnt_type_txt, dlvry_nm, credit_reason_id, po_form_nbr, tax_grp_id, picking_list_updt_ind, cust_ref_txt, print_invoice_ind,\r\n    item_reserved_ind, packing_slip_available_ind, dlvry_window_txt, spcl_instr_txt, srvc_duration_mins_nbr, requrmnt_txt, picking_list_printed_ind, \r\n    picking_list_printed_after_chg_ind, do_not_send_ind\r\n    from opco_picking_list\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_picking_list_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_picking_list"], "unique_id": "model.OI_Foundation.opco_picking_list", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_picking_list.sql", "original_file_path": "models/foundation/customer/opco_picking_list.sql", "name": "opco_picking_list", "alias": "opco_picking_list", "checksum": {"name": "sha256", "checksum": "a0cf80118c0f29566b3b80bf1367272c138a0f557b5d4eda74da1f3f1876b61d"}, "tags": [], "refs": [["v_opco_picking_list_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3286889}, "model.OI_Foundation.opco_cust_type": {"raw_sql": "with opco_cust_type as(\r\n    select *,\r\n    rank() over(partition by opco_cust_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_type_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_type_sk, opco_cust_type_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_cust_type_cd, src_cust_type_desc\r\n\r\n    from opco_cust_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_type"], "unique_id": "model.OI_Foundation.opco_cust_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_type.sql", "original_file_path": "models/foundation/customer/opco_cust_type.sql", "name": "opco_cust_type", "alias": "opco_cust_type", "checksum": {"name": "sha256", "checksum": "b7ac5c034f50f949a5d6d9b2c133dac50b67329f96de2a658300c8e8e610d30f"}, "tags": [], "refs": [["v_opco_cust_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3304873}, "model.OI_Foundation.opco_opco_cust_xref": {"raw_sql": "with opco_opco_cust_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sk, opco_cust_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_opco_cust_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sk, opco_cust_sk, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    actv_ind, opco_currency_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk, opco_cust_code_sk, opco_cust_type_sk, opco_commsn_grp_sk,\r\n    opco_cust_grp_sk, opco_cash_dscnt_terms_sk, line_disc_txt, max_cr_amt, mandatory_cr_lmt_ind, block_lvl_cd, cust_clssfctn_cd,\r\n    pymnt_schd_desc, sls_grp_nm, rgnl_sls_mgr_nm, invoice_acct_nbr, segment_cd, segmentation_txt\r\n    from opco_opco_cust_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_opco_cust_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_opco_cust_xref"], "unique_id": "model.OI_Foundation.opco_opco_cust_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_opco_cust_xref.sql", "original_file_path": "models/foundation/customer/opco_opco_cust_xref.sql", "name": "opco_opco_cust_xref", "alias": "opco_opco_cust_xref", "checksum": {"name": "sha256", "checksum": "6923826acbf1a55349a2cfc10c354085399002703da689340260c531a33990fa"}, "tags": [], "refs": [["v_opco_opco_cust_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.332498}, "model.OI_Foundation.opco_currency": {"raw_sql": "with opco_currency as(\r\n    select *,\r\n    rank() over(partition by opco_currency_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_currency_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_CURRENCY_SK, OPCO_CURRENCY_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_CURRENCY_CD, SRC_CURRENCY_NM\r\n    from opco_currency\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_currency_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_currency"], "unique_id": "model.OI_Foundation.opco_currency", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_currency.sql", "original_file_path": "models/foundation/customer/opco_currency.sql", "name": "opco_currency", "alias": "opco_currency", "checksum": {"name": "sha256", "checksum": "ffff705aa05d42b7e27ed4f0383d567d87c81a656b2912a2a28e30125d3c2348"}, "tags": [], "refs": [["v_opco_currency_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.33439}, "model.OI_Foundation.opco_cust_invoice": {"raw_sql": "with opco_cust_invoice as(\r\n    select *,\r\n    rank() over(partition by opco_cust_invoice_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_invoice_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_invoice_sk, opco_cust_invoice_ck, opco_cust_invoice_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, src_key_txt, opco_sk, opco_cust_sk, opco_sls_ordr_sk, opco_picking_list_sk, opco_cust_packing_slip_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, opco_sls_ordr_type_sk, invoice_cust_sk, trans_currency_sk, opco_cust_grp_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk\r\n    invoice_locn_sk, invoice_nbr, trans_ref_txt, invoice_dt, due_dt, cash_dscnt_dt, gl_voucher_nbr, document_nbr, document_dt, dlvry_cust_nm, invoice_cust_nm, sls_grp_txt, sls_tax_included_ind,\r\n    updt_after_printing_ind, specific_action_txt, dispatch_locn_txt, pymnt_sched_cd, lead_cd, po_form_nbr,commsn_grp_id, credit_reason_id, end_cust_id, tax_grp_id, invoice_qty, invoice_volume_amt,\r\n    invoice_weight_amt, trans_currency_balance_sls_amt, opco_currency_balance_sls_amt, trans_currency_invoice_amt, opco_currency_invoice_amt, trans_currency_line_dscnt_amt, opco_currency_line_dscnt_amt,\r\n    trans_currency_cash_dscnt_amt, trans_currency_sls_tax_amt, opco_currency_sls_tax_amt, trans_currency_misc_chrgs_amt, opco_currenty_misc_chrgs_amt, dlvry_cost_amt\r\n\r\n    from opco_cust_invoice\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_invoice_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_invoice"], "unique_id": "model.OI_Foundation.opco_cust_invoice", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_invoice.sql", "original_file_path": "models/foundation/customer/opco_cust_invoice.sql", "name": "opco_cust_invoice", "alias": "opco_cust_invoice", "checksum": {"name": "sha256", "checksum": "0fd4c9aa7e4a9710da5189aa5aac616c05a1390a104fcba61b600affef167158"}, "tags": [], "refs": [["v_opco_cust_invoice_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.336191}, "model.OI_Foundation.opco_cust_grp": {"raw_sql": "with opco_cust_grp as(\r\n    select *,\r\n    rank() over(partition by opco_cust_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_grp_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_grp_sk, opco_cust_grp_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_cust_grp_cd, src_cust_grp_desc  \r\n    from opco_cust_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_grp_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_grp"], "unique_id": "model.OI_Foundation.opco_cust_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_grp.sql", "original_file_path": "models/foundation/customer/opco_cust_grp.sql", "name": "opco_cust_grp", "alias": "opco_cust_grp", "checksum": {"name": "sha256", "checksum": "a94d2375a2a1a9face5d90428035be017c27d35f34674fb3935d4cd5acb69f15"}, "tags": [], "refs": [["v_opco_cust_grp_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3379927}, "model.OI_Foundation.opco_cust_open_trans": {"raw_sql": "with opco_cust_open_trans as(\r\n    select *,\r\n    rank() over(partition by opco_cust_open_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_open_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_open_trans_sk, opco_cust_open_trans_CK, opco_cust_open_trans_ak, CRT_DTM,  STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_cust_trans_sk, opco_sk, opco_cust_sk, cash_dscnt_gl_acct_sk, trans_dt, due_dt, ltst_interest_calc_dt, cash_dscnt_dt, \r\n    cash_dscnt_usage_txt, trans_currency_trans_amt, opco_currency_trans_amt, included_cash_dscnt_amt \r\n    from opco_cust_open_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_open_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_open_trans"], "unique_id": "model.OI_Foundation.opco_cust_open_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_open_trans.sql", "original_file_path": "models/foundation/customer/opco_cust_open_trans.sql", "name": "opco_cust_open_trans", "alias": "opco_cust_open_trans", "checksum": {"name": "sha256", "checksum": "d4760bafdf95982adf04cf0dc7e5f929f8000e5806ecfcb87dce752b72a636e0"}, "tags": [], "refs": [["v_opco_cust_open_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3398602}, "model.OI_Foundation.opco_cust": {"raw_sql": "with opco_cust as(\r\n    select *,\r\n    rank() over(partition by opco_cust_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_sk, opco_cust_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, cust_id, opco_id, dba_nm, govt_issued_id, duns_nbr, lob_nm, vat_number, language_txt, country_cd, website_url_txt,\r\n    tax_exempt_nbr, tax_grp_txt, cust_item_grp_cd, end_market_nm, collector_cd, party_id, flag_id\r\n\r\n    from opco_cust\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust"], "unique_id": "model.OI_Foundation.opco_cust", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust.sql", "original_file_path": "models/foundation/customer/opco_cust.sql", "name": "opco_cust", "alias": "opco_cust", "checksum": {"name": "sha256", "checksum": "3dbda89be6018c4f98abf99a418ecf77e701112e40f31005c5e489b7c7a24167"}, "tags": [], "refs": [["v_opco_cust_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3418927}, "model.OI_Foundation.opco_commsn_grp": {"raw_sql": "with opco_commsn_grp as(\r\n    select *,\r\n    rank() over(partition by opco_commsn_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_commsn_grp_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n     opco_commsn_grp_sk, opco_commsn_grp_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_commsn_grp_cd, src_commsn_grp_desc, src_commsn_grp_type_txt \r\n    from opco_commsn_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_commsn_grp_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_commsn_grp"], "unique_id": "model.OI_Foundation.opco_commsn_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_commsn_grp.sql", "original_file_path": "models/foundation/customer/opco_commsn_grp.sql", "name": "opco_commsn_grp", "alias": "opco_commsn_grp", "checksum": {"name": "sha256", "checksum": "ed5f2770bc117d0eb7545d29f62bcdc001cccb2e0ed68acb1a584ec76e3b19ad"}, "tags": [], "refs": [["v_opco_commsn_grp_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3436568}, "model.OI_Foundation.opco_cust_packing_slip_line": {"raw_sql": "with opco_cust_packing_slip_line as(\r\n    select *,\r\n    rank() over(partition by opco_cust_packing_slip_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_packing_slip_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_packing_slip_line_sk, opco_cust_packing_slip_line_ck, opco_cust_packing_slip_line_ak, CRT_DTM, STG_LOAD_DTM,DELETE_DTM,\r\n    src_sys_nm, opco_id, packing_slip_id, intry_trans_id, opco_cust_packing_slip_sk, opco_sls_ordr_sk, orig_sls_ordr_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, \r\n    opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_assctn_sk, opco_invtry_ref_type_sk, sls_uom_sk, invtry_uom_sk, line_nbr, cust_item_id, item_desc, invtry_ref_id, \r\n    invtry_ref_trans_id, ship_dt, dlvry_county_nm, dlvry_state_nm, dlvry_country_nm, partial_dlvry_ind, dlvry_type_txt, sls_grp_txt, packing_slip_line_desc, spcl_item_ind,\r\n    spcl_item_nbr, grp_nm, per_unit_qty, invtry_unit_qty, picked_ordr_qty, packed_ordr_qty, released_qty, remaining_qty, per_unit_sls_price_amt, opco_currency_picked_line_amt,\r\n    opco_currency_packed_line_amt, item_weight_amt\r\n    from opco_cust_packing_slip_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_packing_slip_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_packing_slip_line"], "unique_id": "model.OI_Foundation.opco_cust_packing_slip_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_packing_slip_line.sql", "original_file_path": "models/foundation/customer/opco_cust_packing_slip_line.sql", "name": "opco_cust_packing_slip_line", "alias": "opco_cust_packing_slip_line", "checksum": {"name": "sha256", "checksum": "e125ccd2f51a45e000cbc7414517a30c055085dd12b03bf7131e814bf4713340"}, "tags": [], "refs": [["v_opco_cust_packing_slip_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3455782}, "model.OI_Foundation.opco_cust_code": {"raw_sql": "with opco_cust_code as(\r\n    select *,\r\n    rank() over(partition by opco_cust_code_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_code_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_code_sk, opco_cust_code_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_cust_code_cd, src_cust_code_desc\r\n    from opco_cust_code\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_code_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_cust_code"], "unique_id": "model.OI_Foundation.opco_cust_code", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_cust_code.sql", "original_file_path": "models/foundation/customer/opco_cust_code.sql", "name": "opco_cust_code", "alias": "opco_cust_code", "checksum": {"name": "sha256", "checksum": "28d60b4198100a4310b1c9b682084aed488857e60ebc7fc44c5def7613a7a0d9"}, "tags": [], "refs": [["v_opco_cust_code_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3473709}, "model.OI_Foundation.opco_invtry_ref_type": {"raw_sql": "with opco_invtry_ref_type as(\r\n    select *\r\n    from {{ ref('v_opco_invtry_ref_type_lineage') }}\r\n\r\n)\r\n\r\nselect * from opco_invtry_ref_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_invtry_ref_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "customer", "opco_invtry_ref_type"], "unique_id": "model.OI_Foundation.opco_invtry_ref_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/customer/opco_invtry_ref_type.sql", "original_file_path": "models/foundation/customer/opco_invtry_ref_type.sql", "name": "opco_invtry_ref_type", "alias": "opco_invtry_ref_type", "checksum": {"name": "sha256", "checksum": "4d3c9e5f7d1ec1b3500c963b7e8e8bb2a0e3684d0a9b2a06ec16987cd3a195d5"}, "tags": [], "refs": [["v_opco_invtry_ref_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3492517}, "model.OI_Foundation.opco_po_line": {"raw_sql": "with opco_po_line as(\r\n    select *,\r\n    rank() over(partition by opco_po_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_po_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_po_line_sk, opco_po_line_ck ,opco_po_line_ak, CRT_DTM,  STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, po_id, po_line_nbr, opco_po_sk, opco_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk,\r\n    opco_assctn_sk, opco_item_sk, trans_currency_sk, opco_trans_status_sk, opco_po_type_sk, purchase_uom_sk, opco_gl_acct_sk, opco_invtry_ref_type_sk,\r\n    opco_project_catgry_sk, opco_project_sk, invtry_trans_id, invtry_ref_id, invtry_ref_trans_id, project_item_trans_id, req_plan_schedule_id, req_plan_ordr_id,\r\n    asset_id, project_tax_grp_id, po_line_nm, po_line_locked_ind, po_line_dlvry_complete_ind, scrap_ind,taxable_ind, tax_item_grp_cd, rqst_dlvry_dt,\r\n    actl_dlvry_dt, dlvry_type_txt, po_line_crt_dtm, po_line_crt_by, vendor_grp_cd, vendor_item_id, invtry_unit_ordr_qty, purchase_unit_ordr_qty, \r\n    purchase_unit_financial_remaining_qty, purchase_unit_physical_remaining_qty, invtry_unit_physical_remaining_qty, invtry_unit_financial_remaining_qty,\r\n    purchase_unit_received_qty, invtry_unit_received_qty, per_unit_qty, po_line_dscnt_pct, per_unit_line_dscnt_amt, per_unit_multi_line_dscnt_amt,\r\n    unit_purchase_price_amt, po_line_amt, purchase_markup_amt, tax_1099_amt\r\n    \r\n    from opco_po_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_po_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "purchase_order", "opco_po_line"], "unique_id": "model.OI_Foundation.opco_po_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/purchase_order/opco_po_line.sql", "original_file_path": "models/foundation/purchase_order/opco_po_line.sql", "name": "opco_po_line", "alias": "opco_po_line", "checksum": {"name": "sha256", "checksum": "4b5c6f8a6dbc114690125dbd81508dd585403beed367a9ae647b85c805ad17ec"}, "tags": [], "refs": [["v_opco_po_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3517346}, "model.OI_Foundation.opco_po_type": {"raw_sql": "with opco_po_type as(\r\n    select *\r\n    from {{ ref('v_opco_po_type_lineage') }}\r\n\r\n)\r\n\r\nselect * from opco_po_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_po_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "purchase_order", "opco_po_type"], "unique_id": "model.OI_Foundation.opco_po_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/purchase_order/opco_po_type.sql", "original_file_path": "models/foundation/purchase_order/opco_po_type.sql", "name": "opco_po_type", "alias": "opco_po_type", "checksum": {"name": "sha256", "checksum": "0320c6a2ae9f26c660e2a3c500ff2fe500cac7b4dc36e37167194a71506c21c4"}, "tags": [], "refs": [["v_opco_po_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3535702}, "model.OI_Foundation.opco_po_doc_status": {"raw_sql": "with opco_po_doc_status as(\r\n    select *\r\n    from {{ ref('v_opco_po_doc_status_lineage') }}\r\n)\r\n\r\nselect * from opco_po_doc_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_po_doc_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "purchase_order", "opco_po_doc_status"], "unique_id": "model.OI_Foundation.opco_po_doc_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/purchase_order/opco_po_doc_status.sql", "original_file_path": "models/foundation/purchase_order/opco_po_doc_status.sql", "name": "opco_po_doc_status", "alias": "opco_po_doc_status", "checksum": {"name": "sha256", "checksum": "19ffe735c5f5b12e92f3749a83fb50cfc11fe9f0805d05b73ecb8ab32ae13511"}, "tags": [], "refs": [["v_opco_po_doc_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3554487}, "model.OI_Foundation.opco_po": {"raw_sql": "with opco_po as(\r\n    select *,\r\n    rank() over(partition by opco_po_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_po_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n     opco_po_sk, opco_po_ck,opco_po_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, po_id, po_nm, opco_sk, opco_cost_center_sk, opco_dept_sk,opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_vendor_sk,\r\n    invoice_vendor_sk, opco_cash_dscnt_terms_sk, trans_currency_sk, opco_trans_status_sk, opco_po_type_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk,\r\n    intercompany_orig_sls_ordr_sk, intercompany_orig_cust_sk, opco_dlvry_mode_sk,  opco_dlvry_terms_sk, opco_po_doc_status_sk, warehouse_sk,\r\n    opco_project_sk, opco_locn_sk, dlvry_dt, po_crt_dtm, po_reqstd_by_nm, vendor_grp_cd, dlvry_vendor_nm, vendor_ref_txt, alias_nm, item_buyer_grp_id,\r\n    purchased_by_txt, taxable_ind, dscnt_pct, cash_dscnt_pct\r\n\r\n    from opco_po\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_po_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "purchase_order", "opco_po"], "unique_id": "model.OI_Foundation.opco_po", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/purchase_order/opco_po.sql", "original_file_path": "models/foundation/purchase_order/opco_po.sql", "name": "opco_po", "alias": "opco_po", "checksum": {"name": "sha256", "checksum": "dfc6b6a027f83da09b5f3690e640086946574a51b6324216fabfee1cd8275517"}, "tags": [], "refs": [["v_opco_po_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3572412}, "model.OI_Foundation.opco_vendor_invoice": {"raw_sql": "with opco_vendor_invoice as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_invoice_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_invoice_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_VENDOR_INVOICE_sk, OPCO_VENDOR_INVOICE_ck,opco_vendor_invoice_ak, crt_dtm, \r\n    STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr, opco_sk, opco_po_sk, opco_vendor_sk, opco_invoice_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_type_sk, trans_currency_sk, opco_pymnt_terms_sk, opco_cash_dscnt_terms_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, opco_project_sk, vendor_grp_cd, invoice_dt, due_dt, gl_voucher_nbr, document_nbr, document_dt, cash_dscnt_dt, default_country_nm, purchaser_nm, invoice_qty, invoice_weight_amt, invoice_vol_amt, rqstd_by_nm, exchg_rt, pymnt_id, tax_grp_id, item_buyer_grp_id, fixed_due_dt, trans_currency_invoice_amt, opco_currency_invoice_amt, trans_currency_invoice_roundoff_amt, trans_currency_misc_chrgs_amt, opco_currency_misc_chrgs_amt, trans_currency_cash_dscnt_amt, trans_currency_line_dscnt_amt, trans_currency_balance_sls_amt\r\n\r\n\r\n    from opco_vendor_invoice\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_invoice_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "vendor", "opco_vendor_invoice"], "unique_id": "model.OI_Foundation.opco_vendor_invoice", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/vendor/opco_vendor_invoice.sql", "original_file_path": "models/foundation/vendor/opco_vendor_invoice.sql", "name": "opco_vendor_invoice", "alias": "opco_vendor_invoice", "checksum": {"name": "sha256", "checksum": "8419862c128ca84651576e0d661f6ca0225bbaf21e82de4b3f5e12ea33f184a3"}, "tags": [], "refs": [["v_opco_vendor_invoice_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3590412}, "model.OI_Foundation.opco_vendor_packing_slip_line": {"raw_sql": "with opco_vendor_packing_slip_line as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_packing_slip_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_packing_slip_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_vendor_packing_slip_line_sk, opco_vendor_packing_slip_line_ck,opco_vendor_packing_slip_line_ak, crt_dtm, \r\n    STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id, invtry_trans_id, opco_vendor_packing_slip_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, orig_po_sk, opco_assctn_sk, opco_uom_sk, opco_invtry_ref_type_sk, line_nbr, dlvry_dt, invtry_trans_dt, invtry_ref_id, vendor_item_id, item_desc, partial_dlvry_ind, dest_country_nm, dest_state_nm, dest_county_nm, per_unit_qty, ordr_qty, received_qty, remaining_qty, invtry_qty, opco_currency_trans_amt\r\n\r\n\r\n    from opco_vendor_packing_slip_line \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "vendor", "opco_vendor_packing_slip_line"], "unique_id": "model.OI_Foundation.opco_vendor_packing_slip_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/vendor/opco_vendor_packing_slip_line.sql", "original_file_path": "models/foundation/vendor/opco_vendor_packing_slip_line.sql", "name": "opco_vendor_packing_slip_line", "alias": "opco_vendor_packing_slip_line", "checksum": {"name": "sha256", "checksum": "3199f7032703b3e549f147ab57f1e096d828b0af3584e723f7784e97f89958f0"}, "tags": [], "refs": [["v_opco_vendor_packing_slip_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3609762}, "model.OI_Foundation.opco_vendor_trans": {"raw_sql": "with opco_vendor_trans  as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_vendor_trans_sk, opco_vendor_trans_ck, opco_vendor_trans_ak, crt_dtm, \r\n    STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, src_key_txt, opco_sk, opco_vendor_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, opco_gl_trans_type_sk, trans_currency_sk, opco_pymnt_mode_sk, opco_cash_dscnt_terms_sk, ltst_settled_opco_sk, ltst_settled_vendor_sk, trans_desc, trans_dt, due_dt, trans_close_dt, voucher_nbr, invoice_nbr, ltst_settled_voucher_nbr, ltst_settle_dt, trans_apprvd_ind, trans_apprvd_by_txt, trans_apprvd_dtm, document_nbr, document_dt, offset_src_key_txt, project_contract_orign_ind, crrctn_trans_ind, auto_settle_ind, cancelled_ind, pymnt_ref_txt, pymnt_id, trans_currency_trans_amt, trans_currency_settled_amt, opco_currency_trans_amt, opco_currency_settled_amt, exchg_rt, ltst_exchg_adjstmt_dt, opco_currency_exchg_adjstmt_amt, opco_currency_realized_exchg_adjstmt_amt, opco_currency_tax_amt, opco_currency_settled_tax_amt, dscnt_dt, dscnt_amt\r\n\r\n\r\n    from opco_vendor_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "vendor", "opco_vendor_trans"], "unique_id": "model.OI_Foundation.opco_vendor_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/vendor/opco_vendor_trans.sql", "original_file_path": "models/foundation/vendor/opco_vendor_trans.sql", "name": "opco_vendor_trans", "alias": "opco_vendor_trans", "checksum": {"name": "sha256", "checksum": "9aac07a800567970a5f15ae202f47e2b5a46cbb9d9c20700cbe77554401b2bc0"}, "tags": [], "refs": [["v_opco_vendor_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3630002}, "model.OI_Foundation.opco_vendor_invoice_line": {"raw_sql": "with opco_vendor_invoice_line as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_invoice_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_invoice_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_VENDOR_invoice_line_sk, OPCO_VENDOR_invoice_line_ck,opco_vendor_invoice_line_ak, crt_dtm, \r\n    STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, invoice_nbr, internal_invoice_nbr, invtry_trans_id, opco_vendor_invoice_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_po_sk, orig_po_sk, gl_acct_sk, trans_currency_sk, opco_assctn_sk, opco_invtry_ref_type_sk, opco_uom_sk, line_nbr, invoice_dt, item_desc, vendor_item_id, invtry_ref_id, invtry_ref_trans_id, invtry_trans_dt, dest_country_nm, dest_state_nm, dest_county_nm, tax_grp_id, tax_item_grp_id, per_unit_qty, purchase_qty, received_qty, invtry_qty, dscnt_pct, line_dscnt_pct, per_unit_price_amt, trans_currency_trans_amt, opco_currency_trans_amt, trans_currency_misc_chrgs_amt, trans_currency_dscnt_amt, trans_currency_line_dscnt_amt, trans_currency_multi_line_dscnt_amt, trans_currency_tax_amt, opco_currency_tax_1099_amt\r\n\r\n\r\n    from opco_vendor_invoice_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_invoice_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "vendor", "opco_vendor_invoice_line"], "unique_id": "model.OI_Foundation.opco_vendor_invoice_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/vendor/opco_vendor_invoice_line.sql", "original_file_path": "models/foundation/vendor/opco_vendor_invoice_line.sql", "name": "opco_vendor_invoice_line", "alias": "opco_vendor_invoice_line", "checksum": {"name": "sha256", "checksum": "45c5e1dacf5ca0dcf7d71224e1582cdbea1266604a3d53e429d8e09d801de97e"}, "tags": [], "refs": [["v_opco_vendor_invoice_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3649032}, "model.OI_Foundation.opco_vendor_packing_slip": {"raw_sql": "with opco_vendor_packing_slip as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_packing_slip_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_packing_slip_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_vendor_packing_slip_sk, opco_vendor_packing_slip_ck,opco_vendor_packing_slip_ak, crt_dtm, \r\n    STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, packing_slip_id, internal_packing_slip_id, opco_sk, opco_vendor_sk, opco_invoice_vendor_sk, opco_po_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_locn_sk, opco_project_sk, opco_po_type_sk, dlvry_dt, dlvry_vendor_nm, gl_voucher_nbr, item_buyer_grp_id, purchaser_nm, rqstd_by_nm, requsitioner_nm, attn_info_txt, dlvry_qty, dlvry_volume_amt, dlvry_weight_amt\r\n\r\n\r\n    from opco_vendor_packing_slip\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_packing_slip_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "vendor", "opco_vendor_packing_slip"], "unique_id": "model.OI_Foundation.opco_vendor_packing_slip", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/vendor/opco_vendor_packing_slip.sql", "original_file_path": "models/foundation/vendor/opco_vendor_packing_slip.sql", "name": "opco_vendor_packing_slip", "alias": "opco_vendor_packing_slip", "checksum": {"name": "sha256", "checksum": "bbc317b9edc5b6cad842b91312c6dfefb5c60534e20a824106ef03706aaff42f"}, "tags": [], "refs": [["v_opco_vendor_packing_slip_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.366711}, "model.OI_Foundation.opco_item_invtry": {"raw_sql": "with opco_item_invtry as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk, opco_assctn_sk  order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_invtry_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_sk, opco_assctn_sk, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, item_avbl_physical_qty, item_posted_qty, item_posted_value_amt\r\n    from opco_item_invtry\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_invtry_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_invtry"], "unique_id": "model.OI_Foundation.opco_item_invtry", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_invtry.sql", "original_file_path": "models/foundation/product/opco_item_invtry.sql", "name": "opco_item_invtry", "alias": "opco_item_invtry", "checksum": {"name": "sha256", "checksum": "157c1222a5f3d36677cf8b62fd9c0561bd05b28a658b0a8ef234f972cca48bf3"}, "tags": [], "refs": [["v_opco_item_invtry_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3685079}, "model.OI_Foundation.opco_item_subtype": {"raw_sql": "with opco_item_subtype as(\r\n    select *,\r\n    rank() over(partition by opco_item_subtype_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_subtype_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_subtype_sk, \r\n    opco_item_subtype_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm,  \r\n    src_item_type_cd,  \r\n    src_item_subtype_cd,  \r\n    src_item_subtype_desc\r\n    from opco_item_subtype\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_subtype_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_subtype"], "unique_id": "model.OI_Foundation.opco_item_subtype", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_subtype.sql", "original_file_path": "models/foundation/product/opco_item_subtype.sql", "name": "opco_item_subtype", "alias": "opco_item_subtype", "checksum": {"name": "sha256", "checksum": "139994b290932748cd1ce2d15c8d473d860bafc212eab17bdb6f172e2fd22bfe"}, "tags": [], "refs": [["v_opco_item_subtype_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3704076}, "model.OI_Foundation.opco_vendor": {"raw_sql": "with opco_vendor as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_VENDOR_SK, OPCO_VENDOR_CK, CRT_DTM,\r\n    STG_LOAD_DTM,DELETE_DTM,\r\n    src_sys_nm, vendor_id, vendor_nm, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_pymnt_mode_sk, opco_pymnt_terms_sk, opco_dlvry_mode_sk, opco_currency_sk, vendor_grp_cd, vendor_alt_nm, vendor_dba_nm, foreign_entity_ind, vendor_block_txt\r\n \r\n    from opco_vendor\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_vendor"], "unique_id": "model.OI_Foundation.opco_vendor", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_vendor.sql", "original_file_path": "models/foundation/product/opco_vendor.sql", "name": "opco_vendor", "alias": "opco_vendor", "checksum": {"name": "sha256", "checksum": "5857f9236897c177c6bdfd3572ff80505fd8547336b71ae83a030d5ffe70690f"}, "tags": [], "refs": [["v_opco_vendor_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3724363}, "model.OI_Foundation.opco_purpose": {"raw_sql": "with opco_purpose as(\r\n    select *,\r\n    rank() over(partition by opco_purpose_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_purpose_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_PURPOSE_SK, OPCO_PURPOSE_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, src_purpose_cd, src_purpose_desc, purpose_wo_spcl_chr_cd, actv_ind\r\n    from opco_purpose\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_purpose_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_purpose"], "unique_id": "model.OI_Foundation.opco_purpose", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_purpose.sql", "original_file_path": "models/foundation/product/opco_purpose.sql", "name": "opco_purpose", "alias": "opco_purpose", "checksum": {"name": "sha256", "checksum": "d4ce361ab98c094c0a877cc401853fa0f9480fe9a1985b54e00fab1c0c588016"}, "tags": [], "refs": [["v_opco_purpose_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3742437}, "model.OI_Foundation.opco_item_opco_assctn_xref": {"raw_sql": "with opco_item_opco_assctn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk, opco_assctn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_opco_assctn_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_sk, opco_assctn_sk, crt_dtm, stg_load_dtm, delete_dtm,\r\n    opco_item_count_grp_sk, opco_item_scrap_type_sk, src_sys_nm, bin_locn_txt, bldg_locn_txt, cubic_yrds_amt, cubic_yrds_fixed_amt, cubic_yrds_variable_amt, fixed_wt_amt, gl_prodn_qty, gl_sls_qty, labor_hrs_nbr, \r\n    max_on_hand_qty, net_wt_amt, prodn_abcd_cd, prodn_flushing_principle_cd, variable_wt_amt\r\n    from opco_item_opco_assctn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_opco_assctn_xref"], "unique_id": "model.OI_Foundation.opco_item_opco_assctn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_opco_assctn_xref.sql", "original_file_path": "models/foundation/product/opco_item_opco_assctn_xref.sql", "name": "opco_item_opco_assctn_xref", "alias": "opco_item_opco_assctn_xref", "checksum": {"name": "sha256", "checksum": "c242a80cb54c7c38a0742f02a6bc4499946c2d04c033b7ae33728659e2e7840d"}, "tags": [], "refs": [["v_opco_item_opco_assctn_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3761554}, "model.OI_Foundation.opco_invtry_trans_type": {"raw_sql": "with opco_invtry_trans_type as(\r\n    select *\r\n    from {{ ref('v_opco_invtry_trans_type_lineage') }}\r\n)\r\n\r\nselect * from opco_invtry_trans_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_invtry_trans_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_invtry_trans_type"], "unique_id": "model.OI_Foundation.opco_invtry_trans_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_invtry_trans_type.sql", "original_file_path": "models/foundation/product/opco_invtry_trans_type.sql", "name": "opco_invtry_trans_type", "alias": "opco_invtry_trans_type", "checksum": {"name": "sha256", "checksum": "d197a4d5c0e282829d565f62a673d5424e236d55b993ec51a67b610e1dc463a2"}, "tags": [], "refs": [["v_opco_invtry_trans_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3779638}, "model.OI_Foundation.opco_item_class": {"raw_sql": "with opco_item_class as(\r\n    select *,\r\n    rank() over(partition by opco_item_class_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_class_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_class_sk, \r\n    opco_item_class_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,src_sys_nm, \r\n    src_ITEM_CLASS_cd, \r\n    src_ITEM_CLASS_desc\r\n    from opco_item_class\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_class_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_class"], "unique_id": "model.OI_Foundation.opco_item_class", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_class.sql", "original_file_path": "models/foundation/product/opco_item_class.sql", "name": "opco_item_class", "alias": "opco_item_class", "checksum": {"name": "sha256", "checksum": "81a5155a0c2fe8e02e3ea53625c9dfc2cb4ca49d9d49c09f8b42ed8c9cab3025"}, "tags": [], "refs": [["v_opco_item_class_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3797412}, "model.OI_Foundation.opco_item_cvrg_grp": {"raw_sql": "with opco_item_cvrg_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_cvrg_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_cvrg_grp_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_cvrg_grp_sk, \r\n    opco_item_cvrg_grp_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_cvrg_grp_cd,\r\n    opco_id, \r\n    src_item_cvrg_grp_desc\r\n    from opco_item_cvrg_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_cvrg_grp_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_cvrg_grp"], "unique_id": "model.OI_Foundation.opco_item_cvrg_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_cvrg_grp.sql", "original_file_path": "models/foundation/product/opco_item_cvrg_grp.sql", "name": "opco_item_cvrg_grp", "alias": "opco_item_cvrg_grp", "checksum": {"name": "sha256", "checksum": "6460b9d887220f042843d90cf8763f3a7536e710e53219b2c745eb015bd0e5ca"}, "tags": [], "refs": [["v_opco_item_cvrg_grp_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3818772}, "model.OI_Foundation.opco_item_type": {"raw_sql": "with opco_item_type as(\r\n    select *,\r\n    rank() over(partition by opco_item_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_type_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_type_sk, \r\n    opco_item_type_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_type_cd, \r\n    src_item_type_desc\r\n    from opco_item_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_type"], "unique_id": "model.OI_Foundation.opco_item_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_type.sql", "original_file_path": "models/foundation/product/opco_item_type.sql", "name": "opco_item_type", "alias": "opco_item_type", "checksum": {"name": "sha256", "checksum": "f08b6f59eb9dbf0a157e745ac4e62335bfaeeb276efb8645edca4e66265b0b20"}, "tags": [], "refs": [["v_opco_item_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3836644}, "model.OI_Foundation.opco_invtry_trans": {"raw_sql": "with opco_invtry_trans as(\r\n    select *,\r\n    rank() over(partition by opco_invtry_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_invtry_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_INVTRY_TRANS_SK, OPCO_INVTRY_TRANS_CK, OPCO_INVTRY_TRANS_AK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n\tsrc_sys_nm, opco_id, src_key_txt, opco_sk, opco_cust_sk, opco_vendor_sk, opco_item_sk, opco_assctn_sk, trans_currency_sk,\r\n    opco_invtry_trans_type_sk, opco_project_sk, opco_project_catgry_sk, opco_picking_list_sk, opco_invtry_issue_status_sk, \r\n    opco_invtry_rcpt_status_sk, invtry_trans_id, parent_invtry_trans_id, invtry_return_trans_id, invtry_transfer_trans_id, \r\n    ref_invtry_trans_id, trans_ref_id, item_route_id, item_bom_id, asset_id, packing_slip_id, project_adjstmt_ref_id, trans_dt,\r\n    trans_status_dt, financial_trans_dt, financial_close_dt, rqst_ship_dt, cnfrm_ship_dt, item_expctd_movement_dt, invtry_qty_registered_dt,\r\n    invtry_qty_picked_dt, invoice_nbr, voucher_nbr, invtry_updt_voucher_nbr, packing_slip_returned_item_ind, invoice_returned_item_ind,\r\n    intercompany_transfer_ind, invtry_order_prcs_nbr, invtry_order_prcs_type_txt, trans_open_txt, invtry_trans_direction_txt, trans_qty, \r\n    settled_qty, posted_cost_amt, adjstmt_cost_amt, operations_cost_amt, settled_cost_amt, std_cost_amt, invtry_updt_qty_cost_amt, \r\n    invtry_updt_qty_revenue_amt\r\n    from opco_invtry_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_invtry_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_invtry_trans"], "unique_id": "model.OI_Foundation.opco_invtry_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_invtry_trans.sql", "original_file_path": "models/foundation/product/opco_invtry_trans.sql", "name": "opco_invtry_trans", "alias": "opco_invtry_trans", "checksum": {"name": "sha256", "checksum": "da2ecfa7063f526e36c74a526324adb1e504f8c669c4cd3dde496d4981cb6847"}, "tags": [], "refs": [["v_opco_invtry_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3855968}, "model.OI_Foundation.opco_item_freight": {"raw_sql": "with opco_item_freight as(\r\n    select *,\r\n    rank() over(partition by opco_item_freight_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_freight_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_freight_sk, \r\n    opco_item_freight_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_freight_cd, \r\n    opco_id, \r\n    src_item_freight_nm\r\n    \r\n    from opco_item_freight\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_freight_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_freight"], "unique_id": "model.OI_Foundation.opco_item_freight", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_freight.sql", "original_file_path": "models/foundation/product/opco_item_freight.sql", "name": "opco_item_freight", "alias": "opco_item_freight", "checksum": {"name": "sha256", "checksum": "365f902add6c55520ad001d5ed324c8c5bc74523336b49cb11527cd09cf06ffa"}, "tags": [], "refs": [["v_opco_item_freight_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.387405}, "model.OI_Foundation.opco_brand": {"raw_sql": "with opco_brand as(\r\n    select *,\r\n    rank() over(partition by opco_brand_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_brand_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_brand_sk, opco_brand_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_brand_cd, src_brand_nm, brand_wo_spcl_chr_cd, actv_ind\r\n    from opco_brand\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_brand_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_brand"], "unique_id": "model.OI_Foundation.opco_brand", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_brand.sql", "original_file_path": "models/foundation/product/opco_brand.sql", "name": "opco_brand", "alias": "opco_brand", "checksum": {"name": "sha256", "checksum": "fd77f7cb72bf805b1859ed22beb09625800d1a7e389247ac83f853c4a7877e91"}, "tags": [], "refs": [["v_opco_brand_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3892002}, "model.OI_Foundation.opco_invtry_rcpt_status": {"raw_sql": "with opco_invtry_rcpt_status as(\r\n    select *\r\n    from {{ ref('v_opco_invtry_rcpt_status_lineage') }}\r\n)\r\n\r\nselect * from opco_invtry_rcpt_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_invtry_rcpt_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_invtry_rcpt_status"], "unique_id": "model.OI_Foundation.opco_invtry_rcpt_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_invtry_rcpt_status.sql", "original_file_path": "models/foundation/product/opco_invtry_rcpt_status.sql", "name": "opco_invtry_rcpt_status", "alias": "opco_invtry_rcpt_status", "checksum": {"name": "sha256", "checksum": "bd939177c4509b6e19313276c143fede674ec61f55f46d07029ef64cd2b0d435"}, "tags": [], "refs": [["v_opco_invtry_rcpt_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3910763}, "model.OI_Foundation.opco_item_grp": {"raw_sql": "with opco_item_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_grp_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_grp_sk, \r\n    opco_item_grp_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_grp_cd, \r\n    opco_id, \r\n    src_item_grp_desc, \r\n    prodn_uom_sk, \r\n    sales_uom_sk, \r\n    opco_item_freight_sk, \r\n    capex_only_ind, \r\n    calc_category_cd, \r\n    item_grp_type_txt, \r\n    explicit_freight_ind, \r\n    explicit_freight_pct, \r\n    freight_pct, \r\n    ic_markup_pct, \r\n    imbedded_freight_ind, \r\n    markup_pct,\r\n    project_only_ind, \r\n    project_ctgry_cd\r\n    from opco_item_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_grp_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_grp"], "unique_id": "model.OI_Foundation.opco_item_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_grp.sql", "original_file_path": "models/foundation/product/opco_item_grp.sql", "name": "opco_item_grp", "alias": "opco_item_grp", "checksum": {"name": "sha256", "checksum": "89f59c25097ec67acc3afde781b29c74958f6f2cd00fc78f2c7b78f5a75a96cf"}, "tags": [], "refs": [["v_opco_item_grp_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3931184}, "model.OI_Foundation.opco_invtry_issue_status": {"raw_sql": "with opco_invtry_issue_status as(\r\n    select *\r\n    from {{ ref('v_opco_invtry_issue_status_lineage') }}\r\n)\r\n\r\nselect * from opco_invtry_issue_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_invtry_issue_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_invtry_issue_status"], "unique_id": "model.OI_Foundation.opco_invtry_issue_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_invtry_issue_status.sql", "original_file_path": "models/foundation/product/opco_invtry_issue_status.sql", "name": "opco_invtry_issue_status", "alias": "opco_invtry_issue_status", "checksum": {"name": "sha256", "checksum": "1b57ed0c0dc389badbd97ce4cdf6d323477420adcc05bcd8dd84532f470130e1"}, "tags": [], "refs": [["v_opco_invtry_issue_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3949232}, "model.OI_Foundation.opco_item_model_grp": {"raw_sql": "with opco_item_model_grp as(\r\n    select *,\r\n    rank() over(partition by opco_item_model_grp_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_model_grp_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_model_grp_sk, \r\n    opco_item_model_grp_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_model_grp_cd, \r\n    src_item_model_grp_nm\r\n    from opco_item_model_grp\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_model_grp_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_model_grp"], "unique_id": "model.OI_Foundation.opco_item_model_grp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_model_grp.sql", "original_file_path": "models/foundation/product/opco_item_model_grp.sql", "name": "opco_item_model_grp", "alias": "opco_item_model_grp", "checksum": {"name": "sha256", "checksum": "2b53097e695785b6c3db6e9001047372e7c8f1bdda28c93c8ae8c4548fb0b024"}, "tags": [], "refs": [["v_opco_item_model_grp_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.3968549}, "model.OI_Foundation.opco_item": {"raw_sql": "with opco_item as(\r\n    select *,\r\n    rank() over(partition by opco_item_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_sk, opco_item_ck, crt_dtm, stg_load_dtm, delete_dtm,         \r\n    src_sys_nm, \r\n    opco_id, \r\n    src_item_cd, \r\n    src_item_nm, \r\n    opco_item_type_sk, \r\n    opco_item_subtype_sk, \r\n    opco_uom_sk, \r\n    opco_commsn_grp_sk, \r\n    opco_item_dim_grp_sk, \r\n    opco_item_buyer_grp_sk, \r\n    opco_item_grp_sk, \r\n    opco_item_model_grp_sk, \r\n    primary_vendor_sk, \r\n    opco_item_class_sk, \r\n    opco_item_cvrg_grp_sk, \r\n    opco_item_sls_class_sk, \r\n    opco_purpose_sk, \r\n    actv_ind, \r\n    height_nbr, \r\n    width_nbr, \r\n    depth_nbr, \r\n    net_wt_nbr, \r\n    cost_model_ind, \r\n    cost_group_txt, \r\n    src_crt_dtm, \r\n    src_crt_by, \r\n    src_updt_dtm, \r\n    src_updt_by, \r\n    opco_lob_sk, \r\n    explicit_freight_ind, \r\n    form_id_txt, \r\n    form_grp_txt, \r\n    item_mold_txt, \r\n    item_admnstrn_type_desc, \r\n    kits_ind, \r\n    item_catgry_txt, \r\n    phantom_item_ind, \r\n    purchase_price_updt_ind, \r\n    shipping_class_txt, \r\n    sku_family_txt, \r\n    item_subcatgry_txt, \r\n    carton_upc_txt, \r\n    item_upc_txt, \r\n    vitality_dt, \r\n    tier_txt\r\n    from opco_item\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item"], "unique_id": "model.OI_Foundation.opco_item", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item.sql", "original_file_path": "models/foundation/product/opco_item.sql", "name": "opco_item", "alias": "opco_item", "checksum": {"name": "sha256", "checksum": "5ced1a52aca959ab8b0e0d6991b5be2b94decbba8ab97e8a8e963b47826f88bc"}, "tags": [], "refs": [["v_opco_item_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.398641}, "model.OI_Foundation.opco_item_sls_class": {"raw_sql": "with opco_item_sls_class as(\r\n    select *,\r\n    rank() over(partition by opco_item_sls_class_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_sls_class_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_sls_class_sk, \r\n    opco_item_sls_class_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_sls_class_cd, \r\n    src_item_sls_class_desc\r\n\r\n    from opco_item_sls_class\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_sls_class_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_sls_class"], "unique_id": "model.OI_Foundation.opco_item_sls_class", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_sls_class.sql", "original_file_path": "models/foundation/product/opco_item_sls_class.sql", "name": "opco_item_sls_class", "alias": "opco_item_sls_class", "checksum": {"name": "sha256", "checksum": "8b3e20788678b61ca78584524f6d6b7ab463a73762cb3bfa82bcca9fec99bd79"}, "tags": [], "refs": [["v_opco_item_sls_class_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4005632}, "model.OI_Foundation.opco_lob": {"raw_sql": "with opco_lob as(\r\n    select *,\r\n    rank() over(partition by opco_lob_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_lob_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_lob_sk, opco_lob_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_lob_cd, src_lob_nm, lob_wo_spcl_chr_cd, actv_ind\r\n    from opco_lob\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_lob_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_lob"], "unique_id": "model.OI_Foundation.opco_lob", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_lob.sql", "original_file_path": "models/foundation/product/opco_lob.sql", "name": "opco_lob", "alias": "opco_lob", "checksum": {"name": "sha256", "checksum": "94eeb8b4519f86d20b98449ad6412897fc26654d03e3a9ba7df2fa74b0d4128e"}, "tags": [], "refs": [["v_opco_lob_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4025843}, "model.OI_Foundation.opco_item_psi_dtl": {"raw_sql": "with opco_item_psi_dtl as(\r\n    select *,\r\n    rank() over(partition by opco_item_psi_dtl_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_psi_dtl_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_psi_dtl_sk, \r\n    opco_item_psi_dtl_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    opco_id, \r\n    src_item_cd, \r\n    psi_type_txt, \r\n    psi_price_dt, \r\n    psi_price_amt, \r\n    psi_price_unit_qty, \r\n    psi_dlvry_qty, \r\n    psi_line_dscnt_amt\r\n\r\n    from opco_item_psi_dtl\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_psi_dtl_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_psi_dtl"], "unique_id": "model.OI_Foundation.opco_item_psi_dtl", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_psi_dtl.sql", "original_file_path": "models/foundation/product/opco_item_psi_dtl.sql", "name": "opco_item_psi_dtl", "alias": "opco_item_psi_dtl", "checksum": {"name": "sha256", "checksum": "6c7ef745c7de19f83100dfadefd57787388be1696e18dac75dfea2888c27493a"}, "tags": [], "refs": [["v_opco_item_psi_dtl_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.404411}, "model.OI_Foundation.opco_item_size": {"raw_sql": "with opco_item_size as(\r\n    select *,\r\n    rank() over(partition by opco_item_size_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_item_size_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_item_size_sk, \r\n    opco_item_size_ck, \r\n    crt_dtm, \r\n    stg_load_dtm, \r\n    delete_dtm,\r\n    src_sys_nm, \r\n    src_item_size_cd, \r\n    opco_id, \r\n    src_item_cd, \r\n    src_item_sk, \r\n    src_item_size_nm, \r\n    src_item_size_desc\r\n\r\n    from opco_item_size\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_item_size_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_item_size"], "unique_id": "model.OI_Foundation.opco_item_size", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_item_size.sql", "original_file_path": "models/foundation/product/opco_item_size.sql", "name": "opco_item_size", "alias": "opco_item_size", "checksum": {"name": "sha256", "checksum": "c4c61f0be2c409198720956775778306afd4ce3825242d00ca3fc67ab255c66b"}, "tags": [], "refs": [["v_opco_item_size_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4063237}, "model.OI_Foundation.opco_uom": {"raw_sql": "with opco_uom as(\r\n    select *,\r\n    rank() over(partition by opco_uom_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_uom_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_uom_sk, opco_uom_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, src_uom_cd, src_uom_desc\r\n    from opco_uom\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_uom_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "product", "opco_uom"], "unique_id": "model.OI_Foundation.opco_uom", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/product/opco_uom.sql", "original_file_path": "models/foundation/product/opco_uom.sql", "name": "opco_uom", "alias": "opco_uom", "checksum": {"name": "sha256", "checksum": "0571f436dbbdc4dda92a4a14e1fa298f3f0fad8c188fd961c3b20f6e0eb196d3"}, "tags": [], "refs": [["v_opco_uom_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.40814}, "model.OI_Foundation.opco_cust_opco_locn_xref": {"raw_sql": "with opco_cust_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_cust_sk, opco_locn_sk, opco_cust_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cust_opco_locn_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_cust_sk, opco_locn_sk, opco_cust_opco_locn_asscn_type_txt, crt_dtm, stg_load_dtm, delete_dtm,\r\n    contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt, actv_ind  \r\n    from opco_cust_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "location", "opco_cust_opco_locn_xref"], "unique_id": "model.OI_Foundation.opco_cust_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/location/opco_cust_opco_locn_xref.sql", "original_file_path": "models/foundation/location/opco_cust_opco_locn_xref.sql", "name": "opco_cust_opco_locn_xref", "alias": "opco_cust_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "1654887741a87d1899c687e2fcac96f40389587eafc182013ed1e00f99ed194f"}, "tags": [], "refs": [["v_opco_cust_opco_locn_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4099379}, "model.OI_Foundation.opco_locn": {"raw_sql": "with opco_locn as(\r\n    select *,\r\n    rank() over(partition by opco_locn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_locn_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_locn_sk, opco_locn_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, addr_ln_1_txt, addr_ln_2_txt, addr_ln_3_txt, city_nm, state_nm, country_nm, zip_cd, county_nm\r\n    from opco_locn\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_locn_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "location", "opco_locn"], "unique_id": "model.OI_Foundation.opco_locn", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/location/opco_locn.sql", "original_file_path": "models/foundation/location/opco_locn.sql", "name": "opco_locn", "alias": "opco_locn", "checksum": {"name": "sha256", "checksum": "cc5a80342fda86cfc1e37f729be6d3ed7e380b3b760a56e01a7f0de6e799512d"}, "tags": [], "refs": [["v_opco_locn_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.412074}, "model.OI_Foundation.opco_opco_locn_xref": {"raw_sql": "with opco_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sk, opco_locn_sk, opco_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_opco_locn_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sk, opco_locn_sk, opco_opco_locn_asscn_type_txt, crt_dtm, stg_load_dtm, delete_dtm,\r\n    contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt \r\n    from opco_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_opco_locn_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "location", "opco_opco_locn_xref"], "unique_id": "model.OI_Foundation.opco_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/location/opco_opco_locn_xref.sql", "original_file_path": "models/foundation/location/opco_opco_locn_xref.sql", "name": "opco_opco_locn_xref", "alias": "opco_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "96f87fbdec2977551ad7be4df639e1bd825c544f79654856658de99ea3c6958d"}, "tags": [], "refs": [["v_opco_opco_locn_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.413895}, "model.OI_Foundation.opco_vendor_opco_locn_xref": {"raw_sql": "with opco_vendor_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_vendor_sk, opco_locn_sk, opco_vendor_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_vendor_opco_locn_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_vendor_sk, opco_locn_sk, opco_vendor_opco_locn_asscn_type_txt, crt_dtm, stg_load_dtm, delete_dtm,\r\n    contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr, contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, language_txt, start_dt, end_dt \r\n    from opco_vendor_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "location", "opco_vendor_opco_locn_xref"], "unique_id": "model.OI_Foundation.opco_vendor_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/location/opco_vendor_opco_locn_xref.sql", "original_file_path": "models/foundation/location/opco_vendor_opco_locn_xref.sql", "name": "opco_vendor_opco_locn_xref", "alias": "opco_vendor_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "c32257b8a0ebd42dfc8c1bd9e6843f72cd300fad38771f780067aaaaa3f5bba7"}, "tags": [], "refs": [["v_opco_vendor_opco_locn_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4156728}, "model.OI_Foundation.opco_type": {"raw_sql": "with opco_type as(\r\n    select *,\r\n    rank() over(partition by opco_type_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_type_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_TYPE_SK, OPCO_TYPE_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, src_type_cd, src_type_desc, type_wo_spcl_chr_cd, actv_ind\r\n    from opco_type\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco_type"], "unique_id": "model.OI_Foundation.opco_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco_type.sql", "original_file_path": "models/foundation/organization/opco_type.sql", "name": "opco_type", "alias": "opco_type", "checksum": {"name": "sha256", "checksum": "6e2df53850a48ae1caf6d5160d40add79bc94bae6caa4d33859e9b526d3ca683"}, "tags": [], "refs": [["v_opco_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4175847}, "model.OI_Foundation.fscl_clndr": {"raw_sql": "with fscl_clndr as(\r\n    select *,\r\n    rank() over(partition by fscl_clndr_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_fscl_clndr_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    fscl_clndr_SK, fscl_clndr_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, busn_apprvd_ind, clndr_dt, dt_ak, serial_mnth_nbr, fscl_yr_id, fscl_yr_nm, fscl_yr_mnth_id, fscl_yr_mnth_nm, fscl_mnth_nbr, fscl_mnth_nm, cn_to_us_cnvrsn_rt, fscl_mnth_strt_dt, fscl_mnth_end_dt, prev_fscl_mnth_strt_dt, prev_fscl_mnth_end_dt, fscl_yr_strt_dt, fscl_yr_end_dt, fscl_mnth_days_nbr, fscl_period_id, fscl_wk_day_nbr, wk_day_ind, clndr_yr_nbr, clndr_yr_day_nbr, clndr_qtr_nbr, clndr_yr_qtr_nbr, clndr_qtr_day_nbr, clndr_qtr_mnth_nbr, clndr_mnth_nbr, clndr_yr_mnth_nbr, clndr_mnth_day_nbr, clndr_wk_yr_nbr, clndr_yr_wk_day_nbr, clndr_wk_nbr, clndr_yr_wk_nbr, fscl_yr_nbr, fscl_yr_day_nbr, fscl_qtr_nbr, fscl_yr_qtr_nbr, fscl_qtr_day_nbr, fscl_qtr_mnth_nbr, fscl_yr_mnth_nbr, fscl_mnth_nbr_1, fscl_mnth_day_nbr, fscl_wk_yr_nbr, fscl_yr_wk_day_nbr, fscl_yr_wk_nbr, fscl_wk_nbr, dt_caption_1033_txt, wk_day_caption_1033_txt, clndr_yr_caption_1033_txt, clndr_qtr_caption_1033_txt, clndr_yr_qtr_caption_1033_txt, clndr_mnth_caption_1033_txt, clndr_yr_mnth_caption_1033_txt, clndr_wk_yr_caption_1033_txt, clndr_wk_caption_1033_txt, clndr_yr_wk_caption_1033_txt, fscl_yr_caption_1033_txt, fscl_qtr_caption_1033_txt, fscl_yr_qtr_caption_1033_txt, fscl_mnth_caption_1033_txt, fscl_yr_mnth_caption_1033_txt, fscl_wk_yr_caption_1033_txt, fscl_yr_wk_caption_1033_txt, fscl_wk_caption_1033_txt\r\n    from fscl_clndr\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_fscl_clndr_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "fscl_clndr"], "unique_id": "model.OI_Foundation.fscl_clndr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/fscl_clndr.sql", "original_file_path": "models/foundation/organization/fscl_clndr.sql", "name": "fscl_clndr", "alias": "fscl_clndr", "checksum": {"name": "sha256", "checksum": "53ceddf1a991bc2a7fa373ee6624a96c7e05602d8748735eaf56f5801b508e80"}, "tags": [], "refs": [["v_fscl_clndr_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4193525}, "model.OI_Foundation.region": {"raw_sql": "with region as(\r\n    select *,\r\n    rank() over(partition by region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_region_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    region_sk, region_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, region_id, region_nm, actv_ind\r\n    from region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_region_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "region"], "unique_id": "model.OI_Foundation.region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/region.sql", "original_file_path": "models/foundation/organization/region.sql", "name": "region", "alias": "region", "checksum": {"name": "sha256", "checksum": "7f31f7c2419b951ec693a7465b85a75343dae212de814596eaacc77e31db7fcd"}, "tags": [], "refs": [["v_region_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4212503}, "model.OI_Foundation.opco_assctn": {"raw_sql": "with opco_assctn as(\r\n    select *,\r\n    rank() over(partition by opco_assctn_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_assctn_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_assctn_sk, opco_assctn_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_assctn_cd, opco_id, opco_sk, opco_site_sk, cost_center_sk, warehouse_sk, actv_ind  \r\n    \r\n    from opco_assctn\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_assctn_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco_assctn"], "unique_id": "model.OI_Foundation.opco_assctn", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco_assctn.sql", "original_file_path": "models/foundation/organization/opco_assctn.sql", "name": "opco_assctn", "alias": "opco_assctn", "checksum": {"name": "sha256", "checksum": "124ba409eac12f03434026824cbd62b7371660be6216540ce61ede2de19ac32a"}, "tags": [], "refs": [["v_opco_assctn_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4232485}, "model.OI_Foundation.warehouse": {"raw_sql": "with warehouse as(\r\n    select *,\r\n    rank() over(partition by warehouse_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_warehouse_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    warehouse_sk, warehouse_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, opco_id, warehouse_id, warehouse_nm, actv_ind \r\n    \r\n    from warehouse\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_warehouse_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "warehouse"], "unique_id": "model.OI_Foundation.warehouse", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/warehouse.sql", "original_file_path": "models/foundation/organization/warehouse.sql", "name": "warehouse", "alias": "warehouse", "checksum": {"name": "sha256", "checksum": "7c068a1724b4c1e3f67773d16721cb6bf5be05456d8d344d9fdbc08a17a8e4db"}, "tags": [], "refs": [["v_warehouse_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4250546}, "model.OI_Foundation.opco_site": {"raw_sql": "with opco_site as(\r\n    select *,\r\n    rank() over(partition by opco_site_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_site_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_site_sk, opco_site_ck, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, src_site_id, src_site_nm, actv_ind  \r\n    \r\n    from opco_site\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_site_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco_site"], "unique_id": "model.OI_Foundation.opco_site", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco_site.sql", "original_file_path": "models/foundation/organization/opco_site.sql", "name": "opco_site", "alias": "opco_site", "checksum": {"name": "sha256", "checksum": "54d1b93ece28773524b90f621c089c7b82f11e3284a571365bd1a0ccb73cd43b"}, "tags": [], "refs": [["v_opco_site_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4269578}, "model.OI_Foundation.sub_region": {"raw_sql": "with sub_region as(\r\n    select *,\r\n    rank() over(partition by sub_region_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_sub_region_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    sub_region_sk, sub_region_ck, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, sub_region_id, sub_region_nm, actv_ind\r\n    from sub_region\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_sub_region_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "sub_region"], "unique_id": "model.OI_Foundation.sub_region", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/sub_region.sql", "original_file_path": "models/foundation/organization/sub_region.sql", "name": "sub_region", "alias": "sub_region", "checksum": {"name": "sha256", "checksum": "7dac2fc388e2a53a86105e6951eb75c627417c09af662c12e58cbd822071358a"}, "tags": [], "refs": [["v_sub_region_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.428761}, "model.OI_Foundation.opco_dept": {"raw_sql": "with opco_dept as(\r\n    select *,\r\n    rank() over(partition by opco_dept_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_dept_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_DEPT_SK, OPCO_DEPT_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_DEPT_CD, SRC_DEPT_DESC, DEPT_WO_SPCL_CHR_CD, ACTV_IND\r\n    from opco_dept\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_dept_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco_dept"], "unique_id": "model.OI_Foundation.opco_dept", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco_dept.sql", "original_file_path": "models/foundation/organization/opco_dept.sql", "name": "opco_dept", "alias": "opco_dept", "checksum": {"name": "sha256", "checksum": "b80e331665e560a0f0c35733f0fff2b6fa8c868e7c8605fdab2d3c7e2b3fc66e"}, "tags": [], "refs": [["v_opco_dept_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4305615}, "model.OI_Foundation.opco_cost_center": {"raw_sql": "with opco_cost_center as(\r\n    select *,\r\n    rank() over(partition by opco_cost_center_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_cost_center_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_COST_CENTER_SK, OPCO_COST_CENTER_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, SRC_SYS_NM, SRC_COST_CENTER_CD, SRC_COST_CENTER_DESC, COST_CENTER_WO_SPCL_CHR_CD, ACTV_IND, SRC_COST_CENTER_TYPE_TXT\r\n    from opco_cost_center\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_cost_center_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco_cost_center"], "unique_id": "model.OI_Foundation.opco_cost_center", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco_cost_center.sql", "original_file_path": "models/foundation/organization/opco_cost_center.sql", "name": "opco_cost_center", "alias": "opco_cost_center", "checksum": {"name": "sha256", "checksum": "7e44eb0b94ceb717f9bd2eeb5236d843d3c02d2a43ec3e0a5a5bdc1df4c178df"}, "tags": [], "refs": [["v_opco_cost_center_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4326754}, "model.OI_Foundation.opco": {"raw_sql": "with opco as(\r\n    select *,\r\n    rank() over(partition by opco_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sk, opco_ck, opco_ak, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, opco_id, opco_nm, opco_currency_sk, region_sk, sub_region_sk, dba_nm, enterprise_ind, govt_issued_id,  duns_nbr, vat_nbr, acqstn_dt, actv_ind, inactv_dt, import_vat_nbr, website_url_txt, language_txt, conversion_dt, foreign_enty_ind, combined_fed_state_tax_filer_ind, validate_1099_on_entry_ind, planning_company_ind, sls_tax_global_id, sls_tax_local_id, product_line_txt, prnt_opco_id, collection_type_txt, dashboard_usage_id\r\n    from opco\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "organization", "opco"], "unique_id": "model.OI_Foundation.opco", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/organization/opco.sql", "original_file_path": "models/foundation/organization/opco.sql", "name": "opco", "alias": "opco", "checksum": {"name": "sha256", "checksum": "d5778f9ffce81d3b0fda4e5e2628c66cd6a8538d09ec737765bb6a0a9b112f98"}, "tags": [], "refs": [["v_opco_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4344544}, "model.OI_Foundation.opco_sls_ordr": {"raw_sql": "with opco_sls_ordr as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_sls_ordr_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sls_ordr_sk, opco_sls_ordr_ck, opco_sls_ordr_ak, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, sls_ordr_id, sls_ordr_nm, sls_ordr_dt, ship_dt, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk,\r\n    opco_lob_sk, opco_cust_sk, opco_trans_status_sk, opco_cust_grp_sk, opco_site_sk, opco_dlvry_terms_sk, opco_dlvry_mode_sk, dlvry_loc_sk,\r\n    warehouse_sk, sls_grp_nm, tax_grp_id, quotation_id, cust_po_nbr, trans_currency_sk, opco_pymnt_terms_sk, opco_pymnt_mode_sk, opco_cash_dscnt_terms_sk,\r\n    cash_dscnt_pct, sls_ordr_crt_dtm, sls_ordr_modified_dtm, sls_ordr_crt_by_nm, sls_ordr_modified_by_nm, on_hold_ind, on_hold_by_nm, on_hold_rsn_desc, \r\n    dscnt_pct, end_cust_nm, cust_ref_txt, dlvry_cust_nm, opco_sls_ordr_doc_status_sk, invoice_cust_sk, line_dscnt_cd, sls_ordr_phase_cd, trade_grp_cd,\r\n    trade_grp_nm, trade_grp_module_txt, trade_grp_type_txt, rcpt_cnfrm_dt, rcpt_rqst_dt, sls_taker_nm, opco_sls_ordr_type_sk, ship_cnfrm_dt, \r\n    ship_rqst_dt, titan_job_nbr, online_ordr_ind, spcl_instr_txt, tax_exempt_nbr, commsn_grp_id, commsn_grp_nm, last_acceptance_dt, fixed_due_dt, \r\n    backlog_cost_amt, backlog_sls_amt, bid_dt, print_invoice_ind, sls_lead_cd, cust_alt_nm, dsptch_locn_nm, equipment_type_txt\r\n    \r\n    from opco_sls_ordr\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_sls_ordr_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_sls_ordr"], "unique_id": "model.OI_Foundation.opco_sls_ordr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_sls_ordr.sql", "original_file_path": "models/foundation/sales_order/opco_sls_ordr.sql", "name": "opco_sls_ordr", "alias": "opco_sls_ordr", "checksum": {"name": "sha256", "checksum": "5d61168fa2ac1265f1348cf0b3ebcbfebd743ac5723980a545c93e7e88deb11c"}, "tags": [], "refs": [["v_opco_sls_ordr_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4362843}, "model.OI_Foundation.opco_sls_ordr_doc_status": {"raw_sql": "with opco_sls_ordr_doc_status as(\r\n    select *\r\n    from {{ ref('v_opco_sls_ordr_doc_status_lineage') }}\r\n)\r\n\r\nselect * from opco_sls_ordr_doc_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_sls_ordr_doc_status"], "unique_id": "model.OI_Foundation.opco_sls_ordr_doc_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_sls_ordr_doc_status.sql", "original_file_path": "models/foundation/sales_order/opco_sls_ordr_doc_status.sql", "name": "opco_sls_ordr_doc_status", "alias": "opco_sls_ordr_doc_status", "checksum": {"name": "sha256", "checksum": "c66a79bf132c257aee5b90da2540b7d993326efbee8a698f83acd536c977ab5a"}, "tags": [], "refs": [["v_opco_sls_ordr_doc_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4381921}, "model.OI_Foundation.opco_trans_status": {"raw_sql": "with opco_trans_status as(\r\n    select *\r\n    from {{ ref('v_opco_trans_status_lineage') }}\r\n)\r\n\r\nselect * from opco_trans_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_trans_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_trans_status"], "unique_id": "model.OI_Foundation.opco_trans_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_trans_status.sql", "original_file_path": "models/foundation/sales_order/opco_trans_status.sql", "name": "opco_trans_status", "alias": "opco_trans_status", "checksum": {"name": "sha256", "checksum": "13ef356be0d2e94e5fd1cad984a6fa794a06850929105b5d0028f70ac474366b"}, "tags": [], "refs": [["v_opco_trans_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4399557}, "model.OI_Foundation.opco_dlvry_terms": {"raw_sql": "with opco_dlvry_terms as(\r\n    select *,\r\n    rank() over(partition by opco_dlvry_terms_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_dlvry_terms_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_dlvry_terms_sk, opco_dlvry_terms_ck, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, src_dlvry_terms_cd, src_dlvry_terms_desc\r\n    from opco_dlvry_terms\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_dlvry_terms_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_dlvry_terms"], "unique_id": "model.OI_Foundation.opco_dlvry_terms", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_dlvry_terms.sql", "original_file_path": "models/foundation/sales_order/opco_dlvry_terms.sql", "name": "opco_dlvry_terms", "alias": "opco_dlvry_terms", "checksum": {"name": "sha256", "checksum": "cd78cd392849817a62b9ab671448f0de3e988db95353dc22498f0783a79f7a6e"}, "tags": [], "refs": [["v_opco_dlvry_terms_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4420848}, "model.OI_Foundation.sls_ordr_opco_locn_xref": {"raw_sql": "with sls_ordr_opco_locn_xref as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_sk, opco_locn_sk, sls_ordr_opco_locn_asscn_type_txt order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_sls_ordr_opco_locn_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sls_ordr_sk, opco_locn_sk, sls_ordr_opco_locn_asscn_type_txt, crt_dtm, stg_load_dtm, delete_dtm, contact_type_txt, contact_nm, contact_ph_nbr, contact_ph_extn_nbr,\r\n    contact_cell_nbr, contact_local_ph_nbr, contact_fax_nbr, contact_telex_nbr, contact_email_id, languate_txt, start_dt, end_dt\r\n    from sls_ordr_opco_locn_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "sls_ordr_opco_locn_xref"], "unique_id": "model.OI_Foundation.sls_ordr_opco_locn_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/sls_ordr_opco_locn_xref.sql", "original_file_path": "models/foundation/sales_order/sls_ordr_opco_locn_xref.sql", "name": "sls_ordr_opco_locn_xref", "alias": "sls_ordr_opco_locn_xref", "checksum": {"name": "sha256", "checksum": "32f43b98406a4504a1db1574439d6cad6a44e791f7044d507043e2bae793f8b2"}, "tags": [], "refs": [["v_sls_ordr_opco_locn_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4438577}, "model.OI_Foundation.opco_sls_ordr_line": {"raw_sql": "with opco_sls_ordr_line as(\r\n    select *,\r\n    rank() over(partition by opco_sls_ordr_line_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_sls_ordr_line_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_sls_ordr_line_sk, opco_sls_ordr_line_ck, opco_sls_ordr_line_ak CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, sls_ordr_id, sls_ordr_line_nbr, invtry_trans_id, opco_sk, opco_sls_ordr_sk, opco_item_sk, opco_cust_sk, trans_currency_sk,\r\n    opco_uom_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_assctn_sk, opco_trans_status_sk, opco_sls_ordr_type_sk,\r\n    opco_dlvry_mode_sk, line_blocked_ind, line_dlvry_complete_ind, item_nm, dlvry_type_txt, po_form_nbr, drawing_locn_txt, item_bom_id, dlvry_date_contrl_txt, \r\n    sls_ordr_line_crt_dtm, rqst_rcpt_dt, cnfrm_rcpt_dt, rqst_ship_dt, cnfrm_ship_dt, cnfrm_dlvry_dt, grp_nm, trans_ref_id, mrkt_cd, sls_ordr_dtl_id, phase_id, \r\n    priority_cd, risk_ind, spcl_item_ind, spcl_in_spcl_item_ind, spcl_item_id, titan_job_nbr, tax_grp_id, tax_item_grp_txt, sls_grp_txt, sales_unit_cd,\r\n    item_height_nbr, item_net_weight_amt, invtry_qty, ordr_qty, non_dlvrd_qty, non_invoiced_dlvrd_qty, sls_qty, sis_qty, unit_cost_price_amt, \r\n    unit_sls_price_amt, item_default_price_amt, item_online_price_amt, item_list_price_amt, item_cost_amt, total_sls_amt, fixed_misc_amt, imbedded_freight_amt,\r\n    imbedded_freight_cost_amt, overhead_cost_pct, line_dscnt_pct, engineering_hours_nbr, labor_hours_nbr\r\n\r\n\r\n    from opco_sls_ordr_line\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_sls_ordr_line_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_sls_ordr_line"], "unique_id": "model.OI_Foundation.opco_sls_ordr_line", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_sls_ordr_line.sql", "original_file_path": "models/foundation/sales_order/opco_sls_ordr_line.sql", "name": "opco_sls_ordr_line", "alias": "opco_sls_ordr_line", "checksum": {"name": "sha256", "checksum": "d94b2246f7b7fc8dd7f1131bd5940a3d740652874a9e0c0a7c590975d32b3585"}, "tags": [], "refs": [["v_opco_sls_ordr_line_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4456851}, "model.OI_Foundation.opco_dlvry_mode": {"raw_sql": "with opco_dlvry_mode as(\r\n    select *,\r\n    rank() over(partition by opco_dlvry_mode_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_dlvry_mode_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_dlvry_mode_sk, opco_dlvry_mode_ck, CRT_DTM, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, src_dlvry_mode_cd, src_dlvry_mode_desc\r\n    from opco_dlvry_mode\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_dlvry_mode_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_dlvry_mode"], "unique_id": "model.OI_Foundation.opco_dlvry_mode", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_dlvry_mode.sql", "original_file_path": "models/foundation/sales_order/opco_dlvry_mode.sql", "name": "opco_dlvry_mode", "alias": "opco_dlvry_mode", "checksum": {"name": "sha256", "checksum": "024d1d3bb7a51d70ea953cfbd6eb1bd0965ef46f7ac6f46f6df330b7c7b5bcf9"}, "tags": [], "refs": [["v_opco_dlvry_mode_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4475894}, "model.OI_Foundation.opco_sls_ordr_type": {"raw_sql": "with opco_sls_ordr_type as(\r\n    select *\r\n    from {{ ref('v_opco_sls_ordr_type_lineage') }}\r\n\r\n)\r\n\r\nselect * from opco_sls_ordr_type", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_sls_ordr_type_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "sales_order", "opco_sls_ordr_type"], "unique_id": "model.OI_Foundation.opco_sls_ordr_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/sales_order/opco_sls_ordr_type.sql", "original_file_path": "models/foundation/sales_order/opco_sls_ordr_type.sql", "name": "opco_sls_ordr_type", "alias": "opco_sls_ordr_type", "checksum": {"name": "sha256", "checksum": "93f7ff24414d7014a943d860470e9f23c7f7519366e20ec0ebe1238d069c22ab"}, "tags": [], "refs": [["v_opco_sls_ordr_type_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4493864}, "model.OI_Foundation.opco_project_cost_trans": {"raw_sql": "with opco_project_cost_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_cost_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_cost_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_PROJECT_COST_TRANS_sk, OPCO_PROJECT_COST_TRANS_ck, OPCO_PROJECT_COST_TRANS_ak, crt_dtm, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, project_cost_trans_id, opco_sk, opco_project_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_uom_sk, trans_currency_sk, opco_project_catgry_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_dt, trans_desc, cost_gl_status_txt, tax_grp_id, voucher_nbr, invoice_nbr, document_nbr, ref_trans_id, calculated_ind, trans_qty, trans_currency_cost_price_amt, opco_currency_cost_price_amt, opco_currency_sls_price_amt, opco_currency_gl_sls_amt, opco_currency_gl_cost_amt, opco_currency_item_price_amt, opco_currency_total_std_cost_amt, opco_currency_total_cost_amt, opco_currency_total_revenue_amt, opco_currency_sls_tax_amt, opco_currency_freight_amt, opco_currency_cash_dscnt_amt, margin_contribution_pct\r\n\r\n\r\n    from opco_project_cost_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_cost_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_cost_trans"], "unique_id": "model.OI_Foundation.opco_project_cost_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_cost_trans.sql", "original_file_path": "models/foundation/project/opco_project_cost_trans.sql", "name": "opco_project_cost_trans", "alias": "opco_project_cost_trans", "checksum": {"name": "sha256", "checksum": "f7214e46cf3fe05afd84304d6e0db36bf8e2dc68e4a37252bdfa8ebd24792731"}, "tags": [], "refs": [["v_opco_project_cost_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.451355}, "model.OI_Foundation.opco_project_item_trans": {"raw_sql": "with opco_project_item_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_item_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_item_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_item_trans_sk, opco_project_item_trans_ck, opco_project_item_trans_ak, crt_dtm, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, project_item_trans_id, invtry_trans_id, opco_project_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_uom_sk, opco_assctn_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_dt, trans_desc, line_property_id, tax_grp_id, tax_item_grp_id, packing_slip_voucher_nbr, cust_invoice_nbr, project_adjsmt_ref_id, ref_project_item_trans_id, calc_ind, project_cost_trans_conversion_ind, trans_qty, per_unit_sls_price_amt, item_price_amt, total_revenue_amt, total_cost_amt, total_std_cost_amt, margin_contribution_pct\r\n\r\n\r\n    from opco_project_item_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_item_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_item_trans"], "unique_id": "model.OI_Foundation.opco_project_item_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_item_trans.sql", "original_file_path": "models/foundation/project/opco_project_item_trans.sql", "name": "opco_project_item_trans", "alias": "opco_project_item_trans", "checksum": {"name": "sha256", "checksum": "ae9c9fa4e819e62d63cd4b42eb4cf71f88c54beeff9f6866c3d5e2d4fe48fd47"}, "tags": [], "refs": [["v_opco_project_item_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4532707}, "model.OI_Foundation.opco_project_cost_frcst": {"raw_sql": "with opco_project_cost_frcst as(\r\n    select *,\r\n    rank() over(partition by opco_project_cost_frcst_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_cost_frcst_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_project_cost_frcst_sK, OPCO_project_cost_frcst_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, opco_id, project_cost_frcst_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_currency_sk, opco_uom_sk, line_property_id, invoice_expctd_dt, budget_amt_applctn_dt, revenue_pymnt_expctd_dt, cost_pymnt_expctd_dt, elimination_expctd_dt, frcst_model_id, tax_grp_id, include_in_rpt_ind, lock_ind, include_amt_ind, trans_qty, opco_currency_cost_price_amt, trans_currency_sls_price_amt, total_revenue_amt, total_cost_amt, marging_contribution_pct\r\n\r\n\r\n    from opco_project_cost_frcst\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_cost_frcst_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_cost_frcst"], "unique_id": "model.OI_Foundation.opco_project_cost_frcst", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_cost_frcst.sql", "original_file_path": "models/foundation/project/opco_project_cost_frcst.sql", "name": "opco_project_cost_frcst", "alias": "opco_project_cost_frcst", "checksum": {"name": "sha256", "checksum": "43f9eab2ee067da5e6efe8a5fa7ba7cbefbc8093433b1ae307981bb00c788642"}, "tags": [], "refs": [["v_opco_project_cost_frcst_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4550707}, "model.OI_Foundation.opco_project_catgry": {"raw_sql": "with opco_project_catgry as(\r\n    select *,\r\n    rank() over(partition by opco_project_catgry_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_catgry_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_catgry_sk, opco_project_catgry_ck, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, opco_id, catgry_cd, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_uom_sk, catgry_nm, catgry_grp_cd, catgry_type_txt, empl_applicable_ind, actv_ind\r\n\r\n    from opco_project_catgry\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_catgry_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_catgry"], "unique_id": "model.OI_Foundation.opco_project_catgry", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_catgry.sql", "original_file_path": "models/foundation/project/opco_project_catgry.sql", "name": "opco_project_catgry", "alias": "opco_project_catgry", "checksum": {"name": "sha256", "checksum": "6c7d5844546d08f09e57015d2ac6fc0f2ced9f1d2e6b5205e999cb85f5f33796"}, "tags": [], "refs": [["v_opco_project_catgry_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.456897}, "model.OI_Foundation.opco_project_empl_trans": {"raw_sql": "with opco_project_empl_trans  as(\r\n    select *,\r\n    rank() over(partition by opco_project_empl_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_empl_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select\r\n    OPCO_PROJECT_EMPL_TRANS_sk, OPCO_PROJECT_EMPL_TRANS_ck, OPCO_PROJECT_EMPL_TRANS_ak, crt_dtm, stg_load_dtm, delete_dtm,\r\n    src_sys_nm, opco_id, project_empl_trans_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, opco_project_trans_status_sk, opco_project_trans_origin_sk, trans_currency_sk, empl_id, line_property_id, ref_project_empl_trans_id, tax_grp_id, trans_dt, gl_voucher_nbr, gl_section_txt, project_empl_trans_desc, calc_ind, trans_hour_qty, opco_currency_hrly_cost_price_amt , trans_currency_hrly_sls_price_amt, item_price_amt, total_revenue_amt, total_cost_amt, total_std_cost_amt, margin_contribution_pct\r\n    \r\n    from opco_project_empl_trans \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_empl_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_empl_trans"], "unique_id": "model.OI_Foundation.opco_project_empl_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_empl_trans.sql", "original_file_path": "models/foundation/project/opco_project_empl_trans.sql", "name": "opco_project_empl_trans", "alias": "opco_project_empl_trans", "checksum": {"name": "sha256", "checksum": "8603567826bd8518eeb2113b892c931e907e6f7ccd08279157297849ac70cf14"}, "tags": [], "refs": [["v_opco_project_empl_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.458781}, "model.OI_Foundation.opco_project_revenue_trans": {"raw_sql": "with opco_project_revenue_trans as(\r\n    select *,\r\n    rank() over(partition by opco_project_revenue_trans_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_revenue_trans_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_revenue_trans_sk, OPCO_PROJECT_REVENUE_TRANS_ck, OPCO_PROJECT_REVENUE_TRANS_AK, crt_dtm, stg_load_dtm, DELETE_DTM, \r\n    src_sys_nm, src_key_txt, opco_project_sk, opco_sk, chg_nbr, project_revenue_trans_type_cd, project_revenue_trans_desc, trans_dt, apprvd_ind, project_revenue_trans_amt\r\n\r\n\r\n    from opco_project_revenue_trans\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_revenue_trans_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_revenue_trans"], "unique_id": "model.OI_Foundation.opco_project_revenue_trans", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_revenue_trans.sql", "original_file_path": "models/foundation/project/opco_project_revenue_trans.sql", "name": "opco_project_revenue_trans", "alias": "opco_project_revenue_trans", "checksum": {"name": "sha256", "checksum": "458fcbabd87c069dc8495d5498bfe966eabf336010c18a15ed8e7b51a7870015"}, "tags": [], "refs": [["v_opco_project_revenue_trans_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4605963}, "model.OI_Foundation.opco_project": {"raw_sql": "with opco_project as(\r\n    select *,\r\n    rank() over(partition by opco_project_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    OPCO_project_SK, OPCO_project_CK, CRT_DTM, STG_LOAD_DTM, DELETE_DTM, src_sys_nm, opco_id, project_id, opco_sk, opco_cust_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_pymnt_terms_sk, dlvry_locn_sk, project_nm, project_status_txt, project_type_txt, project_crt_dt, project_start_dt, project_end_dt, estimated_start_dt, estimated_end_dt, actual_start_dt, actual_end_dt, estimator_nm, project_mgr_nm, gl_posting_ind, sort_1_id, sort_2_id, sort_3_id, sls_grp_txt, tax_grp_id, locn_1_txt, locn_2_txt, retention_terms_txt, retention_due_dt, use_tax_ind\r\n\r\n    from opco_project\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project"], "unique_id": "model.OI_Foundation.opco_project", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project.sql", "original_file_path": "models/foundation/project/opco_project.sql", "name": "opco_project", "alias": "opco_project", "checksum": {"name": "sha256", "checksum": "94965d5a26578d4da3eafaa53941421ec1cf7929860aca79bd7b50385f383074"}, "tags": [], "refs": [["v_opco_project_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4626737}, "model.OI_Foundation.opco_project_trans_origin": {"raw_sql": "with opco_project_trans_origin as(\r\n    select *\r\n    from {{ ref('v_opco_project_trans_origin_lineage') }}\r\n\r\n)\r\n\r\nselect * from opco_project_trans_origin", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_trans_origin_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_trans_origin"], "unique_id": "model.OI_Foundation.opco_project_trans_origin", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_trans_origin.sql", "original_file_path": "models/foundation/project/opco_project_trans_origin.sql", "name": "opco_project_trans_origin", "alias": "opco_project_trans_origin", "checksum": {"name": "sha256", "checksum": "95fe7688da3cc1e06b79cc180ee431e8948a28ed692700c9c0c085a41371a528"}, "tags": [], "refs": [["v_opco_project_trans_origin_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4645176}, "model.OI_Foundation.opco_project_empl_frcst": {"raw_sql": "with opco_project_empl_frcst as(\r\n    select *,\r\n    rank() over(partition by opco_project_empl_frcst_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_empl_frcst_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_empl_frcst_sk, opco_project_empl_frcst_ck, opco_project_empl_frcst_ak, crt_dtm, STG_LOAD_DTM, DELETE_DTM,\r\n    src_sys_nm, opco_id, project_empl_frcst_id, opco_project_sk, opco_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, trans_currency_sk, opco_uom_sk, line_nbr, line_property_id, empl_id, model_id, tax_grp_id, include_amt_ind, lock_ind, sched_link_type_txt, sched_link_txt, sched_from_dt, sched_worktime_ind, sched_capacity_ind, revenue_pymnt_expctd_dt, cost_pymnt_expctd_dt, invoice_expctd_dt, eliminatin_expctd_dt, trans_hours_qty, sched_load_pct, trans_currency_cost_price_amt, trans_currency_sls_price_amt, total_revenue_amt, total_cost_amt, margin_contribution_pct\r\n\r\n\r\n    from opco_project_empl_frcst\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_empl_frcst_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_empl_frcst"], "unique_id": "model.OI_Foundation.opco_project_empl_frcst", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_empl_frcst.sql", "original_file_path": "models/foundation/project/opco_project_empl_frcst.sql", "name": "opco_project_empl_frcst", "alias": "opco_project_empl_frcst", "checksum": {"name": "sha256", "checksum": "84b93a9f198d5e19e0420701104e608e63b8b6bee3b8c7fd4c2c3e0efc9d491e"}, "tags": [], "refs": [["v_opco_project_empl_frcst_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4663086}, "model.OI_Foundation.opco_project_invoice_project_xref": {"raw_sql": "with opco_project_invoice_project_xref  as(\r\n    select *,\r\n    rank() over(partition by opco_project_sk, invoice_project_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_invoice_project_xref_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_sk, invoice_project_sk, crt_dtm, stg_load_dtm, delete_dtm, src_sys_nm, opco_id, invoice_project_id\r\n    from opco_project_invoice_project_xref\r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_invoice_project_xref_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_invoice_project_xref"], "unique_id": "model.OI_Foundation.opco_project_invoice_project_xref", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_invoice_project_xref.sql", "original_file_path": "models/foundation/project/opco_project_invoice_project_xref.sql", "name": "opco_project_invoice_project_xref", "alias": "opco_project_invoice_project_xref", "checksum": {"name": "sha256", "checksum": "f7eb5ab4fb387000d0f9dcf2814807f4647bfebd8b430f891a8674f7e83ec9c8"}, "tags": [], "refs": [["v_opco_project_invoice_project_xref_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.4682267}, "model.OI_Foundation.opco_project_trans_posting": {"raw_sql": "with opco_project_trans_posting  as(\r\n    select *,\r\n    rank() over(partition by opco_project_trans_posting_sk order by stg_load_dtm desc, delete_dtm desc) as rnk\r\n    from {{ ref('v_opco_project_trans_posting_lineage') }}\r\n),\r\nfinal as(\r\n    select \r\n    opco_project_trans_posting_sk, opco_project_trans_posting_ck,opco_project_trans_posting_AK ,crt_dtm, DELETE_DTM, \r\n    src_sys_nm, opco_id, src_key_txt, opco_project_sk, opco_sk, opco_item_sk, opco_cost_center_sk, opco_dept_sk, opco_type_sk, opco_purpose_sk, opco_lob_sk, opco_project_catgry_sk, opco_project_trans_origin_sk, opco_gl_trans_origin_sk, opco_gl_trans_posting_type_sk, opco_gl_acct_sk, project_trans_posting_id, gl_trans_dt, voucher_nbr, project_trans_dt, project_trans_type_txt, project_type_txt, project_cost_or_sls_txt, project_adjstmt_ref_id, pymnt_dt, pymnt_status_txt, invtry_trans_id, empl_id, trans_qty, opco_currency_trans_amt\r\n\r\n\r\n    from opco_project_trans_posting \r\n    where rnk = 1 and delete_dtm is null\r\n)\r\n\r\nselect * from final", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_trans_posting_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_trans_posting"], "unique_id": "model.OI_Foundation.opco_project_trans_posting", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_trans_posting.sql", "original_file_path": "models/foundation/project/opco_project_trans_posting.sql", "name": "opco_project_trans_posting", "alias": "opco_project_trans_posting", "checksum": {"name": "sha256", "checksum": "48782be50ba77daf1dc52857ea546f39aa6cfdb353f44f38920f54ac5b01bcaf"}, "tags": [], "refs": [["v_opco_project_trans_posting_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.47001}, "model.OI_Foundation.opco_project_trans_status": {"raw_sql": "with opco_project_trans_status as(\r\n    select *\r\n    from {{ ref('v_opco_project_trans_status_lineage') }}\r\n)\r\n\r\nselect * from opco_project_trans_status", "resource_type": "model", "depends_on": {"macros": [], "nodes": ["model.OI_Foundation.v_opco_project_trans_status_lineage"]}, "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "materialized": "table", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "transient": false, "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "FND_DEV_BKP", "fqn": ["OI_Foundation", "foundation", "project", "opco_project_trans_status"], "unique_id": "model.OI_Foundation.opco_project_trans_status", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "foundation/project/opco_project_trans_status.sql", "original_file_path": "models/foundation/project/opco_project_trans_status.sql", "name": "opco_project_trans_status", "alias": "opco_project_trans_status", "checksum": {"name": "sha256", "checksum": "49f6bc71c0d9fd3fc0e74e7902cd73aae2bae6d319e527b62a8807760801a7e5"}, "tags": [], "refs": [["v_opco_project_trans_status_lineage"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"materialized": "table", "transient": false}, "created_at": 1659086795.472319}, "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage": {"raw_sql": "with v_opco_fscl_yr_gl_opening_bal as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_fscl_yr_gl_opening_bal'), ref('ns_opco_fscl_yr_gl_opening_bal'), ref('jde_opco_fscl_yr_gl_opening_bal'), ref('primex_opco_fscl_yr_gl_opening_bal')])}}\r\n)\r\n\r\nselect * from v_opco_fscl_yr_gl_opening_bal", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_fscl_yr_gl_opening_bal_lineage"], "unique_id": "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_fscl_yr_gl_opening_bal_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_fscl_yr_gl_opening_bal_lineage.sql", "name": "v_opco_fscl_yr_gl_opening_bal_lineage", "alias": "v_opco_fscl_yr_gl_opening_bal_lineage", "checksum": {"name": "sha256", "checksum": "7b9fd8e54b8d265a42ba2a5f6941cce59b7eefb39c3c4f10482683c211728726"}, "tags": [], "refs": [["ax_opco_fscl_yr_gl_opening_bal"], ["ns_opco_fscl_yr_gl_opening_bal"], ["jde_opco_fscl_yr_gl_opening_bal"], ["primex_opco_fscl_yr_gl_opening_bal"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.4741943}, "model.OI_Foundation.v_opco_sub_ledger_type_lineage": {"raw_sql": "with v_opco_sub_ledger_type as(\r\n    {{ union_relations(\r\n        relations=[ref('jde_opco_sub_ledger_type'), ref('primex_opco_sub_ledger_type')])}}\r\n)\r\n\r\nselect * from v_opco_sub_ledger_type", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.jde_opco_sub_ledger_type", "model.OI_Foundation.primex_opco_sub_ledger_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_sub_ledger_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_sub_ledger_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_sub_ledger_type_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_sub_ledger_type_lineage.sql", "name": "v_opco_sub_ledger_type_lineage", "alias": "v_opco_sub_ledger_type_lineage", "checksum": {"name": "sha256", "checksum": "3f15ea46e7163e78eff6d301f8d6811ceb7e4a11e01116727721d41ccb176733"}, "tags": [], "refs": [["jde_opco_sub_ledger_type"], ["primex_opco_sub_ledger_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.4968848}, "model.OI_Foundation.v_opco_gl_trans_type_lineage": {"raw_sql": "with v_opco_gl_trans_type as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_gl_trans_type'), ref('ns_opco_gl_trans_type'), ref('jde_opco_gl_trans_type'), ref('primex_opco_gl_trans_type')])}}\r\n)\r\n\r\nselect * from v_opco_gl_trans_type", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_gl_trans_type", "model.OI_Foundation.ns_opco_gl_trans_type", "model.OI_Foundation.jde_opco_gl_trans_type", "model.OI_Foundation.primex_opco_gl_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_gl_trans_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_gl_trans_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_gl_trans_type_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_gl_trans_type_lineage.sql", "name": "v_opco_gl_trans_type_lineage", "alias": "v_opco_gl_trans_type_lineage", "checksum": {"name": "sha256", "checksum": "f07464ae98fb5736015f619670591151de65ad85aeac836bdf8e7f5b416a78d2"}, "tags": [], "refs": [["ax_opco_gl_trans_type"], ["ns_opco_gl_trans_type"], ["jde_opco_gl_trans_type"], ["primex_opco_gl_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.501463}, "model.OI_Foundation.v_opco_chart_of_accts_lineage": {"raw_sql": "with v_opco_chart_of_accts as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_chart_of_accts'), ref('ns_opco_chart_of_accts'), ref('jde_opco_chart_of_accts'), ref('primex_opco_chart_of_accts')])}}\r\n)\r\n\r\nselect * from v_opco_chart_of_accts", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.jde_opco_chart_of_accts", "model.OI_Foundation.primex_opco_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_chart_of_accts_lineage"], "unique_id": "model.OI_Foundation.v_opco_chart_of_accts_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_chart_of_accts_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_chart_of_accts_lineage.sql", "name": "v_opco_chart_of_accts_lineage", "alias": "v_opco_chart_of_accts_lineage", "checksum": {"name": "sha256", "checksum": "5026149e5a3787e0e398e5afed6eca709ec35aca4d74629dffd3255532455fe8"}, "tags": [], "refs": [["ax_opco_chart_of_accts"], ["ns_opco_chart_of_accts"], ["jde_opco_chart_of_accts"], ["primex_opco_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5063221}, "model.OI_Foundation.v_chart_of_accts_lineage": {"raw_sql": "with v_chart_of_accts as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_chart_of_accts')])}}\r\n)\r\n\r\nselect * from v_chart_of_accts", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_chart_of_accts"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_chart_of_accts_lineage"], "unique_id": "model.OI_Foundation.v_chart_of_accts_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_chart_of_accts_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_chart_of_accts_lineage.sql", "name": "v_chart_of_accts_lineage", "alias": "v_chart_of_accts_lineage", "checksum": {"name": "sha256", "checksum": "0aaef574008abb157854950768522e50de5a0d440bb0d0eb094f46c1f4c9db21"}, "tags": [], "refs": [["ax_chart_of_accts"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.511182}, "model.OI_Foundation.v_opco_gl_trans_lineage": {"raw_sql": "with v_opco_gl_trans as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_gl_trans'), ref('ns_opco_gl_trans'), ref('jde_opco_gl_trans'), ref('primex_opco_gl_trans')])}}\r\n)\r\n\r\nselect * from v_opco_gl_trans", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ns_opco_gl_trans", "model.OI_Foundation.jde_opco_gl_trans", "model.OI_Foundation.primex_opco_gl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_gl_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_gl_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_gl_trans_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_gl_trans_lineage.sql", "name": "v_opco_gl_trans_lineage", "alias": "v_opco_gl_trans_lineage", "checksum": {"name": "sha256", "checksum": "2c38cc4feb89760bb6e6b2e4a8df28b955bc6290bf6030c339ee6f690b75b2a2"}, "tags": [], "refs": [["ax_opco_gl_trans"], ["ns_opco_gl_trans"], ["jde_opco_gl_trans"], ["primex_opco_gl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5153353}, "model.OI_Foundation.v_opco_gl_trans_posting_type_lineage": {"raw_sql": "with v_opco_gl_trans_posting_type as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_gl_trans_posting_type')])}}\r\n)\r\n\r\nselect * from v_opco_gl_trans_posting_type", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_gl_trans_posting_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_gl_trans_posting_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_gl_trans_posting_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_gl_trans_posting_type_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_gl_trans_posting_type_lineage.sql", "name": "v_opco_gl_trans_posting_type_lineage", "alias": "v_opco_gl_trans_posting_type_lineage", "checksum": {"name": "sha256", "checksum": "59a29f9cb54384d24557a879a8de4966c169f41f5a7d65f0150d3c6c09d4666a"}, "tags": [], "refs": [["ax_opco_gl_trans_posting_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5202494}, "model.OI_Foundation.v_opco_chart_of_accts_type_lineage": {"raw_sql": "with v_opco_chart_of_accts_type as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_chart_of_accts_type'), ref('ns_opco_chart_of_accts_type'), ref('primex_opco_chart_of_accts_type')])}}\r\n)\r\n\r\nselect * from v_opco_chart_of_accts_type", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_chart_of_accts_type", "model.OI_Foundation.ns_opco_chart_of_accts_type", "model.OI_Foundation.primex_opco_chart_of_accts_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "general_ledger", "v_opco_chart_of_accts_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_chart_of_accts_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/general_ledger/v_opco_chart_of_accts_type_lineage.sql", "original_file_path": "models/historical_views/general_ledger/v_opco_chart_of_accts_type_lineage.sql", "name": "v_opco_chart_of_accts_type_lineage", "alias": "v_opco_chart_of_accts_type_lineage", "checksum": {"name": "sha256", "checksum": "0e6d4cdb1416687890b061f464923ae47b55135499b94497f7f1c71375266ea6"}, "tags": [], "refs": [["ax_opco_chart_of_accts_type"], ["ns_opco_chart_of_accts_type"], ["primex_opco_chart_of_accts_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5251837}, "model.OI_Foundation.v_opco_cust_packing_slip_line_lineage": {"raw_sql": "with v_opco_cust_packing_slip_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_packing_slip_line')])}}\r\n)\r\n\r\nselect * from v_opco_cust_packing_slip_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_packing_slip_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_packing_slip_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_packing_slip_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_packing_slip_line_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_packing_slip_line_lineage.sql", "name": "v_opco_cust_packing_slip_line_lineage", "alias": "v_opco_cust_packing_slip_line_lineage", "checksum": {"name": "sha256", "checksum": "aff246656e9641766f72de4d08e86610928e5b2ca8dfc6445921c79da9d4f7e7"}, "tags": [], "refs": [["ax_opco_cust_packing_slip_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5298464}, "model.OI_Foundation.v_opco_cust_code_lineage": {"raw_sql": "with v_opco_cust_code_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_code')])}}\r\n)\r\n\r\nselect * from v_opco_cust_code_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_code"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_code_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_code_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_code_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_code_lineage.sql", "name": "v_opco_cust_code_lineage", "alias": "v_opco_cust_code_lineage", "checksum": {"name": "sha256", "checksum": "6f482ccbe408d76c923ff8555f1866d50db4055a285ae5b5d9d40de7c99a4187"}, "tags": [], "refs": [["ax_opco_cust_code"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.534106}, "model.OI_Foundation.v_opco_invtry_ref_type_lineage": {"raw_sql": "with v_opco_invtry_ref_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_invtry_ref_type')])}}\r\n)\r\n\r\nselect * from v_opco_invtry_ref_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_invtry_ref_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_invtry_ref_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_invtry_ref_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_invtry_ref_type_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_invtry_ref_type_lineage.sql", "name": "v_opco_invtry_ref_type_lineage", "alias": "v_opco_invtry_ref_type_lineage", "checksum": {"name": "sha256", "checksum": "d0ed100e905cebf03e1bbdb69f2cf9d13f675758589e34c413a811014af7d9d1"}, "tags": [], "refs": [["ax_opco_invtry_ref_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5383093}, "model.OI_Foundation.v_opco_commsn_grp_lineage": {"raw_sql": "with v_opco_commsn_grp_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_commsn_grp')])}}\r\n)\r\n\r\nselect * from v_opco_commsn_grp_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_commsn_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_commsn_grp_lineage"], "unique_id": "model.OI_Foundation.v_opco_commsn_grp_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_commsn_grp_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_commsn_grp_lineage.sql", "name": "v_opco_commsn_grp_lineage", "alias": "v_opco_commsn_grp_lineage", "checksum": {"name": "sha256", "checksum": "40dce013c0fa62b2c6b21136e7841bad91eea88f84c0ea9668ef43ccf0bf313d"}, "tags": [], "refs": [["ax_opco_commsn_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.54258}, "model.OI_Foundation.v_opco_cust_invoice_lineage": {"raw_sql": "with v_opco_cust_invoice_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_invoice')])}}\r\n)\r\n\r\nselect * from v_opco_cust_invoice_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_invoice"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_invoice_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_invoice_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_invoice_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_invoice_lineage.sql", "name": "v_opco_cust_invoice_lineage", "alias": "v_opco_cust_invoice_lineage", "checksum": {"name": "sha256", "checksum": "12de62a77bb6cb36f486ece4455fe2ceeb9fce67fc98682a4cfe3e494f6b0f59"}, "tags": [], "refs": [["ax_opco_cust_invoice"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5469263}, "model.OI_Foundation.v_opco_currency_lineage": {"raw_sql": "with v_opco_currency as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_currency'), ref('ns_opco_currency'), ref('jde_opco_currency'), ref('primex_opco_currency')])}}\r\n)\r\n\r\nselect * from v_opco_currency", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_currency", "model.OI_Foundation.ns_opco_currency", "model.OI_Foundation.jde_opco_currency", "model.OI_Foundation.primex_opco_currency"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_currency_lineage"], "unique_id": "model.OI_Foundation.v_opco_currency_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_currency_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_currency_lineage.sql", "name": "v_opco_currency_lineage", "alias": "v_opco_currency_lineage", "checksum": {"name": "sha256", "checksum": "2d45a17f1b7a6c0fa83e9fcea07b9655e6b48f805a139740d8c48036cf817d15"}, "tags": [], "refs": [["ax_opco_currency"], ["ns_opco_currency"], ["jde_opco_currency"], ["primex_opco_currency"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5511746}, "model.OI_Foundation.v_opco_opco_cust_xref_lineage": {"raw_sql": "with v_opco_opco_cust_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_opco_cust_xref')])}}\r\n)\r\n\r\nselect * from v_opco_opco_cust_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_opco_cust_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_opco_cust_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_opco_cust_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_opco_cust_xref_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_opco_cust_xref_lineage.sql", "name": "v_opco_opco_cust_xref_lineage", "alias": "v_opco_opco_cust_xref_lineage", "checksum": {"name": "sha256", "checksum": "e00917820f2446b98ae6a3eb5e2a69aa156419e6f78d68199b093d6ce8d767cd"}, "tags": [], "refs": [["ax_opco_opco_cust_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5567362}, "model.OI_Foundation.v_opco_cust_lineage": {"raw_sql": "with v_opco_cust_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust')])}}\r\n)\r\n\r\nselect * from v_opco_cust_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_lineage.sql", "name": "v_opco_cust_lineage", "alias": "v_opco_cust_lineage", "checksum": {"name": "sha256", "checksum": "0a4c2ace92feb1f89e35da4d62f94978b1eebca87d9e25fd848ec551adeaa7e2"}, "tags": [], "refs": [["ax_opco_cust"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.561082}, "model.OI_Foundation.v_opco_cust_open_trans_lineage": {"raw_sql": "with v_opco_cust_open_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_open_trans')])}}\r\n)\r\n\r\nselect * from v_opco_cust_open_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_open_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_open_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_open_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_open_trans_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_open_trans_lineage.sql", "name": "v_opco_cust_open_trans_lineage", "alias": "v_opco_cust_open_trans_lineage", "checksum": {"name": "sha256", "checksum": "ea9a9813d53740f40353187bfc2a93dc057b430cc6ea06ca1157c9879389bcb4"}, "tags": [], "refs": [["ax_opco_cust_open_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5652664}, "model.OI_Foundation.v_opco_cust_grp_lineage": {"raw_sql": "with v_opco_cust_grp_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_grp')])}}\r\n)\r\n\r\nselect * from v_opco_cust_grp_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_grp_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_grp_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_grp_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_grp_lineage.sql", "name": "v_opco_cust_grp_lineage", "alias": "v_opco_cust_grp_lineage", "checksum": {"name": "sha256", "checksum": "e9f73741a3499828dd544726d8efd49fe679d3f36e2a48ee96160237e6429661"}, "tags": [], "refs": [["ax_opco_cust_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.569459}, "model.OI_Foundation.v_opco_cust_settled_trans_lineage": {"raw_sql": "with v_opco_cust_settled_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_settled_trans')])}}\r\n)\r\n\r\nselect * from v_opco_cust_settled_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_settled_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_settled_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_settled_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_settled_trans_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_settled_trans_lineage.sql", "name": "v_opco_cust_settled_trans_lineage", "alias": "v_opco_cust_settled_trans_lineage", "checksum": {"name": "sha256", "checksum": "48bdcfd69b91642d9a25b559b155314cf1d169355dc955ae6ece0a1d3c591df7"}, "tags": [], "refs": [["ax_opco_cust_settled_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5738204}, "model.OI_Foundation.v_opco_cust_packing_slip_lineage": {"raw_sql": "with v_opco_cust_packing_slip_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_packing_slip')])}}\r\n)\r\n\r\nselect * from v_opco_cust_packing_slip_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_packing_slip"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_packing_slip_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_packing_slip_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_packing_slip_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_packing_slip_lineage.sql", "name": "v_opco_cust_packing_slip_lineage", "alias": "v_opco_cust_packing_slip_lineage", "checksum": {"name": "sha256", "checksum": "878b70fb31b526c7fdd1d1c3143d1e2816d9340c8f0326ccc8e70e922da0dc57"}, "tags": [], "refs": [["ax_opco_cust_packing_slip"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5780346}, "model.OI_Foundation.v_opco_cust_invoice_line_lineage": {"raw_sql": "with v_opco_cust_invoice_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_invoice_line')])}}\r\n)\r\n\r\nselect * from v_opco_cust_invoice_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_invoice_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_invoice_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_invoice_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_invoice_line_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_invoice_line_lineage.sql", "name": "v_opco_cust_invoice_line_lineage", "alias": "v_opco_cust_invoice_line_lineage", "checksum": {"name": "sha256", "checksum": "ac6cbd6d0a7831d3b09b96984d9b908a7e42875a412cb228e3fb4f45304d2034"}, "tags": [], "refs": [["ax_opco_cust_invoice_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.58234}, "model.OI_Foundation.v_opco_pymnt_terms_lineage": {"raw_sql": "with v_opco_pymnt_terms_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_pymnt_terms'),ref('ns_opco_pymnt_terms')])}}\r\n)\r\n\r\nselect * from v_opco_pymnt_terms_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_pymnt_terms", "model.OI_Foundation.ns_opco_pymnt_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_pymnt_terms_lineage"], "unique_id": "model.OI_Foundation.v_opco_pymnt_terms_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_pymnt_terms_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_pymnt_terms_lineage.sql", "name": "v_opco_pymnt_terms_lineage", "alias": "v_opco_pymnt_terms_lineage", "checksum": {"name": "sha256", "checksum": "d1d0050c91b38471b2affee8467f0804aeb5a291a14d0b27f0d534b18d77836f"}, "tags": [], "refs": [["ax_opco_pymnt_terms"], ["ns_opco_pymnt_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5875447}, "model.OI_Foundation.v_opco_cust_trans_lineage": {"raw_sql": "with v_opco_cust_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_trans')])}}\r\n)\r\n\r\nselect * from v_opco_cust_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_trans_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_trans_lineage.sql", "name": "v_opco_cust_trans_lineage", "alias": "v_opco_cust_trans_lineage", "checksum": {"name": "sha256", "checksum": "d43924ede03f7a51512d65b74d8f71c72eff8ca31ac306e1258a5224fb55c009"}, "tags": [], "refs": [["ax_opco_cust_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5919623}, "model.OI_Foundation.v_opco_pymnt_mode_lineage": {"raw_sql": "with v_opco_pymnt_mode_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_pymnt_mode'),ref('ns_opco_pymnt_mode')])}}\r\n)\r\n\r\nselect * from v_opco_pymnt_mode_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_pymnt_mode", "model.OI_Foundation.ns_opco_pymnt_mode"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_pymnt_mode_lineage"], "unique_id": "model.OI_Foundation.v_opco_pymnt_mode_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_pymnt_mode_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_pymnt_mode_lineage.sql", "name": "v_opco_pymnt_mode_lineage", "alias": "v_opco_pymnt_mode_lineage", "checksum": {"name": "sha256", "checksum": "e496521233d51a868898198f2f9dc40edae7fcf046f8607715ed69dcfd2e49dc"}, "tags": [], "refs": [["ax_opco_pymnt_mode"], ["ns_opco_pymnt_mode"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.5963087}, "model.OI_Foundation.v_opco_cash_dscnt_terms_lineage": {"raw_sql": "with v_opco_cash_dscnt_terms_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cash_dscnt_terms')])}}\r\n)\r\n\r\nselect * from v_opco_cash_dscnt_terms_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cash_dscnt_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cash_dscnt_terms_lineage"], "unique_id": "model.OI_Foundation.v_opco_cash_dscnt_terms_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cash_dscnt_terms_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cash_dscnt_terms_lineage.sql", "name": "v_opco_cash_dscnt_terms_lineage", "alias": "v_opco_cash_dscnt_terms_lineage", "checksum": {"name": "sha256", "checksum": "ead95ce9b63c618c27fe9e68053891b1375019eb477a0e85e25dd9f3377d1bc0"}, "tags": [], "refs": [["ax_opco_cash_dscnt_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6007407}, "model.OI_Foundation.v_opco_picking_list_lineage": {"raw_sql": "with v_opco_picking_list_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_picking_list')])}}\r\n)\r\n\r\nselect * from v_opco_picking_list_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_picking_list"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_picking_list_lineage"], "unique_id": "model.OI_Foundation.v_opco_picking_list_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_picking_list_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_picking_list_lineage.sql", "name": "v_opco_picking_list_lineage", "alias": "v_opco_picking_list_lineage", "checksum": {"name": "sha256", "checksum": "17c768f5c0350f5f423f14aa0fa2e04d33527b9404ca00ebe4ac74bdb3a7a24b"}, "tags": [], "refs": [["ax_opco_picking_list"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.604902}, "model.OI_Foundation.v_opco_cust_type_lineage": {"raw_sql": "with v_opco_cust_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_type')])}}\r\n)\r\n\r\nselect * from v_opco_cust_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_cust_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_cust_type_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_cust_type_lineage.sql", "name": "v_opco_cust_type_lineage", "alias": "v_opco_cust_type_lineage", "checksum": {"name": "sha256", "checksum": "2bdaf4f993a8197f1df27411ea8b4abc316714bbc1ac71b87ec9d45094984c4a"}, "tags": [], "refs": [["ax_opco_cust_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6091864}, "model.OI_Foundation.v_opco_handling_status_lineage": {"raw_sql": "with v_opco_handling_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_handling_status')])}}\r\n)\r\n\r\nselect * from v_opco_handling_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_handling_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "customer", "v_opco_handling_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_handling_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/customer/v_opco_handling_status_lineage.sql", "original_file_path": "models/historical_views/customer/v_opco_handling_status_lineage.sql", "name": "v_opco_handling_status_lineage", "alias": "v_opco_handling_status_lineage", "checksum": {"name": "sha256", "checksum": "82f20c6321112a02e063fd241e668524e72e49cd5352b2a53034377c65734daa"}, "tags": [], "refs": [["ax_opco_handling_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6135805}, "model.OI_Foundation.v_opco_po_lineage": {"raw_sql": "with v_opco_po_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_po')])}}\r\n)\r\n\r\nselect * from v_opco_po_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_po"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "purchase_order", "v_opco_po_lineage"], "unique_id": "model.OI_Foundation.v_opco_po_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/purchase_order/v_opco_po_lineage.sql", "original_file_path": "models/historical_views/purchase_order/v_opco_po_lineage.sql", "name": "v_opco_po_lineage", "alias": "v_opco_po_lineage", "checksum": {"name": "sha256", "checksum": "bc9f0d780abcdca8651b3809e46797b7ef1d6b308a148c746ba333c0d93271e9"}, "tags": [], "refs": [["ax_opco_po"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6177716}, "model.OI_Foundation.v_opco_po_doc_status_lineage": {"raw_sql": "with v_opco_po_doc_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_po_doc_status')])}}\r\n)\r\n\r\nselect * from v_opco_po_doc_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_po_doc_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "purchase_order", "v_opco_po_doc_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_po_doc_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/purchase_order/v_opco_po_doc_status_lineage.sql", "original_file_path": "models/historical_views/purchase_order/v_opco_po_doc_status_lineage.sql", "name": "v_opco_po_doc_status_lineage", "alias": "v_opco_po_doc_status_lineage", "checksum": {"name": "sha256", "checksum": "10bf656f06c15b19a1893f84bfafb7f2e942b2f9294b7dfdd62f650ae42c99ad"}, "tags": [], "refs": [["ax_opco_po_doc_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6227665}, "model.OI_Foundation.v_opco_po_line_lineage": {"raw_sql": "with v_opco_po_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_po_line')])}}\r\n)\r\n\r\nselect * from v_opco_po_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_po_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "purchase_order", "v_opco_po_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_po_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/purchase_order/v_opco_po_line_lineage.sql", "original_file_path": "models/historical_views/purchase_order/v_opco_po_line_lineage.sql", "name": "v_opco_po_line_lineage", "alias": "v_opco_po_line_lineage", "checksum": {"name": "sha256", "checksum": "579d0cde61018bf7a228aa2e6982881de99cc3182d39df525702f9fe68de310b"}, "tags": [], "refs": [["ax_opco_po_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6271544}, "model.OI_Foundation.v_opco_po_type_lineage": {"raw_sql": "with v_opco_po_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_po_type')])}}\r\n)\r\n\r\nselect * from v_opco_po_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_po_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "purchase_order", "v_opco_po_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_po_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/purchase_order/v_opco_po_type_lineage.sql", "original_file_path": "models/historical_views/purchase_order/v_opco_po_type_lineage.sql", "name": "v_opco_po_type_lineage", "alias": "v_opco_po_type_lineage", "checksum": {"name": "sha256", "checksum": "c9180eda423239a3a6882fae432c9bfcdeecf77ce6089c1500bf989b4f57fd49"}, "tags": [], "refs": [["ax_opco_po_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.631224}, "model.OI_Foundation.v_opco_vendor_invoice_line_lineage": {"raw_sql": "with v_opco_vendor_invoice_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_invoice_line')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_invoice_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_invoice_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "vendor", "v_opco_vendor_invoice_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_invoice_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/vendor/v_opco_vendor_invoice_line_lineage.sql", "original_file_path": "models/historical_views/vendor/v_opco_vendor_invoice_line_lineage.sql", "name": "v_opco_vendor_invoice_line_lineage", "alias": "v_opco_vendor_invoice_line_lineage", "checksum": {"name": "sha256", "checksum": "317156dff18f2774763868a9ca3a29b06f430dac6576dd71a2b340f88416f098"}, "tags": [], "refs": [["ax_opco_vendor_invoice_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6355217}, "model.OI_Foundation.v_opco_vendor_packing_slip_lineage": {"raw_sql": "with v_opco_vendor_packing_slip_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_packing_slip')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_packing_slip_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_packing_slip"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "vendor", "v_opco_vendor_packing_slip_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_packing_slip_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/vendor/v_opco_vendor_packing_slip_lineage.sql", "original_file_path": "models/historical_views/vendor/v_opco_vendor_packing_slip_lineage.sql", "name": "v_opco_vendor_packing_slip_lineage", "alias": "v_opco_vendor_packing_slip_lineage", "checksum": {"name": "sha256", "checksum": "465efcfd999bbe8b3d3d65eb35a9c38591b952273ca5b6da6fd23b6bce9da8b6"}, "tags": [], "refs": [["ax_opco_vendor_packing_slip"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6399665}, "model.OI_Foundation.v_opco_vendor_trans_lineage": {"raw_sql": "with v_opco_vendor_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_trans')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "vendor", "v_opco_vendor_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/vendor/v_opco_vendor_trans_lineage.sql", "original_file_path": "models/historical_views/vendor/v_opco_vendor_trans_lineage.sql", "name": "v_opco_vendor_trans_lineage", "alias": "v_opco_vendor_trans_lineage", "checksum": {"name": "sha256", "checksum": "389b133ac6756fde5bf8e4d9950a9a11f2361f0589983b9328dc10632b9d0dbc"}, "tags": [], "refs": [["ax_opco_vendor_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6441278}, "model.OI_Foundation.v_opco_vendor_invoice_lineage": {"raw_sql": "with v_opco_vendor_invoice_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_invoice')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_invoice_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_invoice"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "vendor", "v_opco_vendor_invoice_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_invoice_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/vendor/v_opco_vendor_invoice_lineage.sql", "original_file_path": "models/historical_views/vendor/v_opco_vendor_invoice_lineage.sql", "name": "v_opco_vendor_invoice_lineage", "alias": "v_opco_vendor_invoice_lineage", "checksum": {"name": "sha256", "checksum": "f527f32b23232f6d2f1854c718cffec10a3ac3a9186d9e5996c1696759e45f9f"}, "tags": [], "refs": [["ax_opco_vendor_invoice"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6484303}, "model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage": {"raw_sql": "with v_opco_vendor_packing_slip_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_packing_slip_line')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_packing_slip_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "vendor", "v_opco_vendor_packing_slip_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/vendor/v_opco_vendor_packing_slip_line_lineage.sql", "original_file_path": "models/historical_views/vendor/v_opco_vendor_packing_slip_line_lineage.sql", "name": "v_opco_vendor_packing_slip_line_lineage", "alias": "v_opco_vendor_packing_slip_line_lineage", "checksum": {"name": "sha256", "checksum": "b9348332dd81d8d0e686a58be3ad12f51a43b331e9aeafe9a90e10c713e0a198"}, "tags": [], "refs": [["ax_opco_vendor_packing_slip_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6535256}, "model.OI_Foundation.v_opco_item_size_lineage": {"raw_sql": "with v_opco_item_size_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_size')])}}\r\n)\r\n\r\nselect * from v_opco_item_size_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_size"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_size_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_size_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_size_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_size_lineage.sql", "name": "v_opco_item_size_lineage", "alias": "v_opco_item_size_lineage", "checksum": {"name": "sha256", "checksum": "531d02f56cbb6ba3dae9e32ae300a2c8ac956519cd2286bc372f6174d8c18700"}, "tags": [], "refs": [["ax_opco_item_size"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6576595}, "model.OI_Foundation.v_opco_uom_lineage": {"raw_sql": "with v_opco_uom as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_uom'), ref('ns_opco_uom'), ref('jde_opco_uom'), ref('primex_opco_uom')])}}\r\n)\r\n\r\nselect * from v_opco_uom", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_uom", "model.OI_Foundation.ns_opco_uom", "model.OI_Foundation.jde_opco_uom", "model.OI_Foundation.primex_opco_uom"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_uom_lineage"], "unique_id": "model.OI_Foundation.v_opco_uom_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_uom_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_uom_lineage.sql", "name": "v_opco_uom_lineage", "alias": "v_opco_uom_lineage", "checksum": {"name": "sha256", "checksum": "5341a33144b783730429a952b936c308b71b11c9842e7784027cf25385f99862"}, "tags": [], "refs": [["ax_opco_uom"], ["ns_opco_uom"], ["jde_opco_uom"], ["primex_opco_uom"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6619003}, "model.OI_Foundation.v_opco_lob_lineage": {"raw_sql": "with v_opco_lob as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_lob'), ref('primex_opco_lob')])}}\r\n)\r\n\r\nselect * from v_opco_lob", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_lob", "model.OI_Foundation.primex_opco_lob"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_lob_lineage"], "unique_id": "model.OI_Foundation.v_opco_lob_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_lob_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_lob_lineage.sql", "name": "v_opco_lob_lineage", "alias": "v_opco_lob_lineage", "checksum": {"name": "sha256", "checksum": "57b37d85890a2e228b624ca7f7efcdedc83b82bad394b9bdd249b6aac8fd6533"}, "tags": [], "refs": [["ax_opco_lob"], ["primex_opco_lob"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6668665}, "model.OI_Foundation.v_opco_item_psi_dtl_lineage": {"raw_sql": "with v_opco_item_psi_dtl_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_psi_dtl')])}}\r\n)\r\n\r\nselect * from v_opco_item_psi_dtl_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_psi_dtl"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_psi_dtl_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_psi_dtl_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_psi_dtl_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_psi_dtl_lineage.sql", "name": "v_opco_item_psi_dtl_lineage", "alias": "v_opco_item_psi_dtl_lineage", "checksum": {"name": "sha256", "checksum": "fb038833daa6e789baa829da6ee64f51d2102951b40fd501def7bdc0a694d4a1"}, "tags": [], "refs": [["ax_opco_item_psi_dtl"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6711614}, "model.OI_Foundation.v_opco_item_sls_class_lineage": {"raw_sql": "with v_opco_item_sls_class_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_sls_class')])}}\r\n)\r\n\r\nselect * from v_opco_item_sls_class_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_sls_class"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_sls_class_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_sls_class_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_sls_class_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_sls_class_lineage.sql", "name": "v_opco_item_sls_class_lineage", "alias": "v_opco_item_sls_class_lineage", "checksum": {"name": "sha256", "checksum": "cf3fbc146d9e47db1bca1f541d4707ce5eee9db107b6427976909f9ac98a314e"}, "tags": [], "refs": [["ax_opco_item_sls_class"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6754553}, "model.OI_Foundation.v_opco_invtry_trans_lineage": {"raw_sql": "with v_opco_invtry_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_invtry_trans')])}}\r\n)\r\n\r\nselect * from v_opco_invtry_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_invtry_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_invtry_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_invtry_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_invtry_trans_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_invtry_trans_lineage.sql", "name": "v_opco_invtry_trans_lineage", "alias": "v_opco_invtry_trans_lineage", "checksum": {"name": "sha256", "checksum": "688dd633c43f9947b1d4c94485747451b3e4fad2260b6729d7d1e6983e0321cf"}, "tags": [], "refs": [["ax_opco_invtry_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6798413}, "model.OI_Foundation.v_opco_item_lineage": {"raw_sql": "with v_opco_item_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item')])}}\r\n)\r\n\r\nselect * from v_opco_item_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_lineage.sql", "name": "v_opco_item_lineage", "alias": "v_opco_item_lineage", "checksum": {"name": "sha256", "checksum": "8bb29d69ccb21fa9807c430baee23959fdbb2fe77774b7cb6f23da76d4e5c407"}, "tags": [], "refs": [["ax_opco_item"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6846416}, "model.OI_Foundation.v_opco_invtry_rcpt_status_lineage": {"raw_sql": "with v_opco_invtry_rcpt_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_invtry_rcpt_status')])}}\r\n)\r\n\r\nselect * from v_opco_invtry_rcpt_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_invtry_rcpt_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_invtry_rcpt_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_invtry_rcpt_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_invtry_rcpt_status_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_invtry_rcpt_status_lineage.sql", "name": "v_opco_invtry_rcpt_status_lineage", "alias": "v_opco_invtry_rcpt_status_lineage", "checksum": {"name": "sha256", "checksum": "c8cd1f361cb7dca378d1b84ca9bd9661290893f85e385812df8cd239891e5fb9"}, "tags": [], "refs": [["ax_opco_invtry_rcpt_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6889591}, "model.OI_Foundation.v_opco_item_grp_lineage": {"raw_sql": "with v_opco_item_grp_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_grp')])}}\r\n)\r\n\r\nselect * from v_opco_item_grp_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_grp_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_grp_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_grp_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_grp_lineage.sql", "name": "v_opco_item_grp_lineage", "alias": "v_opco_item_grp_lineage", "checksum": {"name": "sha256", "checksum": "191aabb757117180b4b89f4df8ab5fd9d3182b084f781c35f1a9d105513cdd46"}, "tags": [], "refs": [["ax_opco_item_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6931221}, "model.OI_Foundation.v_opco_item_model_grp_lineage": {"raw_sql": "with v_opco_item_model_grp_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_model_grp')])}}\r\n)\r\n\r\nselect * from v_opco_item_model_grp_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_model_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_model_grp_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_model_grp_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_model_grp_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_model_grp_lineage.sql", "name": "v_opco_item_model_grp_lineage", "alias": "v_opco_item_model_grp_lineage", "checksum": {"name": "sha256", "checksum": "7608daff1275a82f05087008e02b5cbfb52848fbb24bda4af39cbf79b1a5cc0d"}, "tags": [], "refs": [["ax_opco_item_model_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.6973937}, "model.OI_Foundation.v_opco_invtry_issue_status_lineage": {"raw_sql": "with v_opco_invtry_issue_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_invtry_issue_status')])}}\r\n)\r\n\r\nselect * from v_opco_invtry_issue_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_invtry_issue_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_invtry_issue_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_invtry_issue_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_invtry_issue_status_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_invtry_issue_status_lineage.sql", "name": "v_opco_invtry_issue_status_lineage", "alias": "v_opco_invtry_issue_status_lineage", "checksum": {"name": "sha256", "checksum": "bc232aeb17356d4bca462e1e9647d428889f9b65eac212334d89ffd0540167dc"}, "tags": [], "refs": [["ax_opco_invtry_issue_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7016878}, "model.OI_Foundation.v_opco_item_freight_lineage": {"raw_sql": "with v_opco_item_freight_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_freight')])}}\r\n)\r\n\r\nselect * from v_opco_item_freight_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_freight"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_freight_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_freight_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_freight_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_freight_lineage.sql", "name": "v_opco_item_freight_lineage", "alias": "v_opco_item_freight_lineage", "checksum": {"name": "sha256", "checksum": "5719b125b7fbac5a107d6d906701044e14f21fffb6efd5694ed2a8347cd9b212"}, "tags": [], "refs": [["ax_opco_item_freight"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.705881}, "model.OI_Foundation.v_opco_brand_lineage": {"raw_sql": "with v_opco_brand as(\r\n    {{ union_relations(\r\n        relations=[ref('ns_opco_brand')])}}\r\n)\r\n\r\nselect * from v_opco_brand", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ns_opco_brand"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_brand_lineage"], "unique_id": "model.OI_Foundation.v_opco_brand_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_brand_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_brand_lineage.sql", "name": "v_opco_brand_lineage", "alias": "v_opco_brand_lineage", "checksum": {"name": "sha256", "checksum": "5b9735d9f257113daf36a68289e51e3f4b70f9dcb033cdd802c7fc4d4a6d4cd5"}, "tags": [], "refs": [["ns_opco_brand"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7102003}, "model.OI_Foundation.v_opco_item_subtype_lineage": {"raw_sql": "with v_opco_item_subtype_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_subtype')])}}\r\n)\r\n\r\nselect * from v_opco_item_subtype_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_subtype"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_subtype_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_subtype_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_subtype_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_subtype_lineage.sql", "name": "v_opco_item_subtype_lineage", "alias": "v_opco_item_subtype_lineage", "checksum": {"name": "sha256", "checksum": "eda226867c805e29a4568df2dd43fa8f3871fb8ea456b354e306022461c0234f"}, "tags": [], "refs": [["ax_opco_item_subtype"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7152178}, "model.OI_Foundation.v_opco_item_invtry_lineage": {"raw_sql": "with v_opco_item_invtry_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_invtry')])}}\r\n)\r\n\r\nselect * from v_opco_item_invtry_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_invtry"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_invtry_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_invtry_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_invtry_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_invtry_lineage.sql", "name": "v_opco_item_invtry_lineage", "alias": "v_opco_item_invtry_lineage", "checksum": {"name": "sha256", "checksum": "10974c7df30a753dba6f42ec87de79b02a781442b6136049630de2168b5e727a"}, "tags": [], "refs": [["ax_opco_item_invtry"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.719534}, "model.OI_Foundation.v_opco_purpose_lineage": {"raw_sql": "with v_opco_purpose as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_purpose'), ref('ns_opco_purpose'), ref('primex_opco_purpose')])}}\r\n)\r\n\r\nselect * from v_opco_purpose", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_purpose", "model.OI_Foundation.ns_opco_purpose", "model.OI_Foundation.primex_opco_purpose"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_purpose_lineage"], "unique_id": "model.OI_Foundation.v_opco_purpose_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_purpose_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_purpose_lineage.sql", "name": "v_opco_purpose_lineage", "alias": "v_opco_purpose_lineage", "checksum": {"name": "sha256", "checksum": "df4d76e81ab956b638c95eab51bef3669d348caeb81cdddfb6fc274ab973ef93"}, "tags": [], "refs": [["ax_opco_purpose"], ["ns_opco_purpose"], ["primex_opco_purpose"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7237651}, "model.OI_Foundation.v_opco_vendor_lineage": {"raw_sql": "with v_opco_vendor_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_vendor_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_vendor_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_vendor_lineage.sql", "name": "v_opco_vendor_lineage", "alias": "v_opco_vendor_lineage", "checksum": {"name": "sha256", "checksum": "a21504f869b654d812aa15c6862aead632b3bc59530fd3e6cc27be3e6eaf27c1"}, "tags": [], "refs": [["ax_opco_vendor"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7285516}, "model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage": {"raw_sql": "with v_opco_item_opco_assctn_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_opco_assctn_xref')])}}\r\n)\r\n\r\nselect * from v_opco_item_opco_assctn_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_opco_assctn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_opco_assctn_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_opco_assctn_xref_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_opco_assctn_xref_lineage.sql", "name": "v_opco_item_opco_assctn_xref_lineage", "alias": "v_opco_item_opco_assctn_xref_lineage", "checksum": {"name": "sha256", "checksum": "9c7c3804fc9f1ea7d34c1c7daadc7bcbb313770043af0f9f7dd13abb14320ec3"}, "tags": [], "refs": [["ax_opco_item_opco_assctn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7327747}, "model.OI_Foundation.v_opco_item_class_lineage": {"raw_sql": "with v_opco_item_class_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_class')])}}\r\n)\r\n\r\nselect * from v_opco_item_class_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_class"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_class_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_class_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_class_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_class_lineage.sql", "name": "v_opco_item_class_lineage", "alias": "v_opco_item_class_lineage", "checksum": {"name": "sha256", "checksum": "450614662afe60938a70f3f30252d03fb83dad55664a106fa887e3b9360de22c"}, "tags": [], "refs": [["ax_opco_item_class"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.737086}, "model.OI_Foundation.v_opco_invtry_trans_type_lineage": {"raw_sql": "with v_opco_invtry_trans_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_invtry_trans_type')])}}\r\n)\r\n\r\nselect * from v_opco_invtry_trans_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_invtry_trans_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_invtry_trans_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_invtry_trans_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_invtry_trans_type_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_invtry_trans_type_lineage.sql", "name": "v_opco_invtry_trans_type_lineage", "alias": "v_opco_invtry_trans_type_lineage", "checksum": {"name": "sha256", "checksum": "fdff6199ee9835ca7e0dc4a0780647793f24d5d80cfe5338a619cb34d375d16b"}, "tags": [], "refs": [["ax_opco_invtry_trans_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7414541}, "model.OI_Foundation.v_opco_item_type_lineage": {"raw_sql": "with v_opco_item_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_type')])}}\r\n)\r\n\r\nselect * from v_opco_item_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_type_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_type_lineage.sql", "name": "v_opco_item_type_lineage", "alias": "v_opco_item_type_lineage", "checksum": {"name": "sha256", "checksum": "cec3ae309cdd9845b4aaa95de67e47fae3d65bc685e7a74612b8031d69903757"}, "tags": [], "refs": [["ax_opco_item_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.74572}, "model.OI_Foundation.v_opco_item_cvrg_grp_lineage": {"raw_sql": "with v_opco_item_cvrg_grp_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_item_cvrg_grp')])}}\r\n)\r\n\r\nselect * from v_opco_item_cvrg_grp_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_item_cvrg_grp"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "product", "v_opco_item_cvrg_grp_lineage"], "unique_id": "model.OI_Foundation.v_opco_item_cvrg_grp_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/product/v_opco_item_cvrg_grp_lineage.sql", "original_file_path": "models/historical_views/product/v_opco_item_cvrg_grp_lineage.sql", "name": "v_opco_item_cvrg_grp_lineage", "alias": "v_opco_item_cvrg_grp_lineage", "checksum": {"name": "sha256", "checksum": "bc022258a9bdbe6052464f4fa3c918b695b5dc361c9766399bd88c04db6f196a"}, "tags": [], "refs": [["ax_opco_item_cvrg_grp"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7506816}, "model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage": {"raw_sql": "with v_opco_vendor_opco_locn_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_vendor_opco_locn_xref')])}}\r\n)\r\n\r\nselect * from v_opco_vendor_opco_locn_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_vendor_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "location", "v_opco_vendor_opco_locn_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/location/v_opco_vendor_opco_locn_xref_lineage.sql", "original_file_path": "models/historical_views/location/v_opco_vendor_opco_locn_xref_lineage.sql", "name": "v_opco_vendor_opco_locn_xref_lineage", "alias": "v_opco_vendor_opco_locn_xref_lineage", "checksum": {"name": "sha256", "checksum": "87b9f928029d925637301c6381bde1010dffc5931c42c9e9c6c75996346c90ca"}, "tags": [], "refs": [["ax_opco_vendor_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7549627}, "model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage": {"raw_sql": "with v_opco_cust_opco_locn_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cust_opco_locn_xref')])}}\r\n)\r\n\r\nselect * from v_opco_cust_opco_locn_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cust_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "location", "v_opco_cust_opco_locn_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/location/v_opco_cust_opco_locn_xref_lineage.sql", "original_file_path": "models/historical_views/location/v_opco_cust_opco_locn_xref_lineage.sql", "name": "v_opco_cust_opco_locn_xref_lineage", "alias": "v_opco_cust_opco_locn_xref_lineage", "checksum": {"name": "sha256", "checksum": "74cce23082ca022d782b1a19475485274303ba965e55fa29953b9268eb8d3abc"}, "tags": [], "refs": [["ax_opco_cust_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.759178}, "model.OI_Foundation.v_opco_locn_lineage": {"raw_sql": "with v_opco_locn_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_locn')])}}\r\n)\r\n\r\nselect * from v_opco_locn_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_locn"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "location", "v_opco_locn_lineage"], "unique_id": "model.OI_Foundation.v_opco_locn_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/location/v_opco_locn_lineage.sql", "original_file_path": "models/historical_views/location/v_opco_locn_lineage.sql", "name": "v_opco_locn_lineage", "alias": "v_opco_locn_lineage", "checksum": {"name": "sha256", "checksum": "88c37ee08f52a4d2890288e3dab48a283395bbf99eafd42aea6c7ee4166d52dc"}, "tags": [], "refs": [["ax_opco_locn"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7636986}, "model.OI_Foundation.v_opco_opco_locn_xref_lineage": {"raw_sql": "with v_opco_opco_locn_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_opco_locn_xref')])}}\r\n)\r\n\r\nselect * from v_opco_opco_locn_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "location", "v_opco_opco_locn_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_opco_locn_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/location/v_opco_opco_locn_xref_lineage.sql", "original_file_path": "models/historical_views/location/v_opco_opco_locn_xref_lineage.sql", "name": "v_opco_opco_locn_xref_lineage", "alias": "v_opco_opco_locn_xref_lineage", "checksum": {"name": "sha256", "checksum": "84d34964595721f295e1883d8637da97309db73930dc8d1d490a22ad4b8063c5"}, "tags": [], "refs": [["ax_opco_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7681012}, "model.OI_Foundation.v_opco_cost_center_lineage": {"raw_sql": "with v_opco_cost_center as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_cost_center'), ref('ns_opco_cost_center'), ref('jde_opco_cost_center'), ref('primex_opco_cost_center')])}}\r\n)\r\n\r\nselect * from v_opco_cost_center", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_cost_center", "model.OI_Foundation.ns_opco_cost_center", "model.OI_Foundation.jde_opco_cost_center", "model.OI_Foundation.primex_opco_cost_center"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_cost_center_lineage"], "unique_id": "model.OI_Foundation.v_opco_cost_center_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_cost_center_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_cost_center_lineage.sql", "name": "v_opco_cost_center_lineage", "alias": "v_opco_cost_center_lineage", "checksum": {"name": "sha256", "checksum": "a18fae0606fad81c19a1181092fba897e2cf1f124ca984e8f9f2b85eb67669a1"}, "tags": [], "refs": [["ax_opco_cost_center"], ["ns_opco_cost_center"], ["jde_opco_cost_center"], ["primex_opco_cost_center"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.772598}, "model.OI_Foundation.v_opco_lineage": {"raw_sql": "with v_opco as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco'), ref('ns_opco'), ref('jde_opco'), ref('primex_opco')])}}\r\n)\r\n\r\nselect * from v_opco", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco", "model.OI_Foundation.ns_opco", "model.OI_Foundation.jde_opco", "model.OI_Foundation.primex_opco"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_lineage"], "unique_id": "model.OI_Foundation.v_opco_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_lineage.sql", "name": "v_opco_lineage", "alias": "v_opco_lineage", "checksum": {"name": "sha256", "checksum": "b05a356ba55cdcfeb0d0cf9819576b95cac3d841620fdb3aba9c150b45efe4ff"}, "tags": [], "refs": [["ax_opco"], ["ns_opco"], ["jde_opco"], ["primex_opco"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.7775595}, "model.OI_Foundation.v_sub_region_lineage": {"raw_sql": "with v_sub_region as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_sub_region'), ref('ns_sub_region')])}}\r\n)\r\n\r\nselect * from v_sub_region", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_sub_region", "model.OI_Foundation.ns_sub_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_sub_region_lineage"], "unique_id": "model.OI_Foundation.v_sub_region_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_sub_region_lineage.sql", "original_file_path": "models/historical_views/organization/v_sub_region_lineage.sql", "name": "v_sub_region_lineage", "alias": "v_sub_region_lineage", "checksum": {"name": "sha256", "checksum": "629dc01949a45269de2d2b5a18366d554ecde47c78c45e0a9a35d7bfa020d4cc"}, "tags": [], "refs": [["ax_sub_region"], ["ns_sub_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.8743339}, "model.OI_Foundation.v_opco_dept_lineage": {"raw_sql": "with v_opco_dept as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_dept'), ref('ns_opco_dept'), ref('primex_opco_dept')])}}\r\n)\r\n\r\nselect * from v_opco_dept", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_dept", "model.OI_Foundation.ns_opco_dept", "model.OI_Foundation.primex_opco_dept"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_dept_lineage"], "unique_id": "model.OI_Foundation.v_opco_dept_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_dept_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_dept_lineage.sql", "name": "v_opco_dept_lineage", "alias": "v_opco_dept_lineage", "checksum": {"name": "sha256", "checksum": "fa9de81e5e900091342c32aea0abef9a5418b79b6b328c637aa63ece1fec3df5"}, "tags": [], "refs": [["ax_opco_dept"], ["ns_opco_dept"], ["primex_opco_dept"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.8796}, "model.OI_Foundation.v_opco_site_lineage": {"raw_sql": "with v_opco_site_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_site')])}}\r\n)\r\n\r\nselect * from v_opco_site_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_site"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_site_lineage"], "unique_id": "model.OI_Foundation.v_opco_site_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_site_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_site_lineage.sql", "name": "v_opco_site_lineage", "alias": "v_opco_site_lineage", "checksum": {"name": "sha256", "checksum": "1d1bc9470a8412947f60d13659dfb7e6abfae86303169661a088fb101899fd4a"}, "tags": [], "refs": [["ax_opco_site"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.884503}, "model.OI_Foundation.v_warehouse_lineage": {"raw_sql": "with v_warehouse_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_warehouse')])}}\r\n)\r\n\r\nselect * from v_warehouse_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_warehouse"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_warehouse_lineage"], "unique_id": "model.OI_Foundation.v_warehouse_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_warehouse_lineage.sql", "original_file_path": "models/historical_views/organization/v_warehouse_lineage.sql", "name": "v_warehouse_lineage", "alias": "v_warehouse_lineage", "checksum": {"name": "sha256", "checksum": "4b22c09cfa98ea8bfc20d09d7db2b581f15f0e2820fd8d85f063dc519785c3fe"}, "tags": [], "refs": [["ax_warehouse"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.8888574}, "model.OI_Foundation.v_fscl_clndr_lineage": {"raw_sql": "with v_fscl_clndr as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_fscl_clndr')])}}\r\n)\r\n\r\nselect * from v_fscl_clndr", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_fscl_clndr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_fscl_clndr_lineage"], "unique_id": "model.OI_Foundation.v_fscl_clndr_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_fscl_clndr_lineage.sql", "original_file_path": "models/historical_views/organization/v_fscl_clndr_lineage.sql", "name": "v_fscl_clndr_lineage", "alias": "v_fscl_clndr_lineage", "checksum": {"name": "sha256", "checksum": "af676c30e3dfbe2f63e34619f5fafd3f760b23bd4b26fddf040f386e1c79bd4a"}, "tags": [], "refs": [["ax_fscl_clndr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.8931353}, "model.OI_Foundation.v_opco_type_lineage": {"raw_sql": "with v_opco_type as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_type'), ref('ns_opco_type'), ref('primex_opco_type')])}}\r\n)\r\n\r\nselect * from v_opco_type", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_type", "model.OI_Foundation.ns_opco_type", "model.OI_Foundation.primex_opco_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_type_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_type_lineage.sql", "name": "v_opco_type_lineage", "alias": "v_opco_type_lineage", "checksum": {"name": "sha256", "checksum": "d527972b7b570344e6f4b54e9cd0964c1b5a8fa55f6498d9b57bb9d2cfc7528e"}, "tags": [], "refs": [["ax_opco_type"], ["ns_opco_type"], ["primex_opco_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.8973086}, "model.OI_Foundation.v_opco_assctn_lineage": {"raw_sql": "with v_opco_assctn_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_assctn')])}}\r\n)\r\n\r\nselect * from v_opco_assctn_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_assctn"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_opco_assctn_lineage"], "unique_id": "model.OI_Foundation.v_opco_assctn_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_opco_assctn_lineage.sql", "original_file_path": "models/historical_views/organization/v_opco_assctn_lineage.sql", "name": "v_opco_assctn_lineage", "alias": "v_opco_assctn_lineage", "checksum": {"name": "sha256", "checksum": "f2709eee19b019b1ca27e6eb98a4ea31b5c27785c315561ab5ffce40d50f428b"}, "tags": [], "refs": [["ax_opco_assctn"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9019756}, "model.OI_Foundation.v_region_lineage": {"raw_sql": "with v_region as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_region'), ref('ns_region')])}}\r\n)\r\n\r\nselect * from v_region", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_region", "model.OI_Foundation.ns_region"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "organization", "v_region_lineage"], "unique_id": "model.OI_Foundation.v_region_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/organization/v_region_lineage.sql", "original_file_path": "models/historical_views/organization/v_region_lineage.sql", "name": "v_region_lineage", "alias": "v_region_lineage", "checksum": {"name": "sha256", "checksum": "7fc1dccc94fa627c703756134349ba62cd526550910aa2f48b6ef0c8cc84ab56"}, "tags": [], "refs": [["ax_region"], ["ns_region"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9070675}, "model.OI_Foundation.v_opco_sls_ordr_type_lineage": {"raw_sql": "with v_opco_sls_ordr_type_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_sls_ordr_type')])}}\r\n)\r\n\r\nselect * from v_opco_sls_ordr_type_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_type"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_sls_ordr_type_lineage"], "unique_id": "model.OI_Foundation.v_opco_sls_ordr_type_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_sls_ordr_type_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_sls_ordr_type_lineage.sql", "name": "v_opco_sls_ordr_type_lineage", "alias": "v_opco_sls_ordr_type_lineage", "checksum": {"name": "sha256", "checksum": "20a618998e3aa8253abb5a7852a7a33536ca5d6720091914d67eb687b3ba17bf"}, "tags": [], "refs": [["ax_opco_sls_ordr_type"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9114165}, "model.OI_Foundation.v_opco_dlvry_mode_lineage": {"raw_sql": "with v_opco_dlvry_mode_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_dlvry_mode')])}}\r\n)\r\n\r\nselect * from v_opco_dlvry_mode_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_dlvry_mode"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_dlvry_mode_lineage"], "unique_id": "model.OI_Foundation.v_opco_dlvry_mode_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_dlvry_mode_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_dlvry_mode_lineage.sql", "name": "v_opco_dlvry_mode_lineage", "alias": "v_opco_dlvry_mode_lineage", "checksum": {"name": "sha256", "checksum": "bdc84d78ba29b36e42d3d5f69e003701fb163802c6e732e422dbc0a93fa87fc9"}, "tags": [], "refs": [["ax_opco_dlvry_mode"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9157643}, "model.OI_Foundation.v_opco_trans_status_lineage": {"raw_sql": "with v_opco_trans_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_trans_status')])}}\r\n)\r\n\r\nselect * from v_opco_trans_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_trans_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_trans_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_trans_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_trans_status_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_trans_status_lineage.sql", "name": "v_opco_trans_status_lineage", "alias": "v_opco_trans_status_lineage", "checksum": {"name": "sha256", "checksum": "e9bbb0affaca17e178b9237343b5b2701646865c47ec1b9b7f7e8299254a44e2"}, "tags": [], "refs": [["ax_opco_trans_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.920155}, "model.OI_Foundation.v_opco_dlvry_terms_lineage": {"raw_sql": "with v_opco_dlvry_terms_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_dlvry_terms')])}}\r\n)\r\n\r\nselect * from v_opco_dlvry_terms_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_dlvry_terms"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_dlvry_terms_lineage"], "unique_id": "model.OI_Foundation.v_opco_dlvry_terms_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_dlvry_terms_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_dlvry_terms_lineage.sql", "name": "v_opco_dlvry_terms_lineage", "alias": "v_opco_dlvry_terms_lineage", "checksum": {"name": "sha256", "checksum": "13d001946c722024acb02790d4f2e4834ad6968689f516eba2c50fe4b88ba1db"}, "tags": [], "refs": [["ax_opco_dlvry_terms"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9243062}, "model.OI_Foundation.v_opco_sls_ordr_line_lineage": {"raw_sql": "with v_opco_sls_ordr_line_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_sls_ordr_line')])}}\r\n)\r\n\r\nselect * from v_opco_sls_ordr_line_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_line"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_sls_ordr_line_lineage"], "unique_id": "model.OI_Foundation.v_opco_sls_ordr_line_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_sls_ordr_line_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_sls_ordr_line_lineage.sql", "name": "v_opco_sls_ordr_line_lineage", "alias": "v_opco_sls_ordr_line_lineage", "checksum": {"name": "sha256", "checksum": "4d6c524e2c3e52a18ff1d7a58ab457bada7802e8b3f8ccb249906f43e5cb2ae2"}, "tags": [], "refs": [["ax_opco_sls_ordr_line"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9285517}, "model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage": {"raw_sql": "with v_sls_ordr_opco_locn_xref_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_sls_ordr_opco_locn_xref')])}}\r\n)\r\n\r\nselect * from v_sls_ordr_opco_locn_xref_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_sls_ordr_opco_locn_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_sls_ordr_opco_locn_xref_lineage"], "unique_id": "model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_sls_ordr_opco_locn_xref_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_sls_ordr_opco_locn_xref_lineage.sql", "name": "v_sls_ordr_opco_locn_xref_lineage", "alias": "v_sls_ordr_opco_locn_xref_lineage", "checksum": {"name": "sha256", "checksum": "f58790af097d65913e74e8ba71b0fd1d92b95fbdd0060bed2bc49e6c0c9adf84"}, "tags": [], "refs": [["ax_sls_ordr_opco_locn_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.932905}, "model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage": {"raw_sql": "with v_opco_sls_ordr_doc_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_sls_ordr_doc_status')])}}\r\n)\r\n\r\nselect * from v_opco_sls_ordr_doc_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr_doc_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_sls_ordr_doc_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_sls_ordr_doc_status_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_sls_ordr_doc_status_lineage.sql", "name": "v_opco_sls_ordr_doc_status_lineage", "alias": "v_opco_sls_ordr_doc_status_lineage", "checksum": {"name": "sha256", "checksum": "0bdfe78b8bad44877e5487779b123a3152c860c8d8ffab0cbda6f7f28674ea58"}, "tags": [], "refs": [["ax_opco_sls_ordr_doc_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9370701}, "model.OI_Foundation.v_opco_sls_ordr_lineage": {"raw_sql": "with v_opco_sls_ordr_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_sls_ordr')])}}\r\n)\r\n\r\nselect * from v_opco_sls_ordr_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_sls_ordr"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "sales_order", "v_opco_sls_ordr_lineage"], "unique_id": "model.OI_Foundation.v_opco_sls_ordr_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/sales_order/v_opco_sls_ordr_lineage.sql", "original_file_path": "models/historical_views/sales_order/v_opco_sls_ordr_lineage.sql", "name": "v_opco_sls_ordr_lineage", "alias": "v_opco_sls_ordr_lineage", "checksum": {"name": "sha256", "checksum": "6fdb5f9369b4f417a7d7cf4ad02c7d34c03eb8cfbd28ecd04ac6acb624869366"}, "tags": [], "refs": [["ax_opco_sls_ordr"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.942133}, "model.OI_Foundation.v_opco_project_trans_status_lineage": {"raw_sql": "with v_opco_project_trans_status_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_trans_status')])}}\r\n)\r\n\r\nselect * from v_opco_project_trans_status_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_trans_status"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_trans_status_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_trans_status_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_trans_status_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_trans_status_lineage.sql", "name": "v_opco_project_trans_status_lineage", "alias": "v_opco_project_trans_status_lineage", "checksum": {"name": "sha256", "checksum": "c77d9911cd0dcfba7a7671c87e484ef8166d44b88f198d42eed7097dc1891df1"}, "tags": [], "refs": [["ax_opco_project_trans_status"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.946534}, "model.OI_Foundation.v_opco_project_trans_posting_lineage": {"raw_sql": "with v_opco_project_trans_posting_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_trans_posting')])}}\r\n)\r\n\r\nselect * from v_opco_project_trans_posting_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_trans_posting"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_trans_posting_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_trans_posting_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_trans_posting_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_trans_posting_lineage.sql", "name": "v_opco_project_trans_posting_lineage", "alias": "v_opco_project_trans_posting_lineage", "checksum": {"name": "sha256", "checksum": "e0717ead672186d5a94e9f776b9404531a3442942f82b2a61b20bbd661866bf6"}, "tags": [], "refs": [["ax_opco_project_trans_posting"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9506483}, "model.OI_Foundation.v_opco_project_invoice_project_xref_lineage": {"raw_sql": "with v_opco_project_invoice_project_xr_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_invoice_project_xref')])}}\r\n)\r\n\r\nselect * from v_opco_project_invoice_project_xr_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_invoice_project_xref"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_invoice_project_xref_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_invoice_project_xref_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_invoice_project_xref_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_invoice_project_xref_lineage.sql", "name": "v_opco_project_invoice_project_xref_lineage", "alias": "v_opco_project_invoice_project_xref_lineage", "checksum": {"name": "sha256", "checksum": "65b1972fd862038ec2aa92f75955a5216cb25660ef85691f2d66658b07c0d416"}, "tags": [], "refs": [["ax_opco_project_invoice_project_xref"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.954885}, "model.OI_Foundation.v_opco_project_empl_frcst_lineage": {"raw_sql": "with v_opco_project_empl_frcst_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_empl_frcst')])}}\r\n)\r\n\r\nselect * from v_opco_project_empl_frcst_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_empl_frcst"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_empl_frcst_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_empl_frcst_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_empl_frcst_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_empl_frcst_lineage.sql", "name": "v_opco_project_empl_frcst_lineage", "alias": "v_opco_project_empl_frcst_lineage", "checksum": {"name": "sha256", "checksum": "9cdc293cf893de7e12d548697f88b95306119735715646479bd632bd4a6a8c06"}, "tags": [], "refs": [["ax_opco_project_empl_frcst"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9592595}, "model.OI_Foundation.v_opco_project_trans_origin_lineage": {"raw_sql": "with v_opco_project_trans_origin_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_trans_origin')])}}\r\n)\r\n\r\nselect * from v_opco_project_trans_origin_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_trans_origin"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_trans_origin_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_trans_origin_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_trans_origin_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_trans_origin_lineage.sql", "name": "v_opco_project_trans_origin_lineage", "alias": "v_opco_project_trans_origin_lineage", "checksum": {"name": "sha256", "checksum": "13ac007273ced2c06745babe2fd012f3b8abb2c6cc27db04ee0e4c1d6a2a699a"}, "tags": [], "refs": [["ax_opco_project_trans_origin"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9633973}, "model.OI_Foundation.v_opco_project_empl_trans_lineage": {"raw_sql": "with v_opco_project_empl_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_empl_trans')])}}\r\n)\r\n\r\nselect * from v_opco_project_empl_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_empl_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_empl_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_empl_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_empl_trans_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_empl_trans_lineage.sql", "name": "v_opco_project_empl_trans_lineage", "alias": "v_opco_project_empl_trans_lineage", "checksum": {"name": "sha256", "checksum": "4bedbd7f901c1e35412d4902be722e8f9b9cb0449fa6180f1bfb644b2545bfaf"}, "tags": [], "refs": [["ax_opco_project_empl_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9677317}, "model.OI_Foundation.v_opco_project_revenue_trans_lineage": {"raw_sql": "with v_opco_project_revenue_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_revenue_trans')])}}\r\n)\r\n\r\nselect * from v_opco_project_revenue_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_revenue_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_revenue_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_revenue_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_revenue_trans_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_revenue_trans_lineage.sql", "name": "v_opco_project_revenue_trans_lineage", "alias": "v_opco_project_revenue_trans_lineage", "checksum": {"name": "sha256", "checksum": "a0aae9f528c08a4dfc6d1f055e927e678e9e6b3d76394dd3c57b178ef603cb0c"}, "tags": [], "refs": [["ax_opco_project_revenue_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9729447}, "model.OI_Foundation.v_opco_project_lineage": {"raw_sql": "with v_opco_project_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project')])}}\r\n)\r\n\r\nselect * from v_opco_project_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_lineage.sql", "name": "v_opco_project_lineage", "alias": "v_opco_project_lineage", "checksum": {"name": "sha256", "checksum": "d176306ca8461dbe5f1e2490a8795b8cb75335fe753716973592b56d93e5d043"}, "tags": [], "refs": [["ax_opco_project"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.977113}, "model.OI_Foundation.v_opco_project_cost_trans_lineage": {"raw_sql": "with v_opco_project_cost_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_cost_trans')])}}\r\n)\r\n\r\nselect * from v_opco_project_cost_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_cost_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_cost_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_cost_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_cost_trans_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_cost_trans_lineage.sql", "name": "v_opco_project_cost_trans_lineage", "alias": "v_opco_project_cost_trans_lineage", "checksum": {"name": "sha256", "checksum": "06f7df78f1abc6a2d19e13c711e5ab59c4ac72dcdd4bd7a9e10381a78b877414"}, "tags": [], "refs": [["ax_opco_project_cost_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9814413}, "model.OI_Foundation.v_opco_project_item_trans_lineage": {"raw_sql": "with v_opco_project_item_trans_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_item_trans')])}}\r\n)\r\n\r\nselect * from v_opco_project_item_trans_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_item_trans"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_item_trans_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_item_trans_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_item_trans_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_item_trans_lineage.sql", "name": "v_opco_project_item_trans_lineage", "alias": "v_opco_project_item_trans_lineage", "checksum": {"name": "sha256", "checksum": "34d3cd829d2b1f1f284ab9349ef24a6a283e34d8de4294cd51f77454c89b053b"}, "tags": [], "refs": [["ax_opco_project_item_trans"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9857829}, "model.OI_Foundation.v_opco_project_cost_frcst_lineage": {"raw_sql": "with v_opco_project_cost_frcst_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_cost_frcst')])}}\r\n)\r\n\r\nselect * from v_opco_project_cost_frcst_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_cost_frcst"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_cost_frcst_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_cost_frcst_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_cost_frcst_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_cost_frcst_lineage.sql", "name": "v_opco_project_cost_frcst_lineage", "alias": "v_opco_project_cost_frcst_lineage", "checksum": {"name": "sha256", "checksum": "826f45adac9fc010fe14ea0c0130e49e1ee7d6cdd6cc70b96db62f411631ea79"}, "tags": [], "refs": [["ax_opco_project_cost_frcst"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.989846}, "model.OI_Foundation.v_opco_project_catgry_lineage": {"raw_sql": "with v_opco_project_catgry_lineage as(\r\n    {{ union_relations(\r\n        relations=[ref('ax_opco_project_catgry')])}}\r\n)\r\n\r\nselect * from v_opco_project_catgry_lineage", "resource_type": "model", "depends_on": {"macros": ["macro.OI_Foundation.union_relations"], "nodes": ["model.OI_Foundation.ax_opco_project_catgry"]}, "config": {"enabled": true, "alias": null, "schema": "intermediate_fnd_bkp", "database": null, "tags": [], "meta": {}, "materialized": "view", "persist_docs": {}, "quoting": {}, "column_types": {}, "full_refresh": null, "on_schema_change": "ignore", "post-hook": [], "pre-hook": []}, "database": "OI_DATA_DEV_V2", "schema": "intermediate_fnd_bkp", "fqn": ["OI_Foundation", "historical_views", "project", "v_opco_project_catgry_lineage"], "unique_id": "model.OI_Foundation.v_opco_project_catgry_lineage", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "historical_views/project/v_opco_project_catgry_lineage.sql", "original_file_path": "models/historical_views/project/v_opco_project_catgry_lineage.sql", "name": "v_opco_project_catgry_lineage", "alias": "v_opco_project_catgry_lineage", "checksum": {"name": "sha256", "checksum": "a1c392f55cc219d4db32a124f96315a2b1df86c18e1ca8547cad91fe084e9fb6"}, "tags": [], "refs": [["ax_opco_project_catgry"]], "sources": [], "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "compiled_path": null, "build_path": null, "deferred": false, "unrendered_config": {"schema": "intermediate_fnd_bkp", "materialized": "view"}, "created_at": 1659086795.9941354}}, "sources": {"source.OI_Foundation.AX_DEV.INVENTTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTTABLE", "created_at": 1659086796.0702765}, "source.OI_Foundation.AX_DEV.CUSTTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTTABLE", "created_at": 1659086796.0704446}, "source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTPRECASTCODE_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTPRECASTCODE_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTPRECASTCODE_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTPRECASTCODE_OPI", "created_at": 1659086796.0705595}, "source.OI_Foundation.AX_DEV.COMPANYINFO": {"fqn": ["OI_Foundation", "AX_DEV", "COMPANYINFO"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.COMPANYINFO", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANYINFO", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "COMPANYINFO", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.COMPANYINFO", "created_at": 1659086796.07067}, "source.OI_Foundation.AX_DEV.INVENTSITE": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTSITE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTSITE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTSITE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTSITE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTSITE", "created_at": 1659086796.0707743}, "source.OI_Foundation.AX_DEV.INVENTLOCATION": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTLOCATION"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTLOCATION", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTLOCATION", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTLOCATION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTLOCATION", "created_at": 1659086796.0708828}, "source.OI_Foundation.AX_DEV.CUSTGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTGROUP", "created_at": 1659086796.071114}, "source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTPAYMMODETABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTPAYMMODETABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTPAYMMODETABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTPAYMMODETABLE", "created_at": 1659086796.071242}, "source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTPRECASTCATEGORY_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTPRECASTCATEGORY_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTPRECASTCATEGORY_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTPRECASTCATEGORY_OPI", "created_at": 1659086796.0713534}, "source.OI_Foundation.AX_DEV.CURRENCY": {"fqn": ["OI_Foundation", "AX_DEV", "CURRENCY"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CURRENCY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CURRENCY", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CURRENCY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CURRENCY", "created_at": 1659086796.0714686}, "source.OI_Foundation.AX_DEV.PAYMTERM": {"fqn": ["OI_Foundation", "AX_DEV", "PAYMTERM"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PAYMTERM", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PAYMTERM", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PAYMTERM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PAYMTERM", "created_at": 1659086796.0715702}, "source.OI_Foundation.AX_DEV.CASHDISC": {"fqn": ["OI_Foundation", "AX_DEV", "CASHDISC"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CASHDISC", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CASHDISC", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CASHDISC", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CASHDISC", "created_at": 1659086796.0716693}, "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "COMMISSIONCUSTOMERGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMMISSIONCUSTOMERGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "COMMISSIONCUSTOMERGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.COMMISSIONCUSTOMERGROUP", "created_at": 1659086796.0717669}, "source.OI_Foundation.AX_DEV.ADDRESS": {"fqn": ["OI_Foundation", "AX_DEV", "ADDRESS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.ADDRESS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "ADDRESS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "ADDRESS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.ADDRESS", "created_at": 1659086796.0718637}, "source.OI_Foundation.AX_DEV.SALESTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "SALESTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.SALESTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "SALESTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "SALESTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.SALESTABLE", "created_at": 1659086796.07196}, "source.OI_Foundation.AX_DEV.VENDTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "VENDTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDTABLE", "created_at": 1659086796.0720558}, "source.OI_Foundation.AX_DEV.CONTACTPERSON": {"fqn": ["OI_Foundation", "AX_DEV", "CONTACTPERSON"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CONTACTPERSON", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CONTACTPERSON", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CONTACTPERSON", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CONTACTPERSON", "created_at": 1659086796.0721712}, "source.OI_Foundation.AX_DEV.DIMENSIONS": {"fqn": ["OI_Foundation", "AX_DEV", "DIMENSIONS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.DIMENSIONS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "DIMENSIONS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "DIMENSIONS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.DIMENSIONS", "created_at": 1659086796.0722702}, "source.OI_Foundation.AX_DEV.UNIT": {"fqn": ["OI_Foundation", "AX_DEV", "UNIT"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.UNIT", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "UNIT", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "UNIT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.UNIT", "created_at": 1659086796.0723684}, "source.OI_Foundation.AX_DEV.INVENTDIMGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTDIMGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTDIMGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTDIMGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTDIMGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTDIMGROUP", "created_at": 1659086796.072467}, "source.OI_Foundation.AX_DEV.INVENTITEMBUYERGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTITEMBUYERGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTITEMBUYERGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTITEMBUYERGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTITEMBUYERGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTITEMBUYERGROUP", "created_at": 1659086796.0725665}, "source.OI_Foundation.AX_DEV.INVENTITEMGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTITEMGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTITEMGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTITEMGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTITEMGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTITEMGROUP", "created_at": 1659086796.0726666}, "source.OI_Foundation.AX_DEV.INVENTMODELGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTMODELGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTMODELGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTMODELGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTMODELGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTMODELGROUP", "created_at": 1659086796.0727656}, "source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTPRECASTCATEGORY_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTPRECASTCATEGORY_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTPRECASTCATEGORY_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTPRECASTCATEGORY_OPI", "created_at": 1659086796.072865}, "source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTPRECASTCODE_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTPRECASTCODE_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTPRECASTCODE_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTPRECASTCODE_OPI", "created_at": 1659086796.0729628}, "source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTPRODUCTCLASS_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTPRODUCTCLASS_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTPRODUCTCLASS_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTPRODUCTCLASS_OPI", "created_at": 1659086796.0730586}, "source.OI_Foundation.AX_DEV.REQGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "REQGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.REQGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "REQGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "REQGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.REQGROUP", "created_at": 1659086796.0731544}, "source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTSALESCLASS_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTSALESCLASS_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTSALESCLASS_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTSALESCLASS_OPI", "created_at": 1659086796.0732505}, "source.OI_Foundation.AX_DEV.INVENTSIZE": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTSIZE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTSIZE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTSIZE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTSIZE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTSIZE", "created_at": 1659086796.0734248}, "source.OI_Foundation.AX_DEV.INVENTDIM": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTDIM"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTDIM", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTDIM", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTDIM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTDIM", "created_at": 1659086796.0735347}, "source.OI_Foundation.AX_DEV.INVENTITEMPRICE": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTITEMPRICE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTITEMPRICE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTITEMPRICE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTITEMPRICE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTITEMPRICE", "created_at": 1659086796.073633}, "source.OI_Foundation.AX_DEV.LEDGERTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "LEDGERTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.LEDGERTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "LEDGERTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "LEDGERTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.LEDGERTABLE", "created_at": 1659086796.073734}, "source.OI_Foundation.AX_DEV.LEDGERBALANCESDIMTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "LEDGERBALANCESDIMTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.LEDGERBALANCESDIMTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "LEDGERBALANCESDIMTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "LEDGERBALANCESDIMTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.LEDGERBALANCESDIMTRANS", "created_at": 1659086796.0738356}, "source.OI_Foundation.AX_DEV.INVENTITEMLOCATION": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTITEMLOCATION"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTITEMLOCATION", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTITEMLOCATION", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTITEMLOCATION", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTITEMLOCATION", "created_at": 1659086796.073934}, "source.OI_Foundation.AX_DEV.INVENTSUM": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTSUM"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTSUM", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTSUM", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTSUM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTSUM", "created_at": 1659086796.0740314}, "source.OI_Foundation.AX_DEV.INVENTTABLEMODULE": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTTABLEMODULE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTTABLEMODULE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTTABLEMODULE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTTABLEMODULE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTTABLEMODULE", "created_at": 1659086796.0741282}, "source.OI_Foundation.AX_DEV.INVENTTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "INVENTTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.INVENTTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "INVENTTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "INVENTTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.INVENTTRANS", "created_at": 1659086796.0742269}, "source.OI_Foundation.AX_DEV.DLVTERM": {"fqn": ["OI_Foundation", "AX_DEV", "DLVTERM"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.DLVTERM", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "DLVTERM", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "DLVTERM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.DLVTERM", "created_at": 1659086796.074326}, "source.OI_Foundation.AX_DEV.DLVMODE": {"fqn": ["OI_Foundation", "AX_DEV", "DLVMODE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.DLVMODE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "DLVMODE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "DLVMODE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.DLVMODE", "created_at": 1659086796.0744224}, "source.OI_Foundation.AX_DEV.SALESLINE": {"fqn": ["OI_Foundation", "AX_DEV", "SALESLINE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.SALESLINE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "SALESLINE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "SALESLINE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.SALESLINE", "created_at": 1659086796.074517}, "source.OI_Foundation.AX_DEV.LEDGERTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "LEDGERTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.LEDGERTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "LEDGERTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "LEDGERTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.LEDGERTRANS", "created_at": 1659086796.0746121}, "source.OI_Foundation.AX_DEV.PURCHTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "PURCHTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PURCHTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PURCHTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PURCHTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PURCHTABLE", "created_at": 1659086796.074706}, "source.OI_Foundation.AX_DEV.PURCHLINE": {"fqn": ["OI_Foundation", "AX_DEV", "PURCHLINE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PURCHLINE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PURCHLINE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PURCHLINE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PURCHLINE", "created_at": 1659086796.0748043}, "source.OI_Foundation.AX_DEV.PROJTABLE": {"fqn": ["OI_Foundation", "AX_DEV", "PROJTABLE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJTABLE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJTABLE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJTABLE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJTABLE", "created_at": 1659086796.0749042}, "source.OI_Foundation.AX_DEV.VENDTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "VENDTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDTRANS", "created_at": 1659086796.0750043}, "source.OI_Foundation.AX_DEV.VENDINVOICEJOUR": {"fqn": ["OI_Foundation", "AX_DEV", "VENDINVOICEJOUR"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDINVOICEJOUR", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDINVOICEJOUR", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDINVOICEJOUR", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDINVOICEJOUR", "created_at": 1659086796.0751014}, "source.OI_Foundation.AX_DEV.CUSTTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTTRANS", "created_at": 1659086796.0751965}, "source.OI_Foundation.AX_DEV.CUSTSETTLEMENT": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTSETTLEMENT"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTSETTLEMENT", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTSETTLEMENT", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTSETTLEMENT", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTSETTLEMENT", "created_at": 1659086796.075297}, "source.OI_Foundation.AX_DEV.PRICEDISCGROUP": {"fqn": ["OI_Foundation", "AX_DEV", "PRICEDISCGROUP"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PRICEDISCGROUP", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PRICEDISCGROUP", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PRICEDISCGROUP", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PRICEDISCGROUP", "created_at": 1659086796.075391}, "source.OI_Foundation.AX_DEV.PROJCATEGORY": {"fqn": ["OI_Foundation", "AX_DEV", "PROJCATEGORY"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJCATEGORY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJCATEGORY", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJCATEGORY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJCATEGORY", "created_at": 1659086796.075517}, "source.OI_Foundation.AX_DEV.WMSPICKINGROUTE": {"fqn": ["OI_Foundation", "AX_DEV", "WMSPICKINGROUTE"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.WMSPICKINGROUTE", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "WMSPICKINGROUTE", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "WMSPICKINGROUTE", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.WMSPICKINGROUTE", "created_at": 1659086796.075615}, "source.OI_Foundation.AX_DEV.PROJCOSTTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "PROJCOSTTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJCOSTTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJCOSTTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJCOSTTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJCOSTTRANS", "created_at": 1659086796.0757163}, "source.OI_Foundation.AX_DEV.CUSTTRANSOPEN": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTTRANSOPEN"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTTRANSOPEN", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTTRANSOPEN", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTTRANSOPEN", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTTRANSOPEN", "created_at": 1659086796.0758126}, "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTPACKINGSLIPJOUR"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTPACKINGSLIPJOUR", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTPACKINGSLIPJOUR", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTPACKINGSLIPJOUR", "created_at": 1659086796.0759065}, "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTPACKINGSLIPTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTPACKINGSLIPTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTPACKINGSLIPTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTPACKINGSLIPTRANS", "created_at": 1659086796.0760012}, "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTINVOICEJOUR"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTINVOICEJOUR", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTINVOICEJOUR", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTINVOICEJOUR", "created_at": 1659086796.0760996}, "source.OI_Foundation.AX_DEV.CUSTINVOICETRANS": {"fqn": ["OI_Foundation", "AX_DEV", "CUSTINVOICETRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.CUSTINVOICETRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CUSTINVOICETRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "CUSTINVOICETRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.CUSTINVOICETRANS", "created_at": 1659086796.0762262}, "source.OI_Foundation.AX_DEV.VENDINVOICETRANS": {"fqn": ["OI_Foundation", "AX_DEV", "VENDINVOICETRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDINVOICETRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDINVOICETRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDINVOICETRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDINVOICETRANS", "created_at": 1659086796.076323}, "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR": {"fqn": ["OI_Foundation", "AX_DEV", "VENDPACKINGSLIPJOUR"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDPACKINGSLIPJOUR", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDPACKINGSLIPJOUR", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDPACKINGSLIPJOUR", "created_at": 1659086796.0764189}, "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "VENDPACKINGSLIPTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "VENDPACKINGSLIPTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "VENDPACKINGSLIPTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.VENDPACKINGSLIPTRANS", "created_at": 1659086796.0765169}, "source.OI_Foundation.AX_DEV.PROJITEMTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "PROJITEMTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJITEMTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJITEMTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJITEMTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJITEMTRANS", "created_at": 1659086796.0766115}, "source.OI_Foundation.AX_DEV.PROJEMPLTRANS": {"fqn": ["OI_Foundation", "AX_DEV", "PROJEMPLTRANS"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJEMPLTRANS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJEMPLTRANS", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJEMPLTRANS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJEMPLTRANS", "created_at": 1659086796.0767097}, "source.OI_Foundation.AX_DEV.PROJFORECASTCOST": {"fqn": ["OI_Foundation", "AX_DEV", "PROJFORECASTCOST"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJFORECASTCOST", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJFORECASTCOST", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJFORECASTCOST", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJFORECASTCOST", "created_at": 1659086796.0768037}, "source.OI_Foundation.AX_DEV.PROJFORECASTEMPL": {"fqn": ["OI_Foundation", "AX_DEV", "PROJFORECASTEMPL"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJFORECASTEMPL", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJFORECASTEMPL", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJFORECASTEMPL", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJFORECASTEMPL", "created_at": 1659086796.076898}, "source.OI_Foundation.AX_DEV.PROJTRANSPOSTING": {"fqn": ["OI_Foundation", "AX_DEV", "PROJTRANSPOSTING"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJTRANSPOSTING", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJTRANSPOSTING", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJTRANSPOSTING", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJTRANSPOSTING", "created_at": 1659086796.0769925}, "source.OI_Foundation.AX_DEV.PROJREVENUE_OPI": {"fqn": ["OI_Foundation", "AX_DEV", "PROJREVENUE_OPI"], "database": "FIVETRAN", "schema": "AX_PRODREPLICATION1_DBO", "unique_id": "source.OI_Foundation.AX_DEV.PROJREVENUE_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PROJREVENUE_OPI", "source_name": "AX_DEV", "source_description": "", "loader": "", "identifier": "PROJREVENUE_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODREPLICATION1_DBO.PROJREVENUE_OPI", "created_at": 1659086796.0770862}, "source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93": {"fqn": ["OI_Foundation", "AX_PRODVIEW", "DIM_TIME_93"], "database": "FIVETRAN", "schema": "AX_PRODVIEW_DBO", "unique_id": "source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "DIM_TIME_93", "source_name": "AX_PRODVIEW", "source_description": "", "loader": "", "identifier": "DIM_TIME_93", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.AX_PRODVIEW_DBO.DIM_TIME_93", "created_at": 1659086796.077183}, "source.OI_Foundation.NS_DEV.PAYMENT_TERMS": {"fqn": ["OI_Foundation", "NS_DEV", "PAYMENT_TERMS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.PAYMENT_TERMS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PAYMENT_TERMS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "PAYMENT_TERMS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.PAYMENT_TERMS", "created_at": 1659086796.0772805}, "source.OI_Foundation.NS_DEV.PAYMENT_METHODS": {"fqn": ["OI_Foundation", "NS_DEV", "PAYMENT_METHODS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.PAYMENT_METHODS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "PAYMENT_METHODS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "PAYMENT_METHODS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.PAYMENT_METHODS", "created_at": 1659086796.0773902}, "source.OI_Foundation.NS_DEV.CURRENCIES": {"fqn": ["OI_Foundation", "NS_DEV", "CURRENCIES"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.CURRENCIES", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CURRENCIES", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "CURRENCIES", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.CURRENCIES", "created_at": 1659086796.0774868}, "source.OI_Foundation.NS_DEV.LOCATIONS": {"fqn": ["OI_Foundation", "NS_DEV", "LOCATIONS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.LOCATIONS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "LOCATIONS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "LOCATIONS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.LOCATIONS", "created_at": 1659086796.0775855}, "source.OI_Foundation.NS_DEV.DEPARTMENTS": {"fqn": ["OI_Foundation", "NS_DEV", "DEPARTMENTS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.DEPARTMENTS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "DEPARTMENTS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "DEPARTMENTS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.DEPARTMENTS", "created_at": 1659086796.0776827}, "source.OI_Foundation.NS_DEV.COMPANY_OPI": {"fqn": ["OI_Foundation", "NS_DEV", "COMPANY_OPI"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.COMPANY_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANY_OPI", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "COMPANY_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.COMPANY_OPI", "created_at": 1659086796.077777}, "source.OI_Foundation.NS_DEV.REGION_OPI": {"fqn": ["OI_Foundation", "NS_DEV", "REGION_OPI"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.REGION_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "REGION_OPI", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "REGION_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.REGION_OPI", "created_at": 1659086796.0778713}, "source.OI_Foundation.NS_DEV.SUBREGION_OPI": {"fqn": ["OI_Foundation", "NS_DEV", "SUBREGION_OPI"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.SUBREGION_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "SUBREGION_OPI", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "SUBREGION_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.SUBREGION_OPI", "created_at": 1659086796.0779653}, "source.OI_Foundation.NS_DEV.ACCOUNTS": {"fqn": ["OI_Foundation", "NS_DEV", "ACCOUNTS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.ACCOUNTS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "ACCOUNTS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "ACCOUNTS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.ACCOUNTS", "created_at": 1659086796.0780592}, "source.OI_Foundation.NS_DEV.TRANSACTIONS": {"fqn": ["OI_Foundation", "NS_DEV", "TRANSACTIONS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.TRANSACTIONS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "TRANSACTIONS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "TRANSACTIONS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.TRANSACTIONS", "created_at": 1659086796.0781534}, "source.OI_Foundation.NS_DEV.TRANSACTION_LINES": {"fqn": ["OI_Foundation", "NS_DEV", "TRANSACTION_LINES"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.TRANSACTION_LINES", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "TRANSACTION_LINES", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "TRANSACTION_LINES", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.TRANSACTION_LINES", "created_at": 1659086796.0782504}, "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS": {"fqn": ["OI_Foundation", "NS_DEV", "ACCOUNTING_PERIODS"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "ACCOUNTING_PERIODS", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "ACCOUNTING_PERIODS", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.ACCOUNTING_PERIODS", "created_at": 1659086796.0783439}, "source.OI_Foundation.NS_DEV.MARKET_OPI": {"fqn": ["OI_Foundation", "NS_DEV", "MARKET_OPI"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.MARKET_OPI", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "MARKET_OPI", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "MARKET_OPI", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.MARKET_OPI", "created_at": 1659086796.0784407}, "source.OI_Foundation.NS_DEV.CLASSES": {"fqn": ["OI_Foundation", "NS_DEV", "CLASSES"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.CLASSES", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "CLASSES", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "CLASSES", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.CLASSES", "created_at": 1659086796.0786266}, "source.OI_Foundation.NS_DEV.UOM": {"fqn": ["OI_Foundation", "NS_DEV", "UOM"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.UOM", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "UOM", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "UOM", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.UOM", "created_at": 1659086796.0787306}, "source.OI_Foundation.NS_DEV.SUBSIDIARIES": {"fqn": ["OI_Foundation", "NS_DEV", "SUBSIDIARIES"], "database": "FIVETRAN", "schema": "NETSUITE", "unique_id": "source.OI_Foundation.NS_DEV.SUBSIDIARIES", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "SUBSIDIARIES", "source_name": "NS_DEV", "source_description": "", "loader": "", "identifier": "SUBSIDIARIES", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "FIVETRAN.NETSUITE.SUBSIDIARIES", "created_at": 1659086796.0788333}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0013"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0013", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0013", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0013", "created_at": 1659086796.0789306}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0010"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0010", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0010", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0010", "created_at": 1659086796.0790267}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0101"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0101", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0101", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0101", "created_at": 1659086796.0791218}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F01151"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F01151", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F01151", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F01151", "created_at": 1659086796.0792186}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0006"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0006", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0006", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0006", "created_at": 1659086796.079318}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODCTL_F0005"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODCTL_F0005", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODCTL_F0005", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODCTL_F0005", "created_at": 1659086796.0794122}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0901"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0901", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0901", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0901", "created_at": 1659086796.0795062}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0911"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0911", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0911", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0911", "created_at": 1659086796.0796313}, "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE_PRODUCTION_PRODDTA_F0902"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE_PRODUCTION_PRODDTA_F0902", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE_PRODUCTION_PRODDTA_F0902", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE_PRODUCTION_PRODDTA_F0902", "created_at": 1659086796.079732}, "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210": {"fqn": ["OI_Foundation", "JDE_DEV", "JDE920_DD920_F9210"], "database": "MULE_STAGING", "schema": "JDE_HANCOCK", "unique_id": "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "JDE920_DD920_F9210", "source_name": "JDE_DEV", "source_description": "", "loader": "", "identifier": "JDE920_DD920_F9210", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.JDE_HANCOCK.JDE920_DD920_F9210", "created_at": 1659086796.079832}, "source.OI_Foundation.PRIMEX_DEV.COMPANYA_DBO_TBLCURRENCY": {"fqn": ["OI_Foundation", "PRIMEX_DEV", "COMPANYA_DBO_TBLCURRENCY"], "database": "MULE_STAGING", "schema": "SYSPRO_PRIMEX", "unique_id": "source.OI_Foundation.PRIMEX_DEV.COMPANYA_DBO_TBLCURRENCY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANYA_DBO_TBLCURRENCY", "source_name": "PRIMEX_DEV", "source_description": "", "loader": "", "identifier": "COMPANYA_DBO_TBLCURRENCY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.SYSPRO_PRIMEX.COMPANYA_DBO_TBLCURRENCY", "created_at": 1659086796.0799358}, "source.OI_Foundation.PRIMEX_DEV.COMPANYC_DBO_TBLCURRENCY": {"fqn": ["OI_Foundation", "PRIMEX_DEV", "COMPANYC_DBO_TBLCURRENCY"], "database": "MULE_STAGING", "schema": "SYSPRO_PRIMEX", "unique_id": "source.OI_Foundation.PRIMEX_DEV.COMPANYC_DBO_TBLCURRENCY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANYC_DBO_TBLCURRENCY", "source_name": "PRIMEX_DEV", "source_description": "", "loader": "", "identifier": "COMPANYC_DBO_TBLCURRENCY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.SYSPRO_PRIMEX.COMPANYC_DBO_TBLCURRENCY", "created_at": 1659086796.0800347}, "source.OI_Foundation.PRIMEX_DEV.COMPANYP_DBO_TBLCURRENCY": {"fqn": ["OI_Foundation", "PRIMEX_DEV", "COMPANYP_DBO_TBLCURRENCY"], "database": "MULE_STAGING", "schema": "SYSPRO_PRIMEX", "unique_id": "source.OI_Foundation.PRIMEX_DEV.COMPANYP_DBO_TBLCURRENCY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANYP_DBO_TBLCURRENCY", "source_name": "PRIMEX_DEV", "source_description": "", "loader": "", "identifier": "COMPANYP_DBO_TBLCURRENCY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.SYSPRO_PRIMEX.COMPANYP_DBO_TBLCURRENCY", "created_at": 1659086796.0801516}, "source.OI_Foundation.PRIMEX_DEV.COMPANYX_DBO_TBLCURRENCY": {"fqn": ["OI_Foundation", "PRIMEX_DEV", "COMPANYX_DBO_TBLCURRENCY"], "database": "MULE_STAGING", "schema": "SYSPRO_PRIMEX", "unique_id": "source.OI_Foundation.PRIMEX_DEV.COMPANYX_DBO_TBLCURRENCY", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "models/sources.yml", "original_file_path": "models/sources.yml", "name": "COMPANYX_DBO_TBLCURRENCY", "source_name": "PRIMEX_DEV", "source_description": "", "loader": "", "identifier": "COMPANYX_DBO_TBLCURRENCY", "resource_type": "source", "quoting": {"database": null, "schema": null, "identifier": null, "column": null}, "loaded_at_field": null, "freshness": {"warn_after": {"count": null, "period": null}, "error_after": {"count": null, "period": null}, "filter": null}, "external": null, "description": "", "columns": {}, "meta": {}, "source_meta": {}, "tags": [], "config": {"enabled": true}, "patch_path": null, "unrendered_config": {}, "relation_name": "MULE_STAGING.SYSPRO_PRIMEX.COMPANYX_DBO_TBLCURRENCY", "created_at": 1659086796.08025}}, "macros": {"macro.OI_Foundation.increment_col": {"unique_id": "macro.OI_Foundation.increment_col", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/increment_col.sql", "original_file_path": "macros/increment_col.sql", "name": "increment_col", "macro_sql": "{% macro increment_col(tb_nm) %}\r\n\r\n    {% set myquery %}\r\n        SELECT DISTINCT INCRMNT_LOAD_ON from {{ var('fnd_tbl_db')}}.{{ var('intermediate_tbl_sch')}}._FOUNDATION_LOAD_CONFIG WHERE TARGET_MODEL_NM = '{{tb_nm}}'\r\n    {% endset %}\r\n    {% set results=run_query(myquery) %}\r\n    {% if execute %}\r\n        {% set rset=results.columns[0].values()[0] %}\r\n    {% endif %}\r\n\r\n    {{ return(rset)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8044589}, "macro.OI_Foundation.clndr_yr": {"unique_id": "macro.OI_Foundation.clndr_yr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "clndr_yr", "macro_sql": "{% macro clndr_yr(dt) %}\r\n    concat((substring({{ dt}}, 1, 1)::int + 19)::varchar, substring({{ dt}}, 2, 2))\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.805705}, "macro.OI_Foundation.clndr_day": {"unique_id": "macro.OI_Foundation.clndr_day", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "clndr_day", "macro_sql": "{% macro clndr_day(dt) %}\r\n    substring({{ dt}}, 4, 3)\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8059402}, "macro.OI_Foundation.hr": {"unique_id": "macro.OI_Foundation.hr", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "hr", "macro_sql": "{% macro hr(ts) %}\r\n    substring({{ ts}}, 1, 2)\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.806166}, "macro.OI_Foundation.mn": {"unique_id": "macro.OI_Foundation.mn", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "mn", "macro_sql": "{% macro mn(ts) %}\r\n    substring({{ ts}}, 3, 2)\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8063912}, "macro.OI_Foundation.sec": {"unique_id": "macro.OI_Foundation.sec", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "sec", "macro_sql": "{% macro sec(ts) %}\r\n    substring({{ ts}}, 5, 2)\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8067172}, "macro.OI_Foundation.julian_to_clndr_dt": {"unique_id": "macro.OI_Foundation.julian_to_clndr_dt", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/julian_to_clndr_dt.sql", "original_file_path": "macros/julian_to_clndr_dt.sql", "name": "julian_to_clndr_dt", "macro_sql": "{% macro julian_to_clndr_dt(dt, ts = none) %}\r\n    {% if ts is none %}\r\n        date_from_parts({{ clndr_yr(dt|string)}}, 1, {{ clndr_day(dt|string)}})\r\n    {% else %}\r\n        timestamp_tz_from_parts({{ clndr_yr(dt|string)}}, 1, {{ clndr_day(dt|string)}}, {{ hr(ts|string)}}, {{ mn(ts|string)}}, {{ sec(ts|string)}})\r\n    {% endif %}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.OI_Foundation.clndr_yr", "macro.OI_Foundation.clndr_day", "macro.OI_Foundation.hr", "macro.OI_Foundation.mn", "macro.OI_Foundation.sec"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.807846}, "macro.OI_Foundation.tb_check": {"unique_id": "macro.OI_Foundation.tb_check", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/tb_check.sql", "original_file_path": "macros/tb_check.sql", "name": "tb_check", "macro_sql": "{% macro tb_check(db_nm, sch_nm, tb_nm) %}\r\n\r\n    {% set myquery %}\r\n        SELECT EXISTS(SELECT * FROM {{db_nm}}.information_schema.tables WHERE table_schema = '{{sch_nm}}' AND table_name = '{{tb_nm}}')\r\n    {% endset %}\r\n    {% set results=run_query(myquery) %}\r\n    {% if execute %}\r\n        {% set rset=results.columns[0].values()[0] %}\r\n    {% endif %}\r\n\r\n    {{ return(rset)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8092706}, "macro.OI_Foundation.generate_schema_name": {"unique_id": "macro.OI_Foundation.generate_schema_name", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/generate_schema_name.sql", "original_file_path": "macros/generate_schema_name.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name, node) -%}\r\n\r\n    {%- set default_schema = target.schema -%}\r\n    {%- if custom_schema_name is none -%}\r\n\r\n        {{ default_schema }}\r\n\r\n    {%- else -%}\r\n\r\n        {{ custom_schema_name | trim }}\r\n\r\n    {%- endif -%}\r\n\r\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8103669}, "macro.OI_Foundation.spcl_chr_rp": {"unique_id": "macro.OI_Foundation.spcl_chr_rp", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/spcl_chr_rp.sql", "original_file_path": "macros/spcl_chr_rp.sql", "name": "spcl_chr_rp", "macro_sql": "{% macro spcl_chr_rp(col) %}\r\n    \r\n    trim(regexp_replace(\r\n            regexp_replace(\r\n                regexp_replace(\r\n                    regexp_replace(\r\n                        regexp_replace(\r\n                            regexp_replace(\r\n                                regexp_replace(\r\n                                    IFNULL(NULLIF({{ col}}, ''), 'NULL'), \r\n                                '[ ]+', ' '),\r\n                            '[\\]\\[\\\\\\/!@#$%\\^*(){}|?~`,\\n\\t\\r]', ' '), \r\n                        '&', ' and '), \r\n                    '<', '.LT.'), \r\n                '>', '.GT.'), \r\n            '[\\+]', ' plus '), \r\n        '=', ' equal '))\r\n    \r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8110657}, "macro.OI_Foundation.table_check": {"unique_id": "macro.OI_Foundation.table_check", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/table_check.sql", "original_file_path": "macros/table_check.sql", "name": "table_check", "macro_sql": "{% macro table_check(tb_nm1, tb_nm2) %}\r\n    {% set present_comp = [] %}\r\n    {% for tbl in var('primex_companies') %}\r\n        {% set myquery %}\r\n            SELECT EXISTS(SELECT * FROM mule_staging.information_schema.tables WHERE table_schema = 'SYSPRO_PRIMEX' AND table_name = '{{ tb_nm1}}{{ tbl}}{{ tb_nm2}}')\r\n        {% endset %}\r\n        {% set results=run_query(myquery) %}\r\n        {% if execute %}\r\n            {% set rset=results.columns[0].values()[0] %}\r\n        {% endif %}\r\n        {% if rset %}\r\n            {% do present_comp.append(tbl) %}\r\n        {% endif %}\r\n    {% endfor %}\r\n    {{ return(present_comp) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.813139}, "macro.OI_Foundation.union_relations": {"unique_id": "macro.OI_Foundation.union_relations", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/union_relations.sql", "original_file_path": "macros/union_relations.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\r\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name, where)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.OI_Foundation.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.817605}, "macro.OI_Foundation.default__union_relations": {"unique_id": "macro.OI_Foundation.default__union_relations", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/union_relations.sql", "original_file_path": "macros/union_relations.sql", "name": "default__union_relations", "macro_sql": "\r\n\r\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation', where=none) -%}\r\n\r\n    {%- if exclude and include -%}\r\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\r\n    {%- endif -%}\r\n\r\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\r\n    {%- if not execute %}\r\n        {{ return('') }}\r\n    {% endif -%}\r\n\r\n    {%- set column_override = column_override if column_override is not none else {} -%}\r\n\r\n    {%- set relation_columns = {} -%}\r\n    {%- set column_superset = {} -%}\r\n\r\n    {%- for relation in relations -%}\r\n\r\n        {%- do relation_columns.update({relation: []}) -%}\r\n\r\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\r\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\r\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\r\n        {%- for col in cols -%}\r\n\r\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\r\n        {%- if exclude and col.column in exclude -%}\r\n\r\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\r\n        {%- elif include and col.column not in include -%}\r\n\r\n        {#- Otherwise add the column to the column superset -#}\r\n        {%- else -%}\r\n\r\n            {#- update the list of columns in this relation -#}\r\n            {%- do relation_columns[relation].append(col.column) -%}\r\n\r\n            {%- if col.column in column_superset -%}\r\n\r\n                {%- set stored = column_superset[col.column] -%}\r\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\r\n\r\n                    {%- do column_superset.update({col.column: col}) -%}\r\n\r\n                {%- endif %}\r\n\r\n            {%- else -%}\r\n\r\n                {%- do column_superset.update({col.column: col}) -%}\r\n\r\n            {%- endif -%}\r\n\r\n        {%- endif -%}\r\n\r\n        {%- endfor -%}\r\n    {%- endfor -%}\r\n\r\n    {%- set ordered_column_names = column_superset.keys() -%}\r\n    {%- set dbt_command = flags.WHICH -%}\r\n\r\n\r\n    {% if dbt_command in ['run', 'build'] %}\r\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\r\n        {%- set relations_string -%}\r\n            {%- for relation in relations -%}\r\n                {{ relation.name }}\r\n            {%- if not loop.last %}, {% endif -%}\r\n            {%- endfor -%}\r\n        {%- endset -%}\r\n\r\n        {%- set error_message -%}\r\n            There were no columns found to union for relations {{ relations_string }}\r\n        {%- endset -%}\r\n\r\n        {{ exceptions.raise_compiler_error(error_message) }}\r\n    {%- endif -%}\r\n    {%- endif -%}\r\n\r\n    {%- for relation in relations %}\r\n\r\n        (\r\n            select\r\n\r\n                {% for col_name in ordered_column_names -%}\r\n\r\n                    {%- set col = column_superset[col_name] %}\r\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\r\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\r\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\r\n\r\n                {%- endfor %}\r\n\r\n            from {{ relation }}\r\n\r\n            {% if where -%}\r\n            where {{ where }}\r\n            {%- endif %}\r\n        )\r\n\r\n        {% if not loop.last -%}\r\n            union all\r\n        {% endif -%}\r\n\r\n    {%- endfor -%}\r\n\r\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.824077}, "macro.OI_Foundation.load_type": {"unique_id": "macro.OI_Foundation.load_type", "package_name": "OI_Foundation", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852", "path": "macros/load_type.sql", "original_file_path": "macros/load_type.sql", "name": "load_type", "macro_sql": "{% macro load_type(tb_nm) %}\r\n\r\n    {% set myquery %}\r\n        SELECT LOAD_TYPE from {{ var('fnd_tbl_db')}}.{{ var('intermediate_tbl_sch')}}._FOUNDATION_LOAD_CONFIG WHERE MODEL_NM = '{{tb_nm}}'\r\n    {% endset %}\r\n    {% set results=run_query(myquery) %}\r\n    {% if execute %}\r\n        {% set rset=results.columns[0].values()[0] %}\r\n    {% endif %}\r\n\r\n    {{ return(rset)}}\r\n\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.825783}, "macro.dbt_snowflake.snowflake__create_table_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_table_as", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__create_table_as", "macro_sql": "{% macro snowflake__create_table_as(temporary, relation, sql) -%}\n  {%- set transient = config.get('transient', default=true) -%}\n  {%- set cluster_by_keys = config.get('cluster_by', default=none) -%}\n  {%- set enable_automatic_clustering = config.get('automatic_clustering', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n\n  {%- if cluster_by_keys is not none and cluster_by_keys is string -%}\n    {%- set cluster_by_keys = [cluster_by_keys] -%}\n  {%- endif -%}\n  {%- if cluster_by_keys is not none -%}\n    {%- set cluster_by_string = cluster_by_keys|join(\", \")-%}\n  {% else %}\n    {%- set cluster_by_string = none -%}\n  {%- endif -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n\n      create or replace {% if temporary -%}\n        temporary\n      {%- elif transient -%}\n        transient\n      {%- endif %} table {{ relation }} {% if copy_grants and not temporary -%} copy grants {%- endif %} as\n      (\n        {%- if cluster_by_string is not none -%}\n          select * from(\n            {{ sql }}\n            ) order by ({{ cluster_by_string }})\n        {%- else -%}\n          {{ sql }}\n        {%- endif %}\n      );\n    {% if cluster_by_string is not none and not temporary -%}\n      alter table {{relation}} cluster by ({{cluster_by_string}});\n    {%- endif -%}\n    {% if enable_automatic_clustering and cluster_by_string is not none and not temporary  -%}\n      alter table {{relation}} resume recluster;\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.846125}, "macro.dbt_snowflake.get_column_comment_sql": {"unique_id": "macro.dbt_snowflake.get_column_comment_sql", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "get_column_comment_sql", "macro_sql": "{% macro get_column_comment_sql(column_name, column_dict) %}\n  {{ adapter.quote(column_name) if column_dict[column_name]['quote'] else column_name }} COMMENT $${{ column_dict[column_name]['description'] | replace('$', '[$]') }}$$\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8468482}, "macro.dbt_snowflake.get_persist_docs_column_list": {"unique_id": "macro.dbt_snowflake.get_persist_docs_column_list", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "get_persist_docs_column_list", "macro_sql": "{% macro get_persist_docs_column_list(model_columns, query_columns) %}\n(\n  {% for column_name in query_columns %}\n    {% if (column_name|upper in model_columns) or (column_name in model_columns) %}\n      {{ get_column_comment_sql(column_name, model_columns) }}\n    {% else %}\n      {{column_name}}\n    {% endif %}\n    {{ \", \" if not loop.last else \"\" }}\n  {% endfor %}\n)\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.847784}, "macro.dbt_snowflake.snowflake__create_view_as": {"unique_id": "macro.dbt_snowflake.snowflake__create_view_as", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__create_view_as", "macro_sql": "{% macro snowflake__create_view_as(relation, sql) -%}\n  {%- set secure = config.get('secure', default=false) -%}\n  {%- set copy_grants = config.get('copy_grants', default=false) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create or replace {% if secure -%}\n    secure\n  {%- endif %} view {{ relation }} \n  {% if config.persist_column_docs() -%}\n    {% set model_columns = model.columns %}\n    {% set query_columns = get_columns_in_query(sql) %}\n    {{ get_persist_docs_column_list(model_columns, query_columns) }}\n    \n  {%- endif %}\n  {% if copy_grants -%} copy grants {%- endif %} as (\n    {{ sql }}\n  );\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query", "macro.dbt_snowflake.get_persist_docs_column_list"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8493996}, "macro.dbt_snowflake.snowflake__get_columns_in_relation": {"unique_id": "macro.dbt_snowflake.snowflake__get_columns_in_relation", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__get_columns_in_relation", "macro_sql": "{% macro snowflake__get_columns_in_relation(relation) -%}\n  {%- set sql -%}\n    describe table {{ relation }}\n  {%- endset -%}\n  {%- set result = run_query(sql) -%}\n\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many columns in relation {{ relation }}! dbt can only get\n      information about relations with fewer than {{ maximum }} columns.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n\n  {% set columns = [] %}\n  {% for row in result %}\n    {% do columns.append(api.Column.from_description(row['name'], row['type'])) %}\n  {% endfor %}\n  {% do return(columns) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8510768}, "macro.dbt_snowflake.snowflake__list_schemas": {"unique_id": "macro.dbt_snowflake.snowflake__list_schemas", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__list_schemas", "macro_sql": "{% macro snowflake__list_schemas(database) -%}\n  {# 10k limit from here: https://docs.snowflake.net/manuals/sql-reference/sql/show-schemas.html#usage-notes #}\n  {% set maximum = 10000 %}\n  {% set sql -%}\n    show terse schemas in database {{ database }}\n    limit {{ maximum }}\n  {%- endset %}\n  {% set result = run_query(sql) %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in database {{ database }}! dbt can only get\n      information about databases with fewer than {{ maximum }} schemas.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {{ return(result) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8522887}, "macro.dbt_snowflake.snowflake__list_relations_without_caching": {"unique_id": "macro.dbt_snowflake.snowflake__list_relations_without_caching", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__list_relations_without_caching", "macro_sql": "{% macro snowflake__list_relations_without_caching(schema_relation) %}\n  {%- set sql -%}\n    show terse objects in {{ schema_relation }}\n  {%- endset -%}\n\n  {%- set result = run_query(sql) -%}\n  {% set maximum = 10000 %}\n  {% if (result | length) >= maximum %}\n    {% set msg %}\n      Too many schemas in schema  {{ schema_relation }}! dbt can only get\n      information about schemas with fewer than {{ maximum }} objects.\n    {% endset %}\n    {% do exceptions.raise_compiler_error(msg) %}\n  {% endif %}\n  {%- do return(result) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.853389}, "macro.dbt_snowflake.snowflake__check_schema_exists": {"unique_id": "macro.dbt_snowflake.snowflake__check_schema_exists", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__check_schema_exists", "macro_sql": "{% macro snowflake__check_schema_exists(information_schema, schema) -%}\n  {% call statement('check_schema_exists', fetch_result=True) -%}\n        select count(*)\n        from {{ information_schema }}.schemata\n        where upper(schema_name) = upper('{{ schema }}')\n            and upper(catalog_name) = upper('{{ information_schema.database }}')\n  {%- endcall %}\n  {{ return(load_result('check_schema_exists').table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8540883}, "macro.dbt_snowflake.snowflake__current_timestamp": {"unique_id": "macro.dbt_snowflake.snowflake__current_timestamp", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__current_timestamp", "macro_sql": "{% macro snowflake__current_timestamp() -%}\n  convert_timezone('UTC', current_timestamp())\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8542821}, "macro.dbt_snowflake.snowflake__snapshot_string_as_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_string_as_time", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__snapshot_string_as_time", "macro_sql": "{% macro snowflake__snapshot_string_as_time(timestamp) -%}\n    {%- set result = \"to_timestamp_ntz('\" ~ timestamp ~ \"')\" -%}\n    {{ return(result) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8547192}, "macro.dbt_snowflake.snowflake__snapshot_get_time": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_get_time", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__snapshot_get_time", "macro_sql": "{% macro snowflake__snapshot_get_time() -%}\n  to_timestamp_ntz({{ current_timestamp() }})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.854978}, "macro.dbt_snowflake.snowflake__rename_relation": {"unique_id": "macro.dbt_snowflake.snowflake__rename_relation", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__rename_relation", "macro_sql": "{% macro snowflake__rename_relation(from_relation, to_relation) -%}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ to_relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.855427}, "macro.dbt_snowflake.snowflake__alter_column_type": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_type", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_column_type", "macro_sql": "{% macro snowflake__alter_column_type(relation, column_name, new_column_type) -%}\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} alter {{ adapter.quote(column_name) }} set data type {{ new_column_type }};\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8560064}, "macro.dbt_snowflake.snowflake__alter_relation_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_relation_comment", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_relation_comment", "macro_sql": "{% macro snowflake__alter_relation_comment(relation, relation_comment) -%}\n  comment on {{ relation.type }} {{ relation }} IS $${{ relation_comment | replace('$', '[$]') }}$$;\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8565013}, "macro.dbt_snowflake.snowflake__alter_column_comment": {"unique_id": "macro.dbt_snowflake.snowflake__alter_column_comment", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_column_comment", "macro_sql": "{% macro snowflake__alter_column_comment(relation, column_dict) -%}\n    {% set existing_columns = adapter.get_columns_in_relation(relation) | map(attribute=\"name\") | list %}\n    alter {{ relation.type }} {{ relation }} alter\n    {% for column_name in column_dict if (column_name in existing_columns) or (column_name|upper in existing_columns) %}\n        {{ get_column_comment_sql(column_name, column_dict) }} {{ ',' if not loop.last else ';' }}\n    {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_column_comment_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8576334}, "macro.dbt_snowflake.get_current_query_tag": {"unique_id": "macro.dbt_snowflake.get_current_query_tag", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "get_current_query_tag", "macro_sql": "{% macro get_current_query_tag() -%}\n  {{ return(run_query(\"show parameters like 'query_tag' in session\").rows[0]['value']) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.858055}, "macro.dbt_snowflake.set_query_tag": {"unique_id": "macro.dbt_snowflake.set_query_tag", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "set_query_tag", "macro_sql": "{% macro set_query_tag() -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% set original_query_tag = get_current_query_tag() %}\n    {{ log(\"Setting query_tag to '\" ~ new_query_tag ~ \"'. Will reset to '\" ~ original_query_tag ~ \"' after materialization.\") }}\n    {% do run_query(\"alter session set query_tag = '{}'\".format(new_query_tag)) %}\n    {{ return(original_query_tag)}}\n  {% endif %}\n  {{ return(none)}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.get_current_query_tag", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.859234}, "macro.dbt_snowflake.unset_query_tag": {"unique_id": "macro.dbt_snowflake.unset_query_tag", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "unset_query_tag", "macro_sql": "{% macro unset_query_tag(original_query_tag) -%}\n  {% set new_query_tag = config.get('query_tag') %}\n  {% if new_query_tag %}\n    {% if original_query_tag %}\n      {{ log(\"Resetting query_tag to '\" ~ original_query_tag ~ \"'.\") }}\n      {% do run_query(\"alter session set query_tag = '{}'\".format(original_query_tag)) %}\n    {% else %}\n      {{ log(\"No original query_tag, unsetting parameter.\") }}\n      {% do run_query(\"alter session unset query_tag\") %}\n    {% endif %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.860347}, "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns": {"unique_id": "macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__alter_relation_add_remove_columns", "macro_sql": "{% macro snowflake__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n  \n  {% if add_columns %}\n    \n    {% set sql -%}\n       alter {{ relation.type }} {{ relation }} add column\n          {% for column in add_columns %}\n            {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n          {% endfor %}\n    {%- endset -%}\n\n    {% do run_query(sql) %}\n\n  {% endif %}\n\n  {% if remove_columns %}\n  \n    {% set sql -%}\n        alter {{ relation.type }} {{ relation }} drop column\n            {% for column in remove_columns %}\n                {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n    {%- endset -%}\n    \n    {% do run_query(sql) %}\n    \n  {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8620367}, "macro.dbt_snowflake.snowflake_dml_explicit_transaction": {"unique_id": "macro.dbt_snowflake.snowflake_dml_explicit_transaction", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake_dml_explicit_transaction", "macro_sql": "{% macro snowflake_dml_explicit_transaction(dml) %}\n  {#\n    Use this macro to wrap all INSERT, MERGE, UPDATE, DELETE, and TRUNCATE \n    statements before passing them into run_query(), or calling in the 'main' statement\n    of a materialization\n  #}\n  {% set dml_transaction -%}\n    begin;\n    {{ dml }};\n    commit;\n  {%- endset %}\n  \n  {% do return(dml_transaction) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.862525}, "macro.dbt_snowflake.snowflake__truncate_relation": {"unique_id": "macro.dbt_snowflake.snowflake__truncate_relation", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/adapters.sql", "original_file_path": "macros/adapters.sql", "name": "snowflake__truncate_relation", "macro_sql": "{% macro snowflake__truncate_relation(relation) -%}\n  {% set truncate_dml %}\n    truncate table {{ relation }}\n  {% endset %}\n  {% call statement('truncate_relation') -%}\n    {{ snowflake_dml_explicit_transaction(truncate_dml) }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8630686}, "macro.dbt_snowflake.snowflake__get_catalog": {"unique_id": "macro.dbt_snowflake.snowflake__get_catalog", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/catalog.sql", "original_file_path": "macros/catalog.sql", "name": "snowflake__get_catalog", "macro_sql": "{% macro snowflake__get_catalog(information_schema, schemas) -%}\n  {% set query %}\n      with tables as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n              table_type as \"table_type\",\n              comment as \"table_comment\",\n\n              -- note: this is the _role_ that owns the table\n              table_owner as \"table_owner\",\n\n              'Clustering Key' as \"stats:clustering_key:label\",\n              clustering_key as \"stats:clustering_key:value\",\n              'The key used to cluster this table' as \"stats:clustering_key:description\",\n              (clustering_key is not null) as \"stats:clustering_key:include\",\n\n              'Row Count' as \"stats:row_count:label\",\n              row_count as \"stats:row_count:value\",\n              'An approximate count of rows in this table' as \"stats:row_count:description\",\n              (row_count is not null) as \"stats:row_count:include\",\n\n              'Approximate Size' as \"stats:bytes:label\",\n              bytes as \"stats:bytes:value\",\n              'Approximate size of the table as reported by Snowflake' as \"stats:bytes:description\",\n              (bytes is not null) as \"stats:bytes:include\",\n\n              'Last Modified' as \"stats:last_modified:label\",\n              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as \"stats:last_modified:value\",\n              'The timestamp for last update/change' as \"stats:last_modified:description\",\n              (last_altered is not null and table_type='BASE TABLE') as \"stats:last_modified:include\"\n\n          from {{ information_schema }}.tables\n\n      ),\n\n      columns as (\n\n          select\n              table_catalog as \"table_database\",\n              table_schema as \"table_schema\",\n              table_name as \"table_name\",\n\n              column_name as \"column_name\",\n              ordinal_position as \"column_index\",\n              data_type as \"column_type\",\n              comment as \"column_comment\"\n\n          from {{ information_schema }}.columns\n      )\n\n      select *\n      from tables\n      join columns using (\"table_database\", \"table_schema\", \"table_name\")\n      where (\n        {%- for schema in schemas -%}\n          upper(\"table_schema\") = upper('{{ schema }}'){%- if not loop.last %} or {% endif -%}\n        {%- endfor -%}\n      )\n      order by \"column_index\"\n    {%- endset -%}\n\n  {{ return(run_query(query)) }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8649147}, "macro.dbt_snowflake.materialization_table_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_table_snowflake", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/table.sql", "original_file_path": "macros/materializations/table.sql", "name": "materialization_table_snowflake", "macro_sql": "{% materialization table, adapter='snowflake' %}\n\n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database, type='table') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {#-- Drop the relation if it was a view to \"convert\" it in a table. This may lead to\n    -- downtime, but it should be a relatively infrequent occurrence  #}\n  {% if old_relation is not none and not old_relation.is_table %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ drop_relation_if_exists(old_relation) }}\n  {% endif %}\n\n  --build model\n  {% call statement('main') -%}\n    {{ create_table_as(false, target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8678834}, "macro.dbt_snowflake.snowflake__load_csv_rows": {"unique_id": "macro.dbt_snowflake.snowflake__load_csv_rows", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/seed.sql", "original_file_path": "macros/materializations/seed.sql", "name": "snowflake__load_csv_rows", "macro_sql": "{% macro snowflake__load_csv_rows(model, agate_table) %}\n    {% set batch_size = get_batch_size() %}\n    {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n    {% set bindings = [] %}\n\n    {% set statements = [] %}\n\n    {% for chunk in agate_table.rows | batch(batch_size) %}\n        {% set bindings = [] %}\n\n        {% for row in chunk %}\n            {% do bindings.extend(row) %}\n        {% endfor %}\n\n        {% set sql %}\n            insert into {{ this.render() }} ({{ cols_sql }}) values\n            {% for row in chunk -%}\n                ({%- for column in agate_table.column_names -%}\n                    %s\n                    {%- if not loop.last%},{%- endif %}\n                {%- endfor -%})\n                {%- if not loop.last%},{%- endif %}\n            {%- endfor %}\n        {% endset %}\n\n        {% do adapter.add_query('BEGIN', auto_begin=False) %}\n        {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n        {% do adapter.add_query('COMMIT', auto_begin=False) %}\n\n        {% if loop.index0 == 0 %}\n            {% do statements.append(sql) %}\n        {% endif %}\n    {% endfor %}\n\n    {# Return SQL so we can render it out into the compiled files #}\n    {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8724504}, "macro.dbt_snowflake.materialization_seed_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_seed_snowflake", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/seed.sql", "original_file_path": "macros/materializations/seed.sql", "name": "materialization_seed_snowflake", "macro_sql": "{% materialization seed, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n\n    {% set relations = materialization_seed_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_seed_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.873121}, "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "dbt_snowflake_validate_get_incremental_strategy", "macro_sql": "{% macro dbt_snowflake_validate_get_incremental_strategy(config) %}\n  {#-- Find and validate the incremental strategy #}\n  {%- set strategy = config.get(\"incremental_strategy\", default=\"merge\") -%}\n\n  {% set invalid_strategy_msg -%}\n    Invalid incremental strategy provided: {{ strategy }}\n    Expected one of: 'merge', 'delete+insert'\n  {%- endset %}\n  {% if strategy not in ['merge', 'delete+insert'] %}\n    {% do exceptions.raise_compiler_error(invalid_strategy_msg) %}\n  {% endif %}\n\n  {% do return(strategy) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8759506}, "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql": {"unique_id": "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "dbt_snowflake_get_incremental_sql", "macro_sql": "{% macro dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n  {% if strategy == 'merge' %}\n    {% do return(get_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% elif strategy == 'delete+insert' %}\n    {% do return(get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns)) %}\n  {% else %}\n    {% do exceptions.raise_compiler_error('invalid strategy: ' ~ strategy) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_merge_sql", "macro.dbt.get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8771436}, "macro.dbt_snowflake.materialization_incremental_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_incremental_snowflake", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/incremental.sql", "original_file_path": "macros/materializations/incremental.sql", "name": "materialization_incremental_snowflake", "macro_sql": "{% materialization incremental, adapter='snowflake' -%}\n   \n  {% set original_query_tag = set_query_tag() %}\n\n  {%- set unique_key = config.get('unique_key') -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set target_relation = this %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(this) %}\n\n  {#-- Validate early so we don't run SQL if the strategy is invalid --#}\n  {% set strategy = dbt_snowflake_validate_get_incremental_strategy(config) -%}\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {{ run_hooks(pre_hooks) }}\n\n  {% if existing_relation is none %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% elif existing_relation.is_view %}\n    {#-- Can't overwrite a view with a table - we must drop --#}\n    {{ log(\"Dropping relation \" ~ target_relation ~ \" because it is a view and this model is a table.\") }}\n    {% do adapter.drop_relation(existing_relation) %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% elif full_refresh_mode %}\n    {% set build_sql = create_table_as(False, target_relation, sql) %}\n  \n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n           from_relation=tmp_relation,\n           to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = dbt_snowflake_get_incremental_sql(strategy, tmp_relation, target_relation, unique_key, dest_columns) %}\n  \n  {% endif %}\n\n  {%- call statement('main') -%}\n    {{ build_sql }}\n  {%- endcall -%}\n\n  {{ run_hooks(post_hooks) }}\n\n  {% set target_relation = target_relation.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% do unset_query_tag(original_query_tag) %}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.882715}, "macro.dbt_snowflake.snowflake__get_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__get_merge_sql", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/merge.sql", "original_file_path": "macros/materializations/merge.sql", "name": "snowflake__get_merge_sql", "macro_sql": "{% macro snowflake__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) -%}\n\n    {#\n       Workaround for Snowflake not being happy with a merge on a constant-false predicate.\n       When no unique_key is provided, this macro will do a regular insert. If a unique_key\n       is provided, then this macro will do a proper merge instead.\n    #}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute='name')) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {%- set dml -%}\n    {%- if unique_key is none -%}\n\n        {{ sql_header if sql_header is not none }}\n\n        insert into {{ target }} ({{ dest_cols_csv }})\n        (\n            select {{ dest_cols_csv }}\n            from {{ source_sql }}\n        )\n\n    {%- else -%}\n\n        {{ default__get_merge_sql(target, source_sql, unique_key, dest_columns, predicates) }}\n\n    {%- endif -%}\n    {%- endset -%}\n    \n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv", "macro.dbt.default__get_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.885417}, "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/merge.sql", "original_file_path": "macros/materializations/merge.sql", "name": "snowflake__get_delete_insert_merge_sql", "macro_sql": "{% macro snowflake__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) %}\n    {% set dml = default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_delete_insert_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.886057}, "macro.dbt_snowflake.snowflake__snapshot_merge_sql": {"unique_id": "macro.dbt_snowflake.snowflake__snapshot_merge_sql", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/merge.sql", "original_file_path": "macros/materializations/merge.sql", "name": "snowflake__snapshot_merge_sql", "macro_sql": "{% macro snowflake__snapshot_merge_sql(target, source, insert_cols) %}\n    {% set dml = default__snapshot_merge_sql(target, source, insert_cols) %}\n    {% do return(snowflake_dml_explicit_transaction(dml)) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_merge_sql", "macro.dbt_snowflake.snowflake_dml_explicit_transaction"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8866105}, "macro.dbt_snowflake.materialization_snapshot_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_snapshot_snowflake", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/snapshot.sql", "original_file_path": "macros/materializations/snapshot.sql", "name": "materialization_snapshot_snowflake", "macro_sql": "{% materialization snapshot, adapter='snowflake' %}\n    {% set original_query_tag = set_query_tag() %}\n\n    {% set relations = materialization_snapshot_default() %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n    {{ return(relations) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.materialization_snapshot_default", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.887522}, "macro.dbt_snowflake.materialization_view_snowflake": {"unique_id": "macro.dbt_snowflake.materialization_view_snowflake", "package_name": "dbt_snowflake", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/snowflake", "path": "macros/materializations/view.sql", "original_file_path": "macros/materializations/view.sql", "name": "materialization_view_snowflake", "macro_sql": "{% materialization view, adapter='snowflake' -%}\n\n    {% set original_query_tag = set_query_tag() %}\n    {% set to_return = create_or_replace_view() %}\n\n    {% set target_relation = this.incorporate(type='view') %}\n    {% do persist_docs(target_relation, model, for_columns=false) %}\n\n    {% do return(to_return) %}\n\n    {% do unset_query_tag(original_query_tag) %}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.create_or_replace_view", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.88878}, "macro.dbt.get_catalog": {"unique_id": "macro.dbt.get_catalog", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "get_catalog", "macro_sql": "{% macro get_catalog(information_schema, schemas) -%}\n  {{ return(adapter.dispatch('get_catalog', 'dbt')(information_schema, schemas)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_catalog"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8915527}, "macro.dbt.default__get_catalog": {"unique_id": "macro.dbt.default__get_catalog", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__get_catalog", "macro_sql": "{% macro default__get_catalog(information_schema, schemas) -%}\n\n  {% set typename = adapter.type() %}\n  {% set msg -%}\n    get_catalog not implemented for {{ typename }}\n  {%- endset %}\n\n  {{ exceptions.raise_compiler_error(msg) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.892163}, "macro.dbt.information_schema_name": {"unique_id": "macro.dbt.information_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "information_schema_name", "macro_sql": "{% macro information_schema_name(database) %}\n  {{ return(adapter.dispatch('information_schema_name', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__information_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8925862}, "macro.dbt.default__information_schema_name": {"unique_id": "macro.dbt.default__information_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__information_schema_name", "macro_sql": "{% macro default__information_schema_name(database) -%}\n  {%- if database -%}\n    {{ database }}.INFORMATION_SCHEMA\n  {%- else -%}\n    INFORMATION_SCHEMA\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8929658}, "macro.dbt.list_schemas": {"unique_id": "macro.dbt.list_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "list_schemas", "macro_sql": "{% macro list_schemas(database) -%}\n  {{ return(adapter.dispatch('list_schemas', 'dbt')(database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8933854}, "macro.dbt.default__list_schemas": {"unique_id": "macro.dbt.default__list_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__list_schemas", "macro_sql": "{% macro default__list_schemas(database) -%}\n  {% set sql %}\n    select distinct schema_name\n    from {{ information_schema_name(database) }}.SCHEMATA\n    where catalog_name ilike '{{ database }}'\n  {% endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.information_schema_name", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8939323}, "macro.dbt.check_schema_exists": {"unique_id": "macro.dbt.check_schema_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "check_schema_exists", "macro_sql": "{% macro check_schema_exists(information_schema, schema) -%}\n  {{ return(adapter.dispatch('check_schema_exists', 'dbt')(information_schema, schema)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__check_schema_exists"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8946104}, "macro.dbt.default__check_schema_exists": {"unique_id": "macro.dbt.default__check_schema_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__check_schema_exists", "macro_sql": "{% macro default__check_schema_exists(information_schema, schema) -%}\n  {% set sql -%}\n        select count(*)\n        from {{ information_schema.replace(information_schema_view='SCHEMATA') }}\n        where catalog_name='{{ information_schema.database }}'\n          and schema_name='{{ schema }}'\n  {%- endset %}\n  {{ return(run_query(sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8953009}, "macro.dbt.list_relations_without_caching": {"unique_id": "macro.dbt.list_relations_without_caching", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "list_relations_without_caching", "macro_sql": "{% macro list_relations_without_caching(schema_relation) %}\n  {{ return(adapter.dispatch('list_relations_without_caching', 'dbt')(schema_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__list_relations_without_caching"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8957205}, "macro.dbt.default__list_relations_without_caching": {"unique_id": "macro.dbt.default__list_relations_without_caching", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/metadata.sql", "original_file_path": "macros/adapters/metadata.sql", "name": "default__list_relations_without_caching", "macro_sql": "{% macro default__list_relations_without_caching(schema_relation) %}\n  {{ exceptions.raise_not_implemented(\n    'list_relations_without_caching macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.8960876}, "macro.dbt.get_columns_in_relation": {"unique_id": "macro.dbt.get_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "get_columns_in_relation", "macro_sql": "{% macro get_columns_in_relation(relation) -%}\n  {{ return(adapter.dispatch('get_columns_in_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_columns_in_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.899137}, "macro.dbt.default__get_columns_in_relation": {"unique_id": "macro.dbt.default__get_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__get_columns_in_relation", "macro_sql": "{% macro default__get_columns_in_relation(relation) -%}\n  {{ exceptions.raise_not_implemented(\n    'get_columns_in_relation macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.899689}, "macro.dbt.sql_convert_columns_in_relation": {"unique_id": "macro.dbt.sql_convert_columns_in_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "sql_convert_columns_in_relation", "macro_sql": "{% macro sql_convert_columns_in_relation(table) -%}\n  {% set columns = [] %}\n  {% for row in table %}\n    {% do columns.append(api.Column(*row)) %}\n  {% endfor %}\n  {{ return(columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9004273}, "macro.dbt.get_columns_in_query": {"unique_id": "macro.dbt.get_columns_in_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "get_columns_in_query", "macro_sql": "{% macro get_columns_in_query(select_sql) -%}\n  {{ return(adapter.dispatch('get_columns_in_query', 'dbt')(select_sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.900846}, "macro.dbt.default__get_columns_in_query": {"unique_id": "macro.dbt.default__get_columns_in_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__get_columns_in_query", "macro_sql": "{% macro default__get_columns_in_query(select_sql) %}\n    {% call statement('get_columns_in_query', fetch_result=True, auto_begin=False) -%}\n        select * from (\n            {{ select_sql }}\n        ) as __dbt_sbq\n        where false\n        limit 0\n    {% endcall %}\n\n    {{ return(load_result('get_columns_in_query').table.columns | map(attribute='name') | list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9017236}, "macro.dbt.alter_column_type": {"unique_id": "macro.dbt.alter_column_type", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "alter_column_type", "macro_sql": "{% macro alter_column_type(relation, column_name, new_column_type) -%}\n  {{ return(adapter.dispatch('alter_column_type', 'dbt')(relation, column_name, new_column_type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9022322}, "macro.dbt.default__alter_column_type": {"unique_id": "macro.dbt.default__alter_column_type", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__alter_column_type", "macro_sql": "{% macro default__alter_column_type(relation, column_name, new_column_type) -%}\n  {#\n    1. Create a new column (w/ temp name and correct type)\n    2. Copy data over to it\n    3. Drop the existing column (cascade!)\n    4. Rename the new column to existing column\n  #}\n  {%- set tmp_column = column_name + \"__dbt_alter\" -%}\n\n  {% call statement('alter_column_type') %}\n    alter table {{ relation }} add column {{ adapter.quote(tmp_column) }} {{ new_column_type }};\n    update {{ relation }} set {{ adapter.quote(tmp_column) }} = {{ adapter.quote(column_name) }};\n    alter table {{ relation }} drop column {{ adapter.quote(column_name) }} cascade;\n    alter table {{ relation }} rename column {{ adapter.quote(tmp_column) }} to {{ adapter.quote(column_name) }}\n  {% endcall %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9035234}, "macro.dbt.alter_relation_add_remove_columns": {"unique_id": "macro.dbt.alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "alter_relation_add_remove_columns", "macro_sql": "{% macro alter_relation_add_remove_columns(relation, add_columns = none, remove_columns = none) -%}\n  {{ return(adapter.dispatch('alter_relation_add_remove_columns', 'dbt')(relation, add_columns, remove_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9041946}, "macro.dbt.default__alter_relation_add_remove_columns": {"unique_id": "macro.dbt.default__alter_relation_add_remove_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/columns.sql", "original_file_path": "macros/adapters/columns.sql", "name": "default__alter_relation_add_remove_columns", "macro_sql": "{% macro default__alter_relation_add_remove_columns(relation, add_columns, remove_columns) %}\n  \n  {% if add_columns is none %}\n    {% set add_columns = [] %}\n  {% endif %}\n  {% if remove_columns is none %}\n    {% set remove_columns = [] %}\n  {% endif %}\n  \n  {% set sql -%}\n     \n     alter {{ relation.type }} {{ relation }}\n       \n            {% for column in add_columns %}\n               add column {{ column.name }} {{ column.data_type }}{{ ',' if not loop.last }}\n            {% endfor %}{{ ',' if add_columns and remove_columns }}\n            \n            {% for column in remove_columns %}\n                drop column {{ column.name }}{{ ',' if not loop.last }}\n            {% endfor %}\n  \n  {%- endset -%}\n\n  {% do run_query(sql) %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.90609}, "macro.dbt.current_timestamp": {"unique_id": "macro.dbt.current_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ adapter.dispatch('current_timestamp', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.907104}, "macro.dbt.default__current_timestamp": {"unique_id": "macro.dbt.default__current_timestamp", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() -%}\n  {{ exceptions.raise_not_implemented(\n    'current_timestamp macro not implemented for adapter '+adapter.type()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9074273}, "macro.dbt.collect_freshness": {"unique_id": "macro.dbt.collect_freshness", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "collect_freshness", "macro_sql": "{% macro collect_freshness(source, loaded_at_field, filter) %}\n  {{ return(adapter.dispatch('collect_freshness', 'dbt')(source, loaded_at_field, filter))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__collect_freshness"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9079118}, "macro.dbt.default__collect_freshness": {"unique_id": "macro.dbt.default__collect_freshness", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/freshness.sql", "original_file_path": "macros/adapters/freshness.sql", "name": "default__collect_freshness", "macro_sql": "{% macro default__collect_freshness(source, loaded_at_field, filter) %}\n  {% call statement('collect_freshness', fetch_result=True, auto_begin=False) -%}\n    select\n      max({{ loaded_at_field }}) as max_loaded_at,\n      {{ current_timestamp() }} as snapshotted_at\n    from {{ source }}\n    {% if filter %}\n    where {{ filter }}\n    {% endif %}\n  {% endcall %}\n  {{ return(load_result('collect_freshness').table) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9088426}, "macro.dbt.alter_column_comment": {"unique_id": "macro.dbt.alter_column_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "alter_column_comment", "macro_sql": "{% macro alter_column_comment(relation, column_dict) -%}\n  {{ return(adapter.dispatch('alter_column_comment', 'dbt')(relation, column_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9104176}, "macro.dbt.default__alter_column_comment": {"unique_id": "macro.dbt.default__alter_column_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__alter_column_comment", "macro_sql": "{% macro default__alter_column_comment(relation, column_dict) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_column_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9108078}, "macro.dbt.alter_relation_comment": {"unique_id": "macro.dbt.alter_relation_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "alter_relation_comment", "macro_sql": "{% macro alter_relation_comment(relation, relation_comment) -%}\n  {{ return(adapter.dispatch('alter_relation_comment', 'dbt')(relation, relation_comment)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__alter_relation_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9113157}, "macro.dbt.default__alter_relation_comment": {"unique_id": "macro.dbt.default__alter_relation_comment", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__alter_relation_comment", "macro_sql": "{% macro default__alter_relation_comment(relation, relation_comment) -%}\n  {{ exceptions.raise_not_implemented(\n    'alter_relation_comment macro not implemented for adapter '+adapter.type()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9117205}, "macro.dbt.persist_docs": {"unique_id": "macro.dbt.persist_docs", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "persist_docs", "macro_sql": "{% macro persist_docs(relation, model, for_relation=true, for_columns=true) -%}\n  {{ return(adapter.dispatch('persist_docs', 'dbt')(relation, model, for_relation, for_columns)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9123495}, "macro.dbt.default__persist_docs": {"unique_id": "macro.dbt.default__persist_docs", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/persist_docs.sql", "original_file_path": "macros/adapters/persist_docs.sql", "name": "default__persist_docs", "macro_sql": "{% macro default__persist_docs(relation, model, for_relation, for_columns) -%}\n  {% if for_relation and config.persist_relation_docs() and model.description %}\n    {% do run_query(alter_relation_comment(relation, model.description)) %}\n  {% endif %}\n\n  {% if for_columns and config.persist_column_docs() and model.columns %}\n    {% do run_query(alter_column_comment(relation, model.columns)) %}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query", "macro.dbt.alter_relation_comment", "macro.dbt.alter_column_comment"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9134052}, "macro.dbt.make_temp_relation": {"unique_id": "macro.dbt.make_temp_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "make_temp_relation", "macro_sql": "{% macro make_temp_relation(base_relation, suffix='__dbt_tmp') %}\n  {{ return(adapter.dispatch('make_temp_relation', 'dbt')(base_relation, suffix))}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__make_temp_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.916577}, "macro.dbt.default__make_temp_relation": {"unique_id": "macro.dbt.default__make_temp_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__make_temp_relation", "macro_sql": "{% macro default__make_temp_relation(base_relation, suffix) %}\n    {% set tmp_identifier = base_relation.identifier ~ suffix %}\n    {% set tmp_relation = base_relation.incorporate(\n                                path={\"identifier\": tmp_identifier}) -%}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.917263}, "macro.dbt.drop_relation": {"unique_id": "macro.dbt.drop_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "drop_relation", "macro_sql": "{% macro drop_relation(relation) -%}\n  {{ return(adapter.dispatch('drop_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__drop_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9176917}, "macro.dbt.default__drop_relation": {"unique_id": "macro.dbt.default__drop_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__drop_relation", "macro_sql": "{% macro default__drop_relation(relation) -%}\n  {% call statement('drop_relation', auto_begin=False) -%}\n    drop {{ relation.type }} if exists {{ relation }} cascade\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9181938}, "macro.dbt.truncate_relation": {"unique_id": "macro.dbt.truncate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "truncate_relation", "macro_sql": "{% macro truncate_relation(relation) -%}\n  {{ return(adapter.dispatch('truncate_relation', 'dbt')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__truncate_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9186013}, "macro.dbt.default__truncate_relation": {"unique_id": "macro.dbt.default__truncate_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__truncate_relation", "macro_sql": "{% macro default__truncate_relation(relation) -%}\n  {% call statement('truncate_relation') -%}\n    truncate table {{ relation }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9189656}, "macro.dbt.rename_relation": {"unique_id": "macro.dbt.rename_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "rename_relation", "macro_sql": "{% macro rename_relation(from_relation, to_relation) -%}\n  {{ return(adapter.dispatch('rename_relation', 'dbt')(from_relation, to_relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__rename_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9194067}, "macro.dbt.default__rename_relation": {"unique_id": "macro.dbt.default__rename_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__rename_relation", "macro_sql": "{% macro default__rename_relation(from_relation, to_relation) -%}\n  {% set target_name = adapter.quote_as_configured(to_relation.identifier, 'identifier') %}\n  {% call statement('rename_relation') -%}\n    alter table {{ from_relation }} rename to {{ target_name }}\n  {%- endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9202485}, "macro.dbt.get_or_create_relation": {"unique_id": "macro.dbt.get_or_create_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "get_or_create_relation", "macro_sql": "{% macro get_or_create_relation(database, schema, identifier, type) -%}\n  {{ return(adapter.dispatch('get_or_create_relation', 'dbt')(database, schema, identifier, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_or_create_relation"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9209878}, "macro.dbt.default__get_or_create_relation": {"unique_id": "macro.dbt.default__get_or_create_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "default__get_or_create_relation", "macro_sql": "{% macro default__get_or_create_relation(database, schema, identifier, type) %}\n  {%- set target_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n\n  {% if target_relation %}\n    {% do return([true, target_relation]) %}\n  {% endif %}\n\n  {%- set new_relation = api.Relation.create(\n      database=database,\n      schema=schema,\n      identifier=identifier,\n      type=type\n  ) -%}\n  {% do return([false, new_relation]) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9221787}, "macro.dbt.load_relation": {"unique_id": "macro.dbt.load_relation", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "load_relation", "macro_sql": "{% macro load_relation(relation) %}\n  {% do return(adapter.get_relation(\n    database=relation.database,\n    schema=relation.schema,\n    identifier=relation.identifier\n  )) -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9226742}, "macro.dbt.drop_relation_if_exists": {"unique_id": "macro.dbt.drop_relation_if_exists", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/relation.sql", "original_file_path": "macros/adapters/relation.sql", "name": "drop_relation_if_exists", "macro_sql": "{% macro drop_relation_if_exists(relation) %}\n  {% if relation is not none %}\n    {{ adapter.drop_relation(relation) }}\n  {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9230986}, "macro.dbt.create_schema": {"unique_id": "macro.dbt.create_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "create_schema", "macro_sql": "{% macro create_schema(relation) -%}\n  {{ adapter.dispatch('create_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9239802}, "macro.dbt.default__create_schema": {"unique_id": "macro.dbt.default__create_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "default__create_schema", "macro_sql": "{% macro default__create_schema(relation) -%}\n  {%- call statement('create_schema') -%}\n    create schema if not exists {{ relation.without_identifier() }}\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9244037}, "macro.dbt.drop_schema": {"unique_id": "macro.dbt.drop_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "drop_schema", "macro_sql": "{% macro drop_schema(relation) -%}\n  {{ adapter.dispatch('drop_schema', 'dbt')(relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__drop_schema"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9247575}, "macro.dbt.default__drop_schema": {"unique_id": "macro.dbt.default__drop_schema", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/schema.sql", "original_file_path": "macros/adapters/schema.sql", "name": "default__drop_schema", "macro_sql": "{% macro default__drop_schema(relation) -%}\n  {%- call statement('drop_schema') -%}\n    drop schema if exists {{ relation.without_identifier() }} cascade\n  {% endcall %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.925334}, "macro.dbt.get_create_index_sql": {"unique_id": "macro.dbt.get_create_index_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "get_create_index_sql", "macro_sql": "{% macro get_create_index_sql(relation, index_dict) -%}\n  {{ return(adapter.dispatch('get_create_index_sql', 'dbt')(relation, index_dict)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_index_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9263864}, "macro.dbt.default__get_create_index_sql": {"unique_id": "macro.dbt.default__get_create_index_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "default__get_create_index_sql", "macro_sql": "{% macro default__get_create_index_sql(relation, index_dict) -%}\n  {% do return(None) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9267056}, "macro.dbt.create_indexes": {"unique_id": "macro.dbt.create_indexes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "create_indexes", "macro_sql": "{% macro create_indexes(relation) -%}\n  {{ adapter.dispatch('create_indexes', 'dbt')(relation) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.927061}, "macro.dbt.default__create_indexes": {"unique_id": "macro.dbt.default__create_indexes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/adapters/indexes.sql", "original_file_path": "macros/adapters/indexes.sql", "name": "default__create_indexes", "macro_sql": "{% macro default__create_indexes(relation) -%}\n  {%- set _indexes = config.get('indexes', default=[]) -%}\n\n  {% for _index_dict in _indexes %}\n    {% set create_index_sql = get_create_index_sql(relation, _index_dict) %}\n    {% if create_index_sql %}\n      {% do run_query(create_index_sql) %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_create_index_sql", "macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.927949}, "macro.dbt.generate_schema_name": {"unique_id": "macro.dbt.generate_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "generate_schema_name", "macro_sql": "{% macro generate_schema_name(custom_schema_name=none, node=none) -%}\n    {{ return(adapter.dispatch('generate_schema_name', 'dbt')(custom_schema_name, node)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_schema_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.929123}, "macro.dbt.default__generate_schema_name": {"unique_id": "macro.dbt.default__generate_schema_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "default__generate_schema_name", "macro_sql": "{% macro default__generate_schema_name(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if custom_schema_name is none -%}\n\n        {{ default_schema }}\n\n    {%- else -%}\n\n        {{ default_schema }}_{{ custom_schema_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9297469}, "macro.dbt.generate_schema_name_for_env": {"unique_id": "macro.dbt.generate_schema_name_for_env", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_schema.sql", "original_file_path": "macros/get_custom_name/get_custom_schema.sql", "name": "generate_schema_name_for_env", "macro_sql": "{% macro generate_schema_name_for_env(custom_schema_name, node) -%}\n\n    {%- set default_schema = target.schema -%}\n    {%- if target.name == 'prod' and custom_schema_name is not none -%}\n\n        {{ custom_schema_name | trim }}\n\n    {%- else -%}\n\n        {{ default_schema }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9306324}, "macro.dbt.generate_alias_name": {"unique_id": "macro.dbt.generate_alias_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "name": "generate_alias_name", "macro_sql": "{% macro generate_alias_name(custom_alias_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_alias_name', 'dbt')(custom_alias_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_alias_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9315827}, "macro.dbt.default__generate_alias_name": {"unique_id": "macro.dbt.default__generate_alias_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_alias.sql", "original_file_path": "macros/get_custom_name/get_custom_alias.sql", "name": "default__generate_alias_name", "macro_sql": "{% macro default__generate_alias_name(custom_alias_name=none, node=none) -%}\n\n    {%- if custom_alias_name is none -%}\n\n        {{ node.name }}\n\n    {%- else -%}\n\n        {{ custom_alias_name | trim }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9321542}, "macro.dbt.generate_database_name": {"unique_id": "macro.dbt.generate_database_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "name": "generate_database_name", "macro_sql": "{% macro generate_database_name(custom_database_name=none, node=none) -%}\n    {% do return(adapter.dispatch('generate_database_name', 'dbt')(custom_database_name, node)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__generate_database_name"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9331}, "macro.dbt.default__generate_database_name": {"unique_id": "macro.dbt.default__generate_database_name", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/get_custom_name/get_custom_database.sql", "original_file_path": "macros/get_custom_name/get_custom_database.sql", "name": "default__generate_database_name", "macro_sql": "{% macro default__generate_database_name(custom_database_name=none, node=none) -%}\n    {%- set default_database = target.database -%}\n    {%- if custom_database_name is none -%}\n\n        {{ default_database }}\n\n    {%- else -%}\n\n        {{ custom_database_name }}\n\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9336848}, "macro.dbt.convert_datetime": {"unique_id": "macro.dbt.convert_datetime", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "convert_datetime", "macro_sql": "{% macro convert_datetime(date_str, date_fmt) %}\n\n  {% set error_msg -%}\n      The provided partition date '{{ date_str }}' does not match the expected format '{{ date_fmt }}'\n  {%- endset %}\n\n  {% set res = try_or_compiler_error(error_msg, modules.datetime.datetime.strptime, date_str.strip(), date_fmt) %}\n  {{ return(res) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9370575}, "macro.dbt.dates_in_range": {"unique_id": "macro.dbt.dates_in_range", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "dates_in_range", "macro_sql": "{% macro dates_in_range(start_date_str, end_date_str=none, in_fmt=\"%Y%m%d\", out_fmt=\"%Y%m%d\") %}\n    {% set end_date_str = start_date_str if end_date_str is none else end_date_str %}\n\n    {% set start_date = convert_datetime(start_date_str, in_fmt) %}\n    {% set end_date = convert_datetime(end_date_str, in_fmt) %}\n\n    {% set day_count = (end_date - start_date).days %}\n    {% if day_count < 0 %}\n        {% set msg -%}\n            Partiton start date is after the end date ({{ start_date }}, {{ end_date }})\n        {%- endset %}\n\n        {{ exceptions.raise_compiler_error(msg, model) }}\n    {% endif %}\n\n    {% set date_list = [] %}\n    {% for i in range(0, day_count + 1) %}\n        {% set the_date = (modules.datetime.timedelta(days=i) + start_date) %}\n        {% if not out_fmt %}\n            {% set _ = date_list.append(the_date) %}\n        {% else %}\n            {% set _ = date_list.append(the_date.strftime(out_fmt)) %}\n        {% endif %}\n    {% endfor %}\n\n    {{ return(date_list) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.convert_datetime"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9397814}, "macro.dbt.partition_range": {"unique_id": "macro.dbt.partition_range", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "partition_range", "macro_sql": "{% macro partition_range(raw_partition_date, date_fmt='%Y%m%d') %}\n    {% set partition_range = (raw_partition_date | string).split(\",\") %}\n\n    {% if (partition_range | length) == 1 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = none %}\n    {% elif (partition_range | length) == 2 %}\n      {% set start_date = partition_range[0] %}\n      {% set end_date = partition_range[1] %}\n    {% else %}\n      {{ exceptions.raise_compiler_error(\"Invalid partition time. Expected format: {Start Date}[,{End Date}]. Got: \" ~ raw_partition_date) }}\n    {% endif %}\n\n    {{ return(dates_in_range(start_date, end_date, in_fmt=date_fmt)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.dates_in_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9416037}, "macro.dbt.py_current_timestring": {"unique_id": "macro.dbt.py_current_timestring", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/datetime.sql", "original_file_path": "macros/etc/datetime.sql", "name": "py_current_timestring", "macro_sql": "{% macro py_current_timestring() %}\n    {% set dt = modules.datetime.datetime.now() %}\n    {% do return(dt.strftime(\"%Y%m%d%H%M%S%f\")) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9421234}, "macro.dbt.statement": {"unique_id": "macro.dbt.statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "statement", "macro_sql": "{% macro statement(name=None, fetch_result=False, auto_begin=True) -%}\n  {%- if execute: -%}\n    {%- set sql = caller() -%}\n\n    {%- if name == 'main' -%}\n      {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n      {{ write(sql) }}\n    {%- endif -%}\n\n    {%- set res, table = adapter.execute(sql, auto_begin=auto_begin, fetch=fetch_result) -%}\n    {%- if name is not none -%}\n      {{ store_result(name, response=res, agate_table=table) }}\n    {%- endif -%}\n\n  {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9444177}, "macro.dbt.noop_statement": {"unique_id": "macro.dbt.noop_statement", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "noop_statement", "macro_sql": "{% macro noop_statement(name=None, message=None, code=None, rows_affected=None, res=None) -%}\n  {%- set sql = caller() -%}\n\n  {%- if name == 'main' -%}\n    {{ log('Writing runtime SQL for node \"{}\"'.format(model['unique_id'])) }}\n    {{ write(sql) }}\n  {%- endif -%}\n\n  {%- if name is not none -%}\n    {{ store_raw_result(name, message=message, code=code, rows_affected=rows_affected, agate_table=res) }}\n  {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9457808}, "macro.dbt.run_query": {"unique_id": "macro.dbt.run_query", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/etc/statement.sql", "original_file_path": "macros/etc/statement.sql", "name": "run_query", "macro_sql": "{% macro run_query(sql) %}\n  {% call statement(\"run_query_statement\", fetch_result=true, auto_begin=false) %}\n    {{ sql }}\n  {% endcall %}\n\n  {% do return(load_result(\"run_query_statement\").table) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.946492}, "macro.dbt.default__test_unique": {"unique_id": "macro.dbt.default__test_unique", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/unique.sql", "original_file_path": "macros/generic_test_sql/unique.sql", "name": "default__test_unique", "macro_sql": "{% macro default__test_unique(model, column_name) %}\n\nselect\n    {{ column_name }} as unique_field,\n    count(*) as n_records\n\nfrom {{ model }}\nwhere {{ column_name }} is not null\ngroup by {{ column_name }}\nhaving count(*) > 1\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.947178}, "macro.dbt.default__test_not_null": {"unique_id": "macro.dbt.default__test_not_null", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/not_null.sql", "original_file_path": "macros/generic_test_sql/not_null.sql", "name": "default__test_not_null", "macro_sql": "{% macro default__test_not_null(model, column_name) %}\n\nselect *\nfrom {{ model }}\nwhere {{ column_name }} is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9477}, "macro.dbt.default__test_accepted_values": {"unique_id": "macro.dbt.default__test_accepted_values", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/accepted_values.sql", "original_file_path": "macros/generic_test_sql/accepted_values.sql", "name": "default__test_accepted_values", "macro_sql": "{% macro default__test_accepted_values(model, column_name, values, quote=True) %}\n\nwith all_values as (\n\n    select\n        {{ column_name }} as value_field,\n        count(*) as n_records\n\n    from {{ model }}\n    group by {{ column_name }}\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    {% for value in values -%}\n        {% if quote -%}\n        '{{ value }}'\n        {%- else -%}\n        {{ value }}\n        {%- endif -%}\n        {%- if not loop.last -%},{%- endif %}\n    {%- endfor %}\n)\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.949031}, "macro.dbt.default__test_relationships": {"unique_id": "macro.dbt.default__test_relationships", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/generic_test_sql/relationships.sql", "original_file_path": "macros/generic_test_sql/relationships.sql", "name": "default__test_relationships", "macro_sql": "{% macro default__test_relationships(model, column_name, to, field) %}\n\nwith child as (\n    select {{ column_name }} as from_field\n    from {{ model }}\n    where {{ column_name }} is not null\n),\n\nparent as (\n    select {{ field }} as to_field\n    from {{ to }}\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9498777}, "macro.dbt.set_sql_header": {"unique_id": "macro.dbt.set_sql_header", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "set_sql_header", "macro_sql": "{% macro set_sql_header(config) -%}\n  {{ config.set('sql_header', caller()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9508162}, "macro.dbt.should_full_refresh": {"unique_id": "macro.dbt.should_full_refresh", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "should_full_refresh", "macro_sql": "{% macro should_full_refresh() %}\n  {% set config_full_refresh = config.get('full_refresh') %}\n  {% if config_full_refresh is none %}\n    {% set config_full_refresh = flags.FULL_REFRESH %}\n  {% endif %}\n  {% do return(config_full_refresh) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9516058}, "macro.dbt.should_store_failures": {"unique_id": "macro.dbt.should_store_failures", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/configs.sql", "original_file_path": "macros/materializations/configs.sql", "name": "should_store_failures", "macro_sql": "{% macro should_store_failures() %}\n  {% set config_store_failures = config.get('store_failures') %}\n  {% if config_store_failures is none %}\n    {% set config_store_failures = flags.STORE_FAILURES %}\n  {% endif %}\n  {% do return(config_store_failures) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9523218}, "macro.dbt.run_hooks": {"unique_id": "macro.dbt.run_hooks", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "run_hooks", "macro_sql": "{% macro run_hooks(hooks, inside_transaction=True) %}\n  {% for hook in hooks | selectattr('transaction', 'equalto', inside_transaction)  %}\n    {% if not inside_transaction and loop.first %}\n      {% call statement(auto_begin=inside_transaction) %}\n        commit;\n      {% endcall %}\n    {% endif %}\n    {% set rendered = render(hook.get('sql')) | trim %}\n    {% if (rendered | length) > 0 %}\n      {% call statement(auto_begin=inside_transaction) %}\n        {{ rendered }}\n      {% endcall %}\n    {% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9545982}, "macro.dbt.make_hook_config": {"unique_id": "macro.dbt.make_hook_config", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "make_hook_config", "macro_sql": "{% macro make_hook_config(sql, inside_transaction) %}\n    {{ tojson({\"sql\": sql, \"transaction\": inside_transaction}) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9550478}, "macro.dbt.before_begin": {"unique_id": "macro.dbt.before_begin", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "before_begin", "macro_sql": "{% macro before_begin(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.955375}, "macro.dbt.in_transaction": {"unique_id": "macro.dbt.in_transaction", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "in_transaction", "macro_sql": "{% macro in_transaction(sql) %}\n    {{ make_hook_config(sql, inside_transaction=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9556932}, "macro.dbt.after_commit": {"unique_id": "macro.dbt.after_commit", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/hooks.sql", "original_file_path": "macros/materializations/hooks.sql", "name": "after_commit", "macro_sql": "{% macro after_commit(sql) %}\n    {{ make_hook_config(sql, inside_transaction=False) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_hook_config"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9562492}, "macro.dbt.materialization_table_default": {"unique_id": "macro.dbt.materialization_table_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/table.sql", "original_file_path": "macros/materializations/models/table/table.sql", "name": "materialization_table_default", "macro_sql": "{% materialization table, default %}\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type='table') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema,\n                                                      database=database,\n                                                      type='table') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n      See ../view/view.sql for more information about this relation.\n  */\n  {%- set backup_relation_type = 'table' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema,\n                                                database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_table_as_sql(False, intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  {% if old_relation is not none %}\n      {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do create_indexes(target_relation) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  -- finally, drop the existing/backup relation after the commit\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.get_create_table_as_sql", "macro.dbt.create_indexes", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.963692}, "macro.dbt.get_create_table_as_sql": {"unique_id": "macro.dbt.get_create_table_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "get_create_table_as_sql", "macro_sql": "{% macro get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ adapter.dispatch('get_create_table_as_sql', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_table_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9647067}, "macro.dbt.default__get_create_table_as_sql": {"unique_id": "macro.dbt.default__get_create_table_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "default__get_create_table_as_sql", "macro_sql": "{% macro default__get_create_table_as_sql(temporary, relation, sql) -%}\n  {{ return(create_table_as(temporary, relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9651117}, "macro.dbt.create_table_as": {"unique_id": "macro.dbt.create_table_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "create_table_as", "macro_sql": "{% macro create_table_as(temporary, relation, sql) -%}\n  {{ adapter.dispatch('create_table_as', 'dbt')(temporary, relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9655607}, "macro.dbt.default__create_table_as": {"unique_id": "macro.dbt.default__create_table_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/table/create_table_as.sql", "original_file_path": "macros/materializations/models/table/create_table_as.sql", "name": "default__create_table_as", "macro_sql": "{% macro default__create_table_as(temporary, relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n  \n  {{ sql_header if sql_header is not none }}\n  \n  create {% if temporary: -%}temporary{%- endif %} table\n    {{ relation.include(database=(not temporary), schema=(not temporary)) }}\n  as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9666362}, "macro.dbt.create_or_replace_view": {"unique_id": "macro.dbt.create_or_replace_view", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_or_replace_view.sql", "original_file_path": "macros/materializations/models/view/create_or_replace_view.sql", "name": "create_or_replace_view", "macro_sql": "{% macro create_or_replace_view() %}\n  {%- set identifier = model['alias'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set target_relation = api.Relation.create(\n      identifier=identifier, schema=schema, database=database,\n      type='view') -%}\n\n  {{ run_hooks(pre_hooks) }}\n\n  -- If there's a table with the same name and we weren't told to full refresh,\n  -- that's an error. If we were told to full refresh, drop it. This behavior differs\n  -- for Snowflake and BigQuery, so multiple dispatch is used.\n  {%- if old_relation is not none and old_relation.is_table -%}\n    {{ handle_existing_table(should_full_refresh(), old_relation) }}\n  {%- endif -%}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ get_create_view_as_sql(target_relation, sql) }}\n  {%- endcall %}\n\n  {{ run_hooks(post_hooks) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.handle_existing_table", "macro.dbt.should_full_refresh", "macro.dbt.statement", "macro.dbt.get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9692385}, "macro.dbt.handle_existing_table": {"unique_id": "macro.dbt.handle_existing_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "name": "handle_existing_table", "macro_sql": "{% macro handle_existing_table(full_refresh, old_relation) %}\n    {{ adapter.dispatch('handle_existing_table', 'dbt')(full_refresh, old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__handle_existing_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9700365}, "macro.dbt.default__handle_existing_table": {"unique_id": "macro.dbt.default__handle_existing_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/helpers.sql", "original_file_path": "macros/materializations/models/view/helpers.sql", "name": "default__handle_existing_table", "macro_sql": "{% macro default__handle_existing_table(full_refresh, old_relation) %}\n    {{ log(\"Dropping relation \" ~ old_relation ~ \" because it is of type \" ~ old_relation.type) }}\n    {{ adapter.drop_relation(old_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.970543}, "macro.dbt.get_create_view_as_sql": {"unique_id": "macro.dbt.get_create_view_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "get_create_view_as_sql", "macro_sql": "{% macro get_create_view_as_sql(relation, sql) -%}\n  {{ adapter.dispatch('get_create_view_as_sql', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_create_view_as_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9715323}, "macro.dbt.default__get_create_view_as_sql": {"unique_id": "macro.dbt.default__get_create_view_as_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "default__get_create_view_as_sql", "macro_sql": "{% macro default__get_create_view_as_sql(relation, sql) -%}\n  {{ return(create_view_as(relation, sql)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.971995}, "macro.dbt.create_view_as": {"unique_id": "macro.dbt.create_view_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "create_view_as", "macro_sql": "{% macro create_view_as(relation, sql) -%}\n  {{ adapter.dispatch('create_view_as', 'dbt')(relation, sql) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__create_view_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9724908}, "macro.dbt.default__create_view_as": {"unique_id": "macro.dbt.default__create_view_as", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/create_view_as.sql", "original_file_path": "macros/materializations/models/view/create_view_as.sql", "name": "default__create_view_as", "macro_sql": "{% macro default__create_view_as(relation, sql) -%}\n  {%- set sql_header = config.get('sql_header', none) -%}\n\n  {{ sql_header if sql_header is not none }}\n  create view {{ relation }} as (\n    {{ sql }}\n  );\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9730823}, "macro.dbt.materialization_view_default": {"unique_id": "macro.dbt.materialization_view_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/view/view.sql", "original_file_path": "macros/materializations/models/view/view.sql", "name": "materialization_view_default", "macro_sql": "{%- materialization view, default -%}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set tmp_identifier = model['name'] + '__dbt_tmp' -%}\n  {%- set backup_identifier = model['name'] + '__dbt_backup' -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, database=database,\n                                                type='view') -%}\n  {%- set intermediate_relation = api.Relation.create(identifier=tmp_identifier,\n                                                      schema=schema, database=database, type='view') -%}\n  -- the intermediate_relation should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation\n  {%- set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                   schema=schema,\n                                                                   database=database) -%}\n  /*\n     This relation (probably) doesn't exist yet. If it does exist, it's a leftover from\n     a previous run, and we're going to try to drop it immediately. At the end of this\n     materialization, we're going to rename the \"old_relation\" to this identifier,\n     and then we're going to drop it. In order to make sure we run the correct one of:\n       - drop view ...\n       - drop table ...\n\n     We need to set the type of this relation to be the type of the old_relation, if it exists,\n     or else \"view\" as a sane default if it does not. Note that if the old_relation does not\n     exist, then there is nothing to move out of the way and subsequentally drop. In that case,\n     this relation will be effectively unused.\n  */\n  {%- set backup_relation_type = 'view' if old_relation is none else old_relation.type -%}\n  {%- set backup_relation = api.Relation.create(identifier=backup_identifier,\n                                                schema=schema, database=database,\n                                                type=backup_relation_type) -%}\n  -- as above, the backup_relation should not already exist\n  {%- set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                             schema=schema,\n                                                             database=database) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- drop the temp relations if they exist already in the database\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% call statement('main') -%}\n    {{ create_view_as(intermediate_relation, sql) }}\n  {%- endcall %}\n\n  -- cleanup\n  -- move the existing view out of the way\n  {% if old_relation is not none %}\n    {{ adapter.rename_relation(old_relation, backup_relation) }}\n  {% endif %}\n  {{ adapter.rename_relation(intermediate_relation, target_relation) }}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {{ drop_relation_if_exists(backup_relation) }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.drop_relation_if_exists", "macro.dbt.statement", "macro.dbt.create_view_as", "macro.dbt.persist_docs"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9800406}, "macro.dbt.materialization_incremental_default": {"unique_id": "macro.dbt.materialization_incremental_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/incremental.sql", "original_file_path": "macros/materializations/models/incremental/incremental.sql", "name": "materialization_incremental_default", "macro_sql": "{% materialization incremental, default -%}\n\n  {% set unique_key = config.get('unique_key') %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% set existing_relation = load_relation(this) %}\n  {% set tmp_relation = make_temp_relation(target_relation) %}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {% set on_schema_change = incremental_validate_on_schema_change(config.get('on_schema_change'), default='ignore') %}\n\n  {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n  {% set backup_identifier = model['name'] + \"__dbt_backup\" %}\n\n  -- the intermediate_ and backup_ relations should not already exist in the database; get_relation\n  -- will return None in that case. Otherwise, we get a relation that we can drop\n  -- later, before we try to use this name for the current operation. This has to happen before\n  -- BEGIN, in a separate transaction\n  {% set preexisting_intermediate_relation = adapter.get_relation(identifier=tmp_identifier, \n                                                                  schema=schema,\n                                                                  database=database) %}                                               \n  {% set preexisting_backup_relation = adapter.get_relation(identifier=backup_identifier,\n                                                            schema=schema,\n                                                            database=database) %}\n  {{ drop_relation_if_exists(preexisting_intermediate_relation) }}\n  {{ drop_relation_if_exists(preexisting_backup_relation) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set to_drop = [] %}\n\n  {# -- first check whether we want to full refresh for source view or config reasons #}\n  {% set trigger_full_refresh = (full_refresh_mode or existing_relation.is_view) %}\n\n  {% if existing_relation is none %}\n      {% set build_sql = create_table_as(False, target_relation, sql) %}\n{% elif trigger_full_refresh %}\n      {#-- Make sure the backup doesn't exist so we don't encounter issues with the rename below #}\n      {% set tmp_identifier = model['name'] + '__dbt_tmp' %}\n      {% set backup_identifier = model['name'] + '__dbt_backup' %}\n      {% set intermediate_relation = existing_relation.incorporate(path={\"identifier\": tmp_identifier}) %}\n      {% set backup_relation = existing_relation.incorporate(path={\"identifier\": backup_identifier}) %}\n\n      {% set build_sql = create_table_as(False, intermediate_relation, sql) %}\n      {% set need_swap = true %}\n      {% do to_drop.append(backup_relation) %}\n  {% else %}\n    {% do run_query(create_table_as(True, tmp_relation, sql)) %}\n    {% do adapter.expand_target_column_types(\n             from_relation=tmp_relation,\n             to_relation=target_relation) %}\n    {#-- Process schema changes. Returns dict of changes if successful. Use source columns for upserting/merging --#}\n    {% set dest_columns = process_schema_changes(on_schema_change, tmp_relation, existing_relation) %}\n    {% if not dest_columns %}\n      {% set dest_columns = adapter.get_columns_in_relation(existing_relation) %}\n    {% endif %}\n    {% set build_sql = get_delete_insert_merge_sql(target_relation, tmp_relation, unique_key, dest_columns) %}\n  \n  {% endif %}\n\n  {% call statement(\"main\") %}\n      {{ build_sql }}\n  {% endcall %}\n\n  {% if need_swap %} \n      {% do adapter.rename_relation(target_relation, backup_relation) %} \n      {% do adapter.rename_relation(intermediate_relation, target_relation) %} \n  {% endif %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if existing_relation is none or existing_relation.is_view or should_full_refresh() %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {% do adapter.commit() %}\n\n  {% for rel in to_drop %}\n      {% do adapter.drop_relation(rel) %}\n  {% endfor %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt.should_full_refresh", "macro.dbt.incremental_validate_on_schema_change", "macro.dbt.drop_relation_if_exists", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt.process_schema_changes", "macro.dbt.get_delete_insert_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.9897661}, "macro.dbt.incremental_validate_on_schema_change": {"unique_id": "macro.dbt.incremental_validate_on_schema_change", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "incremental_validate_on_schema_change", "macro_sql": "{% macro incremental_validate_on_schema_change(on_schema_change, default='ignore') %}\n   \n   {% if on_schema_change not in ['sync_all_columns', 'append_new_columns', 'fail', 'ignore'] %}\n     \n     {% set log_message = 'Invalid value for on_schema_change (%s) specified. Setting default value of %s.' % (on_schema_change, default) %}\n     {% do log(log_message) %}\n     \n     {{ return(default) }}\n\n   {% else %}\n\n     {{ return(on_schema_change) }}\n   \n   {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086791.997917}, "macro.dbt.check_for_schema_changes": {"unique_id": "macro.dbt.check_for_schema_changes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "check_for_schema_changes", "macro_sql": "{% macro check_for_schema_changes(source_relation, target_relation) %}\n  \n  {% set schema_changed = False %}\n  \n  {%- set source_columns = adapter.get_columns_in_relation(source_relation) -%}\n  {%- set target_columns = adapter.get_columns_in_relation(target_relation) -%}\n  {%- set source_not_in_target = diff_columns(source_columns, target_columns) -%}\n  {%- set target_not_in_source = diff_columns(target_columns, source_columns) -%}\n\n  {% set new_target_types = diff_column_data_types(source_columns, target_columns) %}\n\n  {% if source_not_in_target != [] %}\n    {% set schema_changed = True %}\n  {% elif target_not_in_source != [] or new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% elif new_target_types != [] %}\n    {% set schema_changed = True %}\n  {% endif %}\n  \n  {% set changes_dict = {\n    'schema_changed': schema_changed,\n    'source_not_in_target': source_not_in_target,\n    'target_not_in_source': target_not_in_source,\n    'source_columns': source_columns,\n    'target_columns': target_columns,\n    'new_target_types': new_target_types\n  } %}\n\n  {% set msg %}\n    In {{ target_relation }}:\n        Schema changed: {{ schema_changed }}\n        Source columns not in target: {{ source_not_in_target }}\n        Target columns not in source: {{ target_not_in_source }}\n        New column types: {{ new_target_types }}\n  {% endset %}\n  \n  {% do log(msg) %}\n\n  {{ return(changes_dict) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.diff_columns", "macro.dbt.diff_column_data_types"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0005913}, "macro.dbt.sync_column_schemas": {"unique_id": "macro.dbt.sync_column_schemas", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "sync_column_schemas", "macro_sql": "{% macro sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n  \n  {%- set add_to_target_arr = schema_changes_dict['source_not_in_target'] -%}\n\n  {%- if on_schema_change == 'append_new_columns'-%}\n     {%- if add_to_target_arr | length > 0 -%}\n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, none) -%}\n     {%- endif -%}\n  \n  {% elif on_schema_change == 'sync_all_columns' %}\n     {%- set remove_from_target_arr = schema_changes_dict['target_not_in_source'] -%}\n     {%- set new_target_types = schema_changes_dict['new_target_types'] -%}\n  \n     {% if add_to_target_arr | length > 0 or remove_from_target_arr | length > 0 %} \n       {%- do alter_relation_add_remove_columns(target_relation, add_to_target_arr, remove_from_target_arr) -%}\n     {% endif %}\n\n     {% if new_target_types != [] %}\n       {% for ntt in new_target_types %}\n         {% set column_name = ntt['column_name'] %}\n         {% set new_type = ntt['new_type'] %}\n         {% do alter_column_type(target_relation, column_name, new_type) %}\n       {% endfor %}\n     {% endif %}\n  \n  {% endif %}\n\n  {% set schema_change_message %}\n    In {{ target_relation }}:\n        Schema change approach: {{ on_schema_change }}\n        Columns added: {{ add_to_target_arr }}\n        Columns removed: {{ remove_from_target_arr }}\n        Data types changed: {{ new_target_types }}\n  {% endset %}\n  \n  {% do log(schema_change_message) %}\n  \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.alter_relation_add_remove_columns", "macro.dbt.alter_column_type"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0033188}, "macro.dbt.process_schema_changes": {"unique_id": "macro.dbt.process_schema_changes", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/on_schema_change.sql", "original_file_path": "macros/materializations/models/incremental/on_schema_change.sql", "name": "process_schema_changes", "macro_sql": "{% macro process_schema_changes(on_schema_change, source_relation, target_relation) %}\n    \n    {% if on_schema_change == 'ignore' %}\n\n     {{ return({}) }}\n\n    {% else %}\n    \n      {% set schema_changes_dict = check_for_schema_changes(source_relation, target_relation) %}\n      \n      {% if schema_changes_dict['schema_changed'] %}\n    \n        {% if on_schema_change == 'fail' %}\n        \n          {% set fail_msg %}\n              The source and target schemas on this incremental model are out of sync!\n              They can be reconciled in several ways: \n                - set the `on_schema_change` config to either append_new_columns or sync_all_columns, depending on your situation.\n                - Re-run the incremental model with `full_refresh: True` to update the target schema.\n                - update the schema manually and re-run the process.\n          {% endset %}\n          \n          {% do exceptions.raise_compiler_error(fail_msg) %}\n        \n        {# -- unless we ignore, run the sync operation per the config #}\n        {% else %}\n          \n          {% do sync_column_schemas(on_schema_change, target_relation, schema_changes_dict) %}\n        \n        {% endif %}\n      \n      {% endif %}\n\n      {{ return(schema_changes_dict['source_columns']) }}\n    \n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.check_for_schema_changes", "macro.dbt.sync_column_schemas"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0049386}, "macro.dbt.is_incremental": {"unique_id": "macro.dbt.is_incremental", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/is_incremental.sql", "original_file_path": "macros/materializations/models/incremental/is_incremental.sql", "name": "is_incremental", "macro_sql": "{% macro is_incremental() %}\n    {#-- do not run introspective queries in parsing #}\n    {% if not execute %}\n        {{ return(False) }}\n    {% else %}\n        {% set relation = adapter.get_relation(this.database, this.schema, this.table) %}\n        {{ return(relation is not none\n                  and relation.type == 'table'\n                  and model.config.materialized == 'incremental'\n                  and not should_full_refresh()) }}\n    {% endif %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.006409}, "macro.dbt.get_merge_sql": {"unique_id": "macro.dbt.get_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_merge_sql", "macro_sql": "{% macro get_merge_sql(target, source, unique_key, dest_columns, predicates=none) -%}\n  {{ adapter.dispatch('get_merge_sql', 'dbt')(target, source, unique_key, dest_columns, predicates) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0113952}, "macro.dbt.default__get_merge_sql": {"unique_id": "macro.dbt.default__get_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_merge_sql", "macro_sql": "{% macro default__get_merge_sql(target, source, unique_key, dest_columns, predicates) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set update_columns = config.get('merge_update_columns', default = dest_columns | map(attribute=\"quoted\") | list) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {% if unique_key %}\n        {% set unique_key_match %}\n            DBT_INTERNAL_SOURCE.{{ unique_key }} = DBT_INTERNAL_DEST.{{ unique_key }}\n        {% endset %}\n        {% do predicates.append(unique_key_match) %}\n    {% else %}\n        {% do predicates.append('FALSE') %}\n    {% endif %}\n\n    {{ sql_header if sql_header is not none }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on {{ predicates | join(' and ') }}\n\n    {% if unique_key %}\n    when matched then update set\n        {% for column_name in update_columns -%}\n            {{ column_name }} = DBT_INTERNAL_SOURCE.{{ column_name }}\n            {%- if not loop.last %}, {%- endif %}\n        {%- endfor %}\n    {% endif %}\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0140688}, "macro.dbt.get_delete_insert_merge_sql": {"unique_id": "macro.dbt.get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_delete_insert_merge_sql", "macro_sql": "{% macro get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n  {{ adapter.dispatch('get_delete_insert_merge_sql', 'dbt')(target, source, unique_key, dest_columns) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0146046}, "macro.dbt.default__get_delete_insert_merge_sql": {"unique_id": "macro.dbt.default__get_delete_insert_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_delete_insert_merge_sql", "macro_sql": "{% macro default__get_delete_insert_merge_sql(target, source, unique_key, dest_columns) -%}\n\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n\n    {% if unique_key is not none %}\n    delete from {{ target }}\n    where ({{ unique_key }}) in (\n        select ({{ unique_key }})\n        from {{ source }}\n    );\n    {% endif %}\n\n    insert into {{ target }} ({{ dest_cols_csv }})\n    (\n        select {{ dest_cols_csv }}\n        from {{ source }}\n    )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0155416}, "macro.dbt.get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "get_insert_overwrite_merge_sql", "macro_sql": "{% macro get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header=false) -%}\n  {{ adapter.dispatch('get_insert_overwrite_merge_sql', 'dbt')(target, source, dest_columns, predicates, include_sql_header) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_insert_overwrite_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0161426}, "macro.dbt.default__get_insert_overwrite_merge_sql": {"unique_id": "macro.dbt.default__get_insert_overwrite_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/merge.sql", "original_file_path": "macros/materializations/models/incremental/merge.sql", "name": "default__get_insert_overwrite_merge_sql", "macro_sql": "{% macro default__get_insert_overwrite_merge_sql(target, source, dest_columns, predicates, include_sql_header) -%}\n    {%- set predicates = [] if predicates is none else [] + predicates -%}\n    {%- set dest_cols_csv = get_quoted_csv(dest_columns | map(attribute=\"name\")) -%}\n    {%- set sql_header = config.get('sql_header', none) -%}\n\n    {{ sql_header if sql_header is not none and include_sql_header }}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n        using {{ source }} as DBT_INTERNAL_SOURCE\n        on FALSE\n\n    when not matched by source\n        {% if predicates %} and {{ predicates | join(' and ') }} {% endif %}\n        then delete\n\n    when not matched then insert\n        ({{ dest_cols_csv }})\n    values\n        ({{ dest_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_quoted_csv"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0175326}, "macro.dbt.get_quoted_csv": {"unique_id": "macro.dbt.get_quoted_csv", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "get_quoted_csv", "macro_sql": "{% macro get_quoted_csv(column_names) %}\n    \n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote(col)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.019371}, "macro.dbt.diff_columns": {"unique_id": "macro.dbt.diff_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "diff_columns", "macro_sql": "{% macro diff_columns(source_columns, target_columns) %}\n\n  {% set result = [] %}\n  {% set source_names = source_columns | map(attribute = 'column') | list %}\n  {% set target_names = target_columns | map(attribute = 'column') | list %}\n   \n   {# --check whether the name attribute exists in the target - this does not perform a data type check #}\n   {% for sc in source_columns %}\n     {% if sc.name not in target_names %}\n        {{ result.append(sc) }}\n     {% endif %}\n   {% endfor %}\n  \n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0205965}, "macro.dbt.diff_column_data_types": {"unique_id": "macro.dbt.diff_column_data_types", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/models/incremental/column_helpers.sql", "original_file_path": "macros/materializations/models/incremental/column_helpers.sql", "name": "diff_column_data_types", "macro_sql": "{% macro diff_column_data_types(source_columns, target_columns) %}\n  \n  {% set result = [] %}\n  {% for sc in source_columns %}\n    {% set tc = target_columns | selectattr(\"name\", \"equalto\", sc.name) | list | first %}\n    {% if tc %}\n      {% if sc.data_type != tc.data_type %}\n        {{ result.append( { 'column_name': tc.name, 'new_type': sc.data_type } ) }} \n      {% endif %}\n    {% endif %}\n  {% endfor %}\n\n  {{ return(result) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0219474}, "macro.dbt.create_csv_table": {"unique_id": "macro.dbt.create_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "create_csv_table", "macro_sql": "{% macro create_csv_table(model, agate_table) -%}\n  {{ adapter.dispatch('create_csv_table', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0288398}, "macro.dbt.default__create_csv_table": {"unique_id": "macro.dbt.default__create_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__create_csv_table", "macro_sql": "{% macro default__create_csv_table(model, agate_table) %}\n  {%- set column_override = model['config'].get('column_types', {}) -%}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n\n  {% set sql %}\n    create table {{ this.render() }} (\n        {%- for col_name in agate_table.column_names -%}\n            {%- set inferred_type = adapter.convert_type(agate_table, loop.index0) -%}\n            {%- set type = column_override.get(col_name, inferred_type) -%}\n            {%- set column_name = (col_name | string) -%}\n            {{ adapter.quote_seed_column(column_name, quote_seed_column) }} {{ type }} {%- if not loop.last -%}, {%- endif -%}\n        {%- endfor -%}\n    )\n  {% endset %}\n\n  {% call statement('_') -%}\n    {{ sql }}\n  {%- endcall %}\n\n  {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0308003}, "macro.dbt.reset_csv_table": {"unique_id": "macro.dbt.reset_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "reset_csv_table", "macro_sql": "{% macro reset_csv_table(model, full_refresh, old_relation, agate_table) -%}\n  {{ adapter.dispatch('reset_csv_table', 'dbt')(model, full_refresh, old_relation, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__reset_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0313215}, "macro.dbt.default__reset_csv_table": {"unique_id": "macro.dbt.default__reset_csv_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__reset_csv_table", "macro_sql": "{% macro default__reset_csv_table(model, full_refresh, old_relation, agate_table) %}\n    {% set sql = \"\" %}\n    {% if full_refresh %}\n        {{ adapter.drop_relation(old_relation) }}\n        {% set sql = create_csv_table(model, agate_table) %}\n    {% else %}\n        {{ adapter.truncate_relation(old_relation) }}\n        {% set sql = \"truncate table \" ~ old_relation %}\n    {% endif %}\n\n    {{ return(sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_csv_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0324063}, "macro.dbt.get_binding_char": {"unique_id": "macro.dbt.get_binding_char", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_binding_char", "macro_sql": "{% macro get_binding_char() -%}\n  {{ adapter.dispatch('get_binding_char', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0327427}, "macro.dbt.default__get_binding_char": {"unique_id": "macro.dbt.default__get_binding_char", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__get_binding_char", "macro_sql": "{% macro default__get_binding_char() %}\n  {{ return('%s') }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0330093}, "macro.dbt.get_batch_size": {"unique_id": "macro.dbt.get_batch_size", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_batch_size", "macro_sql": "{% macro get_batch_size() -%}\n  {{ return(adapter.dispatch('get_batch_size', 'dbt')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_batch_size"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.033454}, "macro.dbt.default__get_batch_size": {"unique_id": "macro.dbt.default__get_batch_size", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__get_batch_size", "macro_sql": "{% macro default__get_batch_size() %}\n  {{ return(10000) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0337338}, "macro.dbt.get_seed_column_quoted_csv": {"unique_id": "macro.dbt.get_seed_column_quoted_csv", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "get_seed_column_quoted_csv", "macro_sql": "{% macro get_seed_column_quoted_csv(model, column_names) %}\n  {%- set quote_seed_column = model['config'].get('quote_columns', None) -%}\n    {% set quoted = [] %}\n    {% for col in column_names -%}\n        {%- do quoted.append(adapter.quote_seed_column(col, quote_seed_column)) -%}\n    {%- endfor %}\n\n    {%- set dest_cols_csv = quoted | join(', ') -%}\n    {{ return(dest_cols_csv) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0349078}, "macro.dbt.load_csv_rows": {"unique_id": "macro.dbt.load_csv_rows", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "load_csv_rows", "macro_sql": "{% macro load_csv_rows(model, agate_table) -%}\n  {{ adapter.dispatch('load_csv_rows', 'dbt')(model, agate_table) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__load_csv_rows"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0353138}, "macro.dbt.default__load_csv_rows": {"unique_id": "macro.dbt.default__load_csv_rows", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/helpers.sql", "original_file_path": "macros/materializations/seeds/helpers.sql", "name": "default__load_csv_rows", "macro_sql": "{% macro default__load_csv_rows(model, agate_table) %}\n\n  {% set batch_size = get_batch_size() %}\n\n  {% set cols_sql = get_seed_column_quoted_csv(model, agate_table.column_names) %}\n  {% set bindings = [] %}\n\n  {% set statements = [] %}\n\n  {% for chunk in agate_table.rows | batch(batch_size) %}\n      {% set bindings = [] %}\n\n      {% for row in chunk %}\n          {% do bindings.extend(row) %}\n      {% endfor %}\n\n      {% set sql %}\n          insert into {{ this.render() }} ({{ cols_sql }}) values\n          {% for row in chunk -%}\n              ({%- for column in agate_table.column_names -%}\n                  {{ get_binding_char() }}\n                  {%- if not loop.last%},{%- endif %}\n              {%- endfor -%})\n              {%- if not loop.last%},{%- endif %}\n          {%- endfor %}\n      {% endset %}\n\n      {% do adapter.add_query(sql, bindings=bindings, abridge_sql_log=True) %}\n\n      {% if loop.index0 == 0 %}\n          {% do statements.append(sql) %}\n      {% endif %}\n  {% endfor %}\n\n  {# Return SQL so we can render it out into the compiled files #}\n  {{ return(statements[0]) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_batch_size", "macro.dbt.get_seed_column_quoted_csv", "macro.dbt.get_binding_char"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0379117}, "macro.dbt.materialization_seed_default": {"unique_id": "macro.dbt.materialization_seed_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/seeds/seed.sql", "original_file_path": "macros/materializations/seeds/seed.sql", "name": "materialization_seed_default", "macro_sql": "{% materialization seed, default %}\n\n  {%- set identifier = model['alias'] -%}\n  {%- set full_refresh_mode = (should_full_refresh()) -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_as_view = (old_relation is not none and old_relation.is_view) -%}\n\n  {%- set agate_table = load_agate_table() -%}\n  {%- do store_result('agate_table', response='OK', agate_table=agate_table) -%}\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  -- `BEGIN` happens here:\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  -- build model\n  {% set create_table_sql = \"\" %}\n  {% if exists_as_view %}\n    {{ exceptions.raise_compiler_error(\"Cannot seed to '{}', it is a view\".format(old_relation)) }}\n  {% elif exists_as_table %}\n    {% set create_table_sql = reset_csv_table(model, full_refresh_mode, old_relation, agate_table) %}\n  {% else %}\n    {% set create_table_sql = create_csv_table(model, agate_table) %}\n  {% endif %}\n\n  {% set code = 'CREATE' if full_refresh_mode else 'INSERT' %}\n  {% set rows_affected = (agate_table.rows | length) %}\n  {% set sql = load_csv_rows(model, agate_table) %}\n\n  {% call noop_statement('main', code ~ ' ' ~ rows_affected, code, rows_affected) %}\n    {{ create_table_sql }};\n    -- dbt seed --\n    {{ sql }}\n  {% endcall %}\n\n  {% set target_relation = this.incorporate(type='table') %}\n  {% do persist_docs(target_relation, model) %}\n\n  {% if full_refresh_mode or not exists_as_table %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  -- `COMMIT` happens here\n  {{ adapter.commit() }}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_full_refresh", "macro.dbt.run_hooks", "macro.dbt.reset_csv_table", "macro.dbt.create_csv_table", "macro.dbt.load_csv_rows", "macro.dbt.noop_statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0438542}, "macro.dbt.get_test_sql": {"unique_id": "macro.dbt.get_test_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "name": "get_test_sql", "macro_sql": "{% macro get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n  {{ adapter.dispatch('get_test_sql', 'dbt')(main_sql, fail_calc, warn_if, error_if, limit) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.044924}, "macro.dbt.default__get_test_sql": {"unique_id": "macro.dbt.default__get_test_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/helpers.sql", "original_file_path": "macros/materializations/tests/helpers.sql", "name": "default__get_test_sql", "macro_sql": "{% macro default__get_test_sql(main_sql, fail_calc, warn_if, error_if, limit) -%}\n    select\n      {{ fail_calc }} as failures,\n      {{ fail_calc }} {{ warn_if }} as should_warn,\n      {{ fail_calc }} {{ error_if }} as should_error\n    from (\n      {{ main_sql }}\n      {{ \"limit \" ~ limit if limit != none }}\n    ) dbt_internal_test\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0456161}, "macro.dbt.materialization_test_default": {"unique_id": "macro.dbt.materialization_test_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/test.sql", "original_file_path": "macros/materializations/tests/test.sql", "name": "materialization_test_default", "macro_sql": "{%- materialization test, default -%}\n\n  {% set relations = [] %}\n\n  {% if should_store_failures() %}\n\n    {% set identifier = model['alias'] %}\n    {% set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) %}\n    {% set target_relation = api.Relation.create(\n        identifier=identifier, schema=schema, database=database, type='table') -%} %}\n    \n    {% if old_relation %}\n        {% do adapter.drop_relation(old_relation) %}\n    {% endif %}\n    \n    {% call statement(auto_begin=True) %}\n        {{ create_table_as(False, target_relation, sql) }}\n    {% endcall %}\n    \n    {% do relations.append(target_relation) %}\n  \n    {% set main_sql %}\n        select *\n        from {{ target_relation }}\n    {% endset %}\n    \n    {{ adapter.commit() }}\n  \n  {% else %}\n\n      {% set main_sql = sql %}\n  \n  {% endif %}\n\n  {% set limit = config.get('limit') %}\n  {% set fail_calc = config.get('fail_calc') %}\n  {% set warn_if = config.get('warn_if') %}\n  {% set error_if = config.get('error_if') %}\n\n  {% call statement('main', fetch_result=True) -%}\n\n    {{ get_test_sql(main_sql, fail_calc, warn_if, error_if, limit)}}\n\n  {%- endcall %}\n  \n  {{ return({'relations': relations}) }}\n\n{%- endmaterialization -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.should_store_failures", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt.get_test_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0499253}, "macro.dbt.get_where_subquery": {"unique_id": "macro.dbt.get_where_subquery", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "name": "get_where_subquery", "macro_sql": "{% macro get_where_subquery(relation) -%}\n    {% do return(adapter.dispatch('get_where_subquery', 'dbt')(relation)) %}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__get_where_subquery"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0508318}, "macro.dbt.default__get_where_subquery": {"unique_id": "macro.dbt.default__get_where_subquery", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/tests/where_subquery.sql", "original_file_path": "macros/materializations/tests/where_subquery.sql", "name": "default__get_where_subquery", "macro_sql": "{% macro default__get_where_subquery(relation) -%}\n    {% set where = config.get('where', '') %}\n    {% if where %}\n        {%- set filtered -%}\n            (select * from {{ relation }} where {{ where }}) dbt_subquery\n        {%- endset -%}\n        {% do return(filtered) %}\n    {%- else -%}\n        {% do return(relation) %}\n    {%- endif -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0516746}, "macro.dbt.create_columns": {"unique_id": "macro.dbt.create_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "create_columns", "macro_sql": "{% macro create_columns(relation, columns) %}\n  {{ adapter.dispatch('create_columns', 'dbt')(relation, columns) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__create_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.056972}, "macro.dbt.default__create_columns": {"unique_id": "macro.dbt.default__create_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__create_columns", "macro_sql": "{% macro default__create_columns(relation, columns) %}\n  {% for column in columns %}\n    {% call statement() %}\n      alter table {{ relation }} add column \"{{ column.name }}\" {{ column.data_type }};\n    {% endcall %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0576253}, "macro.dbt.post_snapshot": {"unique_id": "macro.dbt.post_snapshot", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "post_snapshot", "macro_sql": "{% macro post_snapshot(staging_relation) %}\n  {{ adapter.dispatch('post_snapshot', 'dbt')(staging_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0580032}, "macro.dbt.default__post_snapshot": {"unique_id": "macro.dbt.default__post_snapshot", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__post_snapshot", "macro_sql": "{% macro default__post_snapshot(staging_relation) %}\n    {# no-op #}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0582104}, "macro.dbt.snapshot_staging_table": {"unique_id": "macro.dbt.snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "snapshot_staging_table", "macro_sql": "{% macro snapshot_staging_table(strategy, source_sql, target_relation) -%}\n  {{ adapter.dispatch('snapshot_staging_table', 'dbt')(strategy, source_sql, target_relation) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_staging_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0586665}, "macro.dbt.default__snapshot_staging_table": {"unique_id": "macro.dbt.default__snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__snapshot_staging_table", "macro_sql": "{% macro default__snapshot_staging_table(strategy, source_sql, target_relation) -%}\n\n    with snapshot_query as (\n\n        {{ source_sql }}\n\n    ),\n\n    snapshotted_data as (\n\n        select *,\n            {{ strategy.unique_key }} as dbt_unique_key\n\n        from {{ target_relation }}\n        where dbt_valid_to is null\n\n    ),\n\n    insertions_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to,\n            {{ strategy.scd_id }} as dbt_scd_id\n\n        from snapshot_query\n    ),\n\n    updates_source_data as (\n\n        select\n            *,\n            {{ strategy.unique_key }} as dbt_unique_key,\n            {{ strategy.updated_at }} as dbt_updated_at,\n            {{ strategy.updated_at }} as dbt_valid_from,\n            {{ strategy.updated_at }} as dbt_valid_to\n\n        from snapshot_query\n    ),\n\n    {%- if strategy.invalidate_hard_deletes %}\n\n    deletes_source_data as (\n\n        select \n            *,\n            {{ strategy.unique_key }} as dbt_unique_key\n        from snapshot_query\n    ),\n    {% endif %}\n\n    insertions as (\n\n        select\n            'insert' as dbt_change_type,\n            source_data.*\n\n        from insertions_source_data as source_data\n        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where snapshotted_data.dbt_unique_key is null\n           or (\n                snapshotted_data.dbt_unique_key is not null\n            and (\n                {{ strategy.row_changed }}\n            )\n        )\n\n    ),\n\n    updates as (\n\n        select\n            'update' as dbt_change_type,\n            source_data.*,\n            snapshotted_data.dbt_scd_id\n\n        from updates_source_data as source_data\n        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where (\n            {{ strategy.row_changed }}\n        )\n    )\n\n    {%- if strategy.invalidate_hard_deletes -%}\n    ,\n\n    deletes as (\n    \n        select\n            'delete' as dbt_change_type,\n            source_data.*,\n            {{ snapshot_get_time() }} as dbt_valid_from,\n            {{ snapshot_get_time() }} as dbt_updated_at,\n            {{ snapshot_get_time() }} as dbt_valid_to,\n            snapshotted_data.dbt_scd_id\n    \n        from snapshotted_data\n        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key\n        where source_data.dbt_unique_key is null\n    )\n    {%- endif %}\n\n    select * from insertions\n    union all\n    select * from updates\n    {%- if strategy.invalidate_hard_deletes %}\n    union all\n    select * from deletes\n    {%- endif %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0606515}, "macro.dbt.build_snapshot_table": {"unique_id": "macro.dbt.build_snapshot_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "build_snapshot_table", "macro_sql": "{% macro build_snapshot_table(strategy, sql) -%}\n  {{ adapter.dispatch('build_snapshot_table', 'dbt')(strategy, sql) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__build_snapshot_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0610857}, "macro.dbt.default__build_snapshot_table": {"unique_id": "macro.dbt.default__build_snapshot_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "default__build_snapshot_table", "macro_sql": "{% macro default__build_snapshot_table(strategy, sql) %}\n\n    select *,\n        {{ strategy.scd_id }} as dbt_scd_id,\n        {{ strategy.updated_at }} as dbt_updated_at,\n        {{ strategy.updated_at }} as dbt_valid_from,\n        nullif({{ strategy.updated_at }}, {{ strategy.updated_at }}) as dbt_valid_to\n    from (\n        {{ sql }}\n    ) sbq\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.06166}, "macro.dbt.build_snapshot_staging_table": {"unique_id": "macro.dbt.build_snapshot_staging_table", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/helpers.sql", "original_file_path": "macros/materializations/snapshots/helpers.sql", "name": "build_snapshot_staging_table", "macro_sql": "{% macro build_snapshot_staging_table(strategy, sql, target_relation) %}\n    {% set tmp_relation = make_temp_relation(target_relation) %}\n\n    {% set select = snapshot_staging_table(strategy, sql, target_relation) %}\n\n    {% call statement('build_snapshot_staging_relation') %}\n        {{ create_table_as(True, tmp_relation, select) }}\n    {% endcall %}\n\n    {% do return(tmp_relation) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.make_temp_relation", "macro.dbt.snapshot_staging_table", "macro.dbt.statement", "macro.dbt.create_table_as"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0625994}, "macro.dbt.strategy_dispatch": {"unique_id": "macro.dbt.strategy_dispatch", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "strategy_dispatch", "macro_sql": "{% macro strategy_dispatch(name) -%}\n{% set original_name = name %}\n  {% if '.' in name %}\n    {% set package_name, name = name.split(\".\", 1) %}\n  {% else %}\n    {% set package_name = none %}\n  {% endif %}\n\n  {% if package_name is none %}\n    {% set package_context = context %}\n  {% elif package_name in context %}\n    {% set package_context = context[package_name] %}\n  {% else %}\n    {% set error_msg %}\n        Could not find package '{{package_name}}', called with '{{original_name}}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n\n  {%- set search_name = 'snapshot_' ~ name ~ '_strategy' -%}\n\n  {% if search_name not in package_context %}\n    {% set error_msg %}\n        The specified strategy macro '{{name}}' was not found in package '{{ package_name }}'\n    {% endset %}\n    {{ exceptions.raise_compiler_error(error_msg | trim) }}\n  {% endif %}\n  {{ return(package_context[search_name]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0690722}, "macro.dbt.snapshot_hash_arguments": {"unique_id": "macro.dbt.snapshot_hash_arguments", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_hash_arguments", "macro_sql": "{% macro snapshot_hash_arguments(args) -%}\n  {{ adapter.dispatch('snapshot_hash_arguments', 'dbt')(args) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0695539}, "macro.dbt.default__snapshot_hash_arguments": {"unique_id": "macro.dbt.default__snapshot_hash_arguments", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_hash_arguments", "macro_sql": "{% macro default__snapshot_hash_arguments(args) -%}\n    md5({%- for arg in args -%}\n        coalesce(cast({{ arg }} as varchar ), '')\n        {% if not loop.last %} || '|' || {% endif %}\n    {%- endfor -%})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0700521}, "macro.dbt.snapshot_get_time": {"unique_id": "macro.dbt.snapshot_get_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_get_time", "macro_sql": "{% macro snapshot_get_time() -%}\n  {{ adapter.dispatch('snapshot_get_time', 'dbt')() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_get_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0703654}, "macro.dbt.default__snapshot_get_time": {"unique_id": "macro.dbt.default__snapshot_get_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_get_time", "macro_sql": "{% macro default__snapshot_get_time() -%}\n  {{ current_timestamp() }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0705867}, "macro.dbt.snapshot_timestamp_strategy": {"unique_id": "macro.dbt.snapshot_timestamp_strategy", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_timestamp_strategy", "macro_sql": "{% macro snapshot_timestamp_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set primary_key = config['unique_key'] %}\n    {% set updated_at = config['updated_at'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n\n    {#/*\n        The snapshot relation might not have an {{ updated_at }} value if the\n        snapshot strategy is changed from `check` to `timestamp`. We\n        should use a dbt-created column for the comparison in the snapshot\n        table instead of assuming that the user-supplied {{ updated_at }}\n        will be present in the historical data.\n\n        See https://github.com/dbt-labs/dbt-core/issues/2350\n    */ #}\n    {% set row_changed_expr -%}\n        ({{ snapshotted_rel }}.dbt_valid_from < {{ current_rel }}.{{ updated_at }})\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0721326}, "macro.dbt.snapshot_string_as_time": {"unique_id": "macro.dbt.snapshot_string_as_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_string_as_time", "macro_sql": "{% macro snapshot_string_as_time(timestamp) -%}\n    {{ adapter.dispatch('snapshot_string_as_time', 'dbt')(timestamp) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_string_as_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0725167}, "macro.dbt.default__snapshot_string_as_time": {"unique_id": "macro.dbt.default__snapshot_string_as_time", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "default__snapshot_string_as_time", "macro_sql": "{% macro default__snapshot_string_as_time(timestamp) %}\n    {% do exceptions.raise_not_implemented(\n        'snapshot_string_as_time macro not implemented for adapter '+adapter.type()\n    ) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0729008}, "macro.dbt.snapshot_check_all_get_existing_columns": {"unique_id": "macro.dbt.snapshot_check_all_get_existing_columns", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_check_all_get_existing_columns", "macro_sql": "{% macro snapshot_check_all_get_existing_columns(node, target_exists) -%}\n    {%- set query_columns = get_columns_in_query(node['compiled_sql']) -%}\n    {%- if not target_exists -%}\n        {# no table yet -> return whatever the query does #}\n        {{ return([false, query_columns]) }}\n    {%- endif -%}\n    {# handle any schema changes #}\n    {%- set target_table = node.get('alias', node.get('name')) -%}\n    {%- set target_relation = adapter.get_relation(database=node.database, schema=node.schema, identifier=target_table) -%}\n    {%- set existing_cols = get_columns_in_query('select * from ' ~ target_relation) -%}\n    {%- set ns = namespace() -%} {# handle for-loop scoping with a namespace #}\n    {%- set ns.column_added = false -%}\n\n    {%- set intersection = [] -%}\n    {%- for col in query_columns -%}\n        {%- if col in existing_cols -%}\n            {%- do intersection.append(col) -%}\n        {%- else -%}\n            {% set ns.column_added = true %}\n        {%- endif -%}\n    {%- endfor -%}\n    {{ return([ns.column_added, intersection]) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.get_columns_in_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0751185}, "macro.dbt.snapshot_check_strategy": {"unique_id": "macro.dbt.snapshot_check_strategy", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/strategies.sql", "original_file_path": "macros/materializations/snapshots/strategies.sql", "name": "snapshot_check_strategy", "macro_sql": "{% macro snapshot_check_strategy(node, snapshotted_rel, current_rel, config, target_exists) %}\n    {% set check_cols_config = config['check_cols'] %}\n    {% set primary_key = config['unique_key'] %}\n    {% set invalidate_hard_deletes = config.get('invalidate_hard_deletes', false) %}\n    \n    {% set select_current_time -%}\n        select {{ snapshot_get_time() }} as snapshot_start\n    {%- endset %}\n\n    {#-- don't access the column by name, to avoid dealing with casing issues on snowflake #}\n    {%- set now = run_query(select_current_time)[0][0] -%}\n    {% if now is none or now is undefined -%}\n        {%- do exceptions.raise_compiler_error('Could not get a snapshot start time from the database') -%}\n    {%- endif %}\n    {% set updated_at = config.get('updated_at', snapshot_string_as_time(now)) %}\n\n    {% set column_added = false %}\n\n    {% if check_cols_config == 'all' %}\n        {% set column_added, check_cols = snapshot_check_all_get_existing_columns(node, target_exists) %}\n    {% elif check_cols_config is iterable and (check_cols_config | length) > 0 %}\n        {% set check_cols = check_cols_config %}\n    {% else %}\n        {% do exceptions.raise_compiler_error(\"Invalid value for 'check_cols': \" ~ check_cols_config) %}\n    {% endif %}\n\n    {%- set row_changed_expr -%}\n    (\n    {%- if column_added -%}\n        TRUE\n    {%- else -%}\n    {%- for col in check_cols -%}\n        {{ snapshotted_rel }}.{{ col }} != {{ current_rel }}.{{ col }}\n        or\n        (\n            (({{ snapshotted_rel }}.{{ col }} is null) and not ({{ current_rel }}.{{ col }} is null))\n            or\n            ((not {{ snapshotted_rel }}.{{ col }} is null) and ({{ current_rel }}.{{ col }} is null))\n        )\n        {%- if not loop.last %} or {% endif -%}\n    {%- endfor -%}\n    {%- endif -%}\n    )\n    {%- endset %}\n\n    {% set scd_id_expr = snapshot_hash_arguments([primary_key, updated_at]) %}\n\n    {% do return({\n        \"unique_key\": primary_key,\n        \"updated_at\": updated_at,\n        \"row_changed\": row_changed_expr,\n        \"scd_id\": scd_id_expr,\n        \"invalidate_hard_deletes\": invalidate_hard_deletes\n    }) %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.snapshot_get_time", "macro.dbt.run_query", "macro.dbt.snapshot_string_as_time", "macro.dbt.snapshot_check_all_get_existing_columns", "macro.dbt.snapshot_hash_arguments"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0792446}, "macro.dbt.snapshot_merge_sql": {"unique_id": "macro.dbt.snapshot_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "name": "snapshot_merge_sql", "macro_sql": "{% macro snapshot_merge_sql(target, source, insert_cols) -%}\n  {{ adapter.dispatch('snapshot_merge_sql', 'dbt')(target, source, insert_cols) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_snowflake.snowflake__snapshot_merge_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.080364}, "macro.dbt.default__snapshot_merge_sql": {"unique_id": "macro.dbt.default__snapshot_merge_sql", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot_merge.sql", "original_file_path": "macros/materializations/snapshots/snapshot_merge.sql", "name": "default__snapshot_merge_sql", "macro_sql": "{% macro default__snapshot_merge_sql(target, source, insert_cols) -%}\n    {%- set insert_cols_csv = insert_cols | join(', ') -%}\n\n    merge into {{ target }} as DBT_INTERNAL_DEST\n    using {{ source }} as DBT_INTERNAL_SOURCE\n    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id\n\n    when matched\n     and DBT_INTERNAL_DEST.dbt_valid_to is null\n     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')\n        then update\n        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to\n\n    when not matched\n     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'\n        then insert ({{ insert_cols_csv }})\n        values ({{ insert_cols_csv }})\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0809603}, "macro.dbt.materialization_snapshot_default": {"unique_id": "macro.dbt.materialization_snapshot_default", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "macros/materializations/snapshots/snapshot.sql", "original_file_path": "macros/materializations/snapshots/snapshot.sql", "name": "materialization_snapshot_default", "macro_sql": "{% materialization snapshot, default %}\n  {%- set config = model['config'] -%}\n\n  {%- set target_table = model.get('alias', model.get('name')) -%}\n\n  {%- set strategy_name = config.get('strategy') -%}\n  {%- set unique_key = config.get('unique_key') %}\n\n  {% if not adapter.check_schema_exists(model.database, model.schema) %}\n    {% do create_schema(model.database, model.schema) %}\n  {% endif %}\n\n  {% set target_relation_exists, target_relation = get_or_create_relation(\n          database=model.database,\n          schema=model.schema,\n          identifier=target_table,\n          type='table') -%}\n\n  {%- if not target_relation.is_table -%}\n    {% do exceptions.relation_wrong_type(target_relation, 'table') %}\n  {%- endif -%}\n\n\n  {{ run_hooks(pre_hooks, inside_transaction=False) }}\n\n  {{ run_hooks(pre_hooks, inside_transaction=True) }}\n\n  {% set strategy_macro = strategy_dispatch(strategy_name) %}\n  {% set strategy = strategy_macro(model, \"snapshotted_data\", \"source_data\", config, target_relation_exists) %}\n\n  {% if not target_relation_exists %}\n\n      {% set build_sql = build_snapshot_table(strategy, model['compiled_sql']) %}\n      {% set final_sql = create_table_as(False, target_relation, build_sql) %}\n\n  {% else %}\n\n      {{ adapter.valid_snapshot_target(target_relation) }}\n\n      {% set staging_table = build_snapshot_staging_table(strategy, sql, target_relation) %}\n\n      -- this may no-op if the database does not require column expansion\n      {% do adapter.expand_target_column_types(from_relation=staging_table,\n                                               to_relation=target_relation) %}\n\n      {% set missing_columns = adapter.get_missing_columns(staging_table, target_relation)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% do create_columns(target_relation, missing_columns) %}\n\n      {% set source_columns = adapter.get_columns_in_relation(staging_table)\n                                   | rejectattr('name', 'equalto', 'dbt_change_type')\n                                   | rejectattr('name', 'equalto', 'DBT_CHANGE_TYPE')\n                                   | rejectattr('name', 'equalto', 'dbt_unique_key')\n                                   | rejectattr('name', 'equalto', 'DBT_UNIQUE_KEY')\n                                   | list %}\n\n      {% set quoted_source_columns = [] %}\n      {% for column in source_columns %}\n        {% do quoted_source_columns.append(adapter.quote(column.name)) %}\n      {% endfor %}\n\n      {% set final_sql = snapshot_merge_sql(\n            target = target_relation,\n            source = staging_table,\n            insert_cols = quoted_source_columns\n         )\n      %}\n\n  {% endif %}\n\n  {% call statement('main') %}\n      {{ final_sql }}\n  {% endcall %}\n\n  {% do persist_docs(target_relation, model) %}\n\n  {% if not target_relation_exists %}\n    {% do create_indexes(target_relation) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=True) }}\n\n  {{ adapter.commit() }}\n\n  {% if staging_table is defined %}\n      {% do post_snapshot(staging_table) %}\n  {% endif %}\n\n  {{ run_hooks(post_hooks, inside_transaction=False) }}\n\n  {{ return({'relations': [target_relation]}) }}\n\n{% endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.create_schema", "macro.dbt.get_or_create_relation", "macro.dbt.run_hooks", "macro.dbt.strategy_dispatch", "macro.dbt.build_snapshot_table", "macro.dbt.create_table_as", "macro.dbt.build_snapshot_staging_table", "macro.dbt.create_columns", "macro.dbt.snapshot_merge_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt.create_indexes", "macro.dbt.post_snapshot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0922642}, "macro.dbt.test_unique": {"unique_id": "macro.dbt.test_unique", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_unique", "macro_sql": "{% test unique(model, column_name) %}\n    {% set macro = adapter.dispatch('test_unique', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.093444}, "macro.dbt.test_not_null": {"unique_id": "macro.dbt.test_not_null", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_not_null", "macro_sql": "{% test not_null(model, column_name) %}\n    {% set macro = adapter.dispatch('test_not_null', 'dbt') %}\n    {{ macro(model, column_name) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0939665}, "macro.dbt.test_accepted_values": {"unique_id": "macro.dbt.test_accepted_values", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_accepted_values", "macro_sql": "{% test accepted_values(model, column_name, values, quote=True) %}\n    {% set macro = adapter.dispatch('test_accepted_values', 'dbt') %}\n    {{ macro(model, column_name, values, quote) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0945904}, "macro.dbt.test_relationships": {"unique_id": "macro.dbt.test_relationships", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "tests/generic/builtin.sql", "original_file_path": "tests/generic/builtin.sql", "name": "test_relationships", "macro_sql": "{% test relationships(model, column_name, to, field) %}\n    {% set macro = adapter.dispatch('test_relationships', 'dbt') %}\n    {{ macro(model, column_name, to, field) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.default__test_relationships"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0952766}, "macro.dbt_utils.pivot": {"unique_id": "macro.dbt_utils.pivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "name": "pivot", "macro_sql": "{% macro pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n    {{ return(adapter.dispatch('pivot', 'dbt_utils')(column, values, alias, agg, cmp, prefix, suffix, then_value, else_value, quote_identifiers, distinct)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.0973926}, "macro.dbt_utils.default__pivot": {"unique_id": "macro.dbt_utils.default__pivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/pivot.sql", "original_file_path": "macros/sql/pivot.sql", "name": "default__pivot", "macro_sql": "{% macro default__pivot(column,\n               values,\n               alias=True,\n               agg='sum',\n               cmp='=',\n               prefix='',\n               suffix='',\n               then_value=1,\n               else_value=0,\n               quote_identifiers=True,\n               distinct=False) %}\n  {% for value in values %}\n    {{ agg }}(\n      {% if distinct %} distinct {% endif %}\n      case\n      when {{ column }} {{ cmp }} '{{ dbt_utils.escape_single_quotes(value) }}'\n        then {{ then_value }}\n      else {{ else_value }}\n      end\n    )\n    {% if alias %}\n      {% if quote_identifiers %}\n            as {{ adapter.quote(prefix ~ value ~ suffix) }}\n      {% else %}\n        as {{ dbt_utils.slugify(prefix ~ value ~ suffix) }}\n      {% endif %}\n    {% endif %}\n    {% if not loop.last %},{% endif %}\n  {% endfor %}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.escape_single_quotes", "macro.dbt_utils.slugify"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.099231}, "macro.dbt_utils.star": {"unique_id": "macro.dbt_utils.star", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "name": "star", "macro_sql": "{% macro star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {{ return(adapter.dispatch('star', 'dbt_utils')(from, relation_alias, except, prefix, suffix)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__star"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.100901}, "macro.dbt_utils.default__star": {"unique_id": "macro.dbt_utils.default__star", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/star.sql", "original_file_path": "macros/sql/star.sql", "name": "default__star", "macro_sql": "{% macro default__star(from, relation_alias=False, except=[], prefix='', suffix='') -%}\n    {%- do dbt_utils._is_relation(from, 'star') -%}\n    {%- do dbt_utils._is_ephemeral(from, 'star') -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return('') }}\n    {% endif %}\n\n    {%- set include_cols = [] %}\n    {%- set cols = adapter.get_columns_in_relation(from) -%}\n    {%- set except = except | map(\"lower\") | list %}\n    {%- for col in cols -%}\n\n        {%- if col.column|lower not in except -%}\n            {% do include_cols.append(col.column) %}\n\n        {%- endif %}\n    {%- endfor %}\n\n    {%- for col in include_cols %}\n\n        {%- if relation_alias %}{{ relation_alias }}.{% else %}{%- endif -%}{{ adapter.quote(col)|trim }} {%- if prefix!='' or suffix!='' -%} as {{ adapter.quote(prefix ~ col ~ suffix)|trim }} {%- endif -%}\n        {%- if not loop.last %},{{ '\\n  ' }}{% endif %}\n\n    {%- endfor -%}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1034021}, "macro.dbt_utils.get_table_types_sql": {"unique_id": "macro.dbt_utils.get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "get_table_types_sql", "macro_sql": "{%- macro get_table_types_sql() -%}\n  {{ return(adapter.dispatch('get_table_types_sql', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1042724}, "macro.dbt_utils.default__get_table_types_sql": {"unique_id": "macro.dbt_utils.default__get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "default__get_table_types_sql", "macro_sql": "{% macro default__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'EXTERNAL TABLE' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as \"table_type\"\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1044805}, "macro.dbt_utils.postgres__get_table_types_sql": {"unique_id": "macro.dbt_utils.postgres__get_table_types_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_table_types_sql.sql", "original_file_path": "macros/sql/get_table_types_sql.sql", "name": "postgres__get_table_types_sql", "macro_sql": "{% macro postgres__get_table_types_sql() %}\n            case table_type\n                when 'BASE TABLE' then 'table'\n                when 'FOREIGN' then 'external'\n                when 'MATERIALIZED VIEW' then 'materializedview'\n                else lower(table_type)\n            end as \"table_type\"\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1046712}, "macro.dbt_utils.surrogate_key": {"unique_id": "macro.dbt_utils.surrogate_key", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "name": "surrogate_key", "macro_sql": "{%- macro surrogate_key(field_list) -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('surrogate_key', 'dbt_utils')(field_list, *varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__surrogate_key"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1060257}, "macro.dbt_utils.default__surrogate_key": {"unique_id": "macro.dbt_utils.default__surrogate_key", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/surrogate_key.sql", "original_file_path": "macros/sql/surrogate_key.sql", "name": "default__surrogate_key", "macro_sql": "\n\n{%- macro default__surrogate_key(field_list) -%}\n\n{%- if varargs|length >= 1 or field_list is string %}\n\n{%- set error_message = '\nWarning: the `surrogate_key` macro now takes a single list argument instead of \\\nmultiple string arguments. Support for multiple string arguments will be \\\ndeprecated in a future release of dbt-utils. The {}.{} model triggered this warning. \\\n'.format(model.package_name, model.name) -%}\n\n{%- do exceptions.warn(error_message) -%}\n\n{# first argument is not included in varargs, so add first element to field_list_xf #}\n{%- set field_list_xf = [field_list] -%}\n\n{%- for field in varargs %}\n{%- set _ = field_list_xf.append(field) -%}\n{%- endfor -%}\n\n{%- else -%}\n\n{# if using list, just set field_list_xf as field_list #}\n{%- set field_list_xf = field_list -%}\n\n{%- endif -%}\n\n\n{%- set fields = [] -%}\n\n{%- for field in field_list_xf -%}\n\n    {%- set _ = fields.append(\n        \"coalesce(cast(\" ~ field ~ \" as \" ~ dbt_utils.type_string() ~ \"), '')\"\n    ) -%}\n\n    {%- if not loop.last %}\n        {%- set _ = fields.append(\"'-'\") -%}\n    {%- endif -%}\n\n{%- endfor -%}\n\n{{dbt_utils.hash(dbt_utils.concat(fields))}}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string", "macro.dbt_utils.hash", "macro.dbt_utils.concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1080742}, "macro.dbt_utils.get_query_results_as_dict": {"unique_id": "macro.dbt_utils.get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "name": "get_query_results_as_dict", "macro_sql": "{% macro get_query_results_as_dict(query) %}\n    {{ return(adapter.dispatch('get_query_results_as_dict', 'dbt_utils')(query)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_query_results_as_dict"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1090217}, "macro.dbt_utils.default__get_query_results_as_dict": {"unique_id": "macro.dbt_utils.default__get_query_results_as_dict", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_query_results_as_dict.sql", "original_file_path": "macros/sql/get_query_results_as_dict.sql", "name": "default__get_query_results_as_dict", "macro_sql": "{% macro default__get_query_results_as_dict(query) %}\n\n{# This macro returns a dictionary of the form {column_name: (tuple_of_results)} #}\n\n    {%- call statement('get_query_results', fetch_result=True,auto_begin=false) -%}\n\n        {{ query }}\n\n    {%- endcall -%}\n\n    {% set sql_results={} %}\n\n    {%- if execute -%}\n        {% set sql_results_table = load_result('get_query_results').table.columns %}\n        {% for column_name, column in sql_results_table.items() %}\n            {% do sql_results.update({column_name: column.values()}) %}\n        {% endfor %}\n    {%- endif -%}\n\n    {{ return(sql_results) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.110326}, "macro.dbt_utils.get_intervals_between": {"unique_id": "macro.dbt_utils.get_intervals_between", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "get_intervals_between", "macro_sql": "{% macro get_intervals_between(start_date, end_date, datepart) -%}\n    {{ return(adapter.dispatch('get_intervals_between', 'dbt_utils')(start_date, end_date, datepart)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_intervals_between"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1118324}, "macro.dbt_utils.default__get_intervals_between": {"unique_id": "macro.dbt_utils.default__get_intervals_between", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "default__get_intervals_between", "macro_sql": "{% macro default__get_intervals_between(start_date, end_date, datepart) -%}\n    {%- call statement('get_intervals_between', fetch_result=True) %}\n\n        select {{dbt_utils.datediff(start_date, end_date, datepart)}}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_intervals_between') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values[0]) }}\n    {%- else -%}\n        {{ return(1) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1131518}, "macro.dbt_utils.date_spine": {"unique_id": "macro.dbt_utils.date_spine", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "date_spine", "macro_sql": "{% macro date_spine(datepart, start_date, end_date) %}\n    {{ return(adapter.dispatch('date_spine', 'dbt_utils')(datepart, start_date, end_date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_spine"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1138098}, "macro.dbt_utils.default__date_spine": {"unique_id": "macro.dbt_utils.default__date_spine", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/date_spine.sql", "original_file_path": "macros/sql/date_spine.sql", "name": "default__date_spine", "macro_sql": "{% macro default__date_spine(datepart, start_date, end_date) %}\n\n\n{# call as follows:\n\ndate_spine(\n    \"day\",\n    \"to_date('01/01/2016', 'mm/dd/yyyy')\",\n    \"dateadd(week, 1, current_date)\"\n) #}\n\n\nwith rawdata as (\n\n    {{dbt_utils.generate_series(\n        dbt_utils.get_intervals_between(start_date, end_date, datepart)\n    )}}\n\n),\n\nall_periods as (\n\n    select (\n        {{\n            dbt_utils.dateadd(\n                datepart,\n                \"row_number() over (order by 1) - 1\",\n                start_date\n            )\n        }}\n    ) as date_{{datepart}}\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_{{datepart}} <= {{ end_date }}\n\n)\n\nselect * from filtered\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.generate_series", "macro.dbt_utils.get_intervals_between", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1146154}, "macro.dbt_utils.get_column_values": {"unique_id": "macro.dbt_utils.get_column_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "name": "get_column_values", "macro_sql": "{% macro get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none) -%}\n    {{ return(adapter.dispatch('get_column_values', 'dbt_utils')(table, column, order_by, max_records, default)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_column_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1166024}, "macro.dbt_utils.default__get_column_values": {"unique_id": "macro.dbt_utils.default__get_column_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_column_values.sql", "original_file_path": "macros/sql/get_column_values.sql", "name": "default__get_column_values", "macro_sql": "{% macro default__get_column_values(table, column, order_by='count(*) desc', max_records=none, default=none) -%}\n{% if default is none %}\n    {% set default = [] %}\n{% endif %}\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n    {%- if not execute -%}\n        {{ return(default) }}\n    {% endif %}\n\n    {# Not all relations are tables. Renaming for internal clarity without breaking functionality for anyone using named arguments #}\n    {# TODO: Change the method signature in a future 0.x.0 release #}\n    {%- set target_relation = table -%}\n\n    {# adapter.load_relation is a convenience wrapper to avoid building a Relation when we already have one #}\n    {% set relation_exists = (load_relation(target_relation)) is not none %}\n\n    {%- call statement('get_column_values', fetch_result=true) %}\n\n        {%- if not relation_exists and default is none -%}\n\n          {{ exceptions.raise_compiler_error(\"In get_column_values(): relation \" ~ target_relation ~ \" does not exist and no default value was provided.\") }}\n\n        {%- elif not relation_exists and default is not none -%}\n\n          {{ log(\"Relation \" ~ target_relation ~ \" does not exist. Returning the default value: \" ~ default) }}\n\n          {{ return(default) }}\n\n        {%- else -%}\n\n\n            select\n                {{ column }} as value\n\n            from {{ target_relation }}\n            group by {{ column }}\n            order by {{ order_by }}\n\n            {% if max_records is not none %}\n            limit {{ max_records }}\n            {% endif %}\n\n        {% endif %}\n\n    {%- endcall -%}\n\n    {%- set value_list = load_result('get_column_values') -%}\n\n    {%- if value_list and value_list['data'] -%}\n        {%- set values = value_list['data'] | map(attribute=0) | list %}\n        {{ return(values) }}\n    {%- else -%}\n        {{ return(default) }}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.load_relation", "macro.dbt.statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.119583}, "macro.dbt_utils.group_by": {"unique_id": "macro.dbt_utils.group_by", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "name": "group_by", "macro_sql": "{%- macro group_by(n) -%}\n    {{ return(adapter.dispatch('group_by', 'dbt_utils')(n)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__group_by"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1203628}, "macro.dbt_utils.default__group_by": {"unique_id": "macro.dbt_utils.default__group_by", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/groupby.sql", "original_file_path": "macros/sql/groupby.sql", "name": "default__group_by", "macro_sql": "\n\n{%- macro default__group_by(n) -%}\n\n  group by {% for i in range(1, n + 1) -%}\n      {{ i }}{{ ',' if not loop.last }}   \n   {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1210232}, "macro.dbt_utils.get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "get_tables_by_pattern_sql", "macro_sql": "{% macro get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_pattern_sql', 'dbt_utils')\n        (schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1237836}, "macro.dbt_utils.default__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "default__get_tables_by_pattern_sql", "macro_sql": "{% macro default__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n        select distinct\n            table_schema as \"table_schema\",\n            table_name as \"table_name\",\n            {{ dbt_utils.get_table_types_sql() }}\n        from {{ database }}.information_schema.tables\n        where table_schema ilike '{{ schema_pattern }}'\n        and table_name ilike '{{ table_pattern }}'\n        and table_name not ilike '{{ exclude }}'\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_table_types_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1244202}, "macro.dbt_utils.bigquery__get_tables_by_pattern_sql": {"unique_id": "macro.dbt_utils.bigquery__get_tables_by_pattern_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "bigquery__get_tables_by_pattern_sql", "macro_sql": "{% macro bigquery__get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {% if '%' in schema_pattern %}\n        {% set schemata=dbt_utils._bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% else %}\n        {% set schemata=[schema_pattern] %}\n    {% endif %}\n\n    {% set sql %}\n        {% for schema in schemata %}\n            select distinct\n                table_schema,\n                table_name,\n                case table_type\n                    when 'BASE TABLE' then 'table'\n                    else lower(table_type)\n                end as table_type\n\n            from {{ adapter.quote(database) }}.{{ schema }}.INFORMATION_SCHEMA.TABLES\n            where lower(table_name) like lower ('{{ table_pattern }}')\n                and lower(table_name) not like lower ('{{ exclude }}')\n\n            {% if not loop.last %} union all {% endif %}\n\n        {% endfor %}\n    {% endset %}\n\n    {{ return(sql) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._bigquery__get_matching_schemata"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.125934}, "macro.dbt_utils._bigquery__get_matching_schemata": {"unique_id": "macro.dbt_utils._bigquery__get_matching_schemata", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_pattern_sql.sql", "original_file_path": "macros/sql/get_tables_by_pattern_sql.sql", "name": "_bigquery__get_matching_schemata", "macro_sql": "{% macro _bigquery__get_matching_schemata(schema_pattern, database) %}\n    {% if execute %}\n\n        {% set sql %}\n        select schema_name from {{ adapter.quote(database) }}.INFORMATION_SCHEMA.SCHEMATA\n        where lower(schema_name) like lower('{{ schema_pattern }}')\n        {% endset %}\n\n        {% set results=run_query(sql) %}\n\n        {% set schemata=results.columns['schema_name'].values() %}\n\n        {{ return(schemata) }}\n\n    {% else %}\n\n        {{ return([]) }}\n\n    {% endif %}\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_query"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1271534}, "macro.dbt_utils.nullcheck_table": {"unique_id": "macro.dbt_utils.nullcheck_table", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "name": "nullcheck_table", "macro_sql": "{% macro nullcheck_table(relation) %}\n    {{ return(adapter.dispatch('nullcheck_table', 'dbt_utils')(relation)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck_table"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.127948}, "macro.dbt_utils.default__nullcheck_table": {"unique_id": "macro.dbt_utils.default__nullcheck_table", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck_table.sql", "original_file_path": "macros/sql/nullcheck_table.sql", "name": "default__nullcheck_table", "macro_sql": "{% macro default__nullcheck_table(relation) %}\n\n  {%- do dbt_utils._is_relation(relation, 'nullcheck_table') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'nullcheck_table') -%}\n  {% set cols = adapter.get_columns_in_relation(relation) %}\n\n  select {{ dbt_utils.nullcheck(cols) }}\n  from {{relation}}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1287398}, "macro.dbt_utils.get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "name": "get_tables_by_prefix_sql", "macro_sql": "{% macro get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_tables_by_prefix_sql', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1297252}, "macro.dbt_utils.default__get_tables_by_prefix_sql": {"unique_id": "macro.dbt_utils.default__get_tables_by_prefix_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_tables_by_prefix_sql.sql", "original_file_path": "macros/sql/get_tables_by_prefix_sql.sql", "name": "default__get_tables_by_prefix_sql", "macro_sql": "{% macro default__get_tables_by_prefix_sql(schema, prefix, exclude='', database=target.database) %}\n\n    {{ dbt_utils.get_tables_by_pattern_sql(\n        schema_pattern = schema,\n        table_pattern = prefix ~ '%',\n        exclude = exclude,\n        database = database\n    ) }}\n    \n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1303463}, "macro.dbt_utils.get_relations_by_pattern": {"unique_id": "macro.dbt_utils.get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "name": "get_relations_by_pattern", "macro_sql": "{% macro get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_pattern', 'dbt_utils')(schema_pattern, table_pattern, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_pattern"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.131829}, "macro.dbt_utils.default__get_relations_by_pattern": {"unique_id": "macro.dbt_utils.default__get_relations_by_pattern", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_pattern.sql", "original_file_path": "macros/sql/get_relations_by_pattern.sql", "name": "default__get_relations_by_pattern", "macro_sql": "{% macro default__get_relations_by_pattern(schema_pattern, table_pattern, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_pattern_sql(schema_pattern, table_pattern, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_pattern_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1337192}, "macro.dbt_utils.get_relations_by_prefix": {"unique_id": "macro.dbt_utils.get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "name": "get_relations_by_prefix", "macro_sql": "{% macro get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n    {{ return(adapter.dispatch('get_relations_by_prefix', 'dbt_utils')(schema, prefix, exclude, database)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_relations_by_prefix"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1351037}, "macro.dbt_utils.default__get_relations_by_prefix": {"unique_id": "macro.dbt_utils.default__get_relations_by_prefix", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/get_relations_by_prefix.sql", "original_file_path": "macros/sql/get_relations_by_prefix.sql", "name": "default__get_relations_by_prefix", "macro_sql": "{% macro default__get_relations_by_prefix(schema, prefix, exclude='', database=target.database) %}\n\n    {%- call statement('get_tables', fetch_result=True) %}\n\n      {{ dbt_utils.get_tables_by_prefix_sql(schema, prefix, exclude, database) }}\n\n    {%- endcall -%}\n\n    {%- set table_list = load_result('get_tables') -%}\n\n    {%- if table_list and table_list['table'] -%}\n        {%- set tbl_relations = [] -%}\n        {%- for row in table_list['table'] -%}\n            {%- set tbl_relation = api.Relation.create(\n                database=database,\n                schema=row.table_schema,\n                identifier=row.table_name,\n                type=row.table_type\n            ) -%}\n            {%- do tbl_relations.append(tbl_relation) -%}\n        {%- endfor -%}\n\n        {{ return(tbl_relations) }}\n    {%- else -%}\n        {{ return([]) }}\n    {%- endif -%}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.get_tables_by_prefix_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1370714}, "macro.dbt_utils.safe_add": {"unique_id": "macro.dbt_utils.safe_add", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "name": "safe_add", "macro_sql": "{%- macro safe_add() -%}\n    {# needed for safe_add to allow for non-keyword arguments see SO post #}\n    {# https://stackoverflow.com/questions/13944751/args-kwargs-in-jinja2-macros #}\n    {% set frustrating_jinja_feature = varargs %}\n    {{ return(adapter.dispatch('safe_add', 'dbt_utils')(*varargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__safe_add"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1380296}, "macro.dbt_utils.default__safe_add": {"unique_id": "macro.dbt_utils.default__safe_add", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/safe_add.sql", "original_file_path": "macros/sql/safe_add.sql", "name": "default__safe_add", "macro_sql": "\n\n{%- macro default__safe_add() -%}\n\n{% set fields = [] %}\n\n{%- for field in varargs -%}\n\n    {% do fields.append(\"coalesce(\" ~ field ~ \", 0)\") %}\n\n{%- endfor -%}\n\n{{ fields|join(' +\\n  ') }}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1386688}, "macro.dbt_utils.degrees_to_radians": {"unique_id": "macro.dbt_utils.degrees_to_radians", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "degrees_to_radians", "macro_sql": "{% macro degrees_to_radians(degrees) -%}\n    acos(-1) * {{degrees}} / 180\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.140618}, "macro.dbt_utils.haversine_distance": {"unique_id": "macro.dbt_utils.haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "haversine_distance", "macro_sql": "{% macro haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n    {{ return(adapter.dispatch('haversine_distance', 'dbt_utils')(lat1,lon1,lat2,lon2,unit)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__haversine_distance"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1416743}, "macro.dbt_utils.default__haversine_distance": {"unique_id": "macro.dbt_utils.default__haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "default__haversine_distance", "macro_sql": "{% macro default__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n\n    2 * 3961 * asin(sqrt(power((sin(radians(({{ lat2 }} - {{ lat1 }}) / 2))), 2) +\n    cos(radians({{lat1}})) * cos(radians({{lat2}})) *\n    power((sin(radians(({{ lon2 }} - {{ lon1 }}) / 2))), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1429312}, "macro.dbt_utils.bigquery__haversine_distance": {"unique_id": "macro.dbt_utils.bigquery__haversine_distance", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/haversine_distance.sql", "original_file_path": "macros/sql/haversine_distance.sql", "name": "bigquery__haversine_distance", "macro_sql": "{% macro bigquery__haversine_distance(lat1, lon1, lat2, lon2, unit='mi') -%}\n{% set radians_lat1 = dbt_utils.degrees_to_radians(lat1) %}\n{% set radians_lat2 = dbt_utils.degrees_to_radians(lat2) %}\n{% set radians_lon1 = dbt_utils.degrees_to_radians(lon1) %}\n{% set radians_lon2 = dbt_utils.degrees_to_radians(lon2) %}\n{%- if unit == 'mi' %}\n    {% set conversion_rate = 1 %}\n{% elif unit == 'km' %}\n    {% set conversion_rate = 1.60934 %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\"unit input must be one of 'mi' or 'km'. Got \" ~ unit) }}\n{% endif %}\n    2 * 3961 * asin(sqrt(power(sin(({{ radians_lat2 }} - {{ radians_lat1 }}) / 2), 2) +\n    cos({{ radians_lat1 }}) * cos({{ radians_lat2 }}) *\n    power(sin(({{ radians_lon2 }} - {{ radians_lon1 }}) / 2), 2))) * {{ conversion_rate }}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.degrees_to_radians"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1447248}, "macro.dbt_utils.unpivot": {"unique_id": "macro.dbt_utils.unpivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "name": "unpivot", "macro_sql": "{% macro unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n    {{ return(adapter.dispatch('unpivot', 'dbt_utils')(relation, cast_to, exclude, remove, field_name, value_name, table)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__unpivot"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1479445}, "macro.dbt_utils.default__unpivot": {"unique_id": "macro.dbt_utils.default__unpivot", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/unpivot.sql", "original_file_path": "macros/sql/unpivot.sql", "name": "default__unpivot", "macro_sql": "{% macro default__unpivot(relation=none, cast_to='varchar', exclude=none, remove=none, field_name='field_name', value_name='value', table=none) -%}\n\n    {% if table %}\n        {%- set error_message = '\n            Warning: the `unpivot` macro no longer accepts a `table` parameter. \\\n            This parameter will be deprecated in a future release of dbt-utils. Use the `relation` parameter instead. \\\n            The {}.{} model triggered this warning. \\\n            '.format(model.package_name, model.name) -%}\n        {%- do exceptions.warn(error_message) -%}\n    {% endif %}\n\n    {% if relation and table %}\n        {{ exceptions.raise_compiler_error(\"Error: both the `relation` and `table` parameters were provided to `unpivot` macro. Choose one only (we recommend `relation`).\") }}\n    {% elif not relation and table %}\n        {% set relation=table %}\n    {% elif not relation and not table %}\n        {{ exceptions.raise_compiler_error(\"Error: argument `relation` is required for `unpivot` macro.\") }}\n    {% endif %}\n\n  {%- set exclude = exclude if exclude is not none else [] %}\n  {%- set remove = remove if remove is not none else [] %}\n\n  {%- set include_cols = [] %}\n\n  {%- set table_columns = {} %}\n\n  {%- do table_columns.update({relation: []}) %}\n\n  {%- do dbt_utils._is_relation(relation, 'unpivot') -%}\n  {%- do dbt_utils._is_ephemeral(relation, 'unpivot') -%}\n  {%- set cols = adapter.get_columns_in_relation(relation) %}\n\n  {%- for col in cols -%}\n    {%- if col.column.lower() not in remove|map('lower') and col.column.lower() not in exclude|map('lower') -%}\n      {% do include_cols.append(col) %}\n    {%- endif %}\n  {%- endfor %}\n\n\n  {%- for col in include_cols -%}\n    select\n      {%- for exclude_col in exclude %}\n        {{ exclude_col }},\n      {%- endfor %}\n\n      cast('{{ col.column }}' as {{ dbt_utils.type_string() }}) as {{ field_name }},\n      cast(  {% if col.data_type == 'boolean' %}\n           {{ dbt_utils.cast_bool_to_text(col.column) }}\n             {% else %}\n           {{ col.column }}\n             {% endif %}\n           as {{ cast_to }}) as {{ value_name }}\n\n    from {{ relation }}\n\n    {% if not loop.last -%}\n      union all\n    {% endif -%}\n  {%- endfor -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.type_string", "macro.dbt_utils.cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1523952}, "macro.dbt_utils.get_powers_of_two": {"unique_id": "macro.dbt_utils.get_powers_of_two", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "get_powers_of_two", "macro_sql": "{% macro get_powers_of_two(upper_bound) %}\n    {{ return(adapter.dispatch('get_powers_of_two', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1540298}, "macro.dbt_utils.default__get_powers_of_two": {"unique_id": "macro.dbt_utils.default__get_powers_of_two", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "default__get_powers_of_two", "macro_sql": "{% macro default__get_powers_of_two(upper_bound) %}\n\n    {% if upper_bound <= 0 %}\n    {{ exceptions.raise_compiler_error(\"upper bound must be positive\") }}\n    {% endif %}\n\n    {% for _ in range(1, 100) %}\n       {% if upper_bound <= 2 ** loop.index %}{{ return(loop.index) }}{% endif %}\n    {% endfor %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.154947}, "macro.dbt_utils.generate_series": {"unique_id": "macro.dbt_utils.generate_series", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "generate_series", "macro_sql": "{% macro generate_series(upper_bound) %}\n    {{ return(adapter.dispatch('generate_series', 'dbt_utils')(upper_bound)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__generate_series"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.155373}, "macro.dbt_utils.default__generate_series": {"unique_id": "macro.dbt_utils.default__generate_series", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/generate_series.sql", "original_file_path": "macros/sql/generate_series.sql", "name": "default__generate_series", "macro_sql": "{% macro default__generate_series(upper_bound) %}\n\n    {% set n = dbt_utils.get_powers_of_two(upper_bound) %}\n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    {% for i in range(n) %}\n    p{{i}}.generated_number * power(2, {{i}})\n    {% if not loop.last %} + {% endif %}\n    {% endfor %}\n    + 1\n    as generated_number\n\n    from\n\n    {% for i in range(n) %}\n    p as p{{i}}\n    {% if not loop.last %} cross join {% endif %}\n    {% endfor %}\n\n    )\n\n    select *\n    from unioned\n    where generated_number <= {{upper_bound}}\n    order by generated_number\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.get_powers_of_two"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1565402}, "macro.dbt_utils.nullcheck": {"unique_id": "macro.dbt_utils.nullcheck", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "name": "nullcheck", "macro_sql": "{% macro nullcheck(cols) %}\n    {{ return(adapter.dispatch('nullcheck', 'dbt_utils')(cols)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__nullcheck"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1574736}, "macro.dbt_utils.default__nullcheck": {"unique_id": "macro.dbt_utils.default__nullcheck", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/nullcheck.sql", "original_file_path": "macros/sql/nullcheck.sql", "name": "default__nullcheck", "macro_sql": "{% macro default__nullcheck(cols) %}\n{%- for col in cols %}\n\n    {% if col.is_string() -%}\n\n    nullif({{col.name}},'') as {{col.name}}\n\n    {%- else -%}\n\n    {{col.name}}\n\n    {%- endif -%}\n\n{%- if not loop.last -%} , {%- endif -%}\n\n{%- endfor -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.15823}, "macro.dbt_utils.union_relations": {"unique_id": "macro.dbt_utils.union_relations", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "name": "union_relations", "macro_sql": "{%- macro union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation') -%}\n    {{ return(adapter.dispatch('union_relations', 'dbt_utils')(relations, column_override, include, exclude, source_column_name)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.OI_Foundation.default__union_relations"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1620648}, "macro.dbt_utils.default__union_relations": {"unique_id": "macro.dbt_utils.default__union_relations", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/sql/union.sql", "original_file_path": "macros/sql/union.sql", "name": "default__union_relations", "macro_sql": "\n\n{%- macro default__union_relations(relations, column_override=none, include=[], exclude=[], source_column_name='_dbt_source_relation') -%}\n\n    {%- if exclude and include -%}\n        {{ exceptions.raise_compiler_error(\"Both an exclude and include list were provided to the `union` macro. Only one is allowed\") }}\n    {%- endif -%}\n\n    {#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. -#}\n    {%- if not execute %}\n        {{ return('') }}\n    {% endif -%}\n\n    {%- set column_override = column_override if column_override is not none else {} -%}\n\n    {%- set relation_columns = {} -%}\n    {%- set column_superset = {} -%}\n\n    {%- for relation in relations -%}\n\n        {%- do relation_columns.update({relation: []}) -%}\n\n        {%- do dbt_utils._is_relation(relation, 'union_relations') -%}\n        {%- do dbt_utils._is_ephemeral(relation, 'union_relations') -%}\n        {%- set cols = adapter.get_columns_in_relation(relation) -%}\n        {%- for col in cols -%}\n\n        {#- If an exclude list was provided and the column is in the list, do nothing -#}\n        {%- if exclude and col.column in exclude -%}\n\n        {#- If an include list was provided and the column is not in the list, do nothing -#}\n        {%- elif include and col.column not in include -%}\n\n        {#- Otherwise add the column to the column superset -#}\n        {%- else -%}\n\n            {#- update the list of columns in this relation -#}\n            {%- do relation_columns[relation].append(col.column) -%}\n\n            {%- if col.column in column_superset -%}\n\n                {%- set stored = column_superset[col.column] -%}\n                {%- if col.is_string() and stored.is_string() and col.string_size() > stored.string_size() -%}\n\n                    {%- do column_superset.update({col.column: col}) -%}\n\n                {%- endif %}\n\n            {%- else -%}\n\n                {%- do column_superset.update({col.column: col}) -%}\n\n            {%- endif -%}\n\n        {%- endif -%}\n\n        {%- endfor -%}\n    {%- endfor -%}\n\n    {%- set ordered_column_names = column_superset.keys() -%}\n\n    {% if (include | length > 0 or exclude | length > 0) and not column_superset.keys() %}\n        {%- set relations_string -%}\n            {%- for relation in relations -%}\n                {{ relation.name }}\n            {%- if not loop.last %}, {% endif -%}\n            {%- endfor -%}\n        {%- endset -%}\n\n        {%- set error_message -%}\n            There were no columns found to union for relations {{ relations_string }}\n        {%- endset -%}\n\n        {{ exceptions.raise_compiler_error(error_message) }}\n    {%- endif -%}\n\n    {%- for relation in relations %}\n\n        (\n            select\n\n                cast({{ dbt_utils.string_literal(relation) }} as {{ dbt_utils.type_string() }}) as {{ source_column_name }},\n                {% for col_name in ordered_column_names -%}\n\n                    {%- set col = column_superset[col_name] %}\n                    {%- set col_type = column_override.get(col.column, col.data_type) %}\n                    {%- set col_name = adapter.quote(col_name) if col_name in relation_columns[relation] else 'null' %}\n                    cast({{ col_name }} as {{ col_type }}) as {{ col.quoted }} {% if not loop.last %},{% endif -%}\n\n                {%- endfor %}\n\n            from {{ relation }}\n        )\n\n        {% if not loop.last -%}\n            union all\n        {% endif -%}\n\n    {%- endfor -%}\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.string_literal", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1683502}, "macro.dbt_utils.get_period_boundaries": {"unique_id": "macro.dbt_utils.get_period_boundaries", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "get_period_boundaries", "macro_sql": "{% macro get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n    {{ return(adapter.dispatch('get_period_boundaries', 'dbt_utils')(target_schema, target_table, timestamp_field, start_date, stop_date, period)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_boundaries"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.178024}, "macro.dbt_utils.default__get_period_boundaries": {"unique_id": "macro.dbt_utils.default__get_period_boundaries", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "default__get_period_boundaries", "macro_sql": "{% macro default__get_period_boundaries(target_schema, target_table, timestamp_field, start_date, stop_date, period) -%}\n\n  {% call statement('period_boundaries', fetch_result=True) -%}\n    with data as (\n      select\n          coalesce(max(\"{{timestamp_field}}\"), '{{start_date}}')::timestamp as start_timestamp,\n          coalesce(\n            {{dbt_utils.dateadd('millisecond',\n                                -1,\n                                \"nullif('\" ~ stop_date ~ \"','')::timestamp\")}},\n            {{dbt_utils.current_timestamp()}}\n          ) as stop_timestamp\n      from \"{{target_schema}}\".\"{{target_table}}\"\n    )\n\n    select\n      start_timestamp,\n      stop_timestamp,\n      {{dbt_utils.datediff('start_timestamp',\n                           'stop_timestamp',\n                           period)}}  + 1 as num_periods\n    from data\n  {%- endcall %}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.statement", "macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp", "macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1791446}, "macro.dbt_utils.get_period_sql": {"unique_id": "macro.dbt_utils.get_period_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "get_period_sql", "macro_sql": "{% macro get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n    {{ return(adapter.dispatch('get_period_sql', 'dbt_utils')(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_period_sql"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1798341}, "macro.dbt_utils.default__get_period_sql": {"unique_id": "macro.dbt_utils.default__get_period_sql", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "default__get_period_sql", "macro_sql": "{% macro default__get_period_sql(target_cols_csv, sql, timestamp_field, period, start_timestamp, stop_timestamp, offset) -%}\n\n  {%- set period_filter -%}\n    (\"{{timestamp_field}}\" >  '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' and\n     \"{{timestamp_field}}\" <= '{{start_timestamp}}'::timestamp + interval '{{offset}} {{period}}' + interval '1 {{period}}' and\n     \"{{timestamp_field}}\" <  '{{stop_timestamp}}'::timestamp)\n  {%- endset -%}\n\n  {%- set filtered_sql = sql | replace(\"__PERIOD_FILTER__\", period_filter) -%}\n\n  select\n    {{target_cols_csv}}\n  from (\n    {{filtered_sql}}\n  )\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1809576}, "macro.dbt_utils.materialization_insert_by_period_default": {"unique_id": "macro.dbt_utils.materialization_insert_by_period_default", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/materializations/insert_by_period_materialization.sql", "original_file_path": "macros/materializations/insert_by_period_materialization.sql", "name": "materialization_insert_by_period_default", "macro_sql": "{% materialization insert_by_period, default -%}\n  {%- set timestamp_field = config.require('timestamp_field') -%}\n  {%- set start_date = config.require('start_date') -%}\n  {%- set stop_date = config.get('stop_date') or '' -%}\n  {%- set period = config.get('period') or 'week' -%}\n\n  {%- if sql.find('__PERIOD_FILTER__') == -1 -%}\n    {%- set error_message -%}\n      Model '{{ model.unique_id }}' does not include the required string '__PERIOD_FILTER__' in its sql\n    {%- endset -%}\n    {{ exceptions.raise_compiler_error(error_message) }}\n  {%- endif -%}\n\n  {%- set identifier = model['name'] -%}\n\n  {%- set old_relation = adapter.get_relation(database=database, schema=schema, identifier=identifier) -%}\n  {%- set target_relation = api.Relation.create(identifier=identifier, schema=schema, type='table') -%}\n\n  {%- set non_destructive_mode = (flags.NON_DESTRUCTIVE == True) -%}\n  {%- set full_refresh_mode = (flags.FULL_REFRESH == True) -%}\n\n  {%- set exists_as_table = (old_relation is not none and old_relation.is_table) -%}\n  {%- set exists_not_as_table = (old_relation is not none and not old_relation.is_table) -%}\n\n  {%- set should_truncate = (non_destructive_mode and full_refresh_mode and exists_as_table) -%}\n  {%- set should_drop = (not should_truncate and (full_refresh_mode or exists_not_as_table)) -%}\n  {%- set force_create = (flags.FULL_REFRESH and not flags.NON_DESTRUCTIVE) -%}\n\n  -- setup\n  {% if old_relation is none -%}\n    -- noop\n  {%- elif should_truncate -%}\n    {{adapter.truncate_relation(old_relation)}}\n  {%- elif should_drop -%}\n    {{adapter.drop_relation(old_relation)}}\n    {%- set old_relation = none -%}\n  {%- endif %}\n\n  {{run_hooks(pre_hooks, inside_transaction=False)}}\n\n  -- `begin` happens here, so `commit` after it to finish the transaction\n  {{run_hooks(pre_hooks, inside_transaction=True)}}\n  {% call statement() -%}\n    begin; -- make extra sure we've closed out the transaction\n    commit;\n  {%- endcall %}\n\n  -- build model\n  {% if force_create or old_relation is none -%}\n    {# Create an empty target table -#}\n    {% call statement('main') -%}\n      {%- set empty_sql = sql | replace(\"__PERIOD_FILTER__\", 'false') -%}\n      {{create_table_as(False, target_relation, empty_sql)}}\n    {%- endcall %}\n  {%- endif %}\n\n  {% set _ = dbt_utils.get_period_boundaries(schema,\n                                              identifier,\n                                              timestamp_field,\n                                              start_date,\n                                              stop_date,\n                                              period) %}\n  {%- set start_timestamp = load_result('period_boundaries')['data'][0][0] | string -%}\n  {%- set stop_timestamp = load_result('period_boundaries')['data'][0][1] | string -%}\n  {%- set num_periods = load_result('period_boundaries')['data'][0][2] | int -%}\n\n  {% set target_columns = adapter.get_columns_in_relation(target_relation) %}\n  {%- set target_cols_csv = target_columns | map(attribute='quoted') | join(', ') -%}\n  {%- set loop_vars = {'sum_rows_inserted': 0} -%}\n\n  -- commit each period as a separate transaction\n  {% for i in range(num_periods) -%}\n    {%- set msg = \"Running for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) -%}\n    {{ dbt_utils.log_info(msg) }}\n\n    {%- set tmp_identifier = model['name'] ~ '__dbt_incremental_period' ~ i ~ '_tmp' -%}\n    {%- set tmp_relation = api.Relation.create(identifier=tmp_identifier,\n                                               schema=schema, type='table') -%}\n    {% call statement() -%}\n      {% set tmp_table_sql = dbt_utils.get_period_sql(target_cols_csv,\n                                                       sql,\n                                                       timestamp_field,\n                                                       period,\n                                                       start_timestamp,\n                                                       stop_timestamp,\n                                                       i) %}\n      {{dbt.create_table_as(True, tmp_relation, tmp_table_sql)}}\n    {%- endcall %}\n\n    {{adapter.expand_target_column_types(from_relation=tmp_relation,\n                                         to_relation=target_relation)}}\n    {%- set name = 'main-' ~ i -%}\n    {% call statement(name, fetch_result=True) -%}\n      insert into {{target_relation}} ({{target_cols_csv}})\n      (\n          select\n              {{target_cols_csv}}\n          from {{tmp_relation.include(schema=False)}}\n      );\n    {%- endcall %}\n    {% set result = load_result('main-' ~ i) %}\n    {% if 'response' in result.keys() %} {# added in v0.19.0 #}\n        {% set rows_inserted = result['response']['rows_affected'] %}\n    {% else %} {# older versions #}\n        {% set rows_inserted = result['status'].split(\" \")[2] | int %}\n    {% endif %}\n    \n    {%- set sum_rows_inserted = loop_vars['sum_rows_inserted'] + rows_inserted -%}\n    {%- if loop_vars.update({'sum_rows_inserted': sum_rows_inserted}) %} {% endif -%}\n\n    {%- set msg = \"Ran for \" ~ period ~ \" \" ~ (i + 1) ~ \" of \" ~ (num_periods) ~ \"; \" ~ rows_inserted ~ \" records inserted\" -%}\n    {{ dbt_utils.log_info(msg) }}\n\n  {%- endfor %}\n\n  {% call statement() -%}\n    begin;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=True)}}\n\n  {% call statement() -%}\n    commit;\n  {%- endcall %}\n\n  {{run_hooks(post_hooks, inside_transaction=False)}}\n\n  {%- set status_string = \"INSERT \" ~ loop_vars['sum_rows_inserted'] -%}\n\n  {% call noop_statement('main', status_string) -%}\n    -- no-op\n  {%- endcall %}\n\n  -- Return the relations created in this materialization\n  {{ return({'relations': [target_relation]}) }}  \n\n{%- endmaterialization %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.create_table_as", "macro.dbt_utils.get_period_boundaries", "macro.dbt_utils.log_info", "macro.dbt_utils.get_period_sql", "macro.dbt.noop_statement"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1919239}, "macro.dbt_utils.pretty_time": {"unique_id": "macro.dbt_utils.pretty_time", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "name": "pretty_time", "macro_sql": "{% macro pretty_time(format='%H:%M:%S') %}\n    {{ return(adapter.dispatch('pretty_time', 'dbt_utils')(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1927416}, "macro.dbt_utils.default__pretty_time": {"unique_id": "macro.dbt_utils.default__pretty_time", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_time.sql", "original_file_path": "macros/jinja_helpers/pretty_time.sql", "name": "default__pretty_time", "macro_sql": "{% macro default__pretty_time(format='%H:%M:%S') %}\n    {{ return(modules.datetime.datetime.now().strftime(format)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1932528}, "macro.dbt_utils.slugify": {"unique_id": "macro.dbt_utils.slugify", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/slugify.sql", "original_file_path": "macros/jinja_helpers/slugify.sql", "name": "slugify", "macro_sql": "{% macro slugify(string) %}\n\n{#- Lower case the string -#}\n{% set string = string | lower %}\n{#- Replace spaces and dashes with underscores -#}\n{% set string = modules.re.sub('[ -]+', '_', string) %}\n{#- Only take letters, numbers, and underscores -#}\n{% set string = modules.re.sub('[^a-z0-9_]+', '', string) %}\n\n{{ return(string) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1944082}, "macro.dbt_utils.log_info": {"unique_id": "macro.dbt_utils.log_info", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "name": "log_info", "macro_sql": "{% macro log_info(message) %}\n    {{ return(adapter.dispatch('log_info', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__log_info"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1951025}, "macro.dbt_utils.default__log_info": {"unique_id": "macro.dbt_utils.default__log_info", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/log_info.sql", "original_file_path": "macros/jinja_helpers/log_info.sql", "name": "default__log_info", "macro_sql": "{% macro default__log_info(message) %}\n    {{ log(dbt_utils.pretty_log_format(message), info=True) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1954925}, "macro.dbt_utils.pretty_log_format": {"unique_id": "macro.dbt_utils.pretty_log_format", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "name": "pretty_log_format", "macro_sql": "{% macro pretty_log_format(message) %}\n    {{ return(adapter.dispatch('pretty_log_format', 'dbt_utils')(message)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__pretty_log_format"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1962142}, "macro.dbt_utils.default__pretty_log_format": {"unique_id": "macro.dbt_utils.default__pretty_log_format", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/jinja_helpers/pretty_log_format.sql", "original_file_path": "macros/jinja_helpers/pretty_log_format.sql", "name": "default__pretty_log_format", "macro_sql": "{% macro default__pretty_log_format(message) %}\n    {{ return( dbt_utils.pretty_time() ~ ' + ' ~ message) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.pretty_time"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1965957}, "macro.dbt_utils.get_url_parameter": {"unique_id": "macro.dbt_utils.get_url_parameter", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "name": "get_url_parameter", "macro_sql": "{% macro get_url_parameter(field, url_parameter) -%}\n    {{ return(adapter.dispatch('get_url_parameter', 'dbt_utils')(field, url_parameter)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_parameter"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1974046}, "macro.dbt_utils.default__get_url_parameter": {"unique_id": "macro.dbt_utils.default__get_url_parameter", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_parameter.sql", "original_file_path": "macros/web/get_url_parameter.sql", "name": "default__get_url_parameter", "macro_sql": "{% macro default__get_url_parameter(field, url_parameter) -%}\n\n{%- set formatted_url_parameter = \"'\" + url_parameter + \"='\" -%}\n\n{%- set split = dbt_utils.split_part(dbt_utils.split_part(field, formatted_url_parameter, 2), \"'&'\", 1) -%}\n\nnullif({{ split }},'')\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1982048}, "macro.dbt_utils.get_url_path": {"unique_id": "macro.dbt_utils.get_url_path", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "name": "get_url_path", "macro_sql": "{% macro get_url_path(field) -%}\n    {{ return(adapter.dispatch('get_url_path', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_path"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.1992524}, "macro.dbt_utils.default__get_url_path": {"unique_id": "macro.dbt_utils.default__get_url_path", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_path.sql", "original_file_path": "macros/web/get_url_path.sql", "name": "default__get_url_path", "macro_sql": "{% macro default__get_url_path(field) -%}\n\n    {%- set stripped_url = \n        dbt_utils.replace(\n            dbt_utils.replace(field, \"'http://'\", \"''\"), \"'https://'\", \"''\")\n    -%}\n\n    {%- set first_slash_pos -%}\n        coalesce(\n            nullif({{dbt_utils.position(\"'/'\", stripped_url)}}, 0),\n            {{dbt_utils.position(\"'?'\", stripped_url)}} - 1\n            )\n    {%- endset -%}\n\n    {%- set parsed_path =\n        dbt_utils.split_part(\n            dbt_utils.right(\n                stripped_url, \n                dbt_utils.length(stripped_url) ~ \"-\" ~ first_slash_pos\n                ), \n            \"'?'\", 1\n            )\n    -%}\n\n    {{ dbt_utils.safe_cast(\n        parsed_path,\n        dbt_utils.type_string()\n    )}}\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.replace", "macro.dbt_utils.position", "macro.dbt_utils.split_part", "macro.dbt_utils.right", "macro.dbt_utils.length", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2011368}, "macro.dbt_utils.get_url_host": {"unique_id": "macro.dbt_utils.get_url_host", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "name": "get_url_host", "macro_sql": "{% macro get_url_host(field) -%}\n    {{ return(adapter.dispatch('get_url_host', 'dbt_utils')(field)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__get_url_host"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.202005}, "macro.dbt_utils.default__get_url_host": {"unique_id": "macro.dbt_utils.default__get_url_host", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/web/get_url_host.sql", "original_file_path": "macros/web/get_url_host.sql", "name": "default__get_url_host", "macro_sql": "{% macro default__get_url_host(field) -%}\n\n{%- set parsed =\n    dbt_utils.split_part(\n        dbt_utils.split_part(\n            dbt_utils.replace(\n                dbt_utils.replace(\n                    dbt_utils.replace(field, \"'android-app://'\", \"''\"\n                    ), \"'http://'\", \"''\"\n                ), \"'https://'\", \"''\"\n            ), \"'/'\", 1\n        ), \"'?'\", 1\n    )\n\n-%}\n\n\n    {{ dbt_utils.safe_cast(\n        parsed,\n        dbt_utils.type_string()\n        )}}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.split_part", "macro.dbt_utils.replace", "macro.dbt_utils.safe_cast", "macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2030137}, "macro.dbt_utils.test_expression_is_true": {"unique_id": "macro.dbt_utils.test_expression_is_true", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/expression_is_true.sql", "original_file_path": "macros/schema_tests/expression_is_true.sql", "name": "test_expression_is_true", "macro_sql": "{% test expression_is_true(model, expression, column_name=None, condition='1=1') %}\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n  {{ return(adapter.dispatch('test_expression_is_true', 'dbt_utils')(model, expression, column_name, condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_expression_is_true"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2042131}, "macro.dbt_utils.default__test_expression_is_true": {"unique_id": "macro.dbt_utils.default__test_expression_is_true", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/expression_is_true.sql", "original_file_path": "macros/schema_tests/expression_is_true.sql", "name": "default__test_expression_is_true", "macro_sql": "{% macro default__test_expression_is_true(model, expression, column_name, condition) %}\n\nwith meet_condition as (\n    select * from {{ model }} where {{ condition }}\n)\n\nselect\n    *\nfrom meet_condition\n{% if column_name is none %}\nwhere not({{ expression }})\n{%- else %}\nwhere not({{ column_name }} {{ expression }})\n{%- endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2048705}, "macro.dbt_utils.test_not_constant": {"unique_id": "macro.dbt_utils.test_not_constant", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_constant.sql", "original_file_path": "macros/schema_tests/not_constant.sql", "name": "test_not_constant", "macro_sql": "{% test not_constant(model, column_name) %}\n  {{ return(adapter.dispatch('test_not_constant', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_constant"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.205685}, "macro.dbt_utils.default__test_not_constant": {"unique_id": "macro.dbt_utils.default__test_not_constant", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_constant.sql", "original_file_path": "macros/schema_tests/not_constant.sql", "name": "default__test_not_constant", "macro_sql": "{% macro default__test_not_constant(model, column_name) %}\n\n\nselect\n    {# In TSQL, subquery aggregate columns need aliases #}\n    {# thus: a filler col name, 'filler_column' #}\n    count(distinct {{ column_name }}) as filler_column\n\nfrom {{ model }}\n\nhaving count(distinct {{ column_name }}) = 1\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2060795}, "macro.dbt_utils.test_sequential_values": {"unique_id": "macro.dbt_utils.test_sequential_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/sequential_values.sql", "original_file_path": "macros/schema_tests/sequential_values.sql", "name": "test_sequential_values", "macro_sql": "{% test sequential_values(model, column_name, interval=1, datepart=None) %}\n\n  {{ return(adapter.dispatch('test_sequential_values', 'dbt_utils')(model, column_name, interval, datepart)) }}\n\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_sequential_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2074234}, "macro.dbt_utils.default__test_sequential_values": {"unique_id": "macro.dbt_utils.default__test_sequential_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/sequential_values.sql", "original_file_path": "macros/schema_tests/sequential_values.sql", "name": "default__test_sequential_values", "macro_sql": "{% macro default__test_sequential_values(model, column_name, interval=1, datepart=None) %}\n\n{% set previous_column_name = \"previous_\" ~ dbt_utils.slugify(column_name) %}\n\nwith windowed as (\n\n    select\n        {{ column_name }},\n        lag({{ column_name }}) over (\n            order by {{ column_name }}\n        ) as {{ previous_column_name }}\n    from {{ model }}\n),\n\nvalidation_errors as (\n    select\n        *\n    from windowed\n    {% if datepart %}\n    where not(cast({{ column_name }} as {{ dbt_utils.type_timestamp() }})= cast({{ dbt_utils.dateadd(datepart, interval, previous_column_name) }} as {{ dbt_utils.type_timestamp() }}))\n    {% else %}\n    where not({{ column_name }} = {{ previous_column_name }} + {{ interval }})\n    {% endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.slugify", "macro.dbt_utils.type_timestamp", "macro.dbt_utils.dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2090187}, "macro.dbt_utils.test_not_null_proportion": {"unique_id": "macro.dbt_utils.test_not_null_proportion", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_null_proportion.sql", "original_file_path": "macros/schema_tests/not_null_proportion.sql", "name": "test_not_null_proportion", "macro_sql": "{% macro test_not_null_proportion(model) %}\n  {{ return(adapter.dispatch('test_not_null_proportion', 'dbt_utils')(model, **kwargs)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_proportion"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2100058}, "macro.dbt_utils.default__test_not_null_proportion": {"unique_id": "macro.dbt_utils.default__test_not_null_proportion", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_null_proportion.sql", "original_file_path": "macros/schema_tests/not_null_proportion.sql", "name": "default__test_not_null_proportion", "macro_sql": "{% macro default__test_not_null_proportion(model) %}\n\n{% set column_name = kwargs.get('column_name', kwargs.get('arg')) %}\n{% set at_least = kwargs.get('at_least', kwargs.get('arg')) %}\n{% set at_most = kwargs.get('at_most', kwargs.get('arg', 1)) %}\n\nwith validation as (\n  select\n    sum(case when {{ column_name }} is null then 0 else 1 end) / cast(count(*) as numeric) as not_null_proportion\n  from {{ model }}\n),\nvalidation_errors as (\n  select\n    not_null_proportion\n  from validation\n  where not_null_proportion < {{ at_least }} or not_null_proportion > {{ at_most }}\n)\nselect\n  *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2111237}, "macro.dbt_utils.test_at_least_one": {"unique_id": "macro.dbt_utils.test_at_least_one", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/at_least_one.sql", "original_file_path": "macros/schema_tests/at_least_one.sql", "name": "test_at_least_one", "macro_sql": "{% test at_least_one(model, column_name) %}\n  {{ return(adapter.dispatch('test_at_least_one', 'dbt_utils')(model, column_name)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_at_least_one"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2119453}, "macro.dbt_utils.default__test_at_least_one": {"unique_id": "macro.dbt_utils.default__test_at_least_one", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/at_least_one.sql", "original_file_path": "macros/schema_tests/at_least_one.sql", "name": "default__test_at_least_one", "macro_sql": "{% macro default__test_at_least_one(model, column_name) %}\n\nselect *\nfrom (\n    select\n        {# In TSQL, subquery aggregate columns need aliases #}\n        {# thus: a filler col name, 'filler_column' #}\n      count({{ column_name }}) as filler_column\n\n    from {{ model }}\n\n    having count({{ column_name }}) = 0\n\n) validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2123694}, "macro.dbt_utils.test_equality": {"unique_id": "macro.dbt_utils.test_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/equality.sql", "original_file_path": "macros/schema_tests/equality.sql", "name": "test_equality", "macro_sql": "{% test equality(model, compare_model, compare_columns=None) %}\n  {{ return(adapter.dispatch('test_equality', 'dbt_utils')(model, compare_model, compare_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2139814}, "macro.dbt_utils.default__test_equality": {"unique_id": "macro.dbt_utils.default__test_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/equality.sql", "original_file_path": "macros/schema_tests/equality.sql", "name": "default__test_equality", "macro_sql": "{% macro default__test_equality(model, compare_model, compare_columns=None) %}\n\n{% set set_diff %}\n    count(*) + coalesce(abs(\n        sum(case when which_diff = 'a_minus_b' then 1 else 0 end) -\n        sum(case when which_diff = 'b_minus_a' then 1 else 0 end)\n    ), 0)\n{% endset %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = set_diff) }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\n-- setup\n{%- do dbt_utils._is_relation(model, 'test_equality') -%}\n\n{#-\nIf the compare_cols arg is provided, we can run this test without querying the\ninformation schema\u00a0\u2014 this allows the model to be an ephemeral model\n-#}\n\n{%- if not compare_columns -%}\n    {%- do dbt_utils._is_ephemeral(model, 'test_equality') -%}\n    {%- set compare_columns = adapter.get_columns_in_relation(model) | map(attribute='quoted') -%}\n{%- endif -%}\n\n{% set compare_cols_csv = compare_columns | join(', ') %}\n\nwith a as (\n\n    select * from {{ model }}\n\n),\n\nb as (\n\n    select * from {{ compare_model }}\n\n),\n\na_minus_b as (\n\n    select {{compare_cols_csv}} from a\n    {{ dbt_utils.except() }}\n    select {{compare_cols_csv}} from b\n\n),\n\nb_minus_a as (\n\n    select {{compare_cols_csv}} from b\n    {{ dbt_utils.except() }}\n    select {{compare_cols_csv}} from a\n\n),\n\nunioned as (\n\n    select 'a_minus_b' as which_diff, a_minus_b.* from a_minus_b\n    union all\n    select 'b_minus_a' as which_diff, b_minus_a.* from b_minus_a\n\n)\n\nselect * from unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils._is_relation", "macro.dbt_utils._is_ephemeral", "macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2159135}, "macro.dbt_utils.test_not_null_where": {"unique_id": "macro.dbt_utils.test_not_null_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/test_not_null_where.sql", "original_file_path": "macros/schema_tests/test_not_null_where.sql", "name": "test_not_null_where", "macro_sql": "{% test not_null_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.not_null_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `not_null` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_not_null_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_null_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2169597}, "macro.dbt_utils.default__test_not_null_where": {"unique_id": "macro.dbt_utils.default__test_not_null_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/test_not_null_where.sql", "original_file_path": "macros/schema_tests/test_not_null_where.sql", "name": "default__test_not_null_where", "macro_sql": "{% macro default__test_not_null_where(model, column_name) %}\r\n  {{ return(test_not_null(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_not_null"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2173507}, "macro.dbt_utils.test_equal_rowcount": {"unique_id": "macro.dbt_utils.test_equal_rowcount", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/equal_rowcount.sql", "original_file_path": "macros/schema_tests/equal_rowcount.sql", "name": "test_equal_rowcount", "macro_sql": "{% test equal_rowcount(model, compare_model) %}\n  {{ return(adapter.dispatch('test_equal_rowcount', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_equal_rowcount"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2182744}, "macro.dbt_utils.default__test_equal_rowcount": {"unique_id": "macro.dbt_utils.default__test_equal_rowcount", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/equal_rowcount.sql", "original_file_path": "macros/schema_tests/equal_rowcount.sql", "name": "default__test_equal_rowcount", "macro_sql": "{% macro default__test_equal_rowcount(model, compare_model) %}\n\n{#-- Needs to be set at parse time, before we return '' below --#}\n{{ config(fail_calc = 'coalesce(diff_count, 0)') }}\n\n{#-- Prevent querying of db in parsing mode. This works because this macro does not create any new refs. #}\n{%- if not execute -%}\n    {{ return('') }}\n{% endif %}\n\nwith a as (\n\n    select count(*) as count_a from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_b from {{ compare_model }}\n\n),\nfinal as (\n\n    select\n        count_a,\n        count_b,\n        abs(count_a - count_b) as diff_count\n    from a\n    cross join b\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2190466}, "macro.dbt_utils.test_not_accepted_values": {"unique_id": "macro.dbt_utils.test_not_accepted_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_accepted_values.sql", "original_file_path": "macros/schema_tests/not_accepted_values.sql", "name": "test_not_accepted_values", "macro_sql": "{% test not_accepted_values(model, column_name, values, quote=True) %}\n  {{ return(adapter.dispatch('test_not_accepted_values', 'dbt_utils')(model, column_name, values, quote)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_not_accepted_values"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2202544}, "macro.dbt_utils.default__test_not_accepted_values": {"unique_id": "macro.dbt_utils.default__test_not_accepted_values", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/not_accepted_values.sql", "original_file_path": "macros/schema_tests/not_accepted_values.sql", "name": "default__test_not_accepted_values", "macro_sql": "{% macro default__test_not_accepted_values(model, column_name, values, quote=True) %}\nwith all_values as (\n\n    select distinct\n        {{ column_name }} as value_field\n\n    from {{ model }}\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field in (\n        {% for value in values -%}\n            {% if quote -%}\n            '{{ value }}'\n            {%- else -%}\n            {{ value }}\n            {%- endif -%}\n            {%- if not loop.last -%},{%- endif %}\n        {%- endfor %}\n        )\n\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2211108}, "macro.dbt_utils.test_unique_where": {"unique_id": "macro.dbt_utils.test_unique_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/test_unique_where.sql", "original_file_path": "macros/schema_tests/test_unique_where.sql", "name": "test_unique_where", "macro_sql": "{% test unique_where(model, column_name) %}\r\n  {%- set deprecation_warning = '\r\n    Warning: `dbt_utils.unique_where` is no longer supported.\r\n    Starting in dbt v0.20.0, the built-in `unique` test supports a `where` config.\r\n    ' -%}\r\n  {%- do exceptions.warn(deprecation_warning) -%}\r\n  {{ return(adapter.dispatch('test_unique_where', 'dbt_utils')(model, column_name)) }}\r\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2221224}, "macro.dbt_utils.default__test_unique_where": {"unique_id": "macro.dbt_utils.default__test_unique_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/test_unique_where.sql", "original_file_path": "macros/schema_tests/test_unique_where.sql", "name": "default__test_unique_where", "macro_sql": "{% macro default__test_unique_where(model, column_name) %}\r\n  {{ return(test_unique(model, column_name)) }}\r\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt.test_unique"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.222503}, "macro.dbt_utils.test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/schema_tests/mutually_exclusive_ranges.sql", "name": "test_mutually_exclusive_ranges", "macro_sql": "{% test mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n  {{ return(adapter.dispatch('test_mutually_exclusive_ranges', 'dbt_utils')(model, lower_bound_column, upper_bound_column, partition_by, gaps, zero_length_range_allowed)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_mutually_exclusive_ranges"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2276387}, "macro.dbt_utils.default__test_mutually_exclusive_ranges": {"unique_id": "macro.dbt_utils.default__test_mutually_exclusive_ranges", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/mutually_exclusive_ranges.sql", "original_file_path": "macros/schema_tests/mutually_exclusive_ranges.sql", "name": "default__test_mutually_exclusive_ranges", "macro_sql": "{% macro default__test_mutually_exclusive_ranges(model, lower_bound_column, upper_bound_column, partition_by=None, gaps='allowed', zero_length_range_allowed=False) %}\n{% if gaps == 'not_allowed' %}\n    {% set allow_gaps_operator='=' %}\n    {% set allow_gaps_operator_in_words='equal_to' %}\n{% elif gaps == 'allowed' %}\n    {% set allow_gaps_operator='<=' %}\n    {% set allow_gaps_operator_in_words='less_than_or_equal_to' %}\n{% elif gaps == 'required' %}\n    {% set allow_gaps_operator='<' %}\n    {% set allow_gaps_operator_in_words='less_than' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`gaps` argument for mutually_exclusive_ranges test must be one of ['not_allowed', 'allowed', 'required'] Got: '\" ~ gaps ~\"'.'\"\n    ) }}\n{% endif %}\n{% if not zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<' %}\n    {% set allow_zero_length_operator_in_words='less_than' %}\n{% elif zero_length_range_allowed %}\n    {% set allow_zero_length_operator='<=' %}\n    {% set allow_zero_length_operator_in_words='less_than_or_equal_to' %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`zero_length_range_allowed` argument for mutually_exclusive_ranges test must be one of [true, false] Got: '\" ~ zero_length_range_allowed ~\"'.'\"\n    ) }}\n{% endif %}\n\n{% set partition_clause=\"partition by \" ~ partition_by if partition_by else '' %}\n\nwith window_functions as (\n\n    select\n        {% if partition_by %}\n        {{ partition_by }} as partition_by_col,\n        {% endif %}\n        {{ lower_bound_column }} as lower_bound,\n        {{ upper_bound_column }} as upper_bound,\n\n        lead({{ lower_bound_column }}) over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }}\n        ) as next_lower_bound,\n\n        row_number() over (\n            {{ partition_clause }}\n            order by {{ lower_bound_column }} desc\n        ) = 1 as is_last_record\n\n    from {{ model }}\n\n),\n\ncalc as (\n    -- We want to return records where one of our assumptions fails, so we'll use\n    -- the `not` function with `and` statements so we can write our assumptions nore cleanly\n    select\n        *,\n\n        -- For each record: lower_bound should be < upper_bound.\n        -- Coalesce it to return an error on the null case (implicit assumption\n        -- these columns are not_null)\n        coalesce(\n            lower_bound {{ allow_zero_length_operator }} upper_bound,\n            false\n        ) as lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound,\n\n        -- For each record: upper_bound {{ allow_gaps_operator }} the next lower_bound.\n        -- Coalesce it to handle null cases for the last record.\n        coalesce(\n            upper_bound {{ allow_gaps_operator }} next_lower_bound,\n            is_last_record,\n            false\n        ) as upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n\n    from window_functions\n\n),\n\nvalidation_errors as (\n\n    select\n        *\n    from calc\n\n    where not(\n        -- THE FOLLOWING SHOULD BE TRUE --\n        lower_bound_{{ allow_zero_length_operator_in_words }}_upper_bound\n        and upper_bound_{{ allow_gaps_operator_in_words }}_next_lower_bound\n    )\n)\n\nselect * from validation_errors\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2311301}, "macro.dbt_utils.test_relationships_where": {"unique_id": "macro.dbt_utils.test_relationships_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/relationships_where.sql", "original_file_path": "macros/schema_tests/relationships_where.sql", "name": "test_relationships_where", "macro_sql": "{% test relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n  {{ return(adapter.dispatch('test_relationships_where', 'dbt_utils')(model, column_name, to, field, from_condition, to_condition)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_relationships_where"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2325175}, "macro.dbt_utils.default__test_relationships_where": {"unique_id": "macro.dbt_utils.default__test_relationships_where", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/relationships_where.sql", "original_file_path": "macros/schema_tests/relationships_where.sql", "name": "default__test_relationships_where", "macro_sql": "{% macro default__test_relationships_where(model, column_name, to, field, from_condition=\"1=1\", to_condition=\"1=1\") %}\n\n{# T-SQL has no boolean data type so we use 1=1 which returns TRUE #}\n{# ref https://stackoverflow.com/a/7170753/3842610 #}\n\nwith left_table as (\n\n  select\n    {{column_name}} as id\n\n  from {{model}}\n\n  where {{column_name}} is not null\n    and {{from_condition}}\n\n),\n\nright_table as (\n\n  select\n    {{field}} as id\n\n  from {{to}}\n\n  where {{field}} is not null\n    and {{to_condition}}\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2332716}, "macro.dbt_utils.test_accepted_range": {"unique_id": "macro.dbt_utils.test_accepted_range", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/accepted_range.sql", "original_file_path": "macros/schema_tests/accepted_range.sql", "name": "test_accepted_range", "macro_sql": "{% test accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n  {{ return(adapter.dispatch('test_accepted_range', 'dbt_utils')(model, column_name, min_value, max_value, inclusive)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_accepted_range"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2346709}, "macro.dbt_utils.default__test_accepted_range": {"unique_id": "macro.dbt_utils.default__test_accepted_range", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/accepted_range.sql", "original_file_path": "macros/schema_tests/accepted_range.sql", "name": "default__test_accepted_range", "macro_sql": "{% macro default__test_accepted_range(model, column_name, min_value=none, max_value=none, inclusive=true) %}\n\nwith meet_condition as(\n  select *\n  from {{ model }}\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n\n  {%- if min_value is not none %}\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} > {{- \"=\" if inclusive }} {{ min_value }}\n  {%- endif %}\n\n  {%- if max_value is not none %}\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not {{ column_name }} < {{- \"=\" if inclusive }} {{ max_value }}\n  {%- endif %}\n)\n\nselect *\nfrom validation_errors\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2357125}, "macro.dbt_utils.test_fewer_rows_than": {"unique_id": "macro.dbt_utils.test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/fewer_rows_than.sql", "original_file_path": "macros/schema_tests/fewer_rows_than.sql", "name": "test_fewer_rows_than", "macro_sql": "{% test fewer_rows_than(model, compare_model) %}\n  {{ return(adapter.dispatch('test_fewer_rows_than', 'dbt_utils')(model, compare_model)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_fewer_rows_than"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2368484}, "macro.dbt_utils.default__test_fewer_rows_than": {"unique_id": "macro.dbt_utils.default__test_fewer_rows_than", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/fewer_rows_than.sql", "original_file_path": "macros/schema_tests/fewer_rows_than.sql", "name": "default__test_fewer_rows_than", "macro_sql": "{% macro default__test_fewer_rows_than(model, compare_model) %}\n\n{{ config(fail_calc = 'coalesce(row_count_delta, 0)') }}\n\nwith a as (\n\n    select count(*) as count_our_model from {{ model }}\n\n),\nb as (\n\n    select count(*) as count_comparison_model from {{ compare_model }}\n\n),\ncounts as (\n\n    select\n        count_our_model,\n        count_comparison_model\n    from a\n    cross join b\n\n),\nfinal as (\n\n    select *,\n        case\n            -- fail the test if we have more rows than the reference model and return the row count delta\n            when count_our_model > count_comparison_model then (count_our_model - count_comparison_model)\n            -- fail the test if they are the same number\n            when count_our_model = count_comparison_model then 1\n            -- pass the test if the delta is positive (i.e. return the number 0)\n            else 0\n    end as row_count_delta\n    from counts\n\n)\n\nselect * from final\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2373557}, "macro.dbt_utils.test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/unique_combination_of_columns.sql", "original_file_path": "macros/schema_tests/unique_combination_of_columns.sql", "name": "test_unique_combination_of_columns", "macro_sql": "{% test unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n  {{ return(adapter.dispatch('test_unique_combination_of_columns', 'dbt_utils')(model, combination_of_columns, quote_columns)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_unique_combination_of_columns"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.238643}, "macro.dbt_utils.default__test_unique_combination_of_columns": {"unique_id": "macro.dbt_utils.default__test_unique_combination_of_columns", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/unique_combination_of_columns.sql", "original_file_path": "macros/schema_tests/unique_combination_of_columns.sql", "name": "default__test_unique_combination_of_columns", "macro_sql": "{% macro default__test_unique_combination_of_columns(model, combination_of_columns, quote_columns=false) %}\n\n{% if not quote_columns %}\n    {%- set column_list=combination_of_columns %}\n{% elif quote_columns %}\n    {%- set column_list=[] %}\n        {% for column in combination_of_columns -%}\n            {% set column_list = column_list.append( adapter.quote(column) ) %}\n        {%- endfor %}\n{% else %}\n    {{ exceptions.raise_compiler_error(\n        \"`quote_columns` argument for unique_combination_of_columns test must be one of [True, False] Got: '\" ~ quote ~\"'.'\"\n    ) }}\n{% endif %}\n\n{%- set columns_csv=column_list | join(', ') %}\n\n\nwith validation_errors as (\n\n    select\n        {{ columns_csv }}\n    from {{ model }}\n    group by {{ columns_csv }}\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2401745}, "macro.dbt_utils.test_recency": {"unique_id": "macro.dbt_utils.test_recency", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/recency.sql", "original_file_path": "macros/schema_tests/recency.sql", "name": "test_recency", "macro_sql": "{% test recency(model, field, datepart, interval) %}\n  {{ return(adapter.dispatch('test_recency', 'dbt_utils')(model, field, datepart, interval)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_recency"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.241149}, "macro.dbt_utils.default__test_recency": {"unique_id": "macro.dbt_utils.default__test_recency", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/recency.sql", "original_file_path": "macros/schema_tests/recency.sql", "name": "default__test_recency", "macro_sql": "{% macro default__test_recency(model, field, datepart, interval) %}\n\n{% set threshold = dbt_utils.dateadd(datepart, interval * -1, dbt_utils.current_timestamp()) %}\n\nwith recency as (\n\n    select max({{field}}) as most_recent\n    from {{ model }}\n\n)\n\nselect\n\n    most_recent,\n    {{ threshold }} as threshold\n\nfrom recency\nwhere most_recent < {{ threshold }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.241892}, "macro.dbt_utils.test_cardinality_equality": {"unique_id": "macro.dbt_utils.test_cardinality_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/cardinality_equality.sql", "original_file_path": "macros/schema_tests/cardinality_equality.sql", "name": "test_cardinality_equality", "macro_sql": "{% test cardinality_equality(model, column_name, to, field) %}\n    {{ return(adapter.dispatch('test_cardinality_equality', 'dbt_utils')(model, column_name, to, field)) }}\n{% endtest %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__test_cardinality_equality"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2430446}, "macro.dbt_utils.default__test_cardinality_equality": {"unique_id": "macro.dbt_utils.default__test_cardinality_equality", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/schema_tests/cardinality_equality.sql", "original_file_path": "macros/schema_tests/cardinality_equality.sql", "name": "default__test_cardinality_equality", "macro_sql": "{% macro default__test_cardinality_equality(model, column_name, to, field) %}\n\n{# T-SQL does not let you use numbers as aliases for columns #}\n{# Thus, no \"GROUP BY 1\" #}\n\nwith table_a as (\nselect\n  {{ column_name }},\n  count(*) as num_rows\nfrom {{ model }}\ngroup by {{ column_name }}\n),\n\ntable_b as (\nselect\n  {{ field }},\n  count(*) as num_rows\nfrom {{ to }}\ngroup by {{ field }}\n),\n\nexcept_a as (\n  select *\n  from table_a\n  {{ dbt_utils.except() }}\n  select *\n  from table_b\n),\n\nexcept_b as (\n  select *\n  from table_b\n  {{ dbt_utils.except() }}\n  select *\n  from table_a\n),\n\nunioned as (\n  select *\n  from except_a\n  union all\n  select *\n  from except_b\n)\n\nselect *\nfrom unioned\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2437959}, "macro.dbt_utils.split_part": {"unique_id": "macro.dbt_utils.split_part", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/split_part.sql", "original_file_path": "macros/cross_db_utils/split_part.sql", "name": "split_part", "macro_sql": "{% macro split_part(string_text, delimiter_text, part_number) %}\n  {{ return(adapter.dispatch('split_part', 'dbt_utils') (string_text, delimiter_text, part_number)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__split_part"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2448893}, "macro.dbt_utils.default__split_part": {"unique_id": "macro.dbt_utils.default__split_part", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/split_part.sql", "original_file_path": "macros/cross_db_utils/split_part.sql", "name": "default__split_part", "macro_sql": "{% macro default__split_part(string_text, delimiter_text, part_number) %}\n\n    split_part(\n        {{ string_text }},\n        {{ delimiter_text }},\n        {{ part_number }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2452707}, "macro.dbt_utils.bigquery__split_part": {"unique_id": "macro.dbt_utils.bigquery__split_part", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/split_part.sql", "original_file_path": "macros/cross_db_utils/split_part.sql", "name": "bigquery__split_part", "macro_sql": "{% macro bigquery__split_part(string_text, delimiter_text, part_number) %}\n\n    split(\n        {{ string_text }},\n        {{ delimiter_text }}\n        )[safe_offset({{ part_number - 1 }})]\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2456787}, "macro.dbt_utils.escape_single_quotes": {"unique_id": "macro.dbt_utils.escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/escape_single_quotes.sql", "name": "escape_single_quotes", "macro_sql": "{% macro escape_single_quotes(expression) %}\n      {{ return(adapter.dispatch('escape_single_quotes', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__escape_single_quotes"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2465196}, "macro.dbt_utils.default__escape_single_quotes": {"unique_id": "macro.dbt_utils.default__escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/escape_single_quotes.sql", "name": "default__escape_single_quotes", "macro_sql": "{% macro default__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\",\"''\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2468474}, "macro.dbt_utils.snowflake__escape_single_quotes": {"unique_id": "macro.dbt_utils.snowflake__escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/escape_single_quotes.sql", "name": "snowflake__escape_single_quotes", "macro_sql": "{% macro snowflake__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\", \"\\\\'\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2471635}, "macro.dbt_utils.bigquery__escape_single_quotes": {"unique_id": "macro.dbt_utils.bigquery__escape_single_quotes", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/escape_single_quotes.sql", "original_file_path": "macros/cross_db_utils/escape_single_quotes.sql", "name": "bigquery__escape_single_quotes", "macro_sql": "{% macro bigquery__escape_single_quotes(expression) -%}\n{{ expression | replace(\"'\", \"\\\\'\") }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2474732}, "macro.dbt_utils.length": {"unique_id": "macro.dbt_utils.length", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/length.sql", "original_file_path": "macros/cross_db_utils/length.sql", "name": "length", "macro_sql": "{% macro length(expression) -%}\n    {{ return(adapter.dispatch('length', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__length"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.248252}, "macro.dbt_utils.default__length": {"unique_id": "macro.dbt_utils.default__length", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/length.sql", "original_file_path": "macros/cross_db_utils/length.sql", "name": "default__length", "macro_sql": "{% macro default__length(expression) %}\n    \n    length(\n        {{ expression }}\n    )\n    \n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2486577}, "macro.dbt_utils.redshift__length": {"unique_id": "macro.dbt_utils.redshift__length", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/length.sql", "original_file_path": "macros/cross_db_utils/length.sql", "name": "redshift__length", "macro_sql": "{% macro redshift__length(expression) %}\n\n    len(\n        {{ expression }}\n    )\n    \n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.248906}, "macro.dbt_utils.current_timestamp": {"unique_id": "macro.dbt_utils.current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "current_timestamp", "macro_sql": "{% macro current_timestamp() -%}\n  {{ return(adapter.dispatch('current_timestamp', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2501955}, "macro.dbt_utils.default__current_timestamp": {"unique_id": "macro.dbt_utils.default__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "default__current_timestamp", "macro_sql": "{% macro default__current_timestamp() %}\n    current_timestamp::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2504604}, "macro.dbt_utils.redshift__current_timestamp": {"unique_id": "macro.dbt_utils.redshift__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "redshift__current_timestamp", "macro_sql": "{% macro redshift__current_timestamp() %}\n    getdate()\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2506313}, "macro.dbt_utils.bigquery__current_timestamp": {"unique_id": "macro.dbt_utils.bigquery__current_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "bigquery__current_timestamp", "macro_sql": "{% macro bigquery__current_timestamp() %}\n    current_timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2507958}, "macro.dbt_utils.current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "current_timestamp_in_utc", "macro_sql": "{% macro current_timestamp_in_utc() -%}\n  {{ return(adapter.dispatch('current_timestamp_in_utc', 'dbt_utils')()) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.251147}, "macro.dbt_utils.default__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.default__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "default__current_timestamp_in_utc", "macro_sql": "{% macro default__current_timestamp_in_utc() %}\n    {{dbt_utils.current_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2514012}, "macro.dbt_utils.snowflake__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.snowflake__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "snowflake__current_timestamp_in_utc", "macro_sql": "{% macro snowflake__current_timestamp_in_utc() %}\n    convert_timezone('UTC', {{dbt_utils.current_timestamp()}})::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.current_timestamp", "macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.251727}, "macro.dbt_utils.postgres__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.postgres__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "postgres__current_timestamp_in_utc", "macro_sql": "{% macro postgres__current_timestamp_in_utc() %}\n    (current_timestamp at time zone 'utc')::{{dbt_utils.type_timestamp()}}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.25198}, "macro.dbt_utils.redshift__current_timestamp_in_utc": {"unique_id": "macro.dbt_utils.redshift__current_timestamp_in_utc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/current_timestamp.sql", "original_file_path": "macros/cross_db_utils/current_timestamp.sql", "name": "redshift__current_timestamp_in_utc", "macro_sql": "{% macro redshift__current_timestamp_in_utc() %}\n    {{ return(dbt_utils.default__current_timestamp_in_utc()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__current_timestamp_in_utc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2523088}, "macro.dbt_utils.right": {"unique_id": "macro.dbt_utils.right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/right.sql", "original_file_path": "macros/cross_db_utils/right.sql", "name": "right", "macro_sql": "{% macro right(string_text, length_expression) -%}\n    {{ return(adapter.dispatch('right', 'dbt_utils') (string_text, length_expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__right"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2534564}, "macro.dbt_utils.default__right": {"unique_id": "macro.dbt_utils.default__right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/right.sql", "original_file_path": "macros/cross_db_utils/right.sql", "name": "default__right", "macro_sql": "{% macro default__right(string_text, length_expression) %}\n\n    right(\n        {{ string_text }},\n        {{ length_expression }}\n    )\n    \n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2537732}, "macro.dbt_utils.bigquery__right": {"unique_id": "macro.dbt_utils.bigquery__right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/right.sql", "original_file_path": "macros/cross_db_utils/right.sql", "name": "bigquery__right", "macro_sql": "{% macro bigquery__right(string_text, length_expression) %}\n\n    case when {{ length_expression }} = 0 \n        then ''\n    else \n        substr(\n            {{ string_text }},\n            -1 * ({{ length_expression }})\n        )\n    end\n\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.254124}, "macro.dbt_utils.snowflake__right": {"unique_id": "macro.dbt_utils.snowflake__right", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/right.sql", "original_file_path": "macros/cross_db_utils/right.sql", "name": "snowflake__right", "macro_sql": "{% macro snowflake__right(string_text, length_expression) %}\n\n    case when {{ length_expression }} = 0 \n        then ''\n    else \n        right(\n            {{ string_text }},\n            {{ length_expression }}\n        )\n    end\n\n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.254473}, "macro.dbt_utils.hash": {"unique_id": "macro.dbt_utils.hash", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/hash.sql", "original_file_path": "macros/cross_db_utils/hash.sql", "name": "hash", "macro_sql": "{% macro hash(field) -%}\n  {{ return(adapter.dispatch('hash', 'dbt_utils') (field)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2553113}, "macro.dbt_utils.default__hash": {"unique_id": "macro.dbt_utils.default__hash", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/hash.sql", "original_file_path": "macros/cross_db_utils/hash.sql", "name": "default__hash", "macro_sql": "{% macro default__hash(field) -%}\n    md5(cast({{field}} as {{dbt_utils.type_string()}}))\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2556329}, "macro.dbt_utils.bigquery__hash": {"unique_id": "macro.dbt_utils.bigquery__hash", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/hash.sql", "original_file_path": "macros/cross_db_utils/hash.sql", "name": "bigquery__hash", "macro_sql": "{% macro bigquery__hash(field) -%}\n    to_hex({{dbt_utils.default__hash(field)}})\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__hash"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2559237}, "macro.dbt_utils.any_value": {"unique_id": "macro.dbt_utils.any_value", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/any_value.sql", "original_file_path": "macros/cross_db_utils/any_value.sql", "name": "any_value", "macro_sql": "{% macro any_value(expression) -%}\n    {{ return(adapter.dispatch('any_value', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__any_value"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2567005}, "macro.dbt_utils.default__any_value": {"unique_id": "macro.dbt_utils.default__any_value", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/any_value.sql", "original_file_path": "macros/cross_db_utils/any_value.sql", "name": "default__any_value", "macro_sql": "{% macro default__any_value(expression) -%}\n    \n    any_value({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2569444}, "macro.dbt_utils.postgres__any_value": {"unique_id": "macro.dbt_utils.postgres__any_value", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/any_value.sql", "original_file_path": "macros/cross_db_utils/any_value.sql", "name": "postgres__any_value", "macro_sql": "{% macro postgres__any_value(expression) -%}\n    {#- /*Postgres doesn't support any_value, so we're using min() to get the same result*/ -#}\n    min({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.25719}, "macro.dbt_utils.replace": {"unique_id": "macro.dbt_utils.replace", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/replace.sql", "original_file_path": "macros/cross_db_utils/replace.sql", "name": "replace", "macro_sql": "{% macro replace(field, old_chars, new_chars) -%}\n    {{ return(adapter.dispatch('replace', 'dbt_utils') (field, old_chars, new_chars)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__replace"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.258031}, "macro.dbt_utils.default__replace": {"unique_id": "macro.dbt_utils.default__replace", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/replace.sql", "original_file_path": "macros/cross_db_utils/replace.sql", "name": "default__replace", "macro_sql": "{% macro default__replace(field, old_chars, new_chars) %}\n\n    replace(\n        {{ field }},\n        {{ old_chars }},\n        {{ new_chars }}\n    )\n    \n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2585554}, "macro.dbt_utils.cast_bool_to_text": {"unique_id": "macro.dbt_utils.cast_bool_to_text", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_bool_to_text.sql", "original_file_path": "macros/cross_db_utils/cast_bool_to_text.sql", "name": "cast_bool_to_text", "macro_sql": "{% macro cast_bool_to_text(field) %}\n  {{ adapter.dispatch('cast_bool_to_text', 'dbt_utils') (field) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__cast_bool_to_text"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.259338}, "macro.dbt_utils.default__cast_bool_to_text": {"unique_id": "macro.dbt_utils.default__cast_bool_to_text", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_bool_to_text.sql", "original_file_path": "macros/cross_db_utils/cast_bool_to_text.sql", "name": "default__cast_bool_to_text", "macro_sql": "{% macro default__cast_bool_to_text(field) %}\n    cast({{ field }} as {{ dbt_utils.type_string() }})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2596567}, "macro.dbt_utils.redshift__cast_bool_to_text": {"unique_id": "macro.dbt_utils.redshift__cast_bool_to_text", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/cast_bool_to_text.sql", "original_file_path": "macros/cross_db_utils/cast_bool_to_text.sql", "name": "redshift__cast_bool_to_text", "macro_sql": "{% macro redshift__cast_bool_to_text(field) %}\n    case\n        when {{ field }} is true then 'true'\n        when {{ field }} is false then 'false'\n    end::text\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2600648}, "macro.dbt_utils.bool_or": {"unique_id": "macro.dbt_utils.bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/bool_or.sql", "original_file_path": "macros/cross_db_utils/bool_or.sql", "name": "bool_or", "macro_sql": "{% macro bool_or(expression) -%}\n    {{ return(adapter.dispatch('bool_or', 'dbt_utils') (expression)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__bool_or"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.260915}, "macro.dbt_utils.default__bool_or": {"unique_id": "macro.dbt_utils.default__bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/bool_or.sql", "original_file_path": "macros/cross_db_utils/bool_or.sql", "name": "default__bool_or", "macro_sql": "{% macro default__bool_or(expression) -%}\n    \n    bool_or({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2611597}, "macro.dbt_utils.snowflake__bool_or": {"unique_id": "macro.dbt_utils.snowflake__bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/bool_or.sql", "original_file_path": "macros/cross_db_utils/bool_or.sql", "name": "snowflake__bool_or", "macro_sql": "{% macro snowflake__bool_or(expression) -%}\n    \n    boolor_agg({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2613997}, "macro.dbt_utils.bigquery__bool_or": {"unique_id": "macro.dbt_utils.bigquery__bool_or", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/bool_or.sql", "original_file_path": "macros/cross_db_utils/bool_or.sql", "name": "bigquery__bool_or", "macro_sql": "{% macro bigquery__bool_or(expression) -%}\n    \n    logical_or({{ expression }})\n    \n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2616446}, "macro.dbt_utils.concat": {"unique_id": "macro.dbt_utils.concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/concat.sql", "original_file_path": "macros/cross_db_utils/concat.sql", "name": "concat", "macro_sql": "{% macro concat(fields) -%}\n  {{ return(adapter.dispatch('concat', 'dbt_utils')(fields)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__concat"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2623231}, "macro.dbt_utils.default__concat": {"unique_id": "macro.dbt_utils.default__concat", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/concat.sql", "original_file_path": "macros/cross_db_utils/concat.sql", "name": "default__concat", "macro_sql": "{% macro default__concat(fields) -%}\n    {{ fields|join(' || ') }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2626467}, "macro.dbt_utils._is_relation": {"unique_id": "macro.dbt_utils._is_relation", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/_is_relation.sql", "original_file_path": "macros/cross_db_utils/_is_relation.sql", "name": "_is_relation", "macro_sql": "{% macro _is_relation(obj, macro) %}\n    {%- if not (obj is mapping and obj.get('metadata', {}).get('type', '').endswith('Relation')) -%}\n        {%- do exceptions.raise_compiler_error(\"Macro \" ~ macro ~ \" expected a Relation but received the value: \" ~ obj) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2637377}, "macro.dbt_utils.identifier": {"unique_id": "macro.dbt_utils.identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/identifier.sql", "original_file_path": "macros/cross_db_utils/identifier.sql", "name": "identifier", "macro_sql": "{% macro identifier(value) %}\t\n  {%- set error_message = '\n    Warning: the `identifier` macro is no longer supported and will be deprecated in a future release of dbt-utils. \\\n    Use `adapter.quote` instead. The {}.{} model triggered this warning. \\\n    '.format(model.package_name, model.name) -%}\n  {%- do exceptions.warn(error_message) -%}\n  {{ return(adapter.dispatch('identifier', 'dbt_utils') (value)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__identifier"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2649057}, "macro.dbt_utils.default__identifier": {"unique_id": "macro.dbt_utils.default__identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/identifier.sql", "original_file_path": "macros/cross_db_utils/identifier.sql", "name": "default__identifier", "macro_sql": "{% macro default__identifier(value) -%}\t\n    \"{{ value }}\"\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.265257}, "macro.dbt_utils.bigquery__identifier": {"unique_id": "macro.dbt_utils.bigquery__identifier", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/identifier.sql", "original_file_path": "macros/cross_db_utils/identifier.sql", "name": "bigquery__identifier", "macro_sql": "{% macro bigquery__identifier(value) -%}\t\n    `{{ value }}`\t\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2655056}, "macro.dbt_utils.datediff": {"unique_id": "macro.dbt_utils.datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datediff.sql", "original_file_path": "macros/cross_db_utils/datediff.sql", "name": "datediff", "macro_sql": "{% macro datediff(first_date, second_date, datepart) %}\n  {{ return(adapter.dispatch('datediff', 'dbt_utils')(first_date, second_date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2700276}, "macro.dbt_utils.default__datediff": {"unique_id": "macro.dbt_utils.default__datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datediff.sql", "original_file_path": "macros/cross_db_utils/datediff.sql", "name": "default__datediff", "macro_sql": "{% macro default__datediff(first_date, second_date, datepart) %}\n\n    datediff(\n        {{ datepart }},\n        {{ first_date }},\n        {{ second_date }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2705069}, "macro.dbt_utils.bigquery__datediff": {"unique_id": "macro.dbt_utils.bigquery__datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datediff.sql", "original_file_path": "macros/cross_db_utils/datediff.sql", "name": "bigquery__datediff", "macro_sql": "{% macro bigquery__datediff(first_date, second_date, datepart) %}\n\n    datetime_diff(\n        cast({{second_date}} as datetime),\n        cast({{first_date}} as datetime),\n        {{datepart}}\n    )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.270867}, "macro.dbt_utils.postgres__datediff": {"unique_id": "macro.dbt_utils.postgres__datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datediff.sql", "original_file_path": "macros/cross_db_utils/datediff.sql", "name": "postgres__datediff", "macro_sql": "{% macro postgres__datediff(first_date, second_date, datepart) %}\n\n    {% if datepart == 'year' %}\n        (date_part('year', ({{second_date}})::date) - date_part('year', ({{first_date}})::date))\n    {% elif datepart == 'quarter' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 4 + date_part('quarter', ({{second_date}})::date) - date_part('quarter', ({{first_date}})::date))\n    {% elif datepart == 'month' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'year') }} * 12 + date_part('month', ({{second_date}})::date) - date_part('month', ({{first_date}})::date))\n    {% elif datepart == 'day' %}\n        (({{second_date}})::date - ({{first_date}})::date)\n    {% elif datepart == 'week' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} / 7 + case\n            when date_part('dow', ({{first_date}})::timestamp) <= date_part('dow', ({{second_date}})::timestamp) then\n                case when {{first_date}} <= {{second_date}} then 0 else -1 end\n            else\n                case when {{first_date}} <= {{second_date}} then 1 else 0 end\n        end)\n    {% elif datepart == 'hour' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'day') }} * 24 + date_part('hour', ({{second_date}})::timestamp) - date_part('hour', ({{first_date}})::timestamp))\n    {% elif datepart == 'minute' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'hour') }} * 60 + date_part('minute', ({{second_date}})::timestamp) - date_part('minute', ({{first_date}})::timestamp))\n    {% elif datepart == 'second' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60 + floor(date_part('second', ({{second_date}})::timestamp)) - floor(date_part('second', ({{first_date}})::timestamp)))\n    {% elif datepart == 'millisecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000 + floor(date_part('millisecond', ({{second_date}})::timestamp)) - floor(date_part('millisecond', ({{first_date}})::timestamp)))\n    {% elif datepart == 'microsecond' %}\n        ({{ dbt_utils.datediff(first_date, second_date, 'minute') }} * 60000000 + floor(date_part('microsecond', ({{second_date}})::timestamp)) - floor(date_part('microsecond', ({{first_date}})::timestamp)))\n    {% else %}\n        {{ exceptions.raise_compiler_error(\"Unsupported datepart for macro datediff in postgres: {!r}\".format(datepart)) }}\n    {% endif %}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.274718}, "macro.dbt_utils.redshift__datediff": {"unique_id": "macro.dbt_utils.redshift__datediff", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datediff.sql", "original_file_path": "macros/cross_db_utils/datediff.sql", "name": "redshift__datediff", "macro_sql": "{% macro redshift__datediff(first_date, second_date, datepart) %}\n\n    {{ return(dbt_utils.default__datediff(first_date, second_date, datepart)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__datediff"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.275177}, "macro.dbt_utils.dateadd": {"unique_id": "macro.dbt_utils.dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/dateadd.sql", "original_file_path": "macros/cross_db_utils/dateadd.sql", "name": "dateadd", "macro_sql": "{% macro dateadd(datepart, interval, from_date_or_timestamp) %}\n  {{ return(adapter.dispatch('dateadd', 'dbt_utils')(datepart, interval, from_date_or_timestamp)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2765133}, "macro.dbt_utils.default__dateadd": {"unique_id": "macro.dbt_utils.default__dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/dateadd.sql", "original_file_path": "macros/cross_db_utils/dateadd.sql", "name": "default__dateadd", "macro_sql": "{% macro default__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    dateadd(\n        {{ datepart }},\n        {{ interval }},\n        {{ from_date_or_timestamp }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2769008}, "macro.dbt_utils.bigquery__dateadd": {"unique_id": "macro.dbt_utils.bigquery__dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/dateadd.sql", "original_file_path": "macros/cross_db_utils/dateadd.sql", "name": "bigquery__dateadd", "macro_sql": "{% macro bigquery__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n        datetime_add(\n            cast( {{ from_date_or_timestamp }} as datetime),\n        interval {{ interval }} {{ datepart }}\n        )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2772646}, "macro.dbt_utils.postgres__dateadd": {"unique_id": "macro.dbt_utils.postgres__dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/dateadd.sql", "original_file_path": "macros/cross_db_utils/dateadd.sql", "name": "postgres__dateadd", "macro_sql": "{% macro postgres__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ from_date_or_timestamp }} + ((interval '1 {{ datepart }}') * ({{ interval }}))\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2776284}, "macro.dbt_utils.redshift__dateadd": {"unique_id": "macro.dbt_utils.redshift__dateadd", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/dateadd.sql", "original_file_path": "macros/cross_db_utils/dateadd.sql", "name": "redshift__dateadd", "macro_sql": "{% macro redshift__dateadd(datepart, interval, from_date_or_timestamp) %}\n\n    {{ return(dbt_utils.default__dateadd(datepart, interval, from_date_or_timestamp)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__dateadd"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2780585}, "macro.dbt_utils.type_string": {"unique_id": "macro.dbt_utils.type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_string", "macro_sql": "\n\n{%- macro type_string() -%}\n  {{ return(adapter.dispatch('type_string', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__type_string"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2794619}, "macro.dbt_utils.default__type_string": {"unique_id": "macro.dbt_utils.default__type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_string", "macro_sql": "{% macro default__type_string() %}\n    string\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2796416}, "macro.dbt_utils.redshift__type_string": {"unique_id": "macro.dbt_utils.redshift__type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "redshift__type_string", "macro_sql": "\n\n{%- macro redshift__type_string() -%}\n    varchar\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.27981}, "macro.dbt_utils.postgres__type_string": {"unique_id": "macro.dbt_utils.postgres__type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "postgres__type_string", "macro_sql": "{% macro postgres__type_string() %}\n    varchar\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2799726}, "macro.dbt_utils.snowflake__type_string": {"unique_id": "macro.dbt_utils.snowflake__type_string", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "snowflake__type_string", "macro_sql": "{% macro snowflake__type_string() %}\n    varchar\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2801547}, "macro.dbt_utils.type_timestamp": {"unique_id": "macro.dbt_utils.type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_timestamp", "macro_sql": "\n\n{%- macro type_timestamp() -%}\n  {{ return(adapter.dispatch('type_timestamp', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__type_timestamp"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.280599}, "macro.dbt_utils.default__type_timestamp": {"unique_id": "macro.dbt_utils.default__type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_timestamp", "macro_sql": "{% macro default__type_timestamp() %}\n    timestamp\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2807782}, "macro.dbt_utils.postgres__type_timestamp": {"unique_id": "macro.dbt_utils.postgres__type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "postgres__type_timestamp", "macro_sql": "{% macro postgres__type_timestamp() %}\n    timestamp without time zone\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.280944}, "macro.dbt_utils.snowflake__type_timestamp": {"unique_id": "macro.dbt_utils.snowflake__type_timestamp", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "snowflake__type_timestamp", "macro_sql": "{% macro snowflake__type_timestamp() %}\n    timestamp_ntz\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2811093}, "macro.dbt_utils.type_float": {"unique_id": "macro.dbt_utils.type_float", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_float", "macro_sql": "\n\n{%- macro type_float() -%}\n  {{ return(adapter.dispatch('type_float', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_float"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2814791}, "macro.dbt_utils.default__type_float": {"unique_id": "macro.dbt_utils.default__type_float", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_float", "macro_sql": "{% macro default__type_float() %}\n    float\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.281655}, "macro.dbt_utils.bigquery__type_float": {"unique_id": "macro.dbt_utils.bigquery__type_float", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "bigquery__type_float", "macro_sql": "{% macro bigquery__type_float() %}\n    float64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2818186}, "macro.dbt_utils.type_numeric": {"unique_id": "macro.dbt_utils.type_numeric", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_numeric", "macro_sql": "\n\n{%- macro type_numeric() -%}\n  {{ return(adapter.dispatch('type_numeric', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2821763}, "macro.dbt_utils.default__type_numeric": {"unique_id": "macro.dbt_utils.default__type_numeric", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_numeric", "macro_sql": "{% macro default__type_numeric() %}\n    numeric(28, 6)\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.282352}, "macro.dbt_utils.bigquery__type_numeric": {"unique_id": "macro.dbt_utils.bigquery__type_numeric", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "bigquery__type_numeric", "macro_sql": "{% macro bigquery__type_numeric() %}\n    numeric\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.282519}, "macro.dbt_utils.type_bigint": {"unique_id": "macro.dbt_utils.type_bigint", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_bigint", "macro_sql": "\n\n{%- macro type_bigint() -%}\n  {{ return(adapter.dispatch('type_bigint', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_bigint"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2829018}, "macro.dbt_utils.default__type_bigint": {"unique_id": "macro.dbt_utils.default__type_bigint", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_bigint", "macro_sql": "{% macro default__type_bigint() %}\n    bigint\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.283242}, "macro.dbt_utils.bigquery__type_bigint": {"unique_id": "macro.dbt_utils.bigquery__type_bigint", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "bigquery__type_bigint", "macro_sql": "{% macro bigquery__type_bigint() %}\n    int64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.28343}, "macro.dbt_utils.type_int": {"unique_id": "macro.dbt_utils.type_int", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "type_int", "macro_sql": "\n\n{%- macro type_int() -%}\n  {{ return(adapter.dispatch('type_int', 'dbt_utils')()) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__type_int"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2838216}, "macro.dbt_utils.default__type_int": {"unique_id": "macro.dbt_utils.default__type_int", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "default__type_int", "macro_sql": "{% macro default__type_int() %}\n    int\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2840154}, "macro.dbt_utils.bigquery__type_int": {"unique_id": "macro.dbt_utils.bigquery__type_int", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/datatypes.sql", "original_file_path": "macros/cross_db_utils/datatypes.sql", "name": "bigquery__type_int", "macro_sql": "{% macro bigquery__type_int() %}\n    int64\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.284213}, "macro.dbt_utils.position": {"unique_id": "macro.dbt_utils.position", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/position.sql", "original_file_path": "macros/cross_db_utils/position.sql", "name": "position", "macro_sql": "{% macro position(substring_text, string_text) -%}\n    {{ return(adapter.dispatch('position', 'dbt_utils') (substring_text, string_text)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__position"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.285104}, "macro.dbt_utils.default__position": {"unique_id": "macro.dbt_utils.default__position", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/position.sql", "original_file_path": "macros/cross_db_utils/position.sql", "name": "default__position", "macro_sql": "{% macro default__position(substring_text, string_text) %}\n\n    position(\n        {{ substring_text }} in {{ string_text }}\n    )\n    \n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2854354}, "macro.dbt_utils.bigquery__position": {"unique_id": "macro.dbt_utils.bigquery__position", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/position.sql", "original_file_path": "macros/cross_db_utils/position.sql", "name": "bigquery__position", "macro_sql": "{% macro bigquery__position(substring_text, string_text) %}\n\n    strpos(\n        {{ string_text }},\n        {{ substring_text }}\n        \n    )\n    \n{%- endmacro -%}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2858453}, "macro.dbt_utils.string_literal": {"unique_id": "macro.dbt_utils.string_literal", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/literal.sql", "original_file_path": "macros/cross_db_utils/literal.sql", "name": "string_literal", "macro_sql": "{%- macro string_literal(value) -%}\n  {{ return(adapter.dispatch('string_literal', 'dbt_utils') (value)) }}\n{%- endmacro -%}\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__string_literal"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.286533}, "macro.dbt_utils.default__string_literal": {"unique_id": "macro.dbt_utils.default__string_literal", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/literal.sql", "original_file_path": "macros/cross_db_utils/literal.sql", "name": "default__string_literal", "macro_sql": "{% macro default__string_literal(value) -%}\n    '{{ value }}'\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.286781}, "macro.dbt_utils._is_ephemeral": {"unique_id": "macro.dbt_utils._is_ephemeral", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/_is_ephemeral.sql", "original_file_path": "macros/cross_db_utils/_is_ephemeral.sql", "name": "_is_ephemeral", "macro_sql": "{% macro _is_ephemeral(obj, macro) %}\n    {%- if obj.is_cte -%}\n        {% set ephemeral_prefix = api.Relation.add_ephemeral_prefix('') %}\n        {% if obj.name.startswith(ephemeral_prefix) %}\n            {% set model_name = obj.name[(ephemeral_prefix|length):] %}\n        {% else %}\n            {% set model_name = obj.name %}\n        {%- endif -%}\n        {% set error_message %}\nThe `{{ macro }}` macro cannot be used with ephemeral models, as it relies on the information schema.\n\n`{{ model_name }}` is an ephemeral model. Consider making it a view or table instead.\n        {% endset %}\n        {%- do exceptions.raise_compiler_error(error_message) -%}\n    {%- endif -%}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2886503}, "macro.dbt_utils.width_bucket": {"unique_id": "macro.dbt_utils.width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/width_bucket.sql", "original_file_path": "macros/cross_db_utils/width_bucket.sql", "name": "width_bucket", "macro_sql": "{% macro width_bucket(expr, min_value, max_value, num_buckets) %}\n  {{ return(adapter.dispatch('width_bucket', 'dbt_utils') (expr, min_value, max_value, num_buckets)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__width_bucket"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.291238}, "macro.dbt_utils.default__width_bucket": {"unique_id": "macro.dbt_utils.default__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/width_bucket.sql", "original_file_path": "macros/cross_db_utils/width_bucket.sql", "name": "default__width_bucket", "macro_sql": "{% macro default__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is eaxtly at the bucket egde\n        case\n            when\n                mod(\n                    {{ dbt_utils.safe_cast(expr, dbt_utils.type_numeric() ) }},\n                    {{ dbt_utils.safe_cast(bin_size, dbt_utils.type_numeric() ) }}\n                ) = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2923412}, "macro.dbt_utils.redshift__width_bucket": {"unique_id": "macro.dbt_utils.redshift__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/width_bucket.sql", "original_file_path": "macros/cross_db_utils/width_bucket.sql", "name": "redshift__width_bucket", "macro_sql": "{% macro redshift__width_bucket(expr, min_value, max_value, num_buckets) -%}\n\n    {% set bin_size -%}\n    (( {{ max_value }} - {{ min_value }} ) / {{ num_buckets }} )\n    {%- endset %}\n    (\n        -- to break ties when the amount is exactly at the bucket edge\n        case\n            when\n                {{ dbt_utils.safe_cast(expr, dbt_utils.type_numeric() ) }} %\n                {{ dbt_utils.safe_cast(bin_size, dbt_utils.type_numeric() ) }}\n                 = 0\n            then 1\n            else 0\n        end\n    ) +\n      -- Anything over max_value goes the N+1 bucket\n    least(\n        ceil(\n            ({{ expr }} - {{ min_value }})/{{ bin_size }}\n        ),\n        {{ num_buckets }} + 1\n    )\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.safe_cast", "macro.dbt_utils.type_numeric"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.293391}, "macro.dbt_utils.snowflake__width_bucket": {"unique_id": "macro.dbt_utils.snowflake__width_bucket", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/width_bucket.sql", "original_file_path": "macros/cross_db_utils/width_bucket.sql", "name": "snowflake__width_bucket", "macro_sql": "{% macro snowflake__width_bucket(expr, min_value, max_value, num_buckets) %}\n    width_bucket({{ expr }}, {{ min_value }}, {{ max_value }}, {{ num_buckets }} )\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.293823}, "macro.dbt_utils.date_trunc": {"unique_id": "macro.dbt_utils.date_trunc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/date_trunc.sql", "original_file_path": "macros/cross_db_utils/date_trunc.sql", "name": "date_trunc", "macro_sql": "{% macro date_trunc(datepart, date) -%}\n  {{ return(adapter.dispatch('date_trunc', 'dbt_utils') (datepart, date)) }}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2946696}, "macro.dbt_utils.default__date_trunc": {"unique_id": "macro.dbt_utils.default__date_trunc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/date_trunc.sql", "original_file_path": "macros/cross_db_utils/date_trunc.sql", "name": "default__date_trunc", "macro_sql": "{% macro default__date_trunc(datepart, date) %}\n    date_trunc('{{datepart}}', {{date}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.294977}, "macro.dbt_utils.bigquery__date_trunc": {"unique_id": "macro.dbt_utils.bigquery__date_trunc", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/date_trunc.sql", "original_file_path": "macros/cross_db_utils/date_trunc.sql", "name": "bigquery__date_trunc", "macro_sql": "{% macro bigquery__date_trunc(datepart, date) %}\n    timestamp_trunc(\n        cast({{date}} as timestamp),\n        {{datepart}}\n    )\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2952769}, "macro.dbt_utils.except": {"unique_id": "macro.dbt_utils.except", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/except.sql", "original_file_path": "macros/cross_db_utils/except.sql", "name": "except", "macro_sql": "{% macro except() %}\n  {{ return(adapter.dispatch('except', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__except"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.296042}, "macro.dbt_utils.default__except": {"unique_id": "macro.dbt_utils.default__except", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/except.sql", "original_file_path": "macros/cross_db_utils/except.sql", "name": "default__except", "macro_sql": "{% macro default__except() %}\n\n    except\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2962635}, "macro.dbt_utils.bigquery__except": {"unique_id": "macro.dbt_utils.bigquery__except", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/except.sql", "original_file_path": "macros/cross_db_utils/except.sql", "name": "bigquery__except", "macro_sql": "{% macro bigquery__except() %}\n\n    except distinct\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.296442}, "macro.dbt_utils.safe_cast": {"unique_id": "macro.dbt_utils.safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/safe_cast.sql", "original_file_path": "macros/cross_db_utils/safe_cast.sql", "name": "safe_cast", "macro_sql": "{% macro safe_cast(field, type) %}\n  {{ return(adapter.dispatch('safe_cast', 'dbt_utils') (field, type)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.snowflake__safe_cast"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2973275}, "macro.dbt_utils.default__safe_cast": {"unique_id": "macro.dbt_utils.default__safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/safe_cast.sql", "original_file_path": "macros/cross_db_utils/safe_cast.sql", "name": "default__safe_cast", "macro_sql": "{% macro default__safe_cast(field, type) %}\n    {# most databases don't support this function yet\n    so we just need to use cast #}\n    cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2976706}, "macro.dbt_utils.snowflake__safe_cast": {"unique_id": "macro.dbt_utils.snowflake__safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/safe_cast.sql", "original_file_path": "macros/cross_db_utils/safe_cast.sql", "name": "snowflake__safe_cast", "macro_sql": "{% macro snowflake__safe_cast(field, type) %}\n    try_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.298141}, "macro.dbt_utils.bigquery__safe_cast": {"unique_id": "macro.dbt_utils.bigquery__safe_cast", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/safe_cast.sql", "original_file_path": "macros/cross_db_utils/safe_cast.sql", "name": "bigquery__safe_cast", "macro_sql": "{% macro bigquery__safe_cast(field, type) %}\n    safe_cast({{field}} as {{type}})\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.2984395}, "macro.dbt_utils.last_day": {"unique_id": "macro.dbt_utils.last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/last_day.sql", "original_file_path": "macros/cross_db_utils/last_day.sql", "name": "last_day", "macro_sql": "{% macro last_day(date, datepart) %}\n  {{ return(adapter.dispatch('last_day', 'dbt_utils') (date, datepart)) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.299639}, "macro.dbt_utils.default_last_day": {"unique_id": "macro.dbt_utils.default_last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/last_day.sql", "original_file_path": "macros/cross_db_utils/last_day.sql", "name": "default_last_day", "macro_sql": "\n\n\n{%- macro default_last_day(date, datepart) -%}\n    cast(\n        {{dbt_utils.dateadd('day', '-1',\n        dbt_utils.dateadd(datepart, '1', dbt_utils.date_trunc(datepart, date))\n        )}}\n        as date)\n{%- endmacro -%}\n\n\n", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.3002625}, "macro.dbt_utils.default__last_day": {"unique_id": "macro.dbt_utils.default__last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/last_day.sql", "original_file_path": "macros/cross_db_utils/last_day.sql", "name": "default__last_day", "macro_sql": "{% macro default__last_day(date, datepart) -%}\n    {{dbt_utils.default_last_day(date, datepart)}}\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.3006024}, "macro.dbt_utils.postgres__last_day": {"unique_id": "macro.dbt_utils.postgres__last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/last_day.sql", "original_file_path": "macros/cross_db_utils/last_day.sql", "name": "postgres__last_day", "macro_sql": "{% macro postgres__last_day(date, datepart) -%}\n\n    {%- if datepart == 'quarter' -%}\n    -- postgres dateadd does not support quarter interval.\n    cast(\n        {{dbt_utils.dateadd('day', '-1',\n        dbt_utils.dateadd('month', '3', dbt_utils.date_trunc(datepart, date))\n        )}}\n        as date)\n    {%- else -%}\n    {{dbt_utils.default_last_day(date, datepart)}}\n    {%- endif -%}\n\n{%- endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.dateadd", "macro.dbt_utils.date_trunc", "macro.dbt_utils.default_last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.3015916}, "macro.dbt_utils.redshift__last_day": {"unique_id": "macro.dbt_utils.redshift__last_day", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/last_day.sql", "original_file_path": "macros/cross_db_utils/last_day.sql", "name": "redshift__last_day", "macro_sql": "{% macro redshift__last_day(date, datepart) %}\n\n    {{ return(dbt_utils.default__last_day(date, datepart)) }}\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__last_day"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.302002}, "macro.dbt_utils.intersect": {"unique_id": "macro.dbt_utils.intersect", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/intersect.sql", "original_file_path": "macros/cross_db_utils/intersect.sql", "name": "intersect", "macro_sql": "{% macro intersect() %}\n  {{ return(adapter.dispatch('intersect', 'dbt_utils')()) }}\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": ["macro.dbt_utils.default__intersect"]}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.3026886}, "macro.dbt_utils.default__intersect": {"unique_id": "macro.dbt_utils.default__intersect", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/intersect.sql", "original_file_path": "macros/cross_db_utils/intersect.sql", "name": "default__intersect", "macro_sql": "{% macro default__intersect() %}\n\n    intersect\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.3028703}, "macro.dbt_utils.bigquery__intersect": {"unique_id": "macro.dbt_utils.bigquery__intersect", "package_name": "dbt_utils", "root_path": "/usr/src/develop/user-56334/environment-103661/repository-82852/dbt_packages/dbt_utils", "path": "macros/cross_db_utils/intersect.sql", "original_file_path": "macros/cross_db_utils/intersect.sql", "name": "bigquery__intersect", "macro_sql": "{% macro bigquery__intersect() %}\n\n    intersect distinct\n\n{% endmacro %}", "resource_type": "macro", "tags": [], "depends_on": {"macros": []}, "description": "", "meta": {}, "docs": {"show": true}, "patch_path": null, "arguments": [], "created_at": 1659086792.30304}}, "docs": {"dbt.__overview__": {"unique_id": "dbt.__overview__", "package_name": "dbt", "root_path": "/usr/local/lib/python3.8/dist-packages/dbt/include/global_project", "path": "overview.md", "original_file_path": "docs/overview.md", "name": "__overview__", "block_contents": "### Welcome!\n\nWelcome to the auto-generated documentation for your dbt project!\n\n### Navigation\n\nYou can use the `Project` and `Database` navigation tabs on the left side of the window to explore the models\nin your project.\n\n#### Project Tab\nThe `Project` tab mirrors the directory structure of your dbt project. In this tab, you can see all of the\nmodels defined in your dbt project, as well as models imported from dbt packages.\n\n#### Database Tab\nThe `Database` tab also exposes your models, but in a format that looks more like a database explorer. This view\nshows relations (tables and views) grouped into database schemas. Note that ephemeral models are _not_ shown\nin this interface, as they do not exist in the database.\n\n### Graph Exploration\nYou can click the blue icon on the bottom-right corner of the page to view the lineage graph of your models.\n\nOn model pages, you'll see the immediate parents and children of the model you're exploring. By clicking the `Expand`\nbutton at the top-right of this lineage pane, you'll be able to see all of the models that are used to build,\nor are built from, the model you're exploring.\n\nOnce expanded, you'll be able to use the `--select` and `--exclude` model selection syntax to filter the\nmodels in the graph. For more information on model selection, check out the [dbt docs](https://docs.getdbt.com/docs/model-selection-syntax).\n\nNote that you can also right-click on models to interactively filter and explore the graph.\n\n---\n\n### More information\n\n- [What is dbt](https://docs.getdbt.com/docs/introduction)?\n- Read the [dbt viewpoint](https://docs.getdbt.com/docs/viewpoint)\n- [Installation](https://docs.getdbt.com/docs/installation)\n- Join the [dbt Community](https://www.getdbt.com/community/) for questions and discussion"}}, "exposures": {}, "metrics": {}, "selectors": {}, "disabled": {}, "parent_map": {"model.OI_Foundation.ns_opco_gl_trans": ["model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_ns_opco_brand_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_curr", "model.OI_Foundation.v_ns_opco_currency_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "model.OI_Foundation.v_ns_opco_purpose_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.TRANSACTIONS", "source.OI_Foundation.NS_DEV.TRANSACTION_LINES"], "model.OI_Foundation.ns_opco_chart_of_accts_type": [], "model.OI_Foundation.ns_opco_chart_of_accts": ["model.OI_Foundation.chart_of_accts", "model.OI_Foundation.v_ns_opco_brand_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.SUBSIDIARIES"], "model.OI_Foundation.ns_opco_gl_trans_type": ["source.OI_Foundation.NS_DEV.TRANSACTIONS"], "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.fscl_clndr", "model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_ns_opco_brand_curr", "model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_ns_opco_curr", "model.OI_Foundation.v_ns_opco_currency_curr", "model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "model.OI_Foundation.v_ns_opco_purpose_curr", "model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_ns_opco_uom_curr", "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.TRANSACTIONS", "source.OI_Foundation.NS_DEV.TRANSACTION_LINES"], "model.OI_Foundation.v_ns_opco_gl_trans_curr": ["model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr": ["model.OI_Foundation.ns_opco_chart_of_accts_type"], "model.OI_Foundation.v_ns_opco_chart_of_accts_curr": ["model.OI_Foundation.ns_opco_chart_of_accts"], "model.OI_Foundation.v_ns_opco_gl_trans_type_curr": ["model.OI_Foundation.ns_opco_gl_trans_type"], "model.OI_Foundation.v_ns_opco_fscl_yr_gl_opening_bal_curr": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_ns_opco_pymnt_terms_curr": ["model.OI_Foundation.ns_opco_pymnt_terms"], "model.OI_Foundation.v_ns_opco_pymnt_mode_curr": ["model.OI_Foundation.ns_opco_pymnt_mode"], "model.OI_Foundation.v_ns_opco_currency_curr": ["model.OI_Foundation.ns_opco_currency"], "model.OI_Foundation.v_ns_opco_purpose_curr": ["model.OI_Foundation.ns_opco_purpose"], "model.OI_Foundation.v_ns_opco_brand_curr": ["model.OI_Foundation.ns_opco_brand"], "model.OI_Foundation.v_ns_opco_uom_curr": ["model.OI_Foundation.ns_opco_uom"], "model.OI_Foundation.v_ns_opco_type_curr": ["model.OI_Foundation.ns_opco_type"], "model.OI_Foundation.v_ns_region_curr": ["model.OI_Foundation.ns_region"], "model.OI_Foundation.v_ns_sub_region_curr": ["model.OI_Foundation.ns_sub_region"], "model.OI_Foundation.v_ns_opco_dept_curr": ["model.OI_Foundation.ns_opco_dept"], "model.OI_Foundation.v_ns_opco_cost_center_curr": ["model.OI_Foundation.ns_opco_cost_center"], "model.OI_Foundation.v_ns_opco_curr": ["model.OI_Foundation.ns_opco"], "model.OI_Foundation.ns_opco_pymnt_terms": ["source.OI_Foundation.NS_DEV.PAYMENT_TERMS"], "model.OI_Foundation.ns_opco_pymnt_mode": ["source.OI_Foundation.NS_DEV.PAYMENT_METHODS"], "model.OI_Foundation.ns_opco_currency": ["source.OI_Foundation.NS_DEV.CURRENCIES"], "model.OI_Foundation.ns_opco_purpose": ["source.OI_Foundation.NS_DEV.MARKET_OPI"], "model.OI_Foundation.ns_opco_brand": ["source.OI_Foundation.NS_DEV.CLASSES"], "model.OI_Foundation.ns_opco_uom": ["source.OI_Foundation.NS_DEV.UOM"], "model.OI_Foundation.ns_opco_type": ["source.OI_Foundation.NS_DEV.ACCOUNTS", "source.OI_Foundation.NS_DEV.ACCOUNTS"], "model.OI_Foundation.ns_region": ["source.OI_Foundation.NS_DEV.REGION_OPI"], "model.OI_Foundation.ns_opco_dept": ["source.OI_Foundation.NS_DEV.DEPARTMENTS"], "model.OI_Foundation.ns_sub_region": ["source.OI_Foundation.NS_DEV.SUBREGION_OPI"], "model.OI_Foundation.ns_opco_cost_center": ["source.OI_Foundation.NS_DEV.LOCATIONS"], "model.OI_Foundation.ns_opco": ["model.OI_Foundation.v_ns_opco_currency_curr", "source.OI_Foundation.NS_DEV.SUBSIDIARIES"], "model.OI_Foundation.ax_opco_gl_trans": ["model.OI_Foundation.v_ax_fscl_clndr_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.LEDGERTABLE", "source.OI_Foundation.AX_DEV.LEDGERTRANS"], "model.OI_Foundation.ax_opco_gl_trans_posting_type": [], "model.OI_Foundation.ax_opco_chart_of_accts_type": [], "model.OI_Foundation.ax_opco_gl_trans_type": [], "model.OI_Foundation.ax_opco_chart_of_accts": ["model.OI_Foundation.v_ax_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.LEDGERTABLE"], "model.OI_Foundation.ax_chart_of_accts": ["model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.LEDGERTABLE"], "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.LEDGERTABLE", "source.OI_Foundation.AX_DEV.LEDGERTRANS"], "model.OI_Foundation.v_ax_opco_gl_trans_curr": ["model.OI_Foundation.ax_opco_gl_trans"], "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr": ["model.OI_Foundation.ax_opco_gl_trans_posting_type"], "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr": ["model.OI_Foundation.ax_opco_chart_of_accts_type"], "model.OI_Foundation.v_ax_opco_gl_trans_type_curr": ["model.OI_Foundation.ax_opco_gl_trans_type"], "model.OI_Foundation.v_ax_opco_chart_of_accts_curr": ["model.OI_Foundation.ax_opco_chart_of_accts"], "model.OI_Foundation.v_ax_chart_of_accts_curr": ["model.OI_Foundation.ax_chart_of_accts"], "model.OI_Foundation.v_ax_opco_fscl_yr_gl_opening_bal_curr": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_ax_opco_cust_settled_trans_curr": ["model.OI_Foundation.ax_opco_cust_settled_trans"], "model.OI_Foundation.v_ax_opco_pymnt_terms_curr": ["model.OI_Foundation.ax_opco_pymnt_terms"], "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr": ["model.OI_Foundation.ax_opco_cust_packing_slip"], "model.OI_Foundation.v_ax_opco_cust_invoice_line_curr": ["model.OI_Foundation.ax_opco_cust_invoice_line"], "model.OI_Foundation.v_ax_opco_cust_trans_curr": ["model.OI_Foundation.ax_opco_cust_trans"], "model.OI_Foundation.v_ax_opco_pymnt_mode_curr": ["model.OI_Foundation.ax_opco_pymnt_mode"], "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr": ["model.OI_Foundation.ax_opco_cash_dscnt_terms"], "model.OI_Foundation.v_ax_opco_cust_type_curr": ["model.OI_Foundation.ax_opco_cust_type"], "model.OI_Foundation.v_ax_opco_picking_list_curr": ["model.OI_Foundation.ax_opco_picking_list"], "model.OI_Foundation.v_ax_opco_handling_status_curr": ["model.OI_Foundation.ax_opco_handling_status"], "model.OI_Foundation.v_ax_opco_currency_curr": ["model.OI_Foundation.ax_opco_currency"], "model.OI_Foundation.v_ax_opco_cust_invoice_curr": ["model.OI_Foundation.ax_opco_cust_invoice"], "model.OI_Foundation.v_ax_opco_opco_cust_xref_curr": ["model.OI_Foundation.ax_opco_opco_cust_xref"], "model.OI_Foundation.v_ax_opco_cust_curr": ["model.OI_Foundation.ax_opco_cust"], "model.OI_Foundation.v_ax_opco_cust_open_trans_curr": ["model.OI_Foundation.ax_opco_cust_open_trans"], "model.OI_Foundation.v_ax_opco_cust_grp_curr": ["model.OI_Foundation.ax_opco_cust_grp"], "model.OI_Foundation.v_ax_opco_commsn_grp_curr": ["model.OI_Foundation.ax_opco_commsn_grp"], "model.OI_Foundation.v_ax_opco_cust_code_curr": ["model.OI_Foundation.ax_opco_cust_code"], "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr": ["model.OI_Foundation.ax_opco_invtry_ref_type"], "model.OI_Foundation.v_ax_opco_cust_packing_slip_line_curr": ["model.OI_Foundation.ax_opco_cust_packing_slip_line"], "model.OI_Foundation.v_ax_opco_po_line_curr": ["model.OI_Foundation.ax_opco_po_line"], "model.OI_Foundation.v_ax_opco_po_type_curr": ["model.OI_Foundation.ax_opco_po_type"], "model.OI_Foundation.v_ax_opco_po_curr": ["model.OI_Foundation.ax_opco_po"], "model.OI_Foundation.v_ax_opco_po_doc_status_curr": ["model.OI_Foundation.ax_opco_po_doc_status"], "model.OI_Foundation.v_ax_opco_vendor_invoice_curr": ["model.OI_Foundation.ax_opco_vendor_invoice"], "model.OI_Foundation.v_ax_opco_vendor_packing_slip_line_curr": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_opco_vendor_trans_curr": ["model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_vendor_invoice_line_curr": ["model.OI_Foundation.ax_opco_vendor_invoice_line"], "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr": ["model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_ax_opco_item_invtry_curr": ["model.OI_Foundation.ax_opco_item_invtry"], "model.OI_Foundation.v_ax_opco_item_subtype_curr": ["model.OI_Foundation.ax_opco_item_subtype"], "model.OI_Foundation.v_ax_opco_purpose_curr": ["model.OI_Foundation.ax_opco_purpose"], "model.OI_Foundation.v_ax_opco_vendor_curr": ["model.OI_Foundation.ax_opco_vendor"], "model.OI_Foundation.v_ax_opco_item_opco_assctn_xref_curr": ["model.OI_Foundation.ax_opco_item_opco_assctn_xref"], "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr": ["model.OI_Foundation.ax_opco_invtry_trans_type"], "model.OI_Foundation.v_ax_opco_item_class_curr": ["model.OI_Foundation.ax_opco_item_class"], "model.OI_Foundation.v_ax_opco_item_type_curr": ["model.OI_Foundation.ax_opco_item_type"], "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr": ["model.OI_Foundation.ax_opco_item_cvrg_grp"], "model.OI_Foundation.v_ax_opco_invtry_trans_curr": ["model.OI_Foundation.ax_opco_invtry_trans"], "model.OI_Foundation.v_ax_opco_item_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_item_model_grp_curr": ["model.OI_Foundation.ax_opco_item_model_grp"], "model.OI_Foundation.v_ax_opco_item_grp_curr": ["model.OI_Foundation.ax_opco_item_grp"], "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr": ["model.OI_Foundation.ax_opco_invtry_rcpt_status"], "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr": ["model.OI_Foundation.ax_opco_invtry_issue_status"], "model.OI_Foundation.v_ax_opco_item_freight_curr": ["model.OI_Foundation.ax_opco_item_freight"], "model.OI_Foundation.v_ax_opco_lob_curr": ["model.OI_Foundation.ax_opco_lob"], "model.OI_Foundation.v_ax_opco_item_psi_dtl_curr": ["model.OI_Foundation.ax_opco_item_psi_dtl"], "model.OI_Foundation.v_ax_opco_item_sls_class_curr": ["model.OI_Foundation.ax_opco_item_sls_class"], "model.OI_Foundation.v_ax_opco_uom_curr": ["model.OI_Foundation.ax_opco_uom"], "model.OI_Foundation.v_ax_opco_item_size_curr": ["model.OI_Foundation.ax_opco_item_size"], "model.OI_Foundation.v_ax_opco_cust_opco_locn_xref_curr": ["model.OI_Foundation.ax_opco_cust_opco_locn_xref"], "model.OI_Foundation.v_ax_opco_locn_curr": ["model.OI_Foundation.ax_opco_locn"], "model.OI_Foundation.v_ax_opco_opco_locn_xref_curr": ["model.OI_Foundation.ax_opco_opco_locn_xref"], "model.OI_Foundation.v_ax_opco_vendor_opco_locn_xref_curr": ["model.OI_Foundation.ax_opco_vendor_opco_locn_xref"], "model.OI_Foundation.v_ax_fscl_clndr_curr": ["model.OI_Foundation.ax_fscl_clndr"], "model.OI_Foundation.v_ax_opco_type_curr": ["model.OI_Foundation.ax_opco_type"], "model.OI_Foundation.v_ax_opco_assctn_curr": ["model.OI_Foundation.ax_opco_assctn"], "model.OI_Foundation.v_ax_region_curr": ["model.OI_Foundation.ax_region"], "model.OI_Foundation.v_ax_warehouse_curr": ["model.OI_Foundation.ax_warehouse"], "model.OI_Foundation.v_ax_opco_dept_curr": ["model.OI_Foundation.ax_opco_dept"], "model.OI_Foundation.v_ax_sub_region_curr": ["model.OI_Foundation.ax_sub_region"], "model.OI_Foundation.v_ax_opco_site_curr": ["model.OI_Foundation.ax_opco_site"], "model.OI_Foundation.v_ax_opco_curr": ["model.OI_Foundation.ax_opco"], "model.OI_Foundation.v_ax_opco_cost_center_curr": ["model.OI_Foundation.ax_opco_cost_center"], "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr": ["model.OI_Foundation.ax_opco_sls_ordr_doc_status"], "model.OI_Foundation.v_ax_opco_sls_ordr_curr": ["model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_ax_opco_dlvry_terms_curr": ["model.OI_Foundation.ax_opco_dlvry_terms"], "model.OI_Foundation.v_ax_opco_trans_status_curr": ["model.OI_Foundation.ax_opco_trans_status"], "model.OI_Foundation.v_ax_opco_sls_ordr_line_curr": ["model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_ax_sls_ordr_opco_locn_xref_curr": ["model.OI_Foundation.ax_sls_ordr_opco_locn_xref"], "model.OI_Foundation.v_ax_opco_dlvry_mode_curr": ["model.OI_Foundation.ax_opco_dlvry_mode"], "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr": ["model.OI_Foundation.ax_opco_sls_ordr_type"], "model.OI_Foundation.v_ax_opco_project_cost_trans_curr": ["model.OI_Foundation.ax_opco_project_cost_trans"], "model.OI_Foundation.v_ax_opco_project_item_trans_curr": ["model.OI_Foundation.ax_opco_project_item_trans"], "model.OI_Foundation.v_ax_opco_project_cost_frcst_curr": ["model.OI_Foundation.ax_opco_project_cost_frcst"], "model.OI_Foundation.v_ax_opco_project_catgry_curr": ["model.OI_Foundation.ax_opco_project_catgry"], "model.OI_Foundation.v_ax_opco_project_empl_trans_curr": ["model.OI_Foundation.ax_opco_project_empl_trans"], "model.OI_Foundation.v_ax_opco_project_revenue_trans_curr": ["model.OI_Foundation.ax_opco_project_revenue_trans"], "model.OI_Foundation.v_ax_opco_project_curr": ["model.OI_Foundation.ax_opco_project"], "model.OI_Foundation.v_ax_opco_project_invoice_project_xref_curr": ["model.OI_Foundation.ax_opco_project_invoice_project_xref"], "model.OI_Foundation.v_ax_opco_project_empl_frcst_curr": ["model.OI_Foundation.ax_opco_project_empl_frcst"], "model.OI_Foundation.v_ax_opco_project_trans_origin_curr": ["model.OI_Foundation.ax_opco_project_trans_origin"], "model.OI_Foundation.v_ax_opco_project_trans_status_curr": ["model.OI_Foundation.ax_opco_project_trans_status"], "model.OI_Foundation.v_ax_opco_project_trans_posting_curr": ["model.OI_Foundation.ax_opco_project_trans_posting"], "model.OI_Foundation.ax_opco_cust_settled_trans": ["model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.CUSTSETTLEMENT"], "model.OI_Foundation.ax_opco_pymnt_terms": ["source.OI_Foundation.AX_DEV.PAYMTERM"], "model.OI_Foundation.ax_opco_cust_invoice_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.CUSTINVOICETRANS"], "model.OI_Foundation.ax_opco_cust_packing_slip": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_warehouse_curr", "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR"], "model.OI_Foundation.ax_opco_cust_trans": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.CUSTTRANS"], "model.OI_Foundation.ax_opco_pymnt_mode": ["source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE"], "model.OI_Foundation.ax_opco_cash_dscnt_terms": ["source.OI_Foundation.AX_DEV.CASHDISC"], "model.OI_Foundation.ax_opco_picking_list": ["model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_handling_status_curr", "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_site_curr", "source.OI_Foundation.AX_DEV.WMSPICKINGROUTE"], "model.OI_Foundation.ax_opco_cust_type": ["source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI"], "model.OI_Foundation.ax_opco_handling_status": [], "model.OI_Foundation.ax_opco_cust_invoice": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR"], "model.OI_Foundation.ax_opco_currency": ["source.OI_Foundation.AX_DEV.CURRENCY"], "model.OI_Foundation.ax_opco_opco_cust_xref": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_commsn_grp_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_code_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_cust_type_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "source.OI_Foundation.AX_DEV.CUSTTABLE"], "model.OI_Foundation.ax_opco_cust": ["source.OI_Foundation.AX_DEV.CUSTTABLE"], "model.OI_Foundation.ax_opco_cust_grp": ["source.OI_Foundation.AX_DEV.CUSTGROUP"], "model.OI_Foundation.ax_opco_cust_open_trans": ["model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_trans_curr", "source.OI_Foundation.AX_DEV.CUSTTRANSOPEN"], "model.OI_Foundation.ax_opco_commsn_grp": ["source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP"], "model.OI_Foundation.ax_opco_cust_packing_slip_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS"], "model.OI_Foundation.ax_opco_invtry_ref_type": [], "model.OI_Foundation.ax_opco_cust_code": ["source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI"], "model.OI_Foundation.ax_opco_po_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.PURCHLINE"], "model.OI_Foundation.ax_opco_po_type": [], "model.OI_Foundation.ax_opco_po": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_po_doc_status_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_warehouse_curr", "source.OI_Foundation.AX_DEV.PURCHTABLE"], "model.OI_Foundation.ax_opco_po_doc_status": [], "model.OI_Foundation.ax_opco_vendor_invoice": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.VENDINVOICEJOUR"], "model.OI_Foundation.ax_opco_vendor_packing_slip_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr", "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS"], "model.OI_Foundation.ax_opco_vendor_trans": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.VENDTRANS"], "model.OI_Foundation.ax_opco_vendor_packing_slip": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR"], "model.OI_Foundation.ax_opco_vendor_invoice_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_vendor_invoice_curr", "source.OI_Foundation.AX_DEV.VENDINVOICETRANS"], "model.OI_Foundation.ax_opco_item_invtry": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_item_curr", "source.OI_Foundation.AX_DEV.INVENTSUM"], "model.OI_Foundation.ax_opco_item_subtype": ["source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI"], "model.OI_Foundation.ax_opco_vendor": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.VENDTABLE"], "model.OI_Foundation.ax_opco_item_opco_assctn_xref": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_item_curr", "source.OI_Foundation.AX_DEV.INVENTITEMLOCATION"], "model.OI_Foundation.ax_opco_purpose": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"], "model.OI_Foundation.ax_opco_invtry_trans_type": [], "model.OI_Foundation.ax_opco_item_class": ["source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI"], "model.OI_Foundation.ax_opco_item_type": ["source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI"], "model.OI_Foundation.ax_opco_item_cvrg_grp": ["source.OI_Foundation.AX_DEV.REQGROUP"], "model.OI_Foundation.ax_opco_invtry_trans": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr", "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr", "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.INVENTTRANS"], "model.OI_Foundation.ax_opco_item": ["model.OI_Foundation.v_ax_opco_commsn_grp_curr", "model.OI_Foundation.v_ax_opco_item_class_curr", "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr", "model.OI_Foundation.v_ax_opco_item_grp_curr", "model.OI_Foundation.v_ax_opco_item_model_grp_curr", "model.OI_Foundation.v_ax_opco_item_sls_class_curr", "model.OI_Foundation.v_ax_opco_item_subtype_curr", "model.OI_Foundation.v_ax_opco_item_type_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.INVENTTABLE"], "model.OI_Foundation.ax_opco_invtry_issue_status": [], "model.OI_Foundation.ax_opco_item_model_grp": ["source.OI_Foundation.AX_DEV.INVENTMODELGROUP"], "model.OI_Foundation.ax_opco_item_grp": ["model.OI_Foundation.v_ax_opco_item_freight_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.INVENTITEMGROUP"], "model.OI_Foundation.ax_opco_invtry_rcpt_status": [], "model.OI_Foundation.ax_opco_item_freight": ["source.OI_Foundation.AX_DEV.INVENTITEMGROUP", "source.OI_Foundation.AX_DEV.INVENTTABLE"], "model.OI_Foundation.ax_opco_item_psi_dtl": ["model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.INVENTTABLEMODULE"], "model.OI_Foundation.ax_opco_lob": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"], "model.OI_Foundation.ax_opco_item_sls_class": ["source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI"], "model.OI_Foundation.ax_opco_uom": ["source.OI_Foundation.AX_DEV.UNIT"], "model.OI_Foundation.ax_opco_item_size": ["model.OI_Foundation.v_ax_opco_item_curr", "source.OI_Foundation.AX_DEV.INVENTSIZE"], "model.OI_Foundation.ax_opco_cust_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "source.OI_Foundation.AX_DEV.CONTACTPERSON", "source.OI_Foundation.AX_DEV.CUSTTABLE"], "model.OI_Foundation.ax_opco_locn": ["source.OI_Foundation.AX_DEV.ADDRESS", "source.OI_Foundation.AX_DEV.COMPANYINFO", "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR", "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR", "source.OI_Foundation.AX_DEV.CUSTTABLE", "source.OI_Foundation.AX_DEV.PROJTABLE", "source.OI_Foundation.AX_DEV.PURCHTABLE", "source.OI_Foundation.AX_DEV.SALESTABLE", "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR", "source.OI_Foundation.AX_DEV.VENDTABLE"], "model.OI_Foundation.ax_opco_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "source.OI_Foundation.AX_DEV.COMPANYINFO"], "model.OI_Foundation.ax_opco_vendor_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_vendor_curr", "source.OI_Foundation.AX_DEV.VENDTABLE"], "model.OI_Foundation.ax_fscl_clndr": ["source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93"], "model.OI_Foundation.ax_opco_type": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"], "model.OI_Foundation.ax_opco_assctn": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_warehouse_curr", "source.OI_Foundation.AX_DEV.INVENTDIM"], "model.OI_Foundation.ax_region": ["source.OI_Foundation.AX_DEV.COMPANYINFO"], "model.OI_Foundation.ax_warehouse": ["source.OI_Foundation.AX_DEV.INVENTLOCATION"], "model.OI_Foundation.ax_sub_region": ["source.OI_Foundation.AX_DEV.COMPANYINFO"], "model.OI_Foundation.ax_opco_dept": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"], "model.OI_Foundation.ax_opco_site": ["source.OI_Foundation.AX_DEV.INVENTSITE"], "model.OI_Foundation.ax_opco": ["model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_region_curr", "model.OI_Foundation.v_ax_sub_region_curr", "source.OI_Foundation.AX_DEV.COMPANYINFO"], "model.OI_Foundation.ax_opco_cost_center": ["source.OI_Foundation.AX_DEV.DIMENSIONS", "source.OI_Foundation.AX_DEV.DIMENSIONS"], "model.OI_Foundation.ax_opco_sls_ordr_doc_status": [], "model.OI_Foundation.ax_opco_sls_ordr": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_warehouse_curr", "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP", "source.OI_Foundation.AX_DEV.PRICEDISCGROUP", "source.OI_Foundation.AX_DEV.SALESTABLE"], "model.OI_Foundation.ax_opco_trans_status": [], "model.OI_Foundation.ax_opco_dlvry_terms": ["source.OI_Foundation.AX_DEV.DLVTERM"], "model.OI_Foundation.ax_opco_sls_ordr_line": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.SALESLINE"], "model.OI_Foundation.ax_sls_ordr_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_locn_curr", "source.OI_Foundation.AX_DEV.CONTACTPERSON", "source.OI_Foundation.AX_DEV.SALESTABLE"], "model.OI_Foundation.ax_opco_dlvry_mode": ["source.OI_Foundation.AX_DEV.DLVMODE"], "model.OI_Foundation.ax_opco_sls_ordr_type": [], "model.OI_Foundation.ax_opco_project_cost_trans": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.PROJCOSTTRANS"], "model.OI_Foundation.ax_opco_project_item_trans": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.PROJITEMTRANS"], "model.OI_Foundation.ax_opco_project_catgry": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.PROJCATEGORY"], "model.OI_Foundation.ax_opco_project_cost_frcst": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.PROJFORECASTCOST"], "model.OI_Foundation.ax_opco_project_empl_trans": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.PROJEMPLTRANS"], "model.OI_Foundation.ax_opco_project": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.PROJTABLE"], "model.OI_Foundation.ax_opco_project_revenue_trans": ["model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_project_curr", "source.OI_Foundation.AX_DEV.PROJREVENUE_OPI"], "model.OI_Foundation.ax_opco_project_invoice_project_xref": ["model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_curr", "source.OI_Foundation.AX_DEV.PROJTABLE"], "model.OI_Foundation.ax_opco_project_trans_origin": [], "model.OI_Foundation.ax_opco_project_empl_frcst": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_ax_opco_uom_curr", "source.OI_Foundation.AX_DEV.PROJFORECASTEMPL"], "model.OI_Foundation.ax_opco_project_trans_posting": ["model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_ax_opco_type_curr", "source.OI_Foundation.AX_DEV.PROJTRANSPOSTING"], "model.OI_Foundation.ax_opco_project_trans_status": [], "model.OI_Foundation.primex_opco_gl_trans": ["model.OI_Foundation.v_primex_opco_chart_of_accts_curr", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_curr", "model.OI_Foundation.v_primex_opco_currency_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_gl_trans_type_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr", "model.OI_Foundation.v_primex_opco_type_curr", "model.OI_Foundation.v_primex_opco_uom_curr"], "model.OI_Foundation.primex_opco_chart_of_accts_type": [], "model.OI_Foundation.primex_opco_chart_of_accts": ["model.OI_Foundation.chart_of_accts", "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_type_curr"], "model.OI_Foundation.primex_opco_gl_trans_type": [], "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_primex_opco_chart_of_accts_curr", "model.OI_Foundation.v_primex_opco_cost_center_curr", "model.OI_Foundation.v_primex_opco_curr", "model.OI_Foundation.v_primex_opco_dept_curr", "model.OI_Foundation.v_primex_opco_lob_curr", "model.OI_Foundation.v_primex_opco_purpose_curr", "model.OI_Foundation.v_primex_opco_type_curr"], "model.OI_Foundation.primex_opco_sub_ledger_type": [], "model.OI_Foundation.v_primex_opco_gl_trans_curr": ["model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr": ["model.OI_Foundation.primex_opco_chart_of_accts_type"], "model.OI_Foundation.v_primex_opco_chart_of_accts_curr": ["model.OI_Foundation.primex_opco_chart_of_accts"], "model.OI_Foundation.v_primex_opco_gl_trans_type_curr": ["model.OI_Foundation.primex_opco_gl_trans_type"], "model.OI_Foundation.v_primex_opco_fscl_yr_gl_opening_bal_curr": ["model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr": ["model.OI_Foundation.primex_opco_sub_ledger_type"], "model.OI_Foundation.v_primex_opco_currency_curr": ["model.OI_Foundation.primex_opco_currency"], "model.OI_Foundation.v_primex_opco_purpose_curr": ["model.OI_Foundation.primex_opco_purpose"], "model.OI_Foundation.v_primex_opco_uom_curr": ["model.OI_Foundation.primex_opco_uom"], "model.OI_Foundation.v_primex_opco_lob_curr": ["model.OI_Foundation.primex_opco_lob"], "model.OI_Foundation.v_primex_opco_type_curr": ["model.OI_Foundation.primex_opco_type"], "model.OI_Foundation.v_primex_opco_curr": ["model.OI_Foundation.primex_opco"], "model.OI_Foundation.v_primex_opco_cost_center_curr": ["model.OI_Foundation.primex_opco_cost_center"], "model.OI_Foundation.v_primex_opco_dept_curr": ["model.OI_Foundation.primex_opco_dept"], "model.OI_Foundation.primex_opco_currency": [], "model.OI_Foundation.primex_opco_purpose": [], "model.OI_Foundation.primex_opco_uom": [], "model.OI_Foundation.primex_opco_lob": [], "model.OI_Foundation.primex_opco_type": [], "model.OI_Foundation.primex_opco": ["model.OI_Foundation.v_primex_opco_currency_curr"], "model.OI_Foundation.primex_opco_cost_center": [], "model.OI_Foundation.primex_opco_dept": [], "model.OI_Foundation.jde_opco_gl_trans": ["model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_curr", "model.OI_Foundation.v_jde_opco_currency_curr", "model.OI_Foundation.v_jde_opco_gl_trans_type_curr", "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr", "model.OI_Foundation.v_jde_opco_uom_curr", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911"], "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.fscl_clndr", "model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_curr", "model.OI_Foundation.v_jde_opco_currency_curr", "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902"], "model.OI_Foundation.jde_opco_sub_ledger_type": [], "model.OI_Foundation.jde_opco_chart_of_accts": ["model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_jde_opco_uom_curr", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901"], "model.OI_Foundation.jde_opco_gl_trans_type": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005"], "model.OI_Foundation.v_jde_opco_gl_trans_curr": ["model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_fscl_yr_gl_opening_bal_curr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr": ["model.OI_Foundation.jde_opco_sub_ledger_type"], "model.OI_Foundation.v_jde_opco_chart_of_accts_curr": ["model.OI_Foundation.jde_opco_chart_of_accts"], "model.OI_Foundation.v_jde_opco_gl_trans_type_curr": ["model.OI_Foundation.jde_opco_gl_trans_type"], "model.OI_Foundation.v_jde_opco_currency_curr": ["model.OI_Foundation.jde_opco_currency"], "model.OI_Foundation.v_jde_opco_uom_curr": ["model.OI_Foundation.jde_opco_uom"], "model.OI_Foundation.v_jde_opco_curr": ["model.OI_Foundation.jde_opco"], "model.OI_Foundation.v_jde_opco_cost_center_curr": ["model.OI_Foundation.jde_opco_cost_center"], "model.OI_Foundation.jde_opco_currency": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013"], "model.OI_Foundation.jde_opco_uom": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005"], "model.OI_Foundation.jde_opco": ["model.OI_Foundation.jde_opco_currency", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101", "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151"], "model.OI_Foundation.jde_opco_cost_center": ["source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006"], "model.OI_Foundation._foundation_load_config": [], "model.OI_Foundation.opco_gl_trans": ["model.OI_Foundation.v_opco_gl_trans_lineage"], "model.OI_Foundation.opco_gl_trans_posting_type": ["model.OI_Foundation.v_opco_gl_trans_posting_type_lineage"], "model.OI_Foundation.opco_chart_of_accts_type": ["model.OI_Foundation.v_opco_chart_of_accts_type_lineage"], "model.OI_Foundation.chart_of_accts": ["model.OI_Foundation.v_chart_of_accts_lineage"], "model.OI_Foundation.opco_chart_of_accts": ["model.OI_Foundation.v_opco_chart_of_accts_lineage"], "model.OI_Foundation.opco_gl_trans_type": ["model.OI_Foundation.v_opco_gl_trans_type_lineage"], "model.OI_Foundation.opco_sub_ledger_type": ["model.OI_Foundation.v_opco_sub_ledger_type_lineage"], "model.OI_Foundation.opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage"], "model.OI_Foundation.opco_cust_invoice_line": ["model.OI_Foundation.v_opco_cust_invoice_line_lineage"], "model.OI_Foundation.opco_cust_packing_slip": ["model.OI_Foundation.v_opco_cust_packing_slip_lineage"], "model.OI_Foundation.opco_pymnt_terms": ["model.OI_Foundation.v_opco_pymnt_terms_lineage"], "model.OI_Foundation.opco_cust_settled_trans": ["model.OI_Foundation.v_opco_cust_settled_trans_lineage"], "model.OI_Foundation.opco_cust_trans": ["model.OI_Foundation.v_opco_cust_trans_lineage"], "model.OI_Foundation.opco_cash_dscnt_terms": ["model.OI_Foundation.v_opco_cash_dscnt_terms_lineage"], "model.OI_Foundation.opco_pymnt_mode": ["model.OI_Foundation.v_opco_pymnt_mode_lineage"], "model.OI_Foundation.opco_handling_status": ["model.OI_Foundation.v_opco_handling_status_lineage"], "model.OI_Foundation.opco_picking_list": ["model.OI_Foundation.v_opco_picking_list_lineage"], "model.OI_Foundation.opco_cust_type": ["model.OI_Foundation.v_opco_cust_type_lineage"], "model.OI_Foundation.opco_opco_cust_xref": ["model.OI_Foundation.v_opco_opco_cust_xref_lineage"], "model.OI_Foundation.opco_currency": ["model.OI_Foundation.v_opco_currency_lineage"], "model.OI_Foundation.opco_cust_invoice": ["model.OI_Foundation.v_opco_cust_invoice_lineage"], "model.OI_Foundation.opco_cust_grp": ["model.OI_Foundation.v_opco_cust_grp_lineage"], "model.OI_Foundation.opco_cust_open_trans": ["model.OI_Foundation.v_opco_cust_open_trans_lineage"], "model.OI_Foundation.opco_cust": ["model.OI_Foundation.v_opco_cust_lineage"], "model.OI_Foundation.opco_commsn_grp": ["model.OI_Foundation.v_opco_commsn_grp_lineage"], "model.OI_Foundation.opco_cust_packing_slip_line": ["model.OI_Foundation.v_opco_cust_packing_slip_line_lineage"], "model.OI_Foundation.opco_cust_code": ["model.OI_Foundation.v_opco_cust_code_lineage"], "model.OI_Foundation.opco_invtry_ref_type": ["model.OI_Foundation.v_opco_invtry_ref_type_lineage"], "model.OI_Foundation.opco_po_line": ["model.OI_Foundation.v_opco_po_line_lineage"], "model.OI_Foundation.opco_po_type": ["model.OI_Foundation.v_opco_po_type_lineage"], "model.OI_Foundation.opco_po_doc_status": ["model.OI_Foundation.v_opco_po_doc_status_lineage"], "model.OI_Foundation.opco_po": ["model.OI_Foundation.v_opco_po_lineage"], "model.OI_Foundation.opco_vendor_invoice": ["model.OI_Foundation.v_opco_vendor_invoice_lineage"], "model.OI_Foundation.opco_vendor_packing_slip_line": ["model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage"], "model.OI_Foundation.opco_vendor_trans": ["model.OI_Foundation.v_opco_vendor_trans_lineage"], "model.OI_Foundation.opco_vendor_invoice_line": ["model.OI_Foundation.v_opco_vendor_invoice_line_lineage"], "model.OI_Foundation.opco_vendor_packing_slip": ["model.OI_Foundation.v_opco_vendor_packing_slip_lineage"], "model.OI_Foundation.opco_item_invtry": ["model.OI_Foundation.v_opco_item_invtry_lineage"], "model.OI_Foundation.opco_item_subtype": ["model.OI_Foundation.v_opco_item_subtype_lineage"], "model.OI_Foundation.opco_vendor": ["model.OI_Foundation.v_opco_vendor_lineage"], "model.OI_Foundation.opco_purpose": ["model.OI_Foundation.v_opco_purpose_lineage"], "model.OI_Foundation.opco_item_opco_assctn_xref": ["model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage"], "model.OI_Foundation.opco_invtry_trans_type": ["model.OI_Foundation.v_opco_invtry_trans_type_lineage"], "model.OI_Foundation.opco_item_class": ["model.OI_Foundation.v_opco_item_class_lineage"], "model.OI_Foundation.opco_item_cvrg_grp": ["model.OI_Foundation.v_opco_item_cvrg_grp_lineage"], "model.OI_Foundation.opco_item_type": ["model.OI_Foundation.v_opco_item_type_lineage"], "model.OI_Foundation.opco_invtry_trans": ["model.OI_Foundation.v_opco_invtry_trans_lineage"], "model.OI_Foundation.opco_item_freight": ["model.OI_Foundation.v_opco_item_freight_lineage"], "model.OI_Foundation.opco_brand": ["model.OI_Foundation.v_opco_brand_lineage"], "model.OI_Foundation.opco_invtry_rcpt_status": ["model.OI_Foundation.v_opco_invtry_rcpt_status_lineage"], "model.OI_Foundation.opco_item_grp": ["model.OI_Foundation.v_opco_item_grp_lineage"], "model.OI_Foundation.opco_invtry_issue_status": ["model.OI_Foundation.v_opco_invtry_issue_status_lineage"], "model.OI_Foundation.opco_item_model_grp": ["model.OI_Foundation.v_opco_item_model_grp_lineage"], "model.OI_Foundation.opco_item": ["model.OI_Foundation.v_opco_item_lineage"], "model.OI_Foundation.opco_item_sls_class": ["model.OI_Foundation.v_opco_item_sls_class_lineage"], "model.OI_Foundation.opco_lob": ["model.OI_Foundation.v_opco_lob_lineage"], "model.OI_Foundation.opco_item_psi_dtl": ["model.OI_Foundation.v_opco_item_psi_dtl_lineage"], "model.OI_Foundation.opco_item_size": ["model.OI_Foundation.v_opco_item_size_lineage"], "model.OI_Foundation.opco_uom": ["model.OI_Foundation.v_opco_uom_lineage"], "model.OI_Foundation.opco_cust_opco_locn_xref": ["model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage"], "model.OI_Foundation.opco_locn": ["model.OI_Foundation.v_opco_locn_lineage"], "model.OI_Foundation.opco_opco_locn_xref": ["model.OI_Foundation.v_opco_opco_locn_xref_lineage"], "model.OI_Foundation.opco_vendor_opco_locn_xref": ["model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage"], "model.OI_Foundation.opco_type": ["model.OI_Foundation.v_opco_type_lineage"], "model.OI_Foundation.fscl_clndr": ["model.OI_Foundation.v_fscl_clndr_lineage"], "model.OI_Foundation.region": ["model.OI_Foundation.v_region_lineage"], "model.OI_Foundation.opco_assctn": ["model.OI_Foundation.v_opco_assctn_lineage"], "model.OI_Foundation.warehouse": ["model.OI_Foundation.v_warehouse_lineage"], "model.OI_Foundation.opco_site": ["model.OI_Foundation.v_opco_site_lineage"], "model.OI_Foundation.sub_region": ["model.OI_Foundation.v_sub_region_lineage"], "model.OI_Foundation.opco_dept": ["model.OI_Foundation.v_opco_dept_lineage"], "model.OI_Foundation.opco_cost_center": ["model.OI_Foundation.v_opco_cost_center_lineage"], "model.OI_Foundation.opco": ["model.OI_Foundation.v_opco_lineage"], "model.OI_Foundation.opco_sls_ordr": ["model.OI_Foundation.v_opco_sls_ordr_lineage"], "model.OI_Foundation.opco_sls_ordr_doc_status": ["model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage"], "model.OI_Foundation.opco_trans_status": ["model.OI_Foundation.v_opco_trans_status_lineage"], "model.OI_Foundation.opco_dlvry_terms": ["model.OI_Foundation.v_opco_dlvry_terms_lineage"], "model.OI_Foundation.sls_ordr_opco_locn_xref": ["model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage"], "model.OI_Foundation.opco_sls_ordr_line": ["model.OI_Foundation.v_opco_sls_ordr_line_lineage"], "model.OI_Foundation.opco_dlvry_mode": ["model.OI_Foundation.v_opco_dlvry_mode_lineage"], "model.OI_Foundation.opco_sls_ordr_type": ["model.OI_Foundation.v_opco_sls_ordr_type_lineage"], "model.OI_Foundation.opco_project_cost_trans": ["model.OI_Foundation.v_opco_project_cost_trans_lineage"], "model.OI_Foundation.opco_project_item_trans": ["model.OI_Foundation.v_opco_project_item_trans_lineage"], "model.OI_Foundation.opco_project_cost_frcst": ["model.OI_Foundation.v_opco_project_cost_frcst_lineage"], "model.OI_Foundation.opco_project_catgry": ["model.OI_Foundation.v_opco_project_catgry_lineage"], "model.OI_Foundation.opco_project_empl_trans": ["model.OI_Foundation.v_opco_project_empl_trans_lineage"], "model.OI_Foundation.opco_project_revenue_trans": ["model.OI_Foundation.v_opco_project_revenue_trans_lineage"], "model.OI_Foundation.opco_project": ["model.OI_Foundation.v_opco_project_lineage"], "model.OI_Foundation.opco_project_trans_origin": ["model.OI_Foundation.v_opco_project_trans_origin_lineage"], "model.OI_Foundation.opco_project_empl_frcst": ["model.OI_Foundation.v_opco_project_empl_frcst_lineage"], "model.OI_Foundation.opco_project_invoice_project_xref": ["model.OI_Foundation.v_opco_project_invoice_project_xref_lineage"], "model.OI_Foundation.opco_project_trans_posting": ["model.OI_Foundation.v_opco_project_trans_posting_lineage"], "model.OI_Foundation.opco_project_trans_status": ["model.OI_Foundation.v_opco_project_trans_status_lineage"], "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_opco_sub_ledger_type_lineage": ["model.OI_Foundation.jde_opco_sub_ledger_type", "model.OI_Foundation.primex_opco_sub_ledger_type"], "model.OI_Foundation.v_opco_gl_trans_type_lineage": ["model.OI_Foundation.ax_opco_gl_trans_type", "model.OI_Foundation.jde_opco_gl_trans_type", "model.OI_Foundation.ns_opco_gl_trans_type", "model.OI_Foundation.primex_opco_gl_trans_type"], "model.OI_Foundation.v_opco_chart_of_accts_lineage": ["model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.jde_opco_chart_of_accts", "model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.primex_opco_chart_of_accts"], "model.OI_Foundation.v_chart_of_accts_lineage": ["model.OI_Foundation.ax_chart_of_accts"], "model.OI_Foundation.v_opco_gl_trans_lineage": ["model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.jde_opco_gl_trans", "model.OI_Foundation.ns_opco_gl_trans", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_opco_gl_trans_posting_type_lineage": ["model.OI_Foundation.ax_opco_gl_trans_posting_type"], "model.OI_Foundation.v_opco_chart_of_accts_type_lineage": ["model.OI_Foundation.ax_opco_chart_of_accts_type", "model.OI_Foundation.ns_opco_chart_of_accts_type", "model.OI_Foundation.primex_opco_chart_of_accts_type"], "model.OI_Foundation.v_opco_cust_packing_slip_line_lineage": ["model.OI_Foundation.ax_opco_cust_packing_slip_line"], "model.OI_Foundation.v_opco_cust_code_lineage": ["model.OI_Foundation.ax_opco_cust_code"], "model.OI_Foundation.v_opco_invtry_ref_type_lineage": ["model.OI_Foundation.ax_opco_invtry_ref_type"], "model.OI_Foundation.v_opco_commsn_grp_lineage": ["model.OI_Foundation.ax_opco_commsn_grp"], "model.OI_Foundation.v_opco_cust_invoice_lineage": ["model.OI_Foundation.ax_opco_cust_invoice"], "model.OI_Foundation.v_opco_currency_lineage": ["model.OI_Foundation.ax_opco_currency", "model.OI_Foundation.jde_opco_currency", "model.OI_Foundation.ns_opco_currency", "model.OI_Foundation.primex_opco_currency"], "model.OI_Foundation.v_opco_opco_cust_xref_lineage": ["model.OI_Foundation.ax_opco_opco_cust_xref"], "model.OI_Foundation.v_opco_cust_lineage": ["model.OI_Foundation.ax_opco_cust"], "model.OI_Foundation.v_opco_cust_open_trans_lineage": ["model.OI_Foundation.ax_opco_cust_open_trans"], "model.OI_Foundation.v_opco_cust_grp_lineage": ["model.OI_Foundation.ax_opco_cust_grp"], "model.OI_Foundation.v_opco_cust_settled_trans_lineage": ["model.OI_Foundation.ax_opco_cust_settled_trans"], "model.OI_Foundation.v_opco_cust_packing_slip_lineage": ["model.OI_Foundation.ax_opco_cust_packing_slip"], "model.OI_Foundation.v_opco_cust_invoice_line_lineage": ["model.OI_Foundation.ax_opco_cust_invoice_line"], "model.OI_Foundation.v_opco_pymnt_terms_lineage": ["model.OI_Foundation.ax_opco_pymnt_terms", "model.OI_Foundation.ns_opco_pymnt_terms"], "model.OI_Foundation.v_opco_cust_trans_lineage": ["model.OI_Foundation.ax_opco_cust_trans"], "model.OI_Foundation.v_opco_pymnt_mode_lineage": ["model.OI_Foundation.ax_opco_pymnt_mode", "model.OI_Foundation.ns_opco_pymnt_mode"], "model.OI_Foundation.v_opco_cash_dscnt_terms_lineage": ["model.OI_Foundation.ax_opco_cash_dscnt_terms"], "model.OI_Foundation.v_opco_picking_list_lineage": ["model.OI_Foundation.ax_opco_picking_list"], "model.OI_Foundation.v_opco_cust_type_lineage": ["model.OI_Foundation.ax_opco_cust_type"], "model.OI_Foundation.v_opco_handling_status_lineage": ["model.OI_Foundation.ax_opco_handling_status"], "model.OI_Foundation.v_opco_po_lineage": ["model.OI_Foundation.ax_opco_po"], "model.OI_Foundation.v_opco_po_doc_status_lineage": ["model.OI_Foundation.ax_opco_po_doc_status"], "model.OI_Foundation.v_opco_po_line_lineage": ["model.OI_Foundation.ax_opco_po_line"], "model.OI_Foundation.v_opco_po_type_lineage": ["model.OI_Foundation.ax_opco_po_type"], "model.OI_Foundation.v_opco_vendor_invoice_line_lineage": ["model.OI_Foundation.ax_opco_vendor_invoice_line"], "model.OI_Foundation.v_opco_vendor_packing_slip_lineage": ["model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_opco_vendor_trans_lineage": ["model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_opco_vendor_invoice_lineage": ["model.OI_Foundation.ax_opco_vendor_invoice"], "model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_opco_item_size_lineage": ["model.OI_Foundation.ax_opco_item_size"], "model.OI_Foundation.v_opco_uom_lineage": ["model.OI_Foundation.ax_opco_uom", "model.OI_Foundation.jde_opco_uom", "model.OI_Foundation.ns_opco_uom", "model.OI_Foundation.primex_opco_uom"], "model.OI_Foundation.v_opco_lob_lineage": ["model.OI_Foundation.ax_opco_lob", "model.OI_Foundation.primex_opco_lob"], "model.OI_Foundation.v_opco_item_psi_dtl_lineage": ["model.OI_Foundation.ax_opco_item_psi_dtl"], "model.OI_Foundation.v_opco_item_sls_class_lineage": ["model.OI_Foundation.ax_opco_item_sls_class"], "model.OI_Foundation.v_opco_invtry_trans_lineage": ["model.OI_Foundation.ax_opco_invtry_trans"], "model.OI_Foundation.v_opco_item_lineage": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_opco_invtry_rcpt_status_lineage": ["model.OI_Foundation.ax_opco_invtry_rcpt_status"], "model.OI_Foundation.v_opco_item_grp_lineage": ["model.OI_Foundation.ax_opco_item_grp"], "model.OI_Foundation.v_opco_item_model_grp_lineage": ["model.OI_Foundation.ax_opco_item_model_grp"], "model.OI_Foundation.v_opco_invtry_issue_status_lineage": ["model.OI_Foundation.ax_opco_invtry_issue_status"], "model.OI_Foundation.v_opco_item_freight_lineage": ["model.OI_Foundation.ax_opco_item_freight"], "model.OI_Foundation.v_opco_brand_lineage": ["model.OI_Foundation.ns_opco_brand"], "model.OI_Foundation.v_opco_item_subtype_lineage": ["model.OI_Foundation.ax_opco_item_subtype"], "model.OI_Foundation.v_opco_item_invtry_lineage": ["model.OI_Foundation.ax_opco_item_invtry"], "model.OI_Foundation.v_opco_purpose_lineage": ["model.OI_Foundation.ax_opco_purpose", "model.OI_Foundation.ns_opco_purpose", "model.OI_Foundation.primex_opco_purpose"], "model.OI_Foundation.v_opco_vendor_lineage": ["model.OI_Foundation.ax_opco_vendor"], "model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage": ["model.OI_Foundation.ax_opco_item_opco_assctn_xref"], "model.OI_Foundation.v_opco_item_class_lineage": ["model.OI_Foundation.ax_opco_item_class"], "model.OI_Foundation.v_opco_invtry_trans_type_lineage": ["model.OI_Foundation.ax_opco_invtry_trans_type"], "model.OI_Foundation.v_opco_item_type_lineage": ["model.OI_Foundation.ax_opco_item_type"], "model.OI_Foundation.v_opco_item_cvrg_grp_lineage": ["model.OI_Foundation.ax_opco_item_cvrg_grp"], "model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage": ["model.OI_Foundation.ax_opco_vendor_opco_locn_xref"], "model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage": ["model.OI_Foundation.ax_opco_cust_opco_locn_xref"], "model.OI_Foundation.v_opco_locn_lineage": ["model.OI_Foundation.ax_opco_locn"], "model.OI_Foundation.v_opco_opco_locn_xref_lineage": ["model.OI_Foundation.ax_opco_opco_locn_xref"], "model.OI_Foundation.v_opco_cost_center_lineage": ["model.OI_Foundation.ax_opco_cost_center", "model.OI_Foundation.jde_opco_cost_center", "model.OI_Foundation.ns_opco_cost_center", "model.OI_Foundation.primex_opco_cost_center"], "model.OI_Foundation.v_opco_lineage": ["model.OI_Foundation.ax_opco", "model.OI_Foundation.jde_opco", "model.OI_Foundation.ns_opco", "model.OI_Foundation.primex_opco"], "model.OI_Foundation.v_sub_region_lineage": ["model.OI_Foundation.ax_sub_region", "model.OI_Foundation.ns_sub_region"], "model.OI_Foundation.v_opco_dept_lineage": ["model.OI_Foundation.ax_opco_dept", "model.OI_Foundation.ns_opco_dept", "model.OI_Foundation.primex_opco_dept"], "model.OI_Foundation.v_opco_site_lineage": ["model.OI_Foundation.ax_opco_site"], "model.OI_Foundation.v_warehouse_lineage": ["model.OI_Foundation.ax_warehouse"], "model.OI_Foundation.v_fscl_clndr_lineage": ["model.OI_Foundation.ax_fscl_clndr"], "model.OI_Foundation.v_opco_type_lineage": ["model.OI_Foundation.ax_opco_type", "model.OI_Foundation.ns_opco_type", "model.OI_Foundation.primex_opco_type"], "model.OI_Foundation.v_opco_assctn_lineage": ["model.OI_Foundation.ax_opco_assctn"], "model.OI_Foundation.v_region_lineage": ["model.OI_Foundation.ax_region", "model.OI_Foundation.ns_region"], "model.OI_Foundation.v_opco_sls_ordr_type_lineage": ["model.OI_Foundation.ax_opco_sls_ordr_type"], "model.OI_Foundation.v_opco_dlvry_mode_lineage": ["model.OI_Foundation.ax_opco_dlvry_mode"], "model.OI_Foundation.v_opco_trans_status_lineage": ["model.OI_Foundation.ax_opco_trans_status"], "model.OI_Foundation.v_opco_dlvry_terms_lineage": ["model.OI_Foundation.ax_opco_dlvry_terms"], "model.OI_Foundation.v_opco_sls_ordr_line_lineage": ["model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage": ["model.OI_Foundation.ax_sls_ordr_opco_locn_xref"], "model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage": ["model.OI_Foundation.ax_opco_sls_ordr_doc_status"], "model.OI_Foundation.v_opco_sls_ordr_lineage": ["model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_opco_project_trans_status_lineage": ["model.OI_Foundation.ax_opco_project_trans_status"], "model.OI_Foundation.v_opco_project_trans_posting_lineage": ["model.OI_Foundation.ax_opco_project_trans_posting"], "model.OI_Foundation.v_opco_project_invoice_project_xref_lineage": ["model.OI_Foundation.ax_opco_project_invoice_project_xref"], "model.OI_Foundation.v_opco_project_empl_frcst_lineage": ["model.OI_Foundation.ax_opco_project_empl_frcst"], "model.OI_Foundation.v_opco_project_trans_origin_lineage": ["model.OI_Foundation.ax_opco_project_trans_origin"], "model.OI_Foundation.v_opco_project_empl_trans_lineage": ["model.OI_Foundation.ax_opco_project_empl_trans"], "model.OI_Foundation.v_opco_project_revenue_trans_lineage": ["model.OI_Foundation.ax_opco_project_revenue_trans"], "model.OI_Foundation.v_opco_project_lineage": ["model.OI_Foundation.ax_opco_project"], "model.OI_Foundation.v_opco_project_cost_trans_lineage": ["model.OI_Foundation.ax_opco_project_cost_trans"], "model.OI_Foundation.v_opco_project_item_trans_lineage": ["model.OI_Foundation.ax_opco_project_item_trans"], "model.OI_Foundation.v_opco_project_cost_frcst_lineage": ["model.OI_Foundation.ax_opco_project_cost_frcst"], "model.OI_Foundation.v_opco_project_catgry_lineage": ["model.OI_Foundation.ax_opco_project_catgry"], "source.OI_Foundation.AX_DEV.INVENTTABLE": [], "source.OI_Foundation.AX_DEV.CUSTTABLE": [], "source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI": [], "source.OI_Foundation.AX_DEV.COMPANYINFO": [], "source.OI_Foundation.AX_DEV.INVENTSITE": [], "source.OI_Foundation.AX_DEV.INVENTLOCATION": [], "source.OI_Foundation.AX_DEV.CUSTGROUP": [], "source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE": [], "source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI": [], "source.OI_Foundation.AX_DEV.CURRENCY": [], "source.OI_Foundation.AX_DEV.PAYMTERM": [], "source.OI_Foundation.AX_DEV.CASHDISC": [], "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP": [], "source.OI_Foundation.AX_DEV.ADDRESS": [], "source.OI_Foundation.AX_DEV.SALESTABLE": [], "source.OI_Foundation.AX_DEV.VENDTABLE": [], "source.OI_Foundation.AX_DEV.CONTACTPERSON": [], "source.OI_Foundation.AX_DEV.DIMENSIONS": [], "source.OI_Foundation.AX_DEV.UNIT": [], "source.OI_Foundation.AX_DEV.INVENTDIMGROUP": [], "source.OI_Foundation.AX_DEV.INVENTITEMBUYERGROUP": [], "source.OI_Foundation.AX_DEV.INVENTITEMGROUP": [], "source.OI_Foundation.AX_DEV.INVENTMODELGROUP": [], "source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI": [], "source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI": [], "source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI": [], "source.OI_Foundation.AX_DEV.REQGROUP": [], "source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI": [], "source.OI_Foundation.AX_DEV.INVENTSIZE": [], "source.OI_Foundation.AX_DEV.INVENTDIM": [], "source.OI_Foundation.AX_DEV.INVENTITEMPRICE": [], "source.OI_Foundation.AX_DEV.LEDGERTABLE": [], "source.OI_Foundation.AX_DEV.LEDGERBALANCESDIMTRANS": [], "source.OI_Foundation.AX_DEV.INVENTITEMLOCATION": [], "source.OI_Foundation.AX_DEV.INVENTSUM": [], "source.OI_Foundation.AX_DEV.INVENTTABLEMODULE": [], "source.OI_Foundation.AX_DEV.INVENTTRANS": [], "source.OI_Foundation.AX_DEV.DLVTERM": [], "source.OI_Foundation.AX_DEV.DLVMODE": [], "source.OI_Foundation.AX_DEV.SALESLINE": [], "source.OI_Foundation.AX_DEV.LEDGERTRANS": [], "source.OI_Foundation.AX_DEV.PURCHTABLE": [], "source.OI_Foundation.AX_DEV.PURCHLINE": [], "source.OI_Foundation.AX_DEV.PROJTABLE": [], "source.OI_Foundation.AX_DEV.VENDTRANS": [], "source.OI_Foundation.AX_DEV.VENDINVOICEJOUR": [], "source.OI_Foundation.AX_DEV.CUSTTRANS": [], "source.OI_Foundation.AX_DEV.CUSTSETTLEMENT": [], "source.OI_Foundation.AX_DEV.PRICEDISCGROUP": [], "source.OI_Foundation.AX_DEV.PROJCATEGORY": [], "source.OI_Foundation.AX_DEV.WMSPICKINGROUTE": [], "source.OI_Foundation.AX_DEV.PROJCOSTTRANS": [], "source.OI_Foundation.AX_DEV.CUSTTRANSOPEN": [], "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR": [], "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS": [], "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR": [], "source.OI_Foundation.AX_DEV.CUSTINVOICETRANS": [], "source.OI_Foundation.AX_DEV.VENDINVOICETRANS": [], "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR": [], "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS": [], "source.OI_Foundation.AX_DEV.PROJITEMTRANS": [], "source.OI_Foundation.AX_DEV.PROJEMPLTRANS": [], "source.OI_Foundation.AX_DEV.PROJFORECASTCOST": [], "source.OI_Foundation.AX_DEV.PROJFORECASTEMPL": [], "source.OI_Foundation.AX_DEV.PROJTRANSPOSTING": [], "source.OI_Foundation.AX_DEV.PROJREVENUE_OPI": [], "source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93": [], "source.OI_Foundation.NS_DEV.PAYMENT_TERMS": [], "source.OI_Foundation.NS_DEV.PAYMENT_METHODS": [], "source.OI_Foundation.NS_DEV.CURRENCIES": [], "source.OI_Foundation.NS_DEV.LOCATIONS": [], "source.OI_Foundation.NS_DEV.DEPARTMENTS": [], "source.OI_Foundation.NS_DEV.COMPANY_OPI": [], "source.OI_Foundation.NS_DEV.REGION_OPI": [], "source.OI_Foundation.NS_DEV.SUBREGION_OPI": [], "source.OI_Foundation.NS_DEV.ACCOUNTS": [], "source.OI_Foundation.NS_DEV.TRANSACTIONS": [], "source.OI_Foundation.NS_DEV.TRANSACTION_LINES": [], "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS": [], "source.OI_Foundation.NS_DEV.MARKET_OPI": [], "source.OI_Foundation.NS_DEV.CLASSES": [], "source.OI_Foundation.NS_DEV.UOM": [], "source.OI_Foundation.NS_DEV.SUBSIDIARIES": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911": [], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902": [], "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYA_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYC_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYP_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYX_DBO_TBLCURRENCY": []}, "child_map": {"model.OI_Foundation.ns_opco_gl_trans": ["model.OI_Foundation.v_ns_opco_gl_trans_curr", "model.OI_Foundation.v_opco_gl_trans_lineage"], "model.OI_Foundation.ns_opco_chart_of_accts_type": ["model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_opco_chart_of_accts_type_lineage"], "model.OI_Foundation.ns_opco_chart_of_accts": ["model.OI_Foundation.v_ns_opco_chart_of_accts_curr", "model.OI_Foundation.v_opco_chart_of_accts_lineage"], "model.OI_Foundation.ns_opco_gl_trans_type": ["model.OI_Foundation.v_ns_opco_gl_trans_type_curr", "model.OI_Foundation.v_opco_gl_trans_type_lineage"], "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_ns_opco_fscl_yr_gl_opening_bal_curr", "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage"], "model.OI_Foundation.v_ns_opco_gl_trans_curr": [], "model.OI_Foundation.v_ns_opco_chart_of_accts_type_curr": ["model.OI_Foundation.ns_opco_chart_of_accts"], "model.OI_Foundation.v_ns_opco_chart_of_accts_curr": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_gl_trans_type_curr": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_fscl_yr_gl_opening_bal_curr": [], "model.OI_Foundation.v_ns_opco_pymnt_terms_curr": [], "model.OI_Foundation.v_ns_opco_pymnt_mode_curr": [], "model.OI_Foundation.v_ns_opco_currency_curr": ["model.OI_Foundation.ns_opco", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_purpose_curr": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_brand_curr": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_uom_curr": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_type_curr": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_region_curr": [], "model.OI_Foundation.v_ns_sub_region_curr": [], "model.OI_Foundation.v_ns_opco_dept_curr": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_cost_center_curr": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.v_ns_opco_curr": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "model.OI_Foundation.ns_opco_pymnt_terms": ["model.OI_Foundation.v_ns_opco_pymnt_terms_curr", "model.OI_Foundation.v_opco_pymnt_terms_lineage"], "model.OI_Foundation.ns_opco_pymnt_mode": ["model.OI_Foundation.v_ns_opco_pymnt_mode_curr", "model.OI_Foundation.v_opco_pymnt_mode_lineage"], "model.OI_Foundation.ns_opco_currency": ["model.OI_Foundation.v_ns_opco_currency_curr", "model.OI_Foundation.v_opco_currency_lineage"], "model.OI_Foundation.ns_opco_purpose": ["model.OI_Foundation.v_ns_opco_purpose_curr", "model.OI_Foundation.v_opco_purpose_lineage"], "model.OI_Foundation.ns_opco_brand": ["model.OI_Foundation.v_ns_opco_brand_curr", "model.OI_Foundation.v_opco_brand_lineage"], "model.OI_Foundation.ns_opco_uom": ["model.OI_Foundation.v_ns_opco_uom_curr", "model.OI_Foundation.v_opco_uom_lineage"], "model.OI_Foundation.ns_opco_type": ["model.OI_Foundation.v_ns_opco_type_curr", "model.OI_Foundation.v_opco_type_lineage"], "model.OI_Foundation.ns_region": ["model.OI_Foundation.v_ns_region_curr", "model.OI_Foundation.v_region_lineage"], "model.OI_Foundation.ns_opco_dept": ["model.OI_Foundation.v_ns_opco_dept_curr", "model.OI_Foundation.v_opco_dept_lineage"], "model.OI_Foundation.ns_sub_region": ["model.OI_Foundation.v_ns_sub_region_curr", "model.OI_Foundation.v_sub_region_lineage"], "model.OI_Foundation.ns_opco_cost_center": ["model.OI_Foundation.v_ns_opco_cost_center_curr", "model.OI_Foundation.v_opco_cost_center_lineage"], "model.OI_Foundation.ns_opco": ["model.OI_Foundation.v_ns_opco_curr", "model.OI_Foundation.v_opco_lineage"], "model.OI_Foundation.ax_opco_gl_trans": ["model.OI_Foundation.v_ax_opco_gl_trans_curr", "model.OI_Foundation.v_opco_gl_trans_lineage"], "model.OI_Foundation.ax_opco_gl_trans_posting_type": ["model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr", "model.OI_Foundation.v_opco_gl_trans_posting_type_lineage"], "model.OI_Foundation.ax_opco_chart_of_accts_type": ["model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr", "model.OI_Foundation.v_opco_chart_of_accts_type_lineage"], "model.OI_Foundation.ax_opco_gl_trans_type": ["model.OI_Foundation.v_ax_opco_gl_trans_type_curr", "model.OI_Foundation.v_opco_gl_trans_type_lineage"], "model.OI_Foundation.ax_opco_chart_of_accts": ["model.OI_Foundation.v_ax_opco_chart_of_accts_curr", "model.OI_Foundation.v_opco_chart_of_accts_lineage"], "model.OI_Foundation.ax_chart_of_accts": ["model.OI_Foundation.v_ax_chart_of_accts_curr", "model.OI_Foundation.v_chart_of_accts_lineage"], "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_ax_opco_fscl_yr_gl_opening_bal_curr", "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage"], "model.OI_Foundation.v_ax_opco_gl_trans_curr": [], "model.OI_Foundation.v_ax_opco_gl_trans_posting_type_curr": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_project_trans_posting"], "model.OI_Foundation.v_ax_opco_chart_of_accts_type_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts"], "model.OI_Foundation.v_ax_opco_gl_trans_type_curr": ["model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_chart_of_accts_curr": ["model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_open_trans", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_vendor_invoice_line"], "model.OI_Foundation.v_ax_chart_of_accts_curr": ["model.OI_Foundation.ax_opco_chart_of_accts"], "model.OI_Foundation.v_ax_opco_fscl_yr_gl_opening_bal_curr": [], "model.OI_Foundation.v_ax_opco_cust_settled_trans_curr": [], "model.OI_Foundation.v_ax_opco_pymnt_terms_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice"], "model.OI_Foundation.v_ax_opco_cust_packing_slip_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip_line"], "model.OI_Foundation.v_ax_opco_cust_invoice_line_curr": [], "model.OI_Foundation.v_ax_opco_cust_trans_curr": ["model.OI_Foundation.ax_opco_cust_open_trans", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_settled_trans"], "model.OI_Foundation.v_ax_opco_pymnt_mode_curr": ["model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_cust_type_curr": ["model.OI_Foundation.ax_opco_opco_cust_xref"], "model.OI_Foundation.v_ax_opco_picking_list_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_invtry_trans"], "model.OI_Foundation.v_ax_opco_handling_status_curr": ["model.OI_Foundation.ax_opco_picking_list"], "model.OI_Foundation.v_ax_opco_currency_curr": ["model.OI_Foundation.ax_opco", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_cust_invoice_curr": [], "model.OI_Foundation.v_ax_opco_opco_cust_xref_curr": [], "model.OI_Foundation.v_ax_opco_cust_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_opco_locn_xref", "model.OI_Foundation.ax_opco_cust_open_trans", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_ax_opco_cust_open_trans_curr": [], "model.OI_Foundation.v_ax_opco_cust_grp_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_ax_opco_commsn_grp_curr": ["model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_opco_cust_xref"], "model.OI_Foundation.v_ax_opco_cust_code_curr": ["model.OI_Foundation.ax_opco_opco_cust_xref"], "model.OI_Foundation.v_ax_opco_invtry_ref_type_curr": ["model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_opco_cust_packing_slip_line_curr": [], "model.OI_Foundation.v_ax_opco_po_line_curr": [], "model.OI_Foundation.v_ax_opco_po_type_curr": ["model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_ax_opco_po_curr": ["model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_po_doc_status_curr": ["model.OI_Foundation.ax_opco_po"], "model.OI_Foundation.v_ax_opco_vendor_invoice_curr": ["model.OI_Foundation.ax_opco_vendor_invoice_line"], "model.OI_Foundation.v_ax_opco_vendor_packing_slip_line_curr": [], "model.OI_Foundation.v_ax_opco_vendor_trans_curr": [], "model.OI_Foundation.v_ax_opco_vendor_invoice_line_curr": [], "model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_opco_item_invtry_curr": [], "model.OI_Foundation.v_ax_opco_item_subtype_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_purpose_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_vendor_curr": ["model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_opco_locn_xref", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_trans", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_item_opco_assctn_xref_curr": [], "model.OI_Foundation.v_ax_opco_invtry_trans_type_curr": ["model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_picking_list"], "model.OI_Foundation.v_ax_opco_item_class_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_item_type_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_invtry_trans_curr": [], "model.OI_Foundation.v_ax_opco_item_curr": ["model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_item_invtry", "model.OI_Foundation.ax_opco_item_opco_assctn_xref", "model.OI_Foundation.ax_opco_item_psi_dtl", "model.OI_Foundation.ax_opco_item_size", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_opco_item_model_grp_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_item_grp_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr": ["model.OI_Foundation.ax_opco_invtry_trans"], "model.OI_Foundation.v_ax_opco_invtry_issue_status_curr": ["model.OI_Foundation.ax_opco_invtry_trans"], "model.OI_Foundation.v_ax_opco_item_freight_curr": ["model.OI_Foundation.ax_opco_item_grp"], "model.OI_Foundation.v_ax_opco_lob_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_item_psi_dtl_curr": [], "model.OI_Foundation.v_ax_opco_item_sls_class_curr": ["model.OI_Foundation.ax_opco_item"], "model.OI_Foundation.v_ax_opco_uom_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_item_grp", "model.OI_Foundation.ax_opco_item_grp", "model.OI_Foundation.ax_opco_item_psi_dtl", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_opco_item_size_curr": [], "model.OI_Foundation.v_ax_opco_cust_opco_locn_xref_curr": [], "model.OI_Foundation.v_ax_opco_locn_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_opco_locn_xref", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_opco_locn_xref", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_vendor_opco_locn_xref", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_sls_ordr_opco_locn_xref"], "model.OI_Foundation.v_ax_opco_opco_locn_xref_curr": [], "model.OI_Foundation.v_ax_opco_vendor_opco_locn_xref_curr": [], "model.OI_Foundation.v_ax_fscl_clndr_curr": ["model.OI_Foundation.ax_opco_gl_trans"], "model.OI_Foundation.v_ax_opco_type_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_assctn_curr": ["model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_item_invtry", "model.OI_Foundation.ax_opco_item_opco_assctn_xref", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "model.OI_Foundation.v_ax_region_curr": ["model.OI_Foundation.ax_opco"], "model.OI_Foundation.v_ax_warehouse_curr": ["model.OI_Foundation.ax_opco_assctn", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_ax_opco_dept_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_sub_region_curr": ["model.OI_Foundation.ax_opco"], "model.OI_Foundation.v_ax_opco_site_curr": ["model.OI_Foundation.ax_opco_assctn", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_ax_opco_curr": ["model.OI_Foundation.ax_opco_assctn", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_open_trans", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_opco_cust_xref", "model.OI_Foundation.ax_opco_opco_locn_xref", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_revenue_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_cost_center_curr": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_assctn", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_settled_trans", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_catgry", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_invoice_line", "model.OI_Foundation.ax_opco_vendor_packing_slip", "model.OI_Foundation.ax_opco_vendor_packing_slip_line", "model.OI_Foundation.ax_opco_vendor_trans"], "model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr": ["model.OI_Foundation.ax_opco_sls_ordr"], "model.OI_Foundation.v_ax_opco_sls_ordr_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_invoice_line", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_packing_slip_line", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_ax_opco_dlvry_terms_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_ax_opco_trans_status_curr": ["model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_ax_opco_sls_ordr_line_curr": [], "model.OI_Foundation.v_ax_sls_ordr_opco_locn_xref_curr": [], "model.OI_Foundation.v_ax_opco_dlvry_mode_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_picking_list", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_ax_opco_sls_ordr_type_curr": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_opco_sls_ordr_line"], "model.OI_Foundation.v_ax_opco_project_cost_trans_curr": [], "model.OI_Foundation.v_ax_opco_project_item_trans_curr": [], "model.OI_Foundation.v_ax_opco_project_cost_frcst_curr": [], "model.OI_Foundation.v_ax_opco_project_catgry_curr": ["model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting"], "model.OI_Foundation.v_ax_opco_project_empl_trans_curr": [], "model.OI_Foundation.v_ax_opco_project_revenue_trans_curr": [], "model.OI_Foundation.v_ax_opco_project_curr": ["model.OI_Foundation.ax_opco_cust_trans", "model.OI_Foundation.ax_opco_invtry_trans", "model.OI_Foundation.ax_opco_po", "model.OI_Foundation.ax_opco_po_line", "model.OI_Foundation.ax_opco_project_cost_frcst", "model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_frcst", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_invoice_project_xref", "model.OI_Foundation.ax_opco_project_invoice_project_xref", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_revenue_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_vendor_invoice", "model.OI_Foundation.ax_opco_vendor_packing_slip"], "model.OI_Foundation.v_ax_opco_project_invoice_project_xref_curr": [], "model.OI_Foundation.v_ax_opco_project_empl_frcst_curr": [], "model.OI_Foundation.v_ax_opco_project_trans_origin_curr": ["model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans", "model.OI_Foundation.ax_opco_project_trans_posting", "model.OI_Foundation.ax_opco_project_trans_posting"], "model.OI_Foundation.v_ax_opco_project_trans_status_curr": ["model.OI_Foundation.ax_opco_project_cost_trans", "model.OI_Foundation.ax_opco_project_empl_trans", "model.OI_Foundation.ax_opco_project_item_trans"], "model.OI_Foundation.v_ax_opco_project_trans_posting_curr": [], "model.OI_Foundation.ax_opco_cust_settled_trans": ["model.OI_Foundation.v_ax_opco_cust_settled_trans_curr", "model.OI_Foundation.v_opco_cust_settled_trans_lineage"], "model.OI_Foundation.ax_opco_pymnt_terms": ["model.OI_Foundation.v_ax_opco_pymnt_terms_curr", "model.OI_Foundation.v_opco_pymnt_terms_lineage"], "model.OI_Foundation.ax_opco_cust_invoice_line": ["model.OI_Foundation.v_ax_opco_cust_invoice_line_curr", "model.OI_Foundation.v_opco_cust_invoice_line_lineage"], "model.OI_Foundation.ax_opco_cust_packing_slip": ["model.OI_Foundation.v_ax_opco_cust_packing_slip_curr", "model.OI_Foundation.v_opco_cust_packing_slip_lineage"], "model.OI_Foundation.ax_opco_cust_trans": ["model.OI_Foundation.v_ax_opco_cust_trans_curr", "model.OI_Foundation.v_opco_cust_trans_lineage"], "model.OI_Foundation.ax_opco_pymnt_mode": ["model.OI_Foundation.v_ax_opco_pymnt_mode_curr", "model.OI_Foundation.v_opco_pymnt_mode_lineage"], "model.OI_Foundation.ax_opco_cash_dscnt_terms": ["model.OI_Foundation.v_ax_opco_cash_dscnt_terms_curr", "model.OI_Foundation.v_opco_cash_dscnt_terms_lineage"], "model.OI_Foundation.ax_opco_picking_list": ["model.OI_Foundation.v_ax_opco_picking_list_curr", "model.OI_Foundation.v_opco_picking_list_lineage"], "model.OI_Foundation.ax_opco_cust_type": ["model.OI_Foundation.v_ax_opco_cust_type_curr", "model.OI_Foundation.v_opco_cust_type_lineage"], "model.OI_Foundation.ax_opco_handling_status": ["model.OI_Foundation.v_ax_opco_handling_status_curr", "model.OI_Foundation.v_opco_handling_status_lineage"], "model.OI_Foundation.ax_opco_cust_invoice": ["model.OI_Foundation.v_ax_opco_cust_invoice_curr", "model.OI_Foundation.v_opco_cust_invoice_lineage"], "model.OI_Foundation.ax_opco_currency": ["model.OI_Foundation.v_ax_opco_currency_curr", "model.OI_Foundation.v_opco_currency_lineage"], "model.OI_Foundation.ax_opco_opco_cust_xref": ["model.OI_Foundation.v_ax_opco_opco_cust_xref_curr", "model.OI_Foundation.v_opco_opco_cust_xref_lineage"], "model.OI_Foundation.ax_opco_cust": ["model.OI_Foundation.v_ax_opco_cust_curr", "model.OI_Foundation.v_opco_cust_lineage"], "model.OI_Foundation.ax_opco_cust_grp": ["model.OI_Foundation.v_ax_opco_cust_grp_curr", "model.OI_Foundation.v_opco_cust_grp_lineage"], "model.OI_Foundation.ax_opco_cust_open_trans": ["model.OI_Foundation.v_ax_opco_cust_open_trans_curr", "model.OI_Foundation.v_opco_cust_open_trans_lineage"], "model.OI_Foundation.ax_opco_commsn_grp": ["model.OI_Foundation.v_ax_opco_commsn_grp_curr", "model.OI_Foundation.v_opco_commsn_grp_lineage"], "model.OI_Foundation.ax_opco_cust_packing_slip_line": ["model.OI_Foundation.v_ax_opco_cust_packing_slip_line_curr", "model.OI_Foundation.v_opco_cust_packing_slip_line_lineage"], "model.OI_Foundation.ax_opco_invtry_ref_type": ["model.OI_Foundation.v_ax_opco_invtry_ref_type_curr", "model.OI_Foundation.v_opco_invtry_ref_type_lineage"], "model.OI_Foundation.ax_opco_cust_code": ["model.OI_Foundation.v_ax_opco_cust_code_curr", "model.OI_Foundation.v_opco_cust_code_lineage"], "model.OI_Foundation.ax_opco_po_line": ["model.OI_Foundation.v_ax_opco_po_line_curr", "model.OI_Foundation.v_opco_po_line_lineage"], "model.OI_Foundation.ax_opco_po_type": ["model.OI_Foundation.v_ax_opco_po_type_curr", "model.OI_Foundation.v_opco_po_type_lineage"], "model.OI_Foundation.ax_opco_po": ["model.OI_Foundation.v_ax_opco_po_curr", "model.OI_Foundation.v_opco_po_lineage"], "model.OI_Foundation.ax_opco_po_doc_status": ["model.OI_Foundation.v_ax_opco_po_doc_status_curr", "model.OI_Foundation.v_opco_po_doc_status_lineage"], "model.OI_Foundation.ax_opco_vendor_invoice": ["model.OI_Foundation.v_ax_opco_vendor_invoice_curr", "model.OI_Foundation.v_opco_vendor_invoice_lineage"], "model.OI_Foundation.ax_opco_vendor_packing_slip_line": ["model.OI_Foundation.v_ax_opco_vendor_packing_slip_line_curr", "model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage"], "model.OI_Foundation.ax_opco_vendor_trans": ["model.OI_Foundation.v_ax_opco_vendor_trans_curr", "model.OI_Foundation.v_opco_vendor_trans_lineage"], "model.OI_Foundation.ax_opco_vendor_packing_slip": ["model.OI_Foundation.v_ax_opco_vendor_packing_slip_curr", "model.OI_Foundation.v_opco_vendor_packing_slip_lineage"], "model.OI_Foundation.ax_opco_vendor_invoice_line": ["model.OI_Foundation.v_ax_opco_vendor_invoice_line_curr", "model.OI_Foundation.v_opco_vendor_invoice_line_lineage"], "model.OI_Foundation.ax_opco_item_invtry": ["model.OI_Foundation.v_ax_opco_item_invtry_curr", "model.OI_Foundation.v_opco_item_invtry_lineage"], "model.OI_Foundation.ax_opco_item_subtype": ["model.OI_Foundation.v_ax_opco_item_subtype_curr", "model.OI_Foundation.v_opco_item_subtype_lineage"], "model.OI_Foundation.ax_opco_vendor": ["model.OI_Foundation.v_ax_opco_vendor_curr", "model.OI_Foundation.v_opco_vendor_lineage"], "model.OI_Foundation.ax_opco_item_opco_assctn_xref": ["model.OI_Foundation.v_ax_opco_item_opco_assctn_xref_curr", "model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage"], "model.OI_Foundation.ax_opco_purpose": ["model.OI_Foundation.v_ax_opco_purpose_curr", "model.OI_Foundation.v_opco_purpose_lineage"], "model.OI_Foundation.ax_opco_invtry_trans_type": ["model.OI_Foundation.v_ax_opco_invtry_trans_type_curr", "model.OI_Foundation.v_opco_invtry_trans_type_lineage"], "model.OI_Foundation.ax_opco_item_class": ["model.OI_Foundation.v_ax_opco_item_class_curr", "model.OI_Foundation.v_opco_item_class_lineage"], "model.OI_Foundation.ax_opco_item_type": ["model.OI_Foundation.v_ax_opco_item_type_curr", "model.OI_Foundation.v_opco_item_type_lineage"], "model.OI_Foundation.ax_opco_item_cvrg_grp": ["model.OI_Foundation.v_ax_opco_item_cvrg_grp_curr", "model.OI_Foundation.v_opco_item_cvrg_grp_lineage"], "model.OI_Foundation.ax_opco_invtry_trans": ["model.OI_Foundation.v_ax_opco_invtry_trans_curr", "model.OI_Foundation.v_opco_invtry_trans_lineage"], "model.OI_Foundation.ax_opco_item": ["model.OI_Foundation.v_ax_opco_item_curr", "model.OI_Foundation.v_opco_item_lineage"], "model.OI_Foundation.ax_opco_invtry_issue_status": ["model.OI_Foundation.v_ax_opco_invtry_issue_status_curr", "model.OI_Foundation.v_opco_invtry_issue_status_lineage"], "model.OI_Foundation.ax_opco_item_model_grp": ["model.OI_Foundation.v_ax_opco_item_model_grp_curr", "model.OI_Foundation.v_opco_item_model_grp_lineage"], "model.OI_Foundation.ax_opco_item_grp": ["model.OI_Foundation.v_ax_opco_item_grp_curr", "model.OI_Foundation.v_opco_item_grp_lineage"], "model.OI_Foundation.ax_opco_invtry_rcpt_status": ["model.OI_Foundation.v_ax_opco_invtry_rcpt_status_curr", "model.OI_Foundation.v_opco_invtry_rcpt_status_lineage"], "model.OI_Foundation.ax_opco_item_freight": ["model.OI_Foundation.v_ax_opco_item_freight_curr", "model.OI_Foundation.v_opco_item_freight_lineage"], "model.OI_Foundation.ax_opco_item_psi_dtl": ["model.OI_Foundation.v_ax_opco_item_psi_dtl_curr", "model.OI_Foundation.v_opco_item_psi_dtl_lineage"], "model.OI_Foundation.ax_opco_lob": ["model.OI_Foundation.v_ax_opco_lob_curr", "model.OI_Foundation.v_opco_lob_lineage"], "model.OI_Foundation.ax_opco_item_sls_class": ["model.OI_Foundation.v_ax_opco_item_sls_class_curr", "model.OI_Foundation.v_opco_item_sls_class_lineage"], "model.OI_Foundation.ax_opco_uom": ["model.OI_Foundation.v_ax_opco_uom_curr", "model.OI_Foundation.v_opco_uom_lineage"], "model.OI_Foundation.ax_opco_item_size": ["model.OI_Foundation.v_ax_opco_item_size_curr", "model.OI_Foundation.v_opco_item_size_lineage"], "model.OI_Foundation.ax_opco_cust_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_cust_opco_locn_xref_curr", "model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage"], "model.OI_Foundation.ax_opco_locn": ["model.OI_Foundation.v_ax_opco_locn_curr", "model.OI_Foundation.v_opco_locn_lineage"], "model.OI_Foundation.ax_opco_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_opco_locn_xref_curr", "model.OI_Foundation.v_opco_opco_locn_xref_lineage"], "model.OI_Foundation.ax_opco_vendor_opco_locn_xref": ["model.OI_Foundation.v_ax_opco_vendor_opco_locn_xref_curr", "model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage"], "model.OI_Foundation.ax_fscl_clndr": ["model.OI_Foundation.v_ax_fscl_clndr_curr", "model.OI_Foundation.v_fscl_clndr_lineage"], "model.OI_Foundation.ax_opco_type": ["model.OI_Foundation.v_ax_opco_type_curr", "model.OI_Foundation.v_opco_type_lineage"], "model.OI_Foundation.ax_opco_assctn": ["model.OI_Foundation.v_ax_opco_assctn_curr", "model.OI_Foundation.v_opco_assctn_lineage"], "model.OI_Foundation.ax_region": ["model.OI_Foundation.v_ax_region_curr", "model.OI_Foundation.v_region_lineage"], "model.OI_Foundation.ax_warehouse": ["model.OI_Foundation.v_ax_warehouse_curr", "model.OI_Foundation.v_warehouse_lineage"], "model.OI_Foundation.ax_sub_region": ["model.OI_Foundation.v_ax_sub_region_curr", "model.OI_Foundation.v_sub_region_lineage"], "model.OI_Foundation.ax_opco_dept": ["model.OI_Foundation.v_ax_opco_dept_curr", "model.OI_Foundation.v_opco_dept_lineage"], "model.OI_Foundation.ax_opco_site": ["model.OI_Foundation.v_ax_opco_site_curr", "model.OI_Foundation.v_opco_site_lineage"], "model.OI_Foundation.ax_opco": ["model.OI_Foundation.v_ax_opco_curr", "model.OI_Foundation.v_opco_lineage"], "model.OI_Foundation.ax_opco_cost_center": ["model.OI_Foundation.v_ax_opco_cost_center_curr", "model.OI_Foundation.v_opco_cost_center_lineage"], "model.OI_Foundation.ax_opco_sls_ordr_doc_status": ["model.OI_Foundation.v_ax_opco_sls_ordr_doc_status_curr", "model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage"], "model.OI_Foundation.ax_opco_sls_ordr": ["model.OI_Foundation.v_ax_opco_sls_ordr_curr", "model.OI_Foundation.v_opco_sls_ordr_lineage"], "model.OI_Foundation.ax_opco_trans_status": ["model.OI_Foundation.v_ax_opco_trans_status_curr", "model.OI_Foundation.v_opco_trans_status_lineage"], "model.OI_Foundation.ax_opco_dlvry_terms": ["model.OI_Foundation.v_ax_opco_dlvry_terms_curr", "model.OI_Foundation.v_opco_dlvry_terms_lineage"], "model.OI_Foundation.ax_opco_sls_ordr_line": ["model.OI_Foundation.v_ax_opco_sls_ordr_line_curr", "model.OI_Foundation.v_opco_sls_ordr_line_lineage"], "model.OI_Foundation.ax_sls_ordr_opco_locn_xref": ["model.OI_Foundation.v_ax_sls_ordr_opco_locn_xref_curr", "model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage"], "model.OI_Foundation.ax_opco_dlvry_mode": ["model.OI_Foundation.v_ax_opco_dlvry_mode_curr", "model.OI_Foundation.v_opco_dlvry_mode_lineage"], "model.OI_Foundation.ax_opco_sls_ordr_type": ["model.OI_Foundation.v_ax_opco_sls_ordr_type_curr", "model.OI_Foundation.v_opco_sls_ordr_type_lineage"], "model.OI_Foundation.ax_opco_project_cost_trans": ["model.OI_Foundation.v_ax_opco_project_cost_trans_curr", "model.OI_Foundation.v_opco_project_cost_trans_lineage"], "model.OI_Foundation.ax_opco_project_item_trans": ["model.OI_Foundation.v_ax_opco_project_item_trans_curr", "model.OI_Foundation.v_opco_project_item_trans_lineage"], "model.OI_Foundation.ax_opco_project_catgry": ["model.OI_Foundation.v_ax_opco_project_catgry_curr", "model.OI_Foundation.v_opco_project_catgry_lineage"], "model.OI_Foundation.ax_opco_project_cost_frcst": ["model.OI_Foundation.v_ax_opco_project_cost_frcst_curr", "model.OI_Foundation.v_opco_project_cost_frcst_lineage"], "model.OI_Foundation.ax_opco_project_empl_trans": ["model.OI_Foundation.v_ax_opco_project_empl_trans_curr", "model.OI_Foundation.v_opco_project_empl_trans_lineage"], "model.OI_Foundation.ax_opco_project": ["model.OI_Foundation.v_ax_opco_project_curr", "model.OI_Foundation.v_opco_project_lineage"], "model.OI_Foundation.ax_opco_project_revenue_trans": ["model.OI_Foundation.v_ax_opco_project_revenue_trans_curr", "model.OI_Foundation.v_opco_project_revenue_trans_lineage"], "model.OI_Foundation.ax_opco_project_invoice_project_xref": ["model.OI_Foundation.v_ax_opco_project_invoice_project_xref_curr", "model.OI_Foundation.v_opco_project_invoice_project_xref_lineage"], "model.OI_Foundation.ax_opco_project_trans_origin": ["model.OI_Foundation.v_ax_opco_project_trans_origin_curr", "model.OI_Foundation.v_opco_project_trans_origin_lineage"], "model.OI_Foundation.ax_opco_project_empl_frcst": ["model.OI_Foundation.v_ax_opco_project_empl_frcst_curr", "model.OI_Foundation.v_opco_project_empl_frcst_lineage"], "model.OI_Foundation.ax_opco_project_trans_posting": ["model.OI_Foundation.v_ax_opco_project_trans_posting_curr", "model.OI_Foundation.v_opco_project_trans_posting_lineage"], "model.OI_Foundation.ax_opco_project_trans_status": ["model.OI_Foundation.v_ax_opco_project_trans_status_curr", "model.OI_Foundation.v_opco_project_trans_status_lineage"], "model.OI_Foundation.primex_opco_gl_trans": ["model.OI_Foundation.v_opco_gl_trans_lineage", "model.OI_Foundation.v_primex_opco_gl_trans_curr"], "model.OI_Foundation.primex_opco_chart_of_accts_type": ["model.OI_Foundation.v_opco_chart_of_accts_type_lineage", "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr"], "model.OI_Foundation.primex_opco_chart_of_accts": ["model.OI_Foundation.v_opco_chart_of_accts_lineage", "model.OI_Foundation.v_primex_opco_chart_of_accts_curr"], "model.OI_Foundation.primex_opco_gl_trans_type": ["model.OI_Foundation.v_opco_gl_trans_type_lineage", "model.OI_Foundation.v_primex_opco_gl_trans_type_curr"], "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage", "model.OI_Foundation.v_primex_opco_fscl_yr_gl_opening_bal_curr"], "model.OI_Foundation.primex_opco_sub_ledger_type": ["model.OI_Foundation.v_opco_sub_ledger_type_lineage", "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr"], "model.OI_Foundation.v_primex_opco_gl_trans_curr": [], "model.OI_Foundation.v_primex_opco_chart_of_accts_type_curr": ["model.OI_Foundation.primex_opco_chart_of_accts"], "model.OI_Foundation.v_primex_opco_chart_of_accts_curr": ["model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_gl_trans_type_curr": ["model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_fscl_yr_gl_opening_bal_curr": [], "model.OI_Foundation.v_primex_opco_sub_ledger_type_curr": ["model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_currency_curr": ["model.OI_Foundation.primex_opco", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_purpose_curr": ["model.OI_Foundation.primex_opco_chart_of_accts", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_uom_curr": ["model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_lob_curr": ["model.OI_Foundation.primex_opco_chart_of_accts", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_type_curr": ["model.OI_Foundation.primex_opco_chart_of_accts", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_curr": ["model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_cost_center_curr": ["model.OI_Foundation.primex_opco_chart_of_accts", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.v_primex_opco_dept_curr": ["model.OI_Foundation.primex_opco_chart_of_accts", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.primex_opco_gl_trans"], "model.OI_Foundation.primex_opco_currency": ["model.OI_Foundation.v_opco_currency_lineage", "model.OI_Foundation.v_primex_opco_currency_curr"], "model.OI_Foundation.primex_opco_purpose": ["model.OI_Foundation.v_opco_purpose_lineage", "model.OI_Foundation.v_primex_opco_purpose_curr"], "model.OI_Foundation.primex_opco_uom": ["model.OI_Foundation.v_opco_uom_lineage", "model.OI_Foundation.v_primex_opco_uom_curr"], "model.OI_Foundation.primex_opco_lob": ["model.OI_Foundation.v_opco_lob_lineage", "model.OI_Foundation.v_primex_opco_lob_curr"], "model.OI_Foundation.primex_opco_type": ["model.OI_Foundation.v_opco_type_lineage", "model.OI_Foundation.v_primex_opco_type_curr"], "model.OI_Foundation.primex_opco": ["model.OI_Foundation.v_opco_lineage", "model.OI_Foundation.v_primex_opco_curr"], "model.OI_Foundation.primex_opco_cost_center": ["model.OI_Foundation.v_opco_cost_center_lineage", "model.OI_Foundation.v_primex_opco_cost_center_curr"], "model.OI_Foundation.primex_opco_dept": ["model.OI_Foundation.v_opco_dept_lineage", "model.OI_Foundation.v_primex_opco_dept_curr"], "model.OI_Foundation.jde_opco_gl_trans": ["model.OI_Foundation.v_jde_opco_gl_trans_curr", "model.OI_Foundation.v_opco_gl_trans_lineage"], "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal": ["model.OI_Foundation.v_jde_opco_fscl_yr_gl_opening_bal_curr", "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage"], "model.OI_Foundation.jde_opco_sub_ledger_type": ["model.OI_Foundation.v_jde_opco_sub_ledger_type_curr", "model.OI_Foundation.v_opco_sub_ledger_type_lineage"], "model.OI_Foundation.jde_opco_chart_of_accts": ["model.OI_Foundation.v_jde_opco_chart_of_accts_curr", "model.OI_Foundation.v_opco_chart_of_accts_lineage"], "model.OI_Foundation.jde_opco_gl_trans_type": ["model.OI_Foundation.v_jde_opco_gl_trans_type_curr", "model.OI_Foundation.v_opco_gl_trans_type_lineage"], "model.OI_Foundation.v_jde_opco_gl_trans_curr": [], "model.OI_Foundation.v_jde_opco_fscl_yr_gl_opening_bal_curr": [], "model.OI_Foundation.v_jde_opco_sub_ledger_type_curr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_chart_of_accts_curr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_gl_trans_type_curr": ["model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_currency_curr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_uom_curr": ["model.OI_Foundation.jde_opco_chart_of_accts", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_curr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.v_jde_opco_cost_center_curr": ["model.OI_Foundation.jde_opco_chart_of_accts", "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans"], "model.OI_Foundation.jde_opco_currency": ["model.OI_Foundation.jde_opco", "model.OI_Foundation.v_jde_opco_currency_curr", "model.OI_Foundation.v_opco_currency_lineage"], "model.OI_Foundation.jde_opco_uom": ["model.OI_Foundation.v_jde_opco_uom_curr", "model.OI_Foundation.v_opco_uom_lineage"], "model.OI_Foundation.jde_opco": ["model.OI_Foundation.v_jde_opco_curr", "model.OI_Foundation.v_opco_lineage"], "model.OI_Foundation.jde_opco_cost_center": ["model.OI_Foundation.v_jde_opco_cost_center_curr", "model.OI_Foundation.v_opco_cost_center_lineage"], "model.OI_Foundation._foundation_load_config": [], "model.OI_Foundation.opco_gl_trans": [], "model.OI_Foundation.opco_gl_trans_posting_type": [], "model.OI_Foundation.opco_chart_of_accts_type": [], "model.OI_Foundation.chart_of_accts": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.primex_opco_chart_of_accts"], "model.OI_Foundation.opco_chart_of_accts": [], "model.OI_Foundation.opco_gl_trans_type": [], "model.OI_Foundation.opco_sub_ledger_type": [], "model.OI_Foundation.opco_fscl_yr_gl_opening_bal": [], "model.OI_Foundation.opco_cust_invoice_line": [], "model.OI_Foundation.opco_cust_packing_slip": [], "model.OI_Foundation.opco_pymnt_terms": [], "model.OI_Foundation.opco_cust_settled_trans": [], "model.OI_Foundation.opco_cust_trans": [], "model.OI_Foundation.opco_cash_dscnt_terms": [], "model.OI_Foundation.opco_pymnt_mode": [], "model.OI_Foundation.opco_handling_status": [], "model.OI_Foundation.opco_picking_list": [], "model.OI_Foundation.opco_cust_type": [], "model.OI_Foundation.opco_opco_cust_xref": [], "model.OI_Foundation.opco_currency": [], "model.OI_Foundation.opco_cust_invoice": [], "model.OI_Foundation.opco_cust_grp": [], "model.OI_Foundation.opco_cust_open_trans": [], "model.OI_Foundation.opco_cust": [], "model.OI_Foundation.opco_commsn_grp": [], "model.OI_Foundation.opco_cust_packing_slip_line": [], "model.OI_Foundation.opco_cust_code": [], "model.OI_Foundation.opco_invtry_ref_type": [], "model.OI_Foundation.opco_po_line": [], "model.OI_Foundation.opco_po_type": [], "model.OI_Foundation.opco_po_doc_status": [], "model.OI_Foundation.opco_po": [], "model.OI_Foundation.opco_vendor_invoice": [], "model.OI_Foundation.opco_vendor_packing_slip_line": [], "model.OI_Foundation.opco_vendor_trans": [], "model.OI_Foundation.opco_vendor_invoice_line": [], "model.OI_Foundation.opco_vendor_packing_slip": [], "model.OI_Foundation.opco_item_invtry": [], "model.OI_Foundation.opco_item_subtype": [], "model.OI_Foundation.opco_vendor": [], "model.OI_Foundation.opco_purpose": [], "model.OI_Foundation.opco_item_opco_assctn_xref": [], "model.OI_Foundation.opco_invtry_trans_type": [], "model.OI_Foundation.opco_item_class": [], "model.OI_Foundation.opco_item_cvrg_grp": [], "model.OI_Foundation.opco_item_type": [], "model.OI_Foundation.opco_invtry_trans": [], "model.OI_Foundation.opco_item_freight": [], "model.OI_Foundation.opco_brand": [], "model.OI_Foundation.opco_invtry_rcpt_status": [], "model.OI_Foundation.opco_item_grp": [], "model.OI_Foundation.opco_invtry_issue_status": [], "model.OI_Foundation.opco_item_model_grp": [], "model.OI_Foundation.opco_item": [], "model.OI_Foundation.opco_item_sls_class": [], "model.OI_Foundation.opco_lob": [], "model.OI_Foundation.opco_item_psi_dtl": [], "model.OI_Foundation.opco_item_size": [], "model.OI_Foundation.opco_uom": [], "model.OI_Foundation.opco_cust_opco_locn_xref": [], "model.OI_Foundation.opco_locn": [], "model.OI_Foundation.opco_opco_locn_xref": [], "model.OI_Foundation.opco_vendor_opco_locn_xref": [], "model.OI_Foundation.opco_type": [], "model.OI_Foundation.fscl_clndr": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans", "model.OI_Foundation.primex_opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.region": [], "model.OI_Foundation.opco_assctn": [], "model.OI_Foundation.warehouse": [], "model.OI_Foundation.opco_site": [], "model.OI_Foundation.sub_region": [], "model.OI_Foundation.opco_dept": [], "model.OI_Foundation.opco_cost_center": [], "model.OI_Foundation.opco": [], "model.OI_Foundation.opco_sls_ordr": [], "model.OI_Foundation.opco_sls_ordr_doc_status": [], "model.OI_Foundation.opco_trans_status": [], "model.OI_Foundation.opco_dlvry_terms": [], "model.OI_Foundation.sls_ordr_opco_locn_xref": [], "model.OI_Foundation.opco_sls_ordr_line": [], "model.OI_Foundation.opco_dlvry_mode": [], "model.OI_Foundation.opco_sls_ordr_type": [], "model.OI_Foundation.opco_project_cost_trans": [], "model.OI_Foundation.opco_project_item_trans": [], "model.OI_Foundation.opco_project_cost_frcst": [], "model.OI_Foundation.opco_project_catgry": [], "model.OI_Foundation.opco_project_empl_trans": [], "model.OI_Foundation.opco_project_revenue_trans": [], "model.OI_Foundation.opco_project": [], "model.OI_Foundation.opco_project_trans_origin": [], "model.OI_Foundation.opco_project_empl_frcst": [], "model.OI_Foundation.opco_project_invoice_project_xref": [], "model.OI_Foundation.opco_project_trans_posting": [], "model.OI_Foundation.opco_project_trans_status": [], "model.OI_Foundation.v_opco_fscl_yr_gl_opening_bal_lineage": ["model.OI_Foundation.opco_fscl_yr_gl_opening_bal"], "model.OI_Foundation.v_opco_sub_ledger_type_lineage": ["model.OI_Foundation.opco_sub_ledger_type"], "model.OI_Foundation.v_opco_gl_trans_type_lineage": ["model.OI_Foundation.opco_gl_trans_type"], "model.OI_Foundation.v_opco_chart_of_accts_lineage": ["model.OI_Foundation.opco_chart_of_accts"], "model.OI_Foundation.v_chart_of_accts_lineage": ["model.OI_Foundation.chart_of_accts"], "model.OI_Foundation.v_opco_gl_trans_lineage": ["model.OI_Foundation.opco_gl_trans"], "model.OI_Foundation.v_opco_gl_trans_posting_type_lineage": ["model.OI_Foundation.opco_gl_trans_posting_type"], "model.OI_Foundation.v_opco_chart_of_accts_type_lineage": ["model.OI_Foundation.opco_chart_of_accts_type"], "model.OI_Foundation.v_opco_cust_packing_slip_line_lineage": ["model.OI_Foundation.opco_cust_packing_slip_line"], "model.OI_Foundation.v_opco_cust_code_lineage": ["model.OI_Foundation.opco_cust_code"], "model.OI_Foundation.v_opco_invtry_ref_type_lineage": ["model.OI_Foundation.opco_invtry_ref_type"], "model.OI_Foundation.v_opco_commsn_grp_lineage": ["model.OI_Foundation.opco_commsn_grp"], "model.OI_Foundation.v_opco_cust_invoice_lineage": ["model.OI_Foundation.opco_cust_invoice"], "model.OI_Foundation.v_opco_currency_lineage": ["model.OI_Foundation.opco_currency"], "model.OI_Foundation.v_opco_opco_cust_xref_lineage": ["model.OI_Foundation.opco_opco_cust_xref"], "model.OI_Foundation.v_opco_cust_lineage": ["model.OI_Foundation.opco_cust"], "model.OI_Foundation.v_opco_cust_open_trans_lineage": ["model.OI_Foundation.opco_cust_open_trans"], "model.OI_Foundation.v_opco_cust_grp_lineage": ["model.OI_Foundation.opco_cust_grp"], "model.OI_Foundation.v_opco_cust_settled_trans_lineage": ["model.OI_Foundation.opco_cust_settled_trans"], "model.OI_Foundation.v_opco_cust_packing_slip_lineage": ["model.OI_Foundation.opco_cust_packing_slip"], "model.OI_Foundation.v_opco_cust_invoice_line_lineage": ["model.OI_Foundation.opco_cust_invoice_line"], "model.OI_Foundation.v_opco_pymnt_terms_lineage": ["model.OI_Foundation.opco_pymnt_terms"], "model.OI_Foundation.v_opco_cust_trans_lineage": ["model.OI_Foundation.opco_cust_trans"], "model.OI_Foundation.v_opco_pymnt_mode_lineage": ["model.OI_Foundation.opco_pymnt_mode"], "model.OI_Foundation.v_opco_cash_dscnt_terms_lineage": ["model.OI_Foundation.opco_cash_dscnt_terms"], "model.OI_Foundation.v_opco_picking_list_lineage": ["model.OI_Foundation.opco_picking_list"], "model.OI_Foundation.v_opco_cust_type_lineage": ["model.OI_Foundation.opco_cust_type"], "model.OI_Foundation.v_opco_handling_status_lineage": ["model.OI_Foundation.opco_handling_status"], "model.OI_Foundation.v_opco_po_lineage": ["model.OI_Foundation.opco_po"], "model.OI_Foundation.v_opco_po_doc_status_lineage": ["model.OI_Foundation.opco_po_doc_status"], "model.OI_Foundation.v_opco_po_line_lineage": ["model.OI_Foundation.opco_po_line"], "model.OI_Foundation.v_opco_po_type_lineage": ["model.OI_Foundation.opco_po_type"], "model.OI_Foundation.v_opco_vendor_invoice_line_lineage": ["model.OI_Foundation.opco_vendor_invoice_line"], "model.OI_Foundation.v_opco_vendor_packing_slip_lineage": ["model.OI_Foundation.opco_vendor_packing_slip"], "model.OI_Foundation.v_opco_vendor_trans_lineage": ["model.OI_Foundation.opco_vendor_trans"], "model.OI_Foundation.v_opco_vendor_invoice_lineage": ["model.OI_Foundation.opco_vendor_invoice"], "model.OI_Foundation.v_opco_vendor_packing_slip_line_lineage": ["model.OI_Foundation.opco_vendor_packing_slip_line"], "model.OI_Foundation.v_opco_item_size_lineage": ["model.OI_Foundation.opco_item_size"], "model.OI_Foundation.v_opco_uom_lineage": ["model.OI_Foundation.opco_uom"], "model.OI_Foundation.v_opco_lob_lineage": ["model.OI_Foundation.opco_lob"], "model.OI_Foundation.v_opco_item_psi_dtl_lineage": ["model.OI_Foundation.opco_item_psi_dtl"], "model.OI_Foundation.v_opco_item_sls_class_lineage": ["model.OI_Foundation.opco_item_sls_class"], "model.OI_Foundation.v_opco_invtry_trans_lineage": ["model.OI_Foundation.opco_invtry_trans"], "model.OI_Foundation.v_opco_item_lineage": ["model.OI_Foundation.opco_item"], "model.OI_Foundation.v_opco_invtry_rcpt_status_lineage": ["model.OI_Foundation.opco_invtry_rcpt_status"], "model.OI_Foundation.v_opco_item_grp_lineage": ["model.OI_Foundation.opco_item_grp"], "model.OI_Foundation.v_opco_item_model_grp_lineage": ["model.OI_Foundation.opco_item_model_grp"], "model.OI_Foundation.v_opco_invtry_issue_status_lineage": ["model.OI_Foundation.opco_invtry_issue_status"], "model.OI_Foundation.v_opco_item_freight_lineage": ["model.OI_Foundation.opco_item_freight"], "model.OI_Foundation.v_opco_brand_lineage": ["model.OI_Foundation.opco_brand"], "model.OI_Foundation.v_opco_item_subtype_lineage": ["model.OI_Foundation.opco_item_subtype"], "model.OI_Foundation.v_opco_item_invtry_lineage": ["model.OI_Foundation.opco_item_invtry"], "model.OI_Foundation.v_opco_purpose_lineage": ["model.OI_Foundation.opco_purpose"], "model.OI_Foundation.v_opco_vendor_lineage": ["model.OI_Foundation.opco_vendor"], "model.OI_Foundation.v_opco_item_opco_assctn_xref_lineage": ["model.OI_Foundation.opco_item_opco_assctn_xref"], "model.OI_Foundation.v_opco_item_class_lineage": ["model.OI_Foundation.opco_item_class"], "model.OI_Foundation.v_opco_invtry_trans_type_lineage": ["model.OI_Foundation.opco_invtry_trans_type"], "model.OI_Foundation.v_opco_item_type_lineage": ["model.OI_Foundation.opco_item_type"], "model.OI_Foundation.v_opco_item_cvrg_grp_lineage": ["model.OI_Foundation.opco_item_cvrg_grp"], "model.OI_Foundation.v_opco_vendor_opco_locn_xref_lineage": ["model.OI_Foundation.opco_vendor_opco_locn_xref"], "model.OI_Foundation.v_opco_cust_opco_locn_xref_lineage": ["model.OI_Foundation.opco_cust_opco_locn_xref"], "model.OI_Foundation.v_opco_locn_lineage": ["model.OI_Foundation.opco_locn"], "model.OI_Foundation.v_opco_opco_locn_xref_lineage": ["model.OI_Foundation.opco_opco_locn_xref"], "model.OI_Foundation.v_opco_cost_center_lineage": ["model.OI_Foundation.opco_cost_center"], "model.OI_Foundation.v_opco_lineage": ["model.OI_Foundation.opco"], "model.OI_Foundation.v_sub_region_lineage": ["model.OI_Foundation.sub_region"], "model.OI_Foundation.v_opco_dept_lineage": ["model.OI_Foundation.opco_dept"], "model.OI_Foundation.v_opco_site_lineage": ["model.OI_Foundation.opco_site"], "model.OI_Foundation.v_warehouse_lineage": ["model.OI_Foundation.warehouse"], "model.OI_Foundation.v_fscl_clndr_lineage": ["model.OI_Foundation.fscl_clndr"], "model.OI_Foundation.v_opco_type_lineage": ["model.OI_Foundation.opco_type"], "model.OI_Foundation.v_opco_assctn_lineage": ["model.OI_Foundation.opco_assctn"], "model.OI_Foundation.v_region_lineage": ["model.OI_Foundation.region"], "model.OI_Foundation.v_opco_sls_ordr_type_lineage": ["model.OI_Foundation.opco_sls_ordr_type"], "model.OI_Foundation.v_opco_dlvry_mode_lineage": ["model.OI_Foundation.opco_dlvry_mode"], "model.OI_Foundation.v_opco_trans_status_lineage": ["model.OI_Foundation.opco_trans_status"], "model.OI_Foundation.v_opco_dlvry_terms_lineage": ["model.OI_Foundation.opco_dlvry_terms"], "model.OI_Foundation.v_opco_sls_ordr_line_lineage": ["model.OI_Foundation.opco_sls_ordr_line"], "model.OI_Foundation.v_sls_ordr_opco_locn_xref_lineage": ["model.OI_Foundation.sls_ordr_opco_locn_xref"], "model.OI_Foundation.v_opco_sls_ordr_doc_status_lineage": ["model.OI_Foundation.opco_sls_ordr_doc_status"], "model.OI_Foundation.v_opco_sls_ordr_lineage": ["model.OI_Foundation.opco_sls_ordr"], "model.OI_Foundation.v_opco_project_trans_status_lineage": ["model.OI_Foundation.opco_project_trans_status"], "model.OI_Foundation.v_opco_project_trans_posting_lineage": ["model.OI_Foundation.opco_project_trans_posting"], "model.OI_Foundation.v_opco_project_invoice_project_xref_lineage": ["model.OI_Foundation.opco_project_invoice_project_xref"], "model.OI_Foundation.v_opco_project_empl_frcst_lineage": ["model.OI_Foundation.opco_project_empl_frcst"], "model.OI_Foundation.v_opco_project_trans_origin_lineage": ["model.OI_Foundation.opco_project_trans_origin"], "model.OI_Foundation.v_opco_project_empl_trans_lineage": ["model.OI_Foundation.opco_project_empl_trans"], "model.OI_Foundation.v_opco_project_revenue_trans_lineage": ["model.OI_Foundation.opco_project_revenue_trans"], "model.OI_Foundation.v_opco_project_lineage": ["model.OI_Foundation.opco_project"], "model.OI_Foundation.v_opco_project_cost_trans_lineage": ["model.OI_Foundation.opco_project_cost_trans"], "model.OI_Foundation.v_opco_project_item_trans_lineage": ["model.OI_Foundation.opco_project_item_trans"], "model.OI_Foundation.v_opco_project_cost_frcst_lineage": ["model.OI_Foundation.opco_project_cost_frcst"], "model.OI_Foundation.v_opco_project_catgry_lineage": ["model.OI_Foundation.opco_project_catgry"], "source.OI_Foundation.AX_DEV.INVENTTABLE": ["model.OI_Foundation.ax_opco_item", "model.OI_Foundation.ax_opco_item_freight"], "source.OI_Foundation.AX_DEV.CUSTTABLE": ["model.OI_Foundation.ax_opco_cust", "model.OI_Foundation.ax_opco_cust_opco_locn_xref", "model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_opco_cust_xref"], "source.OI_Foundation.AX_DEV.CUSTPRECASTCODE_OPI": ["model.OI_Foundation.ax_opco_cust_code"], "source.OI_Foundation.AX_DEV.COMPANYINFO": ["model.OI_Foundation.ax_opco", "model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_opco_locn_xref", "model.OI_Foundation.ax_region", "model.OI_Foundation.ax_sub_region"], "source.OI_Foundation.AX_DEV.INVENTSITE": ["model.OI_Foundation.ax_opco_site"], "source.OI_Foundation.AX_DEV.INVENTLOCATION": ["model.OI_Foundation.ax_warehouse"], "source.OI_Foundation.AX_DEV.CUSTGROUP": ["model.OI_Foundation.ax_opco_cust_grp"], "source.OI_Foundation.AX_DEV.CUSTPAYMMODETABLE": ["model.OI_Foundation.ax_opco_pymnt_mode"], "source.OI_Foundation.AX_DEV.CUSTPRECASTCATEGORY_OPI": ["model.OI_Foundation.ax_opco_cust_type"], "source.OI_Foundation.AX_DEV.CURRENCY": ["model.OI_Foundation.ax_opco_currency"], "source.OI_Foundation.AX_DEV.PAYMTERM": ["model.OI_Foundation.ax_opco_pymnt_terms"], "source.OI_Foundation.AX_DEV.CASHDISC": ["model.OI_Foundation.ax_opco_cash_dscnt_terms"], "source.OI_Foundation.AX_DEV.COMMISSIONCUSTOMERGROUP": ["model.OI_Foundation.ax_opco_commsn_grp", "model.OI_Foundation.ax_opco_sls_ordr"], "source.OI_Foundation.AX_DEV.ADDRESS": ["model.OI_Foundation.ax_opco_locn"], "source.OI_Foundation.AX_DEV.SALESTABLE": ["model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_sls_ordr", "model.OI_Foundation.ax_sls_ordr_opco_locn_xref"], "source.OI_Foundation.AX_DEV.VENDTABLE": ["model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_vendor", "model.OI_Foundation.ax_opco_vendor_opco_locn_xref"], "source.OI_Foundation.AX_DEV.CONTACTPERSON": ["model.OI_Foundation.ax_opco_cust_opco_locn_xref", "model.OI_Foundation.ax_sls_ordr_opco_locn_xref"], "source.OI_Foundation.AX_DEV.DIMENSIONS": ["model.OI_Foundation.ax_opco_cost_center", "model.OI_Foundation.ax_opco_cost_center", "model.OI_Foundation.ax_opco_dept", "model.OI_Foundation.ax_opco_dept", "model.OI_Foundation.ax_opco_lob", "model.OI_Foundation.ax_opco_lob", "model.OI_Foundation.ax_opco_purpose", "model.OI_Foundation.ax_opco_purpose", "model.OI_Foundation.ax_opco_type", "model.OI_Foundation.ax_opco_type"], "source.OI_Foundation.AX_DEV.UNIT": ["model.OI_Foundation.ax_opco_uom"], "source.OI_Foundation.AX_DEV.INVENTDIMGROUP": [], "source.OI_Foundation.AX_DEV.INVENTITEMBUYERGROUP": [], "source.OI_Foundation.AX_DEV.INVENTITEMGROUP": ["model.OI_Foundation.ax_opco_item_freight", "model.OI_Foundation.ax_opco_item_grp"], "source.OI_Foundation.AX_DEV.INVENTMODELGROUP": ["model.OI_Foundation.ax_opco_item_model_grp"], "source.OI_Foundation.AX_DEV.INVENTPRECASTCATEGORY_OPI": ["model.OI_Foundation.ax_opco_item_type"], "source.OI_Foundation.AX_DEV.INVENTPRECASTCODE_OPI": ["model.OI_Foundation.ax_opco_item_subtype"], "source.OI_Foundation.AX_DEV.INVENTPRODUCTCLASS_OPI": ["model.OI_Foundation.ax_opco_item_class"], "source.OI_Foundation.AX_DEV.REQGROUP": ["model.OI_Foundation.ax_opco_item_cvrg_grp"], "source.OI_Foundation.AX_DEV.INVENTSALESCLASS_OPI": ["model.OI_Foundation.ax_opco_item_sls_class"], "source.OI_Foundation.AX_DEV.INVENTSIZE": ["model.OI_Foundation.ax_opco_item_size"], "source.OI_Foundation.AX_DEV.INVENTDIM": ["model.OI_Foundation.ax_opco_assctn"], "source.OI_Foundation.AX_DEV.INVENTITEMPRICE": [], "source.OI_Foundation.AX_DEV.LEDGERTABLE": ["model.OI_Foundation.ax_chart_of_accts", "model.OI_Foundation.ax_opco_chart_of_accts", "model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans"], "source.OI_Foundation.AX_DEV.LEDGERBALANCESDIMTRANS": [], "source.OI_Foundation.AX_DEV.INVENTITEMLOCATION": ["model.OI_Foundation.ax_opco_item_opco_assctn_xref"], "source.OI_Foundation.AX_DEV.INVENTSUM": ["model.OI_Foundation.ax_opco_item_invtry"], "source.OI_Foundation.AX_DEV.INVENTTABLEMODULE": ["model.OI_Foundation.ax_opco_item_psi_dtl"], "source.OI_Foundation.AX_DEV.INVENTTRANS": ["model.OI_Foundation.ax_opco_invtry_trans"], "source.OI_Foundation.AX_DEV.DLVTERM": ["model.OI_Foundation.ax_opco_dlvry_terms"], "source.OI_Foundation.AX_DEV.DLVMODE": ["model.OI_Foundation.ax_opco_dlvry_mode"], "source.OI_Foundation.AX_DEV.SALESLINE": ["model.OI_Foundation.ax_opco_sls_ordr_line"], "source.OI_Foundation.AX_DEV.LEDGERTRANS": ["model.OI_Foundation.ax_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ax_opco_gl_trans"], "source.OI_Foundation.AX_DEV.PURCHTABLE": ["model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_po"], "source.OI_Foundation.AX_DEV.PURCHLINE": ["model.OI_Foundation.ax_opco_po_line"], "source.OI_Foundation.AX_DEV.PROJTABLE": ["model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_project", "model.OI_Foundation.ax_opco_project_invoice_project_xref"], "source.OI_Foundation.AX_DEV.VENDTRANS": ["model.OI_Foundation.ax_opco_vendor_trans"], "source.OI_Foundation.AX_DEV.VENDINVOICEJOUR": ["model.OI_Foundation.ax_opco_vendor_invoice"], "source.OI_Foundation.AX_DEV.CUSTTRANS": ["model.OI_Foundation.ax_opco_cust_trans"], "source.OI_Foundation.AX_DEV.CUSTSETTLEMENT": ["model.OI_Foundation.ax_opco_cust_settled_trans"], "source.OI_Foundation.AX_DEV.PRICEDISCGROUP": ["model.OI_Foundation.ax_opco_sls_ordr"], "source.OI_Foundation.AX_DEV.PROJCATEGORY": ["model.OI_Foundation.ax_opco_project_catgry"], "source.OI_Foundation.AX_DEV.WMSPICKINGROUTE": ["model.OI_Foundation.ax_opco_picking_list"], "source.OI_Foundation.AX_DEV.PROJCOSTTRANS": ["model.OI_Foundation.ax_opco_project_cost_trans"], "source.OI_Foundation.AX_DEV.CUSTTRANSOPEN": ["model.OI_Foundation.ax_opco_cust_open_trans"], "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPJOUR": ["model.OI_Foundation.ax_opco_cust_packing_slip", "model.OI_Foundation.ax_opco_locn"], "source.OI_Foundation.AX_DEV.CUSTPACKINGSLIPTRANS": ["model.OI_Foundation.ax_opco_cust_packing_slip_line"], "source.OI_Foundation.AX_DEV.CUSTINVOICEJOUR": ["model.OI_Foundation.ax_opco_cust_invoice", "model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_locn"], "source.OI_Foundation.AX_DEV.CUSTINVOICETRANS": ["model.OI_Foundation.ax_opco_cust_invoice_line"], "source.OI_Foundation.AX_DEV.VENDINVOICETRANS": ["model.OI_Foundation.ax_opco_vendor_invoice_line"], "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPJOUR": ["model.OI_Foundation.ax_opco_locn", "model.OI_Foundation.ax_opco_vendor_packing_slip"], "source.OI_Foundation.AX_DEV.VENDPACKINGSLIPTRANS": ["model.OI_Foundation.ax_opco_vendor_packing_slip_line"], "source.OI_Foundation.AX_DEV.PROJITEMTRANS": ["model.OI_Foundation.ax_opco_project_item_trans"], "source.OI_Foundation.AX_DEV.PROJEMPLTRANS": ["model.OI_Foundation.ax_opco_project_empl_trans"], "source.OI_Foundation.AX_DEV.PROJFORECASTCOST": ["model.OI_Foundation.ax_opco_project_cost_frcst"], "source.OI_Foundation.AX_DEV.PROJFORECASTEMPL": ["model.OI_Foundation.ax_opco_project_empl_frcst"], "source.OI_Foundation.AX_DEV.PROJTRANSPOSTING": ["model.OI_Foundation.ax_opco_project_trans_posting"], "source.OI_Foundation.AX_DEV.PROJREVENUE_OPI": ["model.OI_Foundation.ax_opco_project_revenue_trans"], "source.OI_Foundation.AX_PRODVIEW.DIM_TIME_93": ["model.OI_Foundation.ax_fscl_clndr"], "source.OI_Foundation.NS_DEV.PAYMENT_TERMS": ["model.OI_Foundation.ns_opco_pymnt_terms"], "source.OI_Foundation.NS_DEV.PAYMENT_METHODS": ["model.OI_Foundation.ns_opco_pymnt_mode"], "source.OI_Foundation.NS_DEV.CURRENCIES": ["model.OI_Foundation.ns_opco_currency"], "source.OI_Foundation.NS_DEV.LOCATIONS": ["model.OI_Foundation.ns_opco_cost_center"], "source.OI_Foundation.NS_DEV.DEPARTMENTS": ["model.OI_Foundation.ns_opco_dept"], "source.OI_Foundation.NS_DEV.COMPANY_OPI": [], "source.OI_Foundation.NS_DEV.REGION_OPI": ["model.OI_Foundation.ns_region"], "source.OI_Foundation.NS_DEV.SUBREGION_OPI": ["model.OI_Foundation.ns_sub_region"], "source.OI_Foundation.NS_DEV.ACCOUNTS": ["model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_chart_of_accts", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans", "model.OI_Foundation.ns_opco_type", "model.OI_Foundation.ns_opco_type"], "source.OI_Foundation.NS_DEV.TRANSACTIONS": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans", "model.OI_Foundation.ns_opco_gl_trans_type"], "source.OI_Foundation.NS_DEV.TRANSACTION_LINES": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "source.OI_Foundation.NS_DEV.ACCOUNTING_PERIODS": ["model.OI_Foundation.ns_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.ns_opco_gl_trans"], "source.OI_Foundation.NS_DEV.MARKET_OPI": ["model.OI_Foundation.ns_opco_purpose"], "source.OI_Foundation.NS_DEV.CLASSES": ["model.OI_Foundation.ns_opco_brand"], "source.OI_Foundation.NS_DEV.UOM": ["model.OI_Foundation.ns_opco_uom"], "source.OI_Foundation.NS_DEV.SUBSIDIARIES": ["model.OI_Foundation.ns_opco", "model.OI_Foundation.ns_opco_chart_of_accts"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0013": ["model.OI_Foundation.jde_opco_currency"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0010": ["model.OI_Foundation.jde_opco"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0101": ["model.OI_Foundation.jde_opco"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F01151": ["model.OI_Foundation.jde_opco"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0006": ["model.OI_Foundation.jde_opco_chart_of_accts", "model.OI_Foundation.jde_opco_cost_center"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODCTL_F0005": ["model.OI_Foundation.jde_opco_gl_trans_type", "model.OI_Foundation.jde_opco_uom"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0901": ["model.OI_Foundation.jde_opco_chart_of_accts"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0911": ["model.OI_Foundation.jde_opco_gl_trans"], "source.OI_Foundation.JDE_DEV.JDE_PRODUCTION_PRODDTA_F0902": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal"], "source.OI_Foundation.JDE_DEV.JDE920_DD920_F9210": ["model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_fscl_yr_gl_opening_bal", "model.OI_Foundation.jde_opco_gl_trans", "model.OI_Foundation.jde_opco_gl_trans", "model.OI_Foundation.jde_opco_gl_trans"], "source.OI_Foundation.PRIMEX_DEV.COMPANYA_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYC_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYP_DBO_TBLCURRENCY": [], "source.OI_Foundation.PRIMEX_DEV.COMPANYX_DBO_TBLCURRENCY": []}}